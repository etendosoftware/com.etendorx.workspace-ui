# Contexto del Código Fuente del Proyecto

Generado el: 2025-08-05 22:14:04
Directorio raíz del proyecto: `.`
Archivos incluidos (2): 517

---

## Archivo: `packages/ComponentLibrary/__mocks__/ReactMarkdownMock.tsx`

```typescript
import { ReactNode } from "react";

interface ChildrenProps {
  children: ReactNode;
}

function ReactMarkdownMock({ children }: ChildrenProps) {
  return <p>{children}</p>;
}

export default ReactMarkdownMock;
```

## Archivo: `packages/ComponentLibrary/__tests__/IconButton.test.tsx`

```typescript
import { render, screen, fireEvent } from "@testing-library/react";
import userEvent from "@testing-library/user-event";
import IconButton from "../src/components/IconButton/index";

// Mock the Tooltip component to simplify testing
jest.mock("../src/components/Tooltip", () => ({
  __esModule: true,
  default: ({ children }: { children: React.ReactNode }) => <div>{children}</div>,
}));

describe("IconButton", () => {
  it("renders with children", () => {
    render(
      <IconButton ariaLabel="test button">
        <svg data-testid="test-icon" />
      </IconButton>
    );

    expect(screen.getByRole("button")).toBeDefined();
    expect(screen.getByTestId("test-icon")).toBeDefined();
  });

  it("applies aria-label correctly", () => {
    render(
      <IconButton ariaLabel="Close dialog">
        <span>X</span>
      </IconButton>
    );

    expect(screen.getByRole("button")).toHaveAttribute("aria-label", "Close dialog");
  });

  it("handles click events", async () => {
    const handleClick = jest.fn();
    const user = userEvent.setup();

    render(
      <IconButton onClick={handleClick} ariaLabel="click me">
        <span>Click</span>
      </IconButton>
    );

    await user.click(screen.getByRole("button"));
    expect(handleClick).toHaveBeenCalledTimes(1);
  });

  it("is disabled when disabled prop is true", () => {
    const handleClick = jest.fn();

    render(
      <IconButton disabled onClick={handleClick} ariaLabel="disabled button">
        <span>Disabled</span>
      </IconButton>
    );

    const button = screen.getByRole("button");
    expect(button).toBeDisabled();

    fireEvent.click(button);
    expect(handleClick).not.toHaveBeenCalled();
  });

  it("renders icon text when provided", () => {
    render(
      <IconButton iconText="Save" ariaLabel="save button">
        <svg data-testid="save-icon" />
      </IconButton>
    );

    expect(screen.getByText("Save")).toBeDefined();
    expect(screen.getByTestId("save-icon")).toBeDefined();
  });

  it("passes through additional props", () => {
    render(
      <IconButton data-testid="custom-button" id="my-button" ariaLabel="button with props">
        <span>Props</span>
      </IconButton>
    );

    const button = screen.getByRole("button");
    expect(button).toHaveAttribute("data-testid", "custom-button");
    expect(button).toHaveAttribute("id", "my-button");
  });

  it("has correct default button type", () => {
    render(
      <IconButton ariaLabel="default type">
        <span>Default</span>
      </IconButton>
    );

    expect(screen.getByRole("button")).toHaveAttribute("type", "button");
  });
});

```

## Archivo: `packages/ComponentLibrary/src/commons.ts`

```typescript
import type { SxProps, Theme } from "@mui/material";
import type { TagType } from "./components/Tag/types";

export interface CtaButton {
  key: string;
  label: string;
  action: () => void;
  icon?: React.ComponentType;
  sx?: SxProps<Theme>;
}

export interface Inotifications {
  id: string;
  description: string;
  date: string;
  priority?: string;
  tagType?: TagType;
  icon: React.ComponentType;
  ctaButtons?: CtaButton[];
}

```

## Archivo: `packages/ComponentLibrary/src/components/Base64Icon/index.tsx`

```typescript
import Image from "next/image";

export interface Base64IconProps {
  src: string;
  alt?: string;
  className?: string;
  size?: number;
}

const DEFAULT_PROPS = {
  alt: "Icon",
  className: "",
  size: 16,
};

const CSS_CLASSES = {
  base: "icon-base64",
  hoverPrefix: "icon-hover-",
} as const;

const Base64Icon: React.FC<Base64IconProps> = ({
  src,
  alt = DEFAULT_PROPS.alt,
  className = DEFAULT_PROPS.className,
  size = DEFAULT_PROPS.size,
}) => {
  const combinedClasses = `${CSS_CLASSES.base} ${className}`.trim();

  return (
    <Image
      src={src}
      alt={alt}
      width={size}
      height={size}
      className={`w-${Math.round(size / 4)} h-${Math.round(size / 4)} ${combinedClasses}`}
    />
  );
};

export default Base64Icon;

```

## Archivo: `packages/ComponentLibrary/src/components/BasicModal/index.tsx`

```typescript
import React, { useCallback, useState, useRef, useEffect, forwardRef, useMemo } from "react";
import { Typography, Button, Box, useTheme } from "@mui/material";
import ModalMUI from "@mui/material/Modal";
import IconButton from "../IconButton";
import { Container, Position } from "../enums";
import type { ModalIProps } from "./types";
import { IconSize, useStyles } from "./styles";
import CloseIcon from "../../assets/icons/x.svg";
import MaximizeIcon from "../../assets/icons/maximize-2.svg";
import MinimizeIcon from "../../assets/icons/minimize-2.svg";
import { calculateModalStyles } from "../../helpers/updateModal";

const Modal = forwardRef<HTMLDivElement, ModalIProps>(
  (
    {
      height = Container.Auto,
      width = Container.Auto,
      posX = Position.Center,
      posY = Position.Center,
      children,
      customTrigger,
      onClose,
      onSave,
      onCancel,
      tittleHeader,
      descriptionText,
      HeaderIcon,
      secondaryButtonLabel,
      saveButtonLabel,
      showHeader,
      buttons,
      SaveIcon,
      backgroundGradient,
      isFullScreenEnabled = false,
      open: externalOpen,
    },
    ref
  ) => {
    const [internalOpen, setInternalOpen] = useState<boolean>(false);
    const [isFullScreen, setIsFullScreen] = useState<boolean>(false);
    const theme = useTheme();
    const { styles, sx } = useStyles();
    const prevOpenRef = useRef(externalOpen);

    const isOpen = externalOpen !== undefined ? externalOpen : internalOpen;

    useEffect(() => {
      if (externalOpen !== undefined && prevOpenRef.current !== externalOpen) {
        setInternalOpen(externalOpen);
        prevOpenRef.current = externalOpen;
      }
    }, [externalOpen]);

    const handleOpen = useCallback(() => {
      setInternalOpen(true);
    }, []);

    const handleClose = useCallback(() => {
      if (typeof onClose === "function") {
        onClose();
      }

      if (externalOpen === undefined) {
        setInternalOpen(false);
      }
      setIsFullScreen(false);
    }, [onClose, externalOpen]);

    const handleSave = useCallback(() => {
      if (typeof onSave === "function") {
        onSave();
      }
      if (externalOpen === undefined) {
        setInternalOpen(false);
      }
    }, [onSave, externalOpen]);

    const handleCancel = useCallback(() => {
      if (typeof onCancel === "function") {
        onCancel();
      }
      if (externalOpen === undefined) {
        setInternalOpen(false);
      }
    }, [onCancel, externalOpen]);

    const gradientStyles = useMemo(
      () =>
        !backgroundGradient
          ? {}
          : {
              "&::before": {
                content: '""',
                position: "absolute",
                top: "-2px",
                left: "-2px",
                right: "-2px",
                height: "50%",
                background: backgroundGradient,
                borderTopLeftRadius: "1rem",
                borderTopRightRadius: "1rem",
                zIndex: 0,
              },
            },
      [backgroundGradient]
    );

    const toggleFullScreen = useCallback(() => {
      setIsFullScreen((prev) => !prev);
    }, []);

    const modalStyles = useMemo(
      () => (isFullScreen ? sx.fullScreenStyles : calculateModalStyles({ height, width, posX, posY })),
      [isFullScreen, sx.fullScreenStyles, height, width, posX, posY]
    );

    const contentStyles = useMemo(
      () =>
        isFullScreen
          ? {
              flex: 1,
              display: "flex",
              flexDirection: "column",
              justifyContent: "center",
              alignItems: "center",
              overflowY: "auto",
            }
          : {},
      [isFullScreen]
    );

    const renderTrigger = useCallback(() => {
      if (externalOpen !== undefined) {
        return null;
      }

      if (customTrigger) {
        return React.cloneElement(customTrigger as React.ReactElement, {
          onClick: handleOpen,
        });
      }

      return (
        <Button onClick={handleOpen} variant="contained">
          Modal
        </Button>
      );
    }, [customTrigger, externalOpen, handleOpen]);

    if (!isOpen) {
      return renderTrigger();
    }

    return (
      <>
        {renderTrigger()}
        <ModalMUI open={isOpen} onClose={handleClose} keepMounted={false} closeAfterTransition>
          <Box
            ref={ref}
            sx={{
              ...styles.boxStyles,
              ...modalStyles,
              ...gradientStyles,
            }}>
            <Box sx={sx.modalContainer}>
              {showHeader && (
                <Box sx={sx.headerContainer}>
                  <Box sx={sx.titleContainer}>
                    {HeaderIcon && (
                      <Box sx={sx.closeRecordButton}>
                        <HeaderIcon
                          fill={theme.palette.baselineColor.etendoPrimary.main}
                          width={IconSize}
                          height={IconSize}
                        />
                      </Box>
                    )}
                    <Typography sx={sx.registerText}>{tittleHeader}</Typography>
                  </Box>
                </Box>
              )}
              {descriptionText && <Typography sx={sx.descriptionText}>{descriptionText}</Typography>}
              <Box sx={sx.actionButtons}>
                {isFullScreenEnabled && (
                  <IconButton aria-label="fullscreen" className="h-4 w-4" onClick={toggleFullScreen}>
                    {isFullScreen ? <MinimizeIcon /> : <MaximizeIcon />}
                  </IconButton>
                )}
                <IconButton aria-label="close" className="h-6 w-4" onClick={handleCancel}>
                  <CloseIcon />
                </IconButton>
              </Box>
              <Box sx={contentStyles}>{children}</Box>
              {buttons ? (
                <Box style={styles.buttonContainerStyles}>{buttons}</Box>
              ) : (
                secondaryButtonLabel &&
                saveButtonLabel &&
                SaveIcon && (
                  <Box style={styles.buttonContainerStyles}>
                    <Button sx={sx.cancelButton} onClick={handleCancel}>
                      {secondaryButtonLabel}
                    </Button>
                    <Button
                      startIcon={
                        <SaveIcon fill={theme.palette.baselineColor.neutral[0]} width={IconSize} height={IconSize} />
                      }
                      sx={sx.saveButton}
                      onClick={handleSave}>
                      {saveButtonLabel}
                    </Button>
                  </Box>
                )
              )}
            </Box>
          </Box>
        </ModalMUI>
      </>
    );
  }
);

Modal.displayName = "Modal";

export default Modal;

```

## Archivo: `packages/ComponentLibrary/src/components/BasicModal/styles.ts`

```typescript
import { type CSSProperties, useMemo } from "react";
import { type SxProps, type Theme, useTheme } from "@mui/material";

export const IconSize = 20;

export const useStyles = () => {
  const theme = useTheme();
  return useMemo(
    () => ({
      styles: {
        boxStyles: {
          position: "absolute",
          width: "18.75rem",
          background: theme.palette.baselineColor.neutral[0],
          border: `2px solid ${theme.palette.baselineColor.transparentNeutral[10]}`,
          borderRadius: "1.125rem",
          boxShadow: `0px 0.25rem 0.625rem 0px ${theme.palette.baselineColor.neutral[90]}`,
        },
        modalStyles: {
          display: "flex",
          alignItems: "center",
          justifyContent: "center",
        },
        buttonContainerStyles: {
          display: "flex",
          justifyContent: "flex-end",
          alignItems: "center",
          gap: "0.5rem",
          flex: "1 0 0",
        },
      } as { [key: string]: CSSProperties },
      sx: {
        actionButtons: {
          position: "absolute",
          right: 8,
          top: 8,
          display: "flex",
          gap: "0.5rem",
        },
        fullScreenStyles: {
          position: "fixed",
          width: "100vw",
          height: "100vh",
        },
        actionButton: {
          background: "none",
          "&:hover": {
            background: theme.palette.baselineColor.transparentNeutral[5],
          },
        },
        headerContainer: {
          display: "flex",
          justifyContent: "space-between",
          alignItems: "flex-start",
        },
        titleContainer: {
          display: "flex",
          alignItems: "center",
          marginBottom: "1rem",
        },
        closeRecordButton: {
          width: "2.5rem",
          height: "2.5rem",
          display: "flex",
          justifyContent: "center",
          alignItems: "center",
          background: theme.palette.dynamicColor.contrastText,
          borderRadius: "2rem",
          marginRight: "0.5rem",
          "&:hover": {
            borderRadius: "2rem",
            background: theme.palette.dynamicColor.contrastText,
          },
        },
        modalContainer: {
          display: "flex",
          flexDirection: "column",
          padding: "2.5rem",
        },
        registerText: { fontSize: "1.275rem", fontWeight: "600" },
        descriptionText: {
          marginBottom: "1rem",
          fontSize: "0.875rem",
          fontWeight: "500",
          color: theme.palette.baselineColor.transparentNeutral[60],
        },
        saveButton: {
          fontWeight: "600",
          fontSize: "0.875rem",
          color: theme.palette.baselineColor.neutral[0],
          padding: "0.5rem 1rem",
          background: theme.palette.baselineColor.neutral[100],
          flex: "1 0 0",
          borderRadius: "6.25rem",
          border: `1px solid ${theme.palette.baselineColor.transparentNeutral[80]}`,
          height: "2.5rem",
          "&:hover": {
            borderRadius: "6.25rem",
            background: theme.palette.dynamicColor.main,
            color: theme.palette.baselineColor.neutral[0],
          },
          "&:disabled": {
            border: "none",
            color: theme.palette.baselineColor.neutral[0],
            background: theme.palette.baselineColor.transparentNeutral[10],
          },
        },
        cancelButton: {
          fontWeight: "600",
          fontSize: "0.875rem",
          padding: "0.5rem 1rem",
          cursor: "pointer",
          height: "2.5rem",
          borderRadius: "6.25rem",
          border: `1px solid ${theme.palette.baselineColor.transparentNeutral[20]}`,
          flex: "1 0 0",
          color: theme.palette.baselineColor.transparentNeutral[70],
          background: theme.palette.baselineColor.neutral[0],
          "&:hover": {
            borderRadius: "6.25rem",
            background: theme.palette.dynamicColor.main,
            color: theme.palette.baselineColor.neutral[0],
          },
        },
      } as { [key: string]: SxProps<Theme> },
    }),
    [theme]
  );
};

```

## Archivo: `packages/ComponentLibrary/src/components/BasicModal/types.ts`

```typescript
import type { ModalProps } from "@mui/material";
import type { ReactNode } from "react";

export interface ModalIProps extends Omit<ModalProps, "children" | "open"> {
  height?: string | number;
  width?: string | number;
  posX?: string | number;
  posY?: string | number;
  children: ReactNode;
  customTrigger?: ReactNode;
  onClose?: () => void;
  onSave?: () => void;
  onCancel?: () => void;
  tittleHeader?: string | undefined;
  descriptionText?: string | undefined;
  HeaderIcon?: React.ElementType;
  SaveIcon?: React.ElementType;
  secondaryButtonLabel?: string | undefined;
  saveButtonLabel?: string | undefined;
  showHeader?: boolean;
  buttons?: ReactNode;
  backgroundGradient?: string;
  isFullScreenEnabled?: boolean;
  open?: boolean;
  onAfterClose?: () => void;
}

```

## Archivo: `packages/ComponentLibrary/src/components/Breadcrums/BreadcrumbItem/index.tsx`

```typescript
import { Box, Button, Typography, useTheme } from "@mui/material";
import type { FC } from "react";
import ChevronDown from "../../../assets/icons/chevron-down.svg";
import ArrowLeftIcon from "../../../assets/icons/arrow-left.svg";
import IconButton from "../../IconButton";
import { useStyle } from "../styles";
import type { BreadcrumbItemProps } from "../types";
import { useCallback } from "react";

const BreadcrumbItem: FC<BreadcrumbItemProps> = ({
  item,
  position,
  breadcrumbsSize,
  handleActionMenuOpen,
  handleHomeNavigation,
}) => {
  const theme = useTheme();
  const { sx } = useStyle();

  const isFirst = position === 0;
  const isLast = position === breadcrumbsSize - 1;

  const handleClick = useCallback(
    (e: React.MouseEvent<HTMLButtonElement>) => {
      e.preventDefault();
      if (breadcrumbsSize > 1 && item?.onClick) {
        item.onClick();
        return;
      }
      handleHomeNavigation();
    },
    [handleHomeNavigation, breadcrumbsSize, item]
  );

  return (
    <Box key={item.id} sx={sx.breadcrumbItem}>
      {isFirst && (
        <Box sx={sx.iconContainer}>
          <IconButton
            onClick={handleClick}
            className="w-8 h-8 bg-transparent hover:bg-[var(--color-transparent-neutral-5)] hover:text-(--color-baseline-80)"
            aria-label="Go back">
            <ArrowLeftIcon className="h-[1.125rem] w-[1.125rem]" />
          </IconButton>
        </Box>
      )}
      {isLast ? (
        <>
          <Typography
            noWrap
            sx={sx.lastItemTypography}
            onClick={(e: React.MouseEvent<HTMLButtonElement>) => {
              if (item.actions && item.actions.length > 0) {
                handleActionMenuOpen(e, item.actions);
              }
            }}>
            {item.label}
          </Typography>
          {item.actions &&
            item.actions.length > 0 &&
            (() => {
              const actions = item.actions;
              return (
                <IconButton onClick={(e) => handleActionMenuOpen(e, actions)}>
                  <ChevronDown fill={theme.palette.baselineColor.neutral[80]} />
                </IconButton>
              );
            })()}
        </>
      ) : (
        <Button
          sx={sx.textButton}
          onClick={(e: React.MouseEvent<HTMLButtonElement>) => {
            e.preventDefault();
            item.onClick?.();
          }}
          aria-label="Go back"
          aria-current="page">
          <Typography noWrap sx={sx.breadcrumbTypography}>
            {item.label}
          </Typography>
        </Button>
      )}
    </Box>
  );
};

export default BreadcrumbItem;

```

## Archivo: `packages/ComponentLibrary/src/components/Breadcrums/BreadcrumbList/index.tsx`

```typescript
import { Box, Breadcrumbs, MenuItem, useTheme } from "@mui/material";
import { type FC, useCallback, useMemo, useState } from "react";
import MoreHorizIcon from "../../../assets/icons/more-horizontal.svg";
import IconButton from "../../IconButton";
import Menu from "../../Menu";
import { useStyle } from "../styles";
import type { BreadcrumbListProps } from "../types";
import BreadcrumbItem from "../BreadcrumbItem/index";

const BreadcrumbList: FC<BreadcrumbListProps> = ({ items, handleActionMenuOpen, handleHomeNavigation, separator }) => {
  const [middleAnchorEl, setMiddleAnchorEl] = useState<HTMLButtonElement | null>(null);
  const theme = useTheme();
  const { sx } = useStyle();

  const handleMiddleMenuOpen = useCallback((event: React.MouseEvent<HTMLButtonElement>) => {
    setMiddleAnchorEl(event.currentTarget);
  }, []);

  const handleMiddleMenuClose = useCallback(() => {
    setMiddleAnchorEl(null);
  }, []);

  const firstItem = useMemo(() => items[0], [items]);
  const lastItem = useMemo(() => items[items.length - 1], [items]);
  const middleItems = useMemo(() => items.slice(1, -1), [items]);

  if (items.length <= 2) {
    return (
      <Breadcrumbs separator={separator} aria-label="breadcrumb" sx={sx.breadcrumbs}>
        {items.map((item, index) => (
          <BreadcrumbItem
            key={item.id}
            item={item}
            position={index}
            breadcrumbsSize={items.length}
            handleActionMenuOpen={handleActionMenuOpen}
            handleHomeNavigation={handleHomeNavigation}
          />
        ))}
      </Breadcrumbs>
    );
  }

  return (
    <Breadcrumbs separator={separator} aria-label="breadcrumb" sx={sx.breadcrumbs}>
      <BreadcrumbItem
        item={firstItem}
        position={0}
        breadcrumbsSize={items.length}
        handleActionMenuOpen={handleActionMenuOpen}
        handleHomeNavigation={handleHomeNavigation}
      />
      {middleItems.length > 0 && (
        <Box sx={sx.breadcrumbItem}>
          <IconButton onClick={handleMiddleMenuOpen}>
            <MoreHorizIcon fill={theme.palette.baselineColor.neutral[80]} />
          </IconButton>
          <Menu anchorEl={middleAnchorEl} onClose={handleMiddleMenuClose}>
            {middleItems.map((item) => (
              <MenuItem
                key={item.id}
                onClick={() => {
                  item.onClick?.();
                  handleMiddleMenuClose();
                }}
                sx={sx.menuItem}>
                {item.label}
              </MenuItem>
            ))}
          </Menu>
        </Box>
      )}
      <BreadcrumbItem
        item={lastItem}
        position={items.length - 1}
        breadcrumbsSize={items.length}
        handleActionMenuOpen={handleActionMenuOpen}
        handleHomeNavigation={handleHomeNavigation}
      />
    </Breadcrumbs>
  );
};

export default BreadcrumbList;

```

## Archivo: `packages/ComponentLibrary/src/components/Breadcrums/index.tsx`

```typescript
import { Box, MenuItem, useTheme } from "@mui/material";
import { type FC, useCallback, useMemo, useState } from "react";
import NavigateNextIcon from "../../assets/icons/chevron-right.svg";
import Menu from "../Menu";
import ToggleChip from "../Toggle/ToggleChip";
import { useStyle } from "./styles";
import type { BreadcrumbAction, BreadcrumbProps } from "./types";
import BreadcrumbList from "./BreadcrumbList/index";

const Breadcrumb: FC<BreadcrumbProps> = ({ items, separator, onHomeClick }) => {
  const [anchorEl, setAnchorEl] = useState<HTMLButtonElement | null>(null);

  const [currentActions, setCurrentActions] = useState<BreadcrumbAction[]>([]);
  const [toggleStates, setToggleStates] = useState<Record<string, boolean>>({});
  const theme = useTheme();
  const { sx } = useStyle();

  const defaultSeparator = useMemo(
    () => (
      <NavigateNextIcon width="1.25rem" height="1.25rem" fill={theme.palette.baselineColor.transparentNeutral[30]} />
    ),
    [theme]
  );

  const handleActionMenuOpen = useCallback(
    (event: React.MouseEvent<HTMLButtonElement>, actions: BreadcrumbAction[]) => {
      setAnchorEl(event.currentTarget);
      setCurrentActions(actions);
    },
    []
  );

  const handleActionMenuClose = useCallback(() => {
    setAnchorEl(null);
  }, []);

  const handleToggle = useCallback((actionId: string) => {
    setToggleStates((prevStates) => ({
      ...prevStates,
      [actionId]: !prevStates[actionId],
    }));
  }, []);

  const activeSeparator = separator ?? defaultSeparator;

  return (
    <Box sx={sx.container}>
      <BreadcrumbList
        items={items}
        handleActionMenuOpen={handleActionMenuOpen}
        handleHomeNavigation={onHomeClick}
        separator={activeSeparator}
      />
      <Menu anchorEl={anchorEl} onClose={handleActionMenuClose}>
        {currentActions.map((action) => (
          <MenuItem key={action.id} onClick={() => {}} sx={sx.menuItem}>
            <Box sx={sx.iconBox}>
              {action.icon}
              <span>{action.label}</span>
            </Box>
            {action.toggle && (
              <Box sx={sx.toggleContainer}>
                <ToggleChip isActive={toggleStates[action.id] ?? false} onToggle={() => handleToggle(action.id)} />
              </Box>
            )}
          </MenuItem>
        ))}
      </Menu>
    </Box>
  );
};

export default Breadcrumb;

```

## Archivo: `packages/ComponentLibrary/src/components/Breadcrums/styles.ts`

```typescript
import { useMemo } from "react";
import { type SxProps, type Theme, useTheme } from "@mui/material";

export const menuStyle = { paddingY: 0 };

export const useStyle = () => {
  const theme = useTheme();
  return useMemo(
    () => ({
      sx: {
        container: {
          display: "flex",
          minWidth: "4.75rem",
          maxWidth: "100%",
          overflow: "hidden",
          height: "2rem",
        },
        breadcrumbs: {
          flexGrow: 1,
          overflow: "hidden",
          height: "2rem",
          "& .MuiBreadcrumbs-ol": {
            height: "2rem",
            "& .MuiBreadcrumbs-li": {
              height: "2rem",
            },
          },
        },
        breadcrumbTypography: {
          fontSize: "1.375rem",
          fontWeight: "600",
          color: theme.palette.baselineColor.neutral[100],
          "&:hover": {
            textDecoration: "underline",
            color: theme.palette.baselineColor.neutral[100],
          },
        },
        breadcrumbItem: {
          height: "2rem",
          padding: "0",
          maxWidth: "100%",
          display: "inline-flex",
          alignItems: "center",
          gap: "0.5rem",
        },
        lastItemTypography: {
          height: "2rem",
          display: "flex",
          alignItems: "center",
          padding: "0.25rem 0",
          fontSize: "1.375rem",
          fontWeight: "600",
          color: theme.palette.baselineColor.neutral[100],
        },
        textButton: {
          textDecoration: "none",
          color: "inherit",
          padding: 0,
          minWidth: "auto",
          "&:hover": {
            backgroundColor: "transparent",
            border: "none",
          },
        },
        iconContainer: {
          display: "flex",
          alignItems: "center",
        },
        iconButton: {
          padding: 0,
          minWidth: "auto",
          "&:hover": {
            backgroundColor: "transparent",
            border: "none",
          },
        },
        actionButton: {
          marginLeft: "0.5rem",
          padding: "0.25rem",
        },
        menu: {
          borderRadius: "0.75rem",
          "& .MuiPaper-root": {
            borderRadius: "0.75rem",
            background: theme.palette.dynamicColor.contrastText,
          },
        },
        menuItem: {
          display: "flex",
          justifyContent: "space-between",
          alignItems: "center",
          margin: "0.5rem",
          padding: "0.5rem",
          borderRadius: "0.5rem",
          "&:hover": {
            color: theme.palette.dynamicColor.main,
            background: theme.palette.dynamicColor.contrastText,
          },
        },
        iconBox: {
          display: "flex",
          alignItems: "center",
          "& > *:first-of-type": {
            marginRight: "0.5rem",
          },
          "& span": {
            whiteSpace: "nowrap",
            overflow: "hidden",
            textOverflow: "ellipsis",
          },
        },
        toggleContainer: {
          marginLeft: "1rem",
        },
      } as { [key: string]: SxProps<Theme> },
    }),
    [theme]
  );
};

```

## Archivo: `packages/ComponentLibrary/src/components/Breadcrums/types.ts`

```typescript
export interface BreadcrumbAction {
  id: string;
  label: string;
  icon: React.ReactNode;
  onClick?: () => void;
  toggle?: boolean;
}

export interface BreadcrumbItem {
  id: string;
  label: string;
  onClick?: () => void;
  actions?: BreadcrumbAction[];
}

export interface BreadcrumbProps {
  items: BreadcrumbItem[];
  onHomeClick: () => void;
  separator?: React.ReactNode;
}

export interface BreadcrumbListProps {
  items: BreadcrumbItem[];
  handleActionMenuOpen: (event: React.MouseEvent<HTMLButtonElement>, actions: BreadcrumbAction[]) => void;
  handleHomeNavigation: () => void;
  separator?: React.ReactNode;
}

export interface BreadcrumbItemProps {
  item: BreadcrumbItem;
  breadcrumbsSize: number;
  position: number;
  handleActionMenuOpen: (event: React.MouseEvent<HTMLButtonElement>, actions: BreadcrumbAction[]) => void;
  handleHomeNavigation: () => void;
}

```

## Archivo: `packages/ComponentLibrary/src/components/ConfigurationModal/constants.ts`

```typescript
import ThemeLightUrl from "../../assets/images/ConfigurationModal/theme-light.svg?url";
import ThemeDarkUrl from "../../assets/images/ConfigurationModal/theme-dark.svg?url";
import ThemeAutomaticUrl from "../../assets/images/ConfigurationModal/theme-automatic.svg?url";
import DensityCompactUrl from "../../assets/images/ConfigurationModal/density-compact.svg?url";
import DensityStandardUrl from "../../assets/images/ConfigurationModal/density-standard.svg?url";
import DensityComfortableUrl from "../../assets/images/ConfigurationModal/density-comfortable.svg?url";
import CommonToolbarIconUrl from "../../assets/images/ConfigurationModal/common-toolbar-buttons-icon.svg?url";
import CommonToolbarTextUrl from "../../assets/images/ConfigurationModal/common-toolbar-buttons-text.svg?url";
import CommonToolbarIconTextUrl from "../../assets/images/ConfigurationModal/common-toolbar-buttons-icon-and-text.svg?url";
import SpecificToolbarIconUrl from "../../assets/images/ConfigurationModal/specific-toolbar buttons-icon.svg?url";
import SpecificToolbarIconTextUrl from "../../assets/images/ConfigurationModal/specific-toolbar buttons-icon-and-text.svg?url";
import SpecificToolbarTextUrl from "../../assets/images/ConfigurationModal/specific-toolbar buttons-text.svg?url";
import InterfaceScaleSmallUrl from "../../assets/images/ConfigurationModal/interface-scale-small.svg?url";
import InterfaceScaleDefaultUrl from "../../assets/images/ConfigurationModal/interface-scale-default.svg?url";
import InterfaceScaleLargeUrl from "../../assets/images/ConfigurationModal/interface-scale-large.svg?url";

export const SECTION_THEME_ID = "theme";
export const SECTION_TABLE_DENSITY_ID = "tableDensity";
export const SECTION_COMMON_TOOLBAR_BUTTONS_ID = "commonToolbarButtons";
export const SECTION_SPECIFIC_TOOLBAR_BUTTONS_ID = "specificToolbarButtons";
export const SECTION_DENSITY_ID = "density";

export const THEME_ITEMS = [
  { img: ThemeLightUrl, id: "light", label: "Light" },
  { img: ThemeDarkUrl, id: "dark", label: "Dark" },
  { img: ThemeAutomaticUrl, id: "automatic", label: "Automatic" },
];

export const TABLE_DENSITY_ITEMS = [
  { img: DensityCompactUrl, id: "table-density-compact", label: "Compact" },
  { img: DensityStandardUrl, id: "table-density-standard", label: "Standard" },
  { img: DensityComfortableUrl, id: "table-density-comfortable", label: "Comfortable" },
];

export const COMMON_TOOLBAR_BUTTONS_ITEMS = [
  { img: CommonToolbarIconUrl, id: "common-icon", label: "Icon" },
  { img: CommonToolbarTextUrl, id: "common-text", label: "Text" },
  { img: CommonToolbarIconTextUrl, id: "common-icon-and-text", label: "Icon and Text" },
];

export const SPECIFIC_TOOLBAR_BUTTONS_ITEMS = [
  { img: SpecificToolbarIconUrl, id: "specific-icon", label: "Icon" },
  { img: SpecificToolbarIconTextUrl, id: "specific-icon-and-text", label: "Icon and Text" },
  { img: SpecificToolbarTextUrl, id: "specific-text", label: "Text" },
];

export const SMALL_INTERFACE_SCALE_ID = "small-scale";
export const DEFAULT_INTERFACE_SCALE_ID = "default-scale";
export const LARGE_INTERFACE_SCALE_ID = "large-scale";

export const INTERFACE_SCALE_ITEMS = [
  { img: InterfaceScaleSmallUrl, id: SMALL_INTERFACE_SCALE_ID, label: "Small" },
  { img: InterfaceScaleDefaultUrl, id: DEFAULT_INTERFACE_SCALE_ID, label: "Default" },
  { img: InterfaceScaleLargeUrl, id: LARGE_INTERFACE_SCALE_ID, label: "Large" },
];

```

## Archivo: `packages/ComponentLibrary/src/components/ConfigurationModal/index.tsx`

```typescript
import { Link } from "@mui/material";
import React, { useEffect, useState } from "react";
import RadioButtonIcon from "../../assets/icons/radio-button.svg";
import CircleIcon from "../../assets/icons/circle.svg";
import type { IConfigurationModalProps, ISection } from "./types";
import "./style.css";
import IconButton from "../IconButton";
import Menu from "../Menu";

const IconRenderer = ({ icon, imageStyles }: { icon: string | React.ReactNode; imageStyles?: string }): JSX.Element => {
  if (typeof icon === "string") {
    return <img src={icon} alt="icon" className={imageStyles} />;
  }
  if (React.isValidElement(icon)) {
    return icon;
  }
  return <span>Invalid icon</span>;
};

const ConfigurationModal: React.FC<IConfigurationModalProps> = ({
  icon,
  tooltipButtonProfile = "",
  title,
  linkTitle,
  sections = [],
  onChangeSelect,
  ...props
}) => {
  const [sectionsState, setSectionsState] = useState<ISection[]>(sections);
  const [anchorEl, setAnchorEl] = useState<HTMLButtonElement | null>(null);

  useEffect(() => {
    const availableSections = sections.filter((section) => !section.isDisabled);
    setSectionsState(availableSections);
  }, [sections]);

  const handleClick = (event: React.MouseEvent<HTMLButtonElement>) => {
    setAnchorEl(event.currentTarget);
  };

  const handleClose = () => {
    setAnchorEl(null);
  };

  const handleImageClick = (sectionIndex: number, imageIndex: number) => {
    setSectionsState((prevSections) => {
      const newSections = [...prevSections];
      newSections[sectionIndex] = {
        ...newSections[sectionIndex],
        selectedItem: imageIndex,
      };
      return newSections;
    });

    if (onChangeSelect) {
      const currentSection = sectionsState[sectionIndex];
      if (!currentSection || !currentSection.items[imageIndex]) return;
      const selectedItem = currentSection.items[imageIndex];
      onChangeSelect({ id: selectedItem.id, sectionId: currentSection.id, sectionIndex, imageIndex });
      handleClose();
    }
  };

  const isSelected = (selectedImageIndex: number, imageIndex: number): boolean => {
    return selectedImageIndex === imageIndex;
  };

  return (
    <>
      <IconButton
        onClick={handleClick}
        tooltip={tooltipButtonProfile}
        aria-label={tooltipButtonProfile}
        className="w-10 h-10">
        {icon}
      </IconButton>
      <Menu
        {...props}
        anchorEl={anchorEl}
        onClose={handleClose}
        className="bg-[var(--color-baseline-10)] radius-xl overflow-hidden border border-[var(--color-transparent-neutral-10)] shadow-md shadow-[var(--color-transparent-neutral-10)]">
        <div className="h-14 p-3 flex flex-row items-center justify-between bg-[var(--color-baseline-0)] border-b border-[var(--color-baseline-10)]">
          <div className="flex flex-row items-center gap-1">
            {title?.icon && (
              <div className="w-8 h-8 flex items-center justify-center bg-[var(--color-dynamic-contrast-text)] rounded-full">
                <IconRenderer icon={title.icon} />
              </div>
            )}
            <div className="text-base font-semibold text-[var(--color-baseline-90)]">{title?.label}</div>
          </div>
          <Link sx={{ visibility: "hidden" }} href={linkTitle?.url}>
            {linkTitle?.label}
          </Link>
        </div>
        <div className="p-2 gap-2 bg-[var(--color-baseline-10)]">
          {sectionsState.map((section, sectionIndex) => (
            <div
              key={sectionIndex}
              className="py-3 px-4 flex flex-col gap-3 bg-[var(--color-baseline-0)] border border-[var(--color-transparent-neutral-10)] rounded-xl">
              <div className="text-sm font-medium text-[var(--color-baseline-90)]">{section.name}</div>
              <div className="w-full h-full flex flex-row gap-3">
                {section.items.map(({ id, label, img }, imageIndex) => (
                  <button
                    key={id}
                    type="button"
                    onClick={() => handleImageClick(sectionIndex, imageIndex)}
                    className={`relative p-3 pt-12 flex flex-col gap-2 bg-[var(--color-baseline-0)] rounded-xl overflow-hidden hover:border-[var(--color-baseline-90)] transition-colors duration-250 ease-in-out box-border ${isSelected(section.selectedItem, imageIndex) ? "bg-[var(--color-dynamic-contrast-text)] border-2 border-[var(--color-etendo-main)]" : "border border-[var(--color-transparent-neutral-10)]"}`}>
                    <div className="absolute top-0 left-0 h-12 w-12 flex items-center justify-center">
                      {isSelected(section.selectedItem, imageIndex) ? (
                        <RadioButtonIcon width="1.5rem" height="1.5rem" fill="var(--color-dynamic-main)" />
                      ) : (
                        <CircleIcon width="1.5rem" height="1.5rem" fill="var(--color-baseline-70)" />
                      )}
                    </div>
                    <IconRenderer icon={img} />
                    <span className="text-sm font-medium text-[var(--color-baseline-100)] text-left">{label}</span>
                  </button>
                ))}
              </div>
            </div>
          ))}
        </div>
      </Menu>
    </>
  );
};

export default ConfigurationModal;

```

## Archivo: `packages/ComponentLibrary/src/components/ConfigurationModal/style.ts`

```typescript
import { type CSSProperties, useMemo } from "react";
import { type SxProps, type Theme, useTheme } from "@mui/material";

export const menuSyle = { paddingY: 0 };
export const COLUMN_SPACING = "0.75rem";
export const FIRST_MARGIN_TOP = "0.75rem";
export const BORDER_SELECT_1 = "1px solid ";
export const BORDER_SELECT_2 = "2px solid ";

export const useStyle = () => {
  const theme = useTheme();
  return useMemo(
    () => ({
      styles: {
        titleModalContainer: {
          display: "flex",
          flexDirection: "row",
          alignItems: "center",
          justifyContent: "space-between",
          background: theme.palette.baselineColor.neutral[0],
          padding: "0.75rem",
        },
        titleModalImageContainer: {
          display: "flex",
          flexDirection: "row",
          alignItems: "center",
        },
        titleModalImageRadius: {
          width: "2rem",
          height: "2rem",
          alignItems: "center",
          justifyContent: "center",
          display: "flex",
          background: theme.palette.baselineColor.neutral[10],
          borderRadius: "2rem",
          marginRight: "0.25rem",
        },
        titleModalImage: {
          width: "1rem",
          height: "1rem",
        },
        titleModal: {
          fontSize: "1rem",
          fontWeight: "600",
          lineHeight: "1.21rem",
          textAlign: "left",
        },
        imgContainer: {
          borderRadius: "0.75rem",
          width: "7rem",
          height: "4.5rem",
          cursor: "pointer",
          overflow: "hidden",
          transition: "border-color 0.25s ease",
        },
        img: { width: "100%", height: "100%" },
        title: {
          fontSize: "0.875rem",
          fontWeight: "500",
          lineHeight: "1.063rem",
          textAlign: "left",
          marginBottom: "0.75rem",
        },
        label: {
          fontSize: "0.875rem",
          fontWeight: "500",
          lineHeight: "1.063rem",
          textAlign: "left",
        },
        labelIcon: {
          width: "1rem",
          height: "1rem",
          marginRight: "0.25rem",
        },
        labelIconContainer: {
          display: "flex",
          flexDirection: "row",
          height: "1.25rem",
          marginTop: "0.25rem",
        },
        gridContainer: {
          padding: "0.75rem 1rem",
        },
        gridSectionContainer: {
          border: `1px solid ${theme.palette.baselineColor.transparentNeutral[10]}`,
          background: theme.palette.baselineColor.neutral[0],
          padding: "0.75rem 1rem 0.75rem 1rem",
          borderRadius: "0.75rem",
        },
        paperStyleMenu: {
          background: theme.palette.baselineColor.neutral[10],
          borderRadius: "0.75rem",
        },
        listContainer: {
          padding: "0.75rem",
        },
        iconButtonStyles: {
          width: "2.5rem",
          height: "2.5rem",
          color: theme.palette.baselineColor.neutral[80],
        },
      } as { [key: string]: CSSProperties },
      sx: {
        hoverStyles: {
          background: "white",
          "&:hover": {
            backgroundColor: theme.palette.dynamicColor.main,
            "& .MuiSvgIcon-root": {
              color: theme.palette.baselineColor.neutral[0],
            },
          },
        },
        linkStyles: {
          fontSize: "0.875rem",
          fontWeight: "500",
          lineHeight: "1rem",
          color: theme.palette.dynamicColor.main,
          textDecoration: "none",
          paddingRight: "0.5rem",
          cursor: "pointer",
          "&:hover": {
            textDecoration: "underline",
          },
        },
      } as { [key: string]: SxProps<Theme> },
    }),
    [theme]
  );
};

```

## Archivo: `packages/ComponentLibrary/src/components/ConfigurationModal/types.ts`

```typescript
import type { MenuProps } from "@mui/material";

export interface SectionItem {
  id: string;
  img: string | React.ReactNode;
  label?: string;
}

export interface ISection {
  id: string;
  name: string;
  items: SectionItem[];
  selectedItem: number;
  isDisabled?: boolean;
}

export interface OptionSelectedProps {
  id: string;
  sectionId: string;
  sectionIndex: number;
  imageIndex: number;
}

export interface IConfigurationModalProps extends Omit<MenuProps, "open" | "title"> {
  icon?: React.ReactNode;
  title?: { icon?: string | React.ReactNode; label?: string };
  tooltipButtonProfile?: string;
  linkTitle?: { url?: string; label?: string };
  sections?: ISection[];
  open?: boolean;
  onChangeSelect?: (optionSelected: OptionSelectedProps) => void;
}

```

## Archivo: `packages/ComponentLibrary/src/components/Copilot/AssistantSelector/index.tsx`

```typescript
import SparksIcon from "../../../assets/icons/sparks.svg";
import RadioGrid, { type RadioGridOption } from "../../RadioGrid";
import { IconButton, TextInputBase } from "../..";
import type { AssistantSelectorProps } from "../types";
import { useState } from "react";

const AssistantSelector: React.FC<AssistantSelectorProps> = ({
  assistants,
  selectedAssistant,
  onSelectAssistant,
  isExpanded = false,
  showDescription,
  translations,
}) => {
  const [filterText, setFilterText] = useState("");

  if (!assistants || !Array.isArray(assistants) || assistants.length === 0) {
    console.error("AssistantSelector: Invalid assistants data:", assistants);
    return (
      <div className="p-6 text-center">
        <h6 className="text-lg font-medium text-gray-600">
          {!assistants || !Array.isArray(assistants)
            ? translations.errorInvalidData
            : translations.errorNoAssistantsAvailable}
        </h6>
      </div>
    );
  }

  const filteredAssistants = assistants.filter(
    (assistant) =>
      assistant.name.toLowerCase().includes(filterText.toLowerCase()) ||
      assistant.description?.toLowerCase().includes(filterText.toLowerCase())
  );

  const radioOptions: RadioGridOption[] = filteredAssistants.map((assistant) => ({
    value: assistant.app_id,
    label: assistant.name,
    description: showDescription ? assistant.description || translations.defaultDescription : undefined,
  }));

  const handleSelect = (value: string) => {
    const assistant = filteredAssistants.find((a) => a.app_id === value);
    if (assistant) {
      onSelectAssistant(assistant);
    }
  };

  return (
    <div className="p-6">
      <div className="mb-6 bg-white rounded-b-xl rounded-tr-xl p-2 border-1 border-(--color-transparent-neutral-10) shadow-xl">
        <h5 className="text-sm font-medium mb-2">{translations.welcomeMessage}</h5>
      </div>

      <div className="bg-(--color-baseline-10) rounded-xl border-1 border-(--color-transparent-neutral-10) shadow-xl">
        <div className="flex justify-between items-center bg-white p-3 pr-4 rounded-t-xl">
          <div className="flex items-center gap-2">
            <IconButton className="">
              <SparksIcon />
            </IconButton>
            <h6 className="text-lg font-semibold">{translations.profilesTitle}</h6>
          </div>
          <div className="w-48">
            <TextInputBase
              value={filterText}
              onChange={(e: React.ChangeEvent<HTMLInputElement>) => setFilterText(e.target.value)}
              placeholder={translations.filterPlaceholder}
              size="small"
            />
          </div>
        </div>

        <div className={`p-2 overflow-y-auto ${isExpanded ? "max-h-[calc(100vh-20rem)]" : "max-h-90"}`}>
          <RadioGrid
            options={radioOptions}
            selectedValue={selectedAssistant?.app_id || null}
            onSelect={handleSelect}
            columns={isExpanded ? 3 : 1}
            name="assistant-selector"
          />
        </div>
      </div>
    </div>
  );
};

export default AssistantSelector;

```

## Archivo: `packages/ComponentLibrary/src/components/Copilot/ContextPreview/index.tsx`

```typescript
import type React from "react";
import { useCallback } from "react";
import TrashIcon from "../../../assets/icons/trash-2.svg";
import LinkIcon from "../../../assets/icons/link.svg";
import { IconButton } from "../..";
import { CONTEXT_CONSTANTS } from "@workspaceui/api-client/src/api/copilot";
import type { ContextPreviewProps } from "../types";

const ContextPreview: React.FC<ContextPreviewProps> = ({
  contextItems,
  onRemoveContext,
  showRemoveButton = true,
  translations,
}) => {
  const handleRemoveAll = useCallback(() => {
    for (const item of contextItems) {
      onRemoveContext(item.id);
    }
  }, [contextItems, onRemoveContext]);

  if (!contextItems || contextItems.length === 0) {
    return null;
  }
  if (contextItems.length > CONTEXT_CONSTANTS.MAX_ITEMS_DISPLAY) {
    return (
      <div className="flex flex-wrap gap-2 mb-3">
        <div className="flex items-center gap-2 bg-(--color-transparent-neutral-5) max-h-6 border border-(--color-transparent-neutral-10) rounded-full px-3 py-2 text-sm">
          <LinkIcon className="w-4 h-4 " fill="var-(--color-baseline-80)" />
          <span className="text-(--color-baseline-90) font-medium">
            {contextItems.length}
            {translations?.selectedRegisters}
          </span>
          {showRemoveButton && (
            <IconButton
              type="button"
              onClick={handleRemoveAll}
              className="[&>svg]:text-[1rem] hover:text-(--color-dynamic-main) hover:bg-blue-100 rounded-full w-4 h-4">
              <TrashIcon />
            </IconButton>
          )}
        </div>
      </div>
    );
  }

  return (
    <div className="flex flex-wrap gap-2 mb-3">
      {contextItems.map((item) => (
        <div
          key={item.id}
          className="flex items-center gap-2 bg-(--color-transparent-neutral-5) max-h-6 border border-(--color-transparent-neutral-10) rounded-full px-3 py-2 text-sm">
          <LinkIcon className="w-4 h-4 " fill="var-(--color-baseline-80)" />
          <span className="text-(--color-baseline-90) font-medium">{item.label}</span>
          {showRemoveButton && (
            <IconButton
              type="button"
              onClick={() => onRemoveContext(item.id)}
              className="[&>svg]:text-[1rem] hover:text-(--color-dynamic-main) hover:bg-blue-100 rounded-full w-4 h-4">
              <TrashIcon />
            </IconButton>
          )}
        </div>
      ))}
    </div>
  );
};

export default ContextPreview;

```

## Archivo: `packages/ComponentLibrary/src/components/Copilot/CopilotButton/index.tsx`

```typescript
import IconButton from "../../IconButton";
import SparksIcon from "../../../assets/icons/sparks.svg";
import type { CopilotButtonProps } from "../types";

const CopilotButton: React.FC<CopilotButtonProps> = ({
  onClick,
  tooltip = "Copilot",
  disabled = false,
  className = "w-10 h-10",
}) => {
  return (
    <IconButton onClick={onClick} tooltip={tooltip} disabled={disabled} className={className} ariaLabel="Open Copilot">
      <SparksIcon />
    </IconButton>
  );
};

export default CopilotButton;

```

## Archivo: `packages/ComponentLibrary/src/components/Copilot/CopilotPopup/ChatInterface.tsx`

```typescript
import AssistantSelector from "../AssistantSelector";
import type { IAssistant } from "@workspaceui/api-client/src/api/copilot";
import MessageList from "../MessageComponents/MessageList";
import MessageInput from "../MessageComponents/MessageInput";
import type { ChatInterfaceProps } from "../types";

const ChatInterface: React.FC<ChatInterfaceProps> = ({
  assistants,
  labels,
  isExpanded = false,
  messages,
  selectedAssistant,
  isLoading,
  onSelectAssistant,
  onSendMessage,
  showDescription = true,
  contextItems = [],
  onRemoveContext,
  translations,
}) => {
  let parsedAssistants: IAssistant[] = [];
  if (typeof assistants === "string") {
    try {
      parsedAssistants = JSON.parse(assistants);
    } catch {
      parsedAssistants = [];
    }
  } else if (Array.isArray(assistants)) {
    parsedAssistants = assistants;
  }

  const showAssistantSelector = !selectedAssistant;

  const handleSelectAssistant = (assistant: IAssistant) => {
    onSelectAssistant(assistant);
  };

  if (showAssistantSelector) {
    return (
      <AssistantSelector
        assistants={parsedAssistants}
        selectedAssistant={selectedAssistant}
        onSelectAssistant={handleSelectAssistant}
        labels={labels}
        isExpanded={isExpanded}
        showDescription={showDescription}
        translations={translations.assistantSelector}
      />
    );
  }

  return (
    <div className="flex flex-col h-full">
      <div className="flex-1 overflow-hidden">
        <MessageList
          messages={messages}
          labels={labels}
          isExpanded={isExpanded}
          isLoading={isLoading}
          translations={translations.messageList}
        />
      </div>

      <MessageInput
        onSendMessage={onSendMessage}
        placeholder={translations.messageInput?.placeholder || labels.ETCOP_Message_Placeholder}
        disabled={isLoading}
        contextItems={contextItems}
        onRemoveContext={onRemoveContext}
        translations={{
          placeholder: translations.messageInput?.placeholder || labels.ETCOP_Message_Placeholder,
          selectedRegisters: translations.selectedRegisters,
        }}
      />
    </div>
  );
};

export default ChatInterface;

```

## Archivo: `packages/ComponentLibrary/src/components/Copilot/CopilotPopup/index.tsx`

```typescript
import type {} from "@workspaceui/api-client/src/api/copilot";
import ChatInterface from "./ChatInterface";
import IconButton from "../../IconButton";
import XIcon from "../../../assets/icons/x.svg";
import MaximizeIcon from "../../../assets/icons/maximize-2.svg";
import MinimizeIcon from "../../../assets/icons/minimize-2.svg";
import BackIcon from "../../../assets/icons/arrow-left.svg";
import SparksIcon from "../../../assets/icons/sparks.svg";
import type { CopilotPopupProps } from "../types";

const CopilotPopup: React.FC<CopilotPopupProps> = ({
  open,
  onClose,
  assistants,
  labels,
  isExpanded = false,
  onToggleExpanded,
  messages,
  selectedAssistant,
  isLoading,
  onSelectAssistant,
  onSendMessage,
  onResetConversation,
  showDescription,
  hasContextPending = false,
  contextItems = [],
  onRemoveContext,
  translations,
}) => {
  if (!open) return null;

  const handleHeaderClick = () => {
    onSelectAssistant(null);
    onResetConversation();
  };

  const truncateAssistantName = (name: string, maxLength = 20) => {
    if (name.length <= maxLength) return name;
    return `${name.substring(0, maxLength)}...`;
  };

  const getHeaderText = () => {
    if (selectedAssistant) {
      const assistantName = isExpanded ? selectedAssistant.name : truncateAssistantName(selectedAssistant.name);
      return `${translations.copilotProfile}: ${assistantName}`;
    }
    return translations.copilotProfile;
  };

  const isHeaderClickable = selectedAssistant !== null && selectedAssistant !== undefined;

  return (
    <div className={`fixed z-500 ${isExpanded ? "inset-4" : "right-2 bottom-2"}`}>
      <div
        className={`bg-gradient-to-br from-purple-100 via-blue-50 to-green-50 rounded-lg border-1  border-(--color-transparent-neutral-20) shadow-xl ${isExpanded ? "w-full h-full" : "w-[26.25rem] h-[600px] max-h-[90vh]"} flex flex-col`}>
        <div className="flex justify-between items-center p-4 pb-2 border-b border-(--color-transparent-neutral-20)">
          <div className="flex-1 pr-2 min-w-0">
            <button
              type="button"
              onClick={isHeaderClickable ? handleHeaderClick : undefined}
              className={`text-lg group font-semibold text-(--color-transparent-neutral-70) flex items-center gap-2 border-1 border-(--color-transparent-neutral-20) px-3 py-1 rounded-full min-w-0 ${
                isExpanded ? "max-w-none" : "max-w-76"
              } 
              ${
                isHeaderClickable
                  ? "cursor-pointer hover:text-(--color-dynamic-main) transition-colors"
                  : "cursor-default"
              }`}
              disabled={!isHeaderClickable}
              aria-label={isHeaderClickable ? translations.backToSelection : undefined}
              title={getHeaderText()}>
              <div className="flex-shrink-0">
                {isHeaderClickable ? (
                  <BackIcon
                    fill="var(--color-transparent-neutral-70)"
                    className="group-hover:fill-(--color-dynamic-main) transition-colors"
                  />
                ) : (
                  <SparksIcon
                    fill={hasContextPending ? "var(--color-dynamic-main)" : "var(--color-transparent-neutral-70)"}
                  />
                )}
              </div>
              <p className="truncate min-w-0 text-left">
                {getHeaderText()}
                {hasContextPending && !isHeaderClickable ? (
                  <span className="bg-blue-100 text-(--color-dynamic-main) py-1 px-2 rounded-full ml-2">
                    {translations.contextText}
                  </span>
                ) : (
                  ""
                )}
              </p>
            </button>
          </div>

          <div className="flex gap-1 flex-shrink-0">
            {onToggleExpanded && (
              <IconButton
                onClick={onToggleExpanded}
                aria-label={isExpanded ? translations.minimize : translations.maximize}
                className="[&>svg]:text-[1.25rem]">
                {isExpanded ? <MinimizeIcon /> : <MaximizeIcon />}
              </IconButton>
            )}
            <IconButton onClick={onClose} aria-label={translations.close} className="[&>svg]:text-[1.25rem]">
              <XIcon />
            </IconButton>
          </div>
        </div>

        <div className="p-0 flex flex-col flex-1 overflow-hidden">
          <ChatInterface
            assistants={assistants}
            labels={labels}
            isExpanded={isExpanded}
            messages={messages}
            selectedAssistant={selectedAssistant}
            isLoading={isLoading}
            onSelectAssistant={onSelectAssistant}
            onSendMessage={onSendMessage}
            onResetConversation={onResetConversation}
            showDescription={showDescription}
            contextItems={contextItems}
            onRemoveContext={onRemoveContext}
            translations={{
              selectedRegisters: translations.selectedRegisters,
              assistantSelector: translations.assistantSelector,
              messageInput: translations.messageInput,
              messageList: translations.messageList,
            }}
          />
        </div>
      </div>
    </div>
  );
};

export default CopilotPopup;

```

## Archivo: `packages/ComponentLibrary/src/components/Copilot/MessageComponents/MessageInput.tsx`

```typescript
import { useCallback, useState } from "react";
import { InputAdornment } from "@mui/material";
import Send from "../../../assets/icons/send.svg";
import AttachFile from "../../../assets/icons/paperclip.svg";
import IconButton from "../../IconButton";
import { SearchInputWithVoice } from "../..";
import ContextPreview from "../ContextPreview";
import type { MessageInputProps } from "../types";

const MessageInput: React.FC<MessageInputProps> = ({
  onSendMessage,
  placeholder,
  disabled = false,
  contextItems = [],
  onRemoveContext,
  translations,
}) => {
  const [message, setMessage] = useState("");

  const handleVoiceClick = useCallback(() => alert("Voice activated"), []);

  const handleSend = useCallback(() => {
    if (message.trim() && !disabled) {
      onSendMessage(message.trim());
      setMessage("");
    }
  }, [message, disabled, onSendMessage]);

  const handleKeyPress = useCallback(
    (e: React.KeyboardEvent) => {
      if (e.key === "Enter" && !e.shiftKey) {
        e.preventDefault();
        handleSend();
      }
    },
    [handleSend]
  );

  return (
    <div className="px-2 pb-1">
      <ContextPreview
        contextItems={contextItems}
        onRemoveContext={onRemoveContext || (() => {})}
        showRemoveButton={!!onRemoveContext}
        translations={{
          selectedRegisters: translations?.selectedRegisters || "",
        }}
      />
      <SearchInputWithVoice
        value={message}
        setValue={setMessage}
        placeholder={translations?.placeholder || placeholder}
        disabled={disabled}
        maxRows={4}
        onKeyDown={handleKeyPress}
        rightIcon={true}
        onVoiceClick={handleVoiceClick}
        InputProps={{
          endAdornment: (
            <InputAdornment position="end">
              <IconButton disabled className="[&>svg]:text-[1.25rem]">
                <AttachFile />
              </IconButton>
              <IconButton
                className="[&>svg]:text-[1.25rem] pr-0.5"
                onClick={handleSend}
                disabled={disabled || !message.trim()}>
                <Send />
              </IconButton>
            </InputAdornment>
          ),
        }}
      />
    </div>
  );
};

export default MessageInput;

```

## Archivo: `packages/ComponentLibrary/src/components/Copilot/MessageComponents/MessageItem.tsx`

```typescript

```

## Archivo: `packages/ComponentLibrary/src/components/Copilot/MessageComponents/MessageList.tsx`

```typescript
import { useEffect, useRef, useMemo, useCallback } from "react";
import ContextPreview from "../ContextPreview";
import { MESSAGE_ROLES, CONTEXT_CONSTANTS } from "@workspaceui/api-client/src/api/copilot";
import type { MessageListProps } from "../types";

const MessageList: React.FC<MessageListProps> = ({ messages, labels, isLoading = false, translations }) => {
  const messagesEndRef = useRef<HTMLDivElement>(null);

  useEffect(() => {
    messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
  }, [messages]);

  const hasContextInMessage = useCallback((text: string) => {
    return text.startsWith(CONTEXT_CONSTANTS.TAG_START);
  }, []);

  const contextRegex = useMemo(() => {
    return new RegExp(`^${CONTEXT_CONSTANTS.TAG_START}[\\s\\S]*?${CONTEXT_CONSTANTS.TAG_END}\\s*`);
  }, []);

  const contextCountRegex = useMemo(() => {
    return new RegExp(`${CONTEXT_CONSTANTS.TAG_START} \\((\\d+) ${translations?.contextRecords || ""}`);
  }, [translations?.contextRecords]);

  const getMessageWithoutContext = useCallback(
    (text: string) => {
      return text.replace(contextRegex, "").trim();
    },
    [contextRegex]
  );

  const getContextCountFromMessage = useCallback(
    (text: string) => {
      const match = text.match(contextCountRegex);
      return match ? Number.parseInt(match[1]) : 0;
    },
    [contextCountRegex]
  );

  if (messages.length === 0) {
    return (
      <div className="p-6 text-center">
        <h6 className="text-lg font-medium text-(--color-baseline-90)">
          {translations?.welcomeMessage || labels.ETCOP_Welcome_Message}
        </h6>
      </div>
    );
  }

  return (
    <div className="p-4 h-full overflow-y-auto flex flex-col gap-4">
      {messages.map((message, index) => {
        const messageHasContext = message.sender === MESSAGE_ROLES.USER && hasContextInMessage(message.text);
        const displayMessage = messageHasContext ? getMessageWithoutContext(message.text) : message.text;
        const contextCount = messageHasContext ? getContextCountFromMessage(message.text) : 0;

        return (
          <div
            key={index}
            className={`flex mb-2 ${message.sender === MESSAGE_ROLES.USER ? "justify-end" : "justify-start"}`}>
            <div
              className={`max-w-[70%] p-4 rounded-xl ${
                message.sender === MESSAGE_ROLES.USER
                  ? "bg-(--color-transparent-neutral-5) text-(--color-baseline-90) font-medium  rounded-tr-none"
                  : "bg-(--color-baseline-0) text-(--color-baseline-90) rounded-tl-none font-medium border-1 border-(--color-transparent-neutral-10) hover:border-(--color-baseline-100) transition-all duration-300"
              }`}>
              {messageHasContext && (
                <div className="mb-3">
                  <ContextPreview
                    contextItems={
                      contextCount > CONTEXT_CONSTANTS.MAX_ITEMS_DISPLAY
                        ? [{ id: "context-summary", label: `${contextCount}`, contextString: "" }]
                        : Array.from({ length: contextCount }, (_, i) => ({
                            id: `context-${i}`,
                            label: translations?.contextRecords || "",
                            contextString: "",
                          }))
                    }
                    onRemoveContext={() => {}}
                    showRemoveButton={false}
                    translations={{
                      selectedRegisters: translations?.contextRecords || "",
                    }}
                  />
                </div>
              )}
              <p className="text-sm mb-1">{displayMessage}</p>
              <span className="text-xs opacity-70">{message.timestamp}</span>
            </div>
          </div>
        );
      })}

      {isLoading && (
        <div className="flex justify-start mb-2">
          <div className="flex items-center gap-2 p-4 rounded-lg bg-(--color-baseline-0)">
            <div className="spinner-gradient" />
            <span className="text-sm">{translations?.typing}</span>
          </div>
        </div>
      )}

      <div ref={messagesEndRef} />
    </div>
  );
};

export default MessageList;

```

## Archivo: `packages/ComponentLibrary/src/components/Copilot/types.ts`

```typescript
import type { IAssistant, ILabels, IMessage } from "@workspaceui/api-client/src/api/copilot";

export interface AssistantSelectorProps {
  assistants: IAssistant[];
  selectedAssistant: IAssistant | null;
  onSelectAssistant: (assistant: IAssistant) => void;
  labels: ILabels;
  isExpanded?: boolean;
  showDescription?: boolean;
  translations: {
    errorInvalidData: string;
    errorNoAssistantsAvailable: string;
    defaultDescription: string;
    welcomeMessage: string;
    profilesTitle: string;
    learnMoreText: string;
    filterPlaceholder: string;
  };
}

export interface CopilotButtonProps {
  onClick: () => void;
  tooltip?: string;
  disabled?: boolean;
  className?: string;
}

export interface ChatInterfaceProps {
  assistants: IAssistant[];
  labels: ILabels;
  isExpanded?: boolean;
  messages: IMessage[];
  selectedAssistant: IAssistant | null;
  isLoading: boolean;
  onSelectAssistant: (assistant: IAssistant | null) => void;
  onSendMessage: (message: string, files?: File[]) => void;
  onResetConversation: () => void;
  showDescription?: boolean;
  contextItems?: ContextItem[];
  onRemoveContext?: (id: string) => void;
  translations: {
    selectedRegisters: string;
    assistantSelector: AssistantSelectorProps["translations"];
    messageInput: MessageInputProps["translations"];
    messageList: MessageListProps["translations"];
  };
}

export interface CopilotPopupProps {
  open: boolean;
  onClose: () => void;
  assistants: IAssistant[];
  labels: ILabels;
  isExpanded?: boolean;
  onToggleExpanded?: () => void;
  messages: IMessage[];
  selectedAssistant: IAssistant | null;
  isLoading: boolean;
  onSelectAssistant: (assistant: IAssistant | null) => void;
  onSendMessage: (message: string, files?: File[]) => void;
  onResetConversation: () => void;
  showDescription?: boolean;
  hasContextPending?: boolean;
  contextItems?: ContextItem[];
  onRemoveContext?: (id: string) => void;
  translations: {
    copilotProfile: string;
    backToSelection: string;
    minimize: string;
    maximize: string;
    close: string;
    contextText: string;
    selectedRegisters: string;
    assistantSelector: AssistantSelectorProps["translations"];
    messageInput: MessageInputProps["translations"];
    messageList: MessageListProps["translations"];
  };
}

export interface MessageInputProps {
  onSendMessage: (message: string, files?: File[]) => void;
  placeholder?: string;
  disabled?: boolean;
  contextItems?: ContextItem[];
  onRemoveContext?: (id: string) => void;
  translations?: {
    placeholder: string;
    selectedRegisters?: string;
  };
}

export interface MessageListProps {
  messages: IMessage[];
  labels: ILabels;
  isExpanded?: boolean;
  isLoading?: boolean;
  translations?: {
    contextRecords: string;
    welcomeMessage: string;
    typing: string;
  };
}

export interface ContextItem {
  id: string;
  label: string;
  contextString: string;
  recordId?: string;
}

export interface ContextPreviewProps {
  contextItems: ContextItem[];
  onRemoveContext: (id: string) => void;
  showRemoveButton?: boolean;
  translations?: {
    selectedRegisters: string;
  };
}

```

## Archivo: `packages/ComponentLibrary/src/components/DragModal/DragModal.tsx`

```typescript
import type React from "react";
import { useState } from "react";
import Modal from "../BasicModal";
import DragModalContent from "./DragModalContent";
import type { DragModalProps, Item } from "./DragModal.types";
import ModalDivider from "../ModalDivider";
import { MODAL_WIDTH } from "./styles";
import CloseRecordIcon from "../../assets/icons/close-record.svg";

const DragModal: React.FC<DragModalProps> = ({
  initialItems = [],
  onClose,
  activateAllText,
  deactivateAllText,
  buttonText,
  backButtonText,
}) => {
  const [items, setItems] = useState<Item[]>(initialItems);

  return (
    <Modal width={MODAL_WIDTH} HeaderIcon={CloseRecordIcon}>
      <ModalDivider />
      <DragModalContent
        items={items}
        setItems={setItems}
        onBack={onClose}
        activateAllText={activateAllText}
        deactivateAllText={deactivateAllText}
        buttonText={buttonText}
        backButtonText={backButtonText}
      />
    </Modal>
  );
};

export default DragModal;

```

## Archivo: `packages/ComponentLibrary/src/components/DragModal/DragModal.types.ts`

```typescript
import type { UniqueIdentifier } from "@dnd-kit/core";
import type { ReactNode } from "react";

export interface ToggleableItem {
  id: UniqueIdentifier;
  label: string;
  isActive: boolean;
}

export interface Item extends ToggleableItem {}

export interface SortableItemProps<T extends ToggleableItem = Item> {
  id: UniqueIdentifier;
  item?: T;
  person?: T;
  icon: React.ReactNode;
  isActive: boolean;
  onToggle: () => void;
}

export interface SortableItemPropsLegacy extends SortableItemProps<Item> {
  person: Item;
}

export interface DragModalProps<T extends ToggleableItem = Item> {
  initialItems: T[];
  onBack?: () => void;
  onClose: () => void;
  backButtonText?: string;
  activateAllText?: string;
  deactivateAllText?: string;
  buttonText?: string;
  icon?: string | ReactNode;
}

export interface DragModalContentProps<T extends ToggleableItem = Item> {
  items?: T[];
  setItems?: React.Dispatch<React.SetStateAction<T[]>>;
  onBack?: () => void;
  backButtonText?: string;
  activateAllText?: string;
  deactivateAllText?: string;
  buttonText?: string;
}

```

## Archivo: `packages/ComponentLibrary/src/components/DragModal/DragModalContent.tsx`

```typescript
import { useCallback, useMemo } from "react";
import List from "@mui/material/List";
import {
  DndContext,
  MouseSensor,
  TouchSensor,
  useSensor,
  useSensors,
  type DragEndEvent,
  type UniqueIdentifier,
  closestCenter,
} from "@dnd-kit/core";
import { SortableContext, arrayMove, verticalListSortingStrategy } from "@dnd-kit/sortable";
import SortableItem from "./SortableItem";
import type { DragModalContentProps } from "./DragModal.types";
import ModalDivider from "../ModalDivider";
import DragIndicator from "../../assets/icons/drag.svg";
import NavigateBefore from "../../assets/icons/chevron-left.svg";
import { useStyle } from "./styles";
import { Box, Button, Link, useTheme } from "@mui/material";
import { restrictToParentElement, restrictToVerticalAxis } from "@dnd-kit/modifiers";

const DragModalContent: React.FC<DragModalContentProps> = ({
  items,
  setItems,
  onBack,
  backButtonText,
  activateAllText,
  deactivateAllText,
  buttonText,
}) => {
  const currentItems = useMemo(() => items ?? [], [items]);
  const setCurrentItems = useMemo(() => setItems ?? (() => {}), [setItems]);

  const sensors = useSensors(
    useSensor(MouseSensor, { activationConstraint: { distance: 5 } }),
    useSensor(TouchSensor, { activationConstraint: { distance: 5 } })
  );
  const theme = useTheme();
  const { styles, sx } = useStyle();

  const handleDragEnd = useCallback(
    (event: DragEndEvent) => {
      const { active, over } = event;
      if (over && active.id !== over.id) {
        setCurrentItems((items) => {
          const oldIndex = items.findIndex((item) => item.id === active.id);
          const newIndex = items.findIndex((item) => item.id === over.id);
          return arrayMove(items, oldIndex, newIndex);
        });
      }
    },
    [setCurrentItems]
  );

  const handleToggleAll = useCallback(() => {
    const allActivated = currentItems.every((item) => item.isActive);
    setCurrentItems((prev) => prev.map((item) => ({ ...item, isActive: !allActivated })));
  }, [currentItems, setCurrentItems]);

  const handleToggle = useCallback(
    (id: UniqueIdentifier) => {
      setCurrentItems((prev) => prev.map((item) => (item.id === id ? { ...item, isActive: !item.isActive } : item)));
    },
    [setCurrentItems]
  );
  return (
    <>
      <div style={styles.sectionContainer}>
        <Box sx={sx.headerBox}>
          <Button
            onClick={onBack}
            startIcon={<NavigateBefore fill={theme.palette.baselineColor.neutral[60]} style={styles.StartIconStyles} />}
            style={styles.CustomizeButton}
            sx={sx.customizeButton}>
            {backButtonText}
          </Button>
        </Box>
      </div>
      <ModalDivider />
      <div style={styles.containerStyles}>
        <p>{buttonText}</p>
        <Link sx={sx.linkStyles} onClick={handleToggleAll}>
          {currentItems.every((item) => item.isActive) ? deactivateAllText : activateAllText}
        </Link>
      </div>
      <div>
        <DndContext
          sensors={sensors}
          collisionDetection={closestCenter}
          modifiers={[restrictToParentElement, restrictToVerticalAxis]}
          onDragEnd={handleDragEnd}>
          <SortableContext items={currentItems.map((item) => item.id)} strategy={verticalListSortingStrategy}>
            <List>
              {currentItems.map((item) => (
                <SortableItem
                  key={item.id}
                  id={item.id}
                  item={item}
                  icon={<DragIndicator fill={theme.palette.baselineColor.neutral[60]} />}
                  onToggle={() => handleToggle(item.id)}
                  isActive={item.isActive}
                />
              ))}
            </List>
          </SortableContext>
        </DndContext>
      </div>
    </>
  );
};

export default DragModalContent;

```

## Archivo: `packages/ComponentLibrary/src/components/DragModal/SortableItem.tsx`

```typescript
import React from "react";
import MenuItem from "@mui/material/MenuItem";
import { useSortable } from "@dnd-kit/sortable";
import { CSS } from "@dnd-kit/utilities";
import ToggleChip from "../Toggle/ToggleChip";
import { useStyle } from "./styles";
import type { SortableItemProps } from "./DragModal.types";
import type { SxProps, Theme } from "@mui/material/styles";

const SortableItem: React.FC<SortableItemProps> = ({ id, person, item, onToggle, icon }) => {
  const currentItem = item || person;
  const { sx, styles } = useStyle();

  const { attributes, listeners, setNodeRef, transform, transition, isDragging } = useSortable({ id });

  const style = {
    transform: CSS.Transform.toString(transform),
    transition,
  };

  const menuItemSx = {
    ...sx.menuItemStyles,
    ...(isDragging ? sx.menuItemDragging : {}),
  } as SxProps<Theme>;

  return (
    <MenuItem ref={setNodeRef} style={style} sx={menuItemSx} {...attributes} {...listeners} disableRipple>
      <div style={styles.sortableItemContainer}>
        <div style={styles.sortableItemLeftContainer}>
          {React.cloneElement(icon as React.ReactElement, {
            style: styles.dragStyles,
          })}
          <span className="person-label" style={styles.sortableItemLabel} title={currentItem?.label}>
            {currentItem?.label}
          </span>
        </div>
        <ToggleChip isActive={currentItem?.isActive} onToggle={onToggle} />
      </div>
    </MenuItem>
  );
};

export default SortableItem;

```

## Archivo: `packages/ComponentLibrary/src/components/DragModal/styles.ts`

```typescript
import { type SxProps, type Theme, useTheme } from "@mui/material";
import { type CSSProperties, useMemo } from "react";

export const MODAL_WIDTH = 240;

export const useStyle = () => {
  const theme = useTheme();

  return useMemo(
    () => ({
      styles: {
        StartIconStyles: {
          marginLeft: "0.25rem",
          maxHeight: "1rem",
          maxWidth: "1rem",
        },
        EndIconStyles: {
          position: "absolute",
          right: "0",
          paddingLeft: "0 0.5rem",
        },
        menuItemStyles: {
          height: "2.25rem",
          cursor: "grab",
          padding: "0.5rem",
        },
        itemsContainer: {
          display: "flex",
          justifyContent: "space-between",
          alignItems: "center",
          width: "100%",
        },
        leftContainer: {
          alignItems: "center",
          display: "flex",
        },
        containerStyles: {
          display: "flex",
          justifyContent: "space-between",
          alignItems: "center",
          padding: "0.75rem 1.25rem 0 1.25rem",
          maxHeight: "2.25rem",
        },
        personLabelStyles: {
          display: "inline-block",
          maxWidth: "8rem",
          overflow: "hidden",
          textOverflow: "ellipsis",
          whiteSpace: "nowrap",
        },
        listStyles: {
          padding: "0.25rem 0rem",
        },
        dragStyles: {
          maxWidth: "1rem",
          maxHeight: "1rem",
          marginRight: "0.5rem",
        },
        sectionContainer: {
          padding: "0.5rem",
        },
        sortableItemContainer: {
          display: "flex",
          justifyContent: "space-between",
          alignItems: "center",
          width: "100%",
        },
        sortableItemLeftContainer: {
          alignItems: "center",
          display: "flex",
          flex: 1,
          minWidth: 0,
        },
        sortableItemLabel: {
          display: "inline-block",
          maxWidth: "8rem",
          overflow: "hidden",
          textOverflow: "ellipsis",
          whiteSpace: "nowrap",
          transition: "all 0.3s ease",
          flex: 1,
          minWidth: 0,
        },
      } as { [key: string]: CSSProperties },
      sx: {
        customizeButton: {
          fontWeight: "500",
          fontSize: "1rem",
          width: "100%",
          height: "2.25rem",
          borderRadius: "0.5rem",
          display: "flex",
          justifyContent: "flex-start",
          alignItems: "center",
          position: "relative",
          "&:hover": {
            border: "none",
            color: theme.palette.baselineColor.neutral[80],
          },
        },
        headerBox: {
          "&:hover": {
            background: theme.palette.dynamicColor.contrastText,
            borderRadius: "0.5rem",
          },
        },
        linkStyles: {
          cursor: "pointer",
          padding: 0,
          fontSize: "0.875rem",
          fontWeight: "500",
          lineHeight: "1rem",
          color: theme.palette.dynamicColor.main,
          textDecoration: "none",
          "&:hover": {
            textDecoration: "underline",
          },
        },
        menuItemStyles: {
          height: "2.25rem",
          cursor: "grab",
          margin: "0.25rem 0.5rem",
          padding: "0.5rem",
          position: "relative",
          touchAction: "none",
          borderRadius: "0.5rem",
          border: "none",
          "&:hover": {
            borderRadius: "0.5rem",
            background: theme.palette.dynamicColor.contrastText,
          },
          "&:active, &.Mui-focusVisible": {
            cursor: "grabbing",
            borderRadius: "0",
            background: theme.palette.baselineColor.neutral[10],
            border: `1px solid ${theme.palette.dynamicColor.main}`,
            "& .toggle-chip": {
              display: "none",
            },
            "& .person-label": {
              maxWidth: "100%",
              color: theme.palette.dynamicColor.main,
            },
          },
        },
        menuItemDragging: {
          opacity: 0.5,
          zIndex: 1000,
          borderRadius: "0",
          background: theme.palette.baselineColor.neutral[10],
          border: `1px solid ${theme.palette.dynamicColor.main}`,
        },
      } as { [key: string]: SxProps<Theme> },
    }),
    [theme]
  );
};

```

## Archivo: `packages/ComponentLibrary/src/components/Drawer/DrawerSection/index.tsx`

```typescript
import type { Menu } from "@workspaceui/api-client/src/api/types";
import React, { useCallback, useEffect, useRef, useState } from "react";
import { useItemActions } from "../../../hooks/useItemType";
import { findActive } from "../../../utils/drawerUtils";
import { MenuTitle } from "../MenuTitle";
import type { DrawerSectionProps, ToggleFunctions } from "../types";
import MenuLibrary from "../../Menu";

export const DrawerSection: React.FC<DrawerSectionProps> = React.memo(
  ({
    item,
    onClick,
    open,
    isSearchActive,
    onToggleExpand,
    hasChildren,
    isExpandable,
    windowId,
    isExpanded: externalExpanded,
    parentId,
  }) => {
    const isSelected = Boolean(windowId?.length && item.windowId === windowId);
    const hasActiveChild = !isSelected && Boolean(windowId?.length && findActive(windowId, item.children));
    const isParentActive = isSelected || hasActiveChild;
    const [expandedSections, setExpandedSections] = useState<Set<string>>(new Set());
    const toggleFunctions = useRef<ToggleFunctions>({});
    const [anchorEl, setAnchorEl] = useState<HTMLElement | null>(null);
    const hoverTimeoutRef = useRef<NodeJS.Timeout | null>(null);

    const menuControlRef = useRef<{ recalculatePosition: () => void } | null>(null);

    const [localExpanded, setLocalExpanded] = useState(isSelected || findActive(windowId, item.children));

    const expanded = Boolean(externalExpanded || localExpanded);

    const onWindowClick = useCallback((item: Menu) => onClick(item), [onClick]);
    const onReportClick = useCallback((item: Menu) => onClick(item), [onClick]);
    const onProcessClick = useCallback((item: Menu) => onClick(item), [onClick]);

    const handleItemClick = useItemActions({
      onWindowClick,
      onReportClick,
      onProcessClick,
    });

    const handleNestedToggle = useCallback((sectionId: string) => {
      setExpandedSections((prev) => {
        const newSet = new Set(prev);
        if (newSet.has(sectionId)) {
          newSet.delete(sectionId);
        } else {
          newSet.add(sectionId);
        }

        setTimeout(() => {
          if (menuControlRef.current) {
            menuControlRef.current.recalculatePosition();
          }
        }, 100);

        return newSet;
      });
    }, []);

    const getToggleFunction = useCallback(
      (sectionId: string) => {
        if (!toggleFunctions.current[sectionId]) {
          toggleFunctions.current[sectionId] = () => handleNestedToggle(sectionId);
        }
        return toggleFunctions.current[sectionId];
      },
      [handleNestedToggle]
    );

    const handleClick = useCallback(() => {
      if (open) {
        if (hasChildren && isExpandable) {
          const newExpandedState = !expanded;
          setLocalExpanded(newExpandedState);
          if (parentId) {
            handleNestedToggle(item.id);
          }

          onToggleExpand();
        } else {
          handleItemClick(item);
        }
      } else {
        if (!hasChildren) {
          handleItemClick(item);
        }
      }
    }, [
      open,
      hasChildren,
      isExpandable,
      expanded,
      parentId,
      onToggleExpand,
      handleNestedToggle,
      item,
      handleItemClick,
    ]);

    const handleMouseEnter = useCallback(
      (event: React.MouseEvent<HTMLElement>) => {
        if (!open && hasChildren) {
          if (hoverTimeoutRef.current) {
            clearTimeout(hoverTimeoutRef.current);
            hoverTimeoutRef.current = null;
          }
          setAnchorEl(event.currentTarget);
        }
      },
      [open, hasChildren]
    );

    const handleMouseLeave = useCallback(() => {
      if (!open) {
        hoverTimeoutRef.current = setTimeout(() => {
          setAnchorEl(null);
        }, 150);
      }
    }, [open]);

    const handleKeyDown = useCallback(
      (event: React.KeyboardEvent) => {
        if (event.key === "Enter" || event.key === " ") {
          event.preventDefault();
          event.stopPropagation();
          handleClick();
        }
      },
      [handleClick]
    );

    const sectionClasses = [
      expanded && open ? "bg-(--color-baseline-10)" : "bg-transparent ",
      open ? "m-2 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" : "flex justify-center",
      !open && hasActiveChild ? "bg-dynamic-main rounded-full" : "",
    ].join(" ");

    const shouldShowChildren = isSearchActive || expanded;

    useEffect(() => {
      if (isSelected || findActive(windowId, item.children)) {
        setLocalExpanded(true);
        if (parentId) {
          handleNestedToggle(item.id);
        }
      }
    }, [isSelected, item.children, windowId, parentId, item.id, handleNestedToggle]);

    useEffect(() => {
      if (item.id === "recently-viewed" && !isSelected && !findActive(windowId, item.children)) {
        setLocalExpanded(false);
      }
    }, [item.id, isSelected, windowId, item.children]);

    useEffect(() => {
      return () => {
        if (hoverTimeoutRef.current) {
          clearTimeout(hoverTimeoutRef.current);
        }
      };
    }, []);

    const handleCloseMenu = useCallback(() => {
      setAnchorEl(null);
    }, []);

    const handleClickAndClose = useCallback(
      (item: Menu) => {
        onClick(item);
        handleCloseMenu();
      },
      [handleCloseMenu, onClick]
    );

    return (
      <div
        className={sectionClasses}
        aria-expanded={expanded}
        onKeyDown={handleKeyDown}
        onMouseEnter={handleMouseEnter}
        onMouseLeave={handleMouseLeave}>
        <MenuTitle
          item={item}
          onClick={handleClick}
          selected={isSelected}
          expanded={shouldShowChildren}
          open={open}
          isParentActive={isParentActive}
          isExpandable={isExpandable && !isSearchActive}
        />
        {hasChildren && open && (
          <div
            className={`transition-all duration-300 ease-in-out h-auto 
              ${shouldShowChildren ? "opacity-100" : "max-h-0 overflow-hidden"}`}>
            {item.children?.map((subitem) => (
              <DrawerSection
                key={subitem.id}
                item={subitem}
                onClick={onClick}
                open={open}
                isSearchActive={isSearchActive}
                onToggleExpand={getToggleFunction(subitem.id)}
                hasChildren={Boolean(subitem.children?.length)}
                isExpandable={isExpandable && !isSearchActive}
                isExpanded={expandedSections.has(subitem.id)}
                parentId={item.id}
                windowId={windowId}
              />
            ))}
          </div>
        )}
        {!open && anchorEl && (
          <div
            onMouseEnter={() => {
              if (hoverTimeoutRef.current) {
                clearTimeout(hoverTimeoutRef.current);
                hoverTimeoutRef.current = null;
              }
            }}
            onMouseLeave={handleMouseLeave}>
            <MenuLibrary
              className="max-h-76 w-full max-w-60 overflow-y-scroll overflow-hidden"
              anchorEl={anchorEl}
              offsetX={52}
              offsetY={-40}
              onClose={handleCloseMenu}
              menuRef={menuControlRef}>
              <div
                className="h-13 border-b border-transparent-neutral-5 flex items-center px-4 bg-neutral-50 
                  font-inter font-semibold text-[14px] leading-[20px] tracking-[0.15px] text-baseline-80">
                {item.name}
              </div>
              {item.children?.map((subitem) => (
                <DrawerSection
                  key={subitem.id}
                  item={subitem}
                  onClick={handleClickAndClose}
                  open={true}
                  isSearchActive={isSearchActive}
                  onToggleExpand={getToggleFunction(subitem.id)}
                  hasChildren={Boolean(subitem.children?.length)}
                  isExpandable={isExpandable && !isSearchActive}
                  isExpanded={expandedSections.has(subitem.id)}
                  parentId={item.id}
                  windowId={windowId}
                />
              ))}
            </MenuLibrary>
          </div>
        )}
      </div>
    );
  }
);

DrawerSection.displayName = "DrawerSection";

export default DrawerSection;

```

## Archivo: `packages/ComponentLibrary/src/components/Drawer/Header/index.tsx`

```typescript
"use client";

import MenuClose from "../../../assets/icons/menu-close.svg";
import MenuOpen from "../../../assets/icons/menu-open.svg";
import IconButton from "../../IconButton";
import Logo from "../../Logo";
import type { DrawerHeaderProps } from "../types";

const DrawerHeader = ({ title, logo, open, onClick, tabIndex }: DrawerHeaderProps) => {
  return (
    <div className="h-14 min-h-14 flex items-center justify-end p-2 border-b border-(--color-transparent-neutral-10)">
      {open && (
        <div className="w-full">
          <a href="/" className="flex items-center gap-1" title="Etendo">
            <Logo logo={logo} title={title} />
            <span className="font-semibold text-(--color-baseline-neutral-90) text-base">{title}</span>
          </a>
        </div>
      )}
      <div>
        <IconButton onClick={onClick} className="h-9 w-9" tabIndex={tabIndex}>
          {open ? <MenuClose /> : <MenuOpen />}
        </IconButton>
      </div>
    </div>
  );
};

export default DrawerHeader;

```

## Archivo: `packages/ComponentLibrary/src/components/Drawer/MenuTitle/constants.ts`

```typescript
export const REPORT_B64 =
  "PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xOCA5QzE4LjU1MjMgOSAxOSA5LjQ0NzcyIDE5IDEwVjIwQzE5IDIwLjU1MjMgMTguNTUyMyAyMSAxOCAyMUMxNy40NDc3IDIxIDE3IDIwLjU1MjMgMTcgMjBWMTBDMTcgOS40NDc3MiAxNy40NDc3IDkgMTggOVoiIGZpbGw9IiMwMDAzMEQiLz4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xMiAzQzEyLjU1MjMgMyAxMyAzLjQ0NzcyIDEzIDRWMjBDMTMgMjAuNTUyMyAxMi41NTIzIDIxIDEyIDIxQzExLjQ0NzcgMjEgMTEgMjAuNTUyMyAxMSAyMFY0QzExIDMuNDQ3NzIgMTEuNDQ3NyAzIDEyIDNaIiBmaWxsPSIjMDAwMzBEIi8+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNNiAxM0M2LjU1MjI4IDEzIDcgMTMuNDQ3NyA3IDE0VjIwQzcgMjAuNTUyMyA2LjU1MjI4IDIxIDYgMjFDNS40NDc3MiAyMSA1IDIwLjU1MjMgNSAyMFYxNEM1IDEzLjQ0NzcgNS40NDc3MiAxMyA2IDEzWiIgZmlsbD0iIzAwMDMwRCIvPgo8L3N2Zz4K";

export const PROCESS_B64 =
  "PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzRfMzUyNDQpIj4KPHBhdGggZD0iTTEyIDcuOTk5OTlDOS43OTAwMiA3Ljk5OTk5IDguMDAwMDIgOS43ODk5OSA4LjAwMDAyIDEyQzguMDAwMDIgMTQuMjEgOS43OTAwMiAxNiAxMiAxNkMxNC4yMSAxNiAxNiAxNC4yMSAxNiAxMkMxNiA5Ljc4OTk5IDE0LjIxIDcuOTk5OTkgMTIgNy45OTk5OVpNMTIgMTRDMTAuOSAxNCAxMCAxMy4xIDEwIDEyQzEwIDEwLjkgMTAuOSA5Ljk5OTk5IDEyIDkuOTk5OTlDMTMuMSA5Ljk5OTk5IDE0IDEwLjkgMTQgMTJDMTQgMTMuMSAxMy4xIDE0IDEyIDE0WiIgZmlsbD0iIzAwMDMwRCIvPgo8cGF0aCBkPSJNMjAuNSAyMC40MkMyMC43OCAyMC4xNCAyMSAxOS44MSAyMS4xNSAxOS40NUMyMS4zIDE5LjA5IDIxLjM4IDE4LjcgMjEuMzggMTguM0MyMS4zOCAxNy45IDIxLjMgMTcuNTIgMjEuMTUgMTcuMTVDMjEgMTYuNzkgMjAuNzggMTYuNDUgMjAuNSAxNi4xOEwyMC40NSAxNi4xM0MyMC4zNiAxNi4wNCAyMC4zIDE1LjkyIDIwLjI4IDE1Ljc5QzIwLjI2IDE1LjY2IDIwLjI4IDE1LjUzIDIwLjMyIDE1LjQxQzIwLjM3IDE1LjI4IDIwLjQ1IDE1LjE4IDIwLjU2IDE1LjExQzIwLjY3IDE1LjA0IDIwLjc5IDE1IDIwLjkxIDE1SDIxQzIxLjggMTUgMjIuNTYgMTQuNjggMjMuMTIgMTQuMTJDMjMuNjggMTMuNTYgMjQgMTIuNzkgMjQgMTJDMjQgMTEuMjEgMjMuNjggMTAuNDQgMjMuMTIgOS44Nzk5OUMyMi41NiA5LjMxOTk5IDIxLjc5IDguOTk5OTkgMjEgOC45OTk5OUgyMC44M0MyMC43IDguOTk5OTkgMjAuNTggOC45NTk5OSAyMC40OCA4Ljg4OTk5QzIwLjQxIDguODM5OTkgMjAuMzUgOC43Nzk5OSAyMC4zIDguNzA5OTlDMjAuMjkgOC42Mzk5OSAyMC4yNiA4LjU3OTk5IDIwLjI0IDguNTA5OTlDMjAuMTkgOC4zODk5OSAyMC4xNyA4LjI1OTk5IDIwLjIgOC4xMjk5OUMyMC4yMiA3Ljk5OTk5IDIwLjI4IDcuODg5OTkgMjAuMzcgNy43ODk5OUwyMC40MyA3LjcyOTk5QzIwLjcxIDcuNDQ5OTkgMjAuOTMgNy4xMTk5OSAyMS4wOCA2Ljc1OTk5QzIxLjIzIDYuMzk5OTkgMjEuMzEgNi4wMDk5OSAyMS4zMSA1LjYwOTk5QzIxLjMxIDUuMjA5OTkgMjEuMjMgNC44Mjk5OSAyMS4wOCA0LjQ1OTk5QzIwLjkzIDQuMDk5OTkgMjAuNzEgMy43Njk5OSAyMC40MyAzLjQ4OTk5QzIwLjE1IDMuMjA5OTkgMTkuODIgMi45ODk5OSAxOS40NiAyLjgzOTk5QzE5LjEgMi42ODk5OSAxOC43MSAyLjYwOTk5IDE4LjMxIDIuNjA5OTlDMTcuOTEgMi42MDk5OSAxNy41MyAyLjY4OTk5IDE3LjE2IDIuODM5OTlDMTYuOCAyLjk4OTk5IDE2LjQ2IDMuMjA5OTkgMTYuMTkgMy40ODk5OUwxNi4xNCAzLjUzOTk5QzE2LjA1IDMuNjI5OTkgMTUuOTMgMy42ODk5OSAxNS44IDMuNzA5OTlDMTUuNjcgMy43Mjk5OSAxNS41NCAzLjcwOTk5IDE1LjQyIDMuNjY5OTlDMTUuMyAzLjYxOTk5IDE1LjIgMy41Mjk5OSAxNS4xMyAzLjQyOTk5QzE1LjA2IDMuMzE5OTkgMTUuMDIgMy4xOTk5OSAxNS4wMiAzLjA3OTk5VjIuOTg5OTlDMTUuMDIgMi4xODk5OSAxNC43IDEuNDI5OTkgMTQuMTQgMC44Njk5OUMxMy41OCAwLjMwOTk5IDEyLjgxIC0wLjAxMDAwOTggMTIuMDIgLTAuMDEwMDA5OEMxMS4yMyAtMC4wMTAwMDk4IDEwLjQ2IDAuMzA5OTkgOS45MDAwMiAwLjg2OTk5QzkuMzQwMDIgMS40Mjk5OSA5LjAyMDAyIDIuMTk5OTkgOS4wMjAwMiAyLjk4OTk5VjMuMTU5OTlDOS4wMjAwMiAzLjI4OTk5IDguOTgwMDIgMy40MDk5OSA4LjkxMDAyIDMuNTA5OTlDOC44NjAwMiAzLjU3OTk5IDguODAwMDIgMy42Mzk5OSA4LjczMDAyIDMuNjg5OTlDOC42NjAwMiAzLjY5OTk5IDguNjAwMDIgMy43Mjk5OSA4LjUzMDAyIDMuNzQ5OTlDOC40MTAwMiAzLjc5OTk5IDguMjgwMDIgMy44MTk5OSA4LjE1MDAyIDMuNzg5OTlDOC4wMjAwMiAzLjc2OTk5IDcuOTEwMDIgMy43MDk5OSA3LjgxMDAyIDMuNjE5OTlMNy43NjAwMiAzLjU2OTk5QzcuNDgwMDIgMy4yODk5OSA3LjE1MDAyIDMuMDY5OTkgNi43OTAwMiAyLjkxOTk5QzYuNDMwMDIgMi43Njk5OSA2LjA0MDAyIDIuNjg5OTkgNS42NDAwMiAyLjY4OTk5QzUuMjQwMDIgMi42ODk5OSA0Ljg2MDAyIDIuNzY5OTkgNC40OTAwMiAyLjkxOTk5QzQuMTMwMDIgMy4wNjk5OSAzLjgwMDAyIDMuMjg5OTkgMy41MjAwMiAzLjU2OTk5QzMuMjQwMDIgMy44NDk5OSAzLjAyMDAyIDQuMTc5OTkgMi44NzAwMiA0LjUzOTk5QzIuNzIwMDIgNC44OTk5OSAyLjY0MDAyIDUuMjg5OTkgMi42NDAwMiA1LjY4OTk5QzIuNjQwMDIgNi4wODk5OSAyLjcyMDAyIDYuNDY5OTkgMi44NzAwMiA2LjgzOTk5QzMuMDIwMDIgNy4xOTk5OSAzLjI0MDAyIDcuNTM5OTkgMy41MjAwMiA3LjgwOTk5TDMuNTcwMDIgNy44NTk5OUMzLjY2MDAyIDcuOTQ5OTkgMy43MjAwMiA4LjA2OTk5IDMuNzQwMDIgOC4xOTk5OUMzLjc2MDAyIDguMzI5OTkgMy43NDAwMiA4LjQ1OTk5IDMuNzAwMDIgOC41Nzk5OUMzLjcwMDAyIDguNTk5OTkgMy42ODAwMiA4LjYxOTk5IDMuNjgwMDIgOC42Mzk5OUMzLjY0MDAyIDguNzU5OTkgMy41NTAwMiA4Ljg2OTk5IDMuNDUwMDIgOC45Mzk5OUMzLjM1MDAyIDkuMDA5OTkgMy4yMjAwMiA5LjA1OTk5IDMuMTAwMDIgOS4wNTk5OUgzLjAyMDAyQzIuMjIwMDIgOS4wNTk5OSAxLjQ2MDAyIDkuMzc5OTkgMC45MDAwMiA5LjkzOTk5QzAuMzQwMDIgMTAuNSAwLjAyMDAxOTUgMTEuMjcgMC4wMjAwMTk1IDEyLjA2QzAuMDIwMDE5NSAxMi44NSAwLjM0MDAyIDEzLjYyIDAuOTAwMDIgMTQuMThDMS40NjAwMiAxNC43NCAyLjIzMDAyIDE1LjA2IDMuMDIwMDIgMTUuMDZIMy4xOTAwMkMzLjMyMDAyIDE1LjA2IDMuNDQwMDIgMTUuMSAzLjU0MDAyIDE1LjE3QzMuNjUwMDIgMTUuMjQgMy43MzAwMiAxNS4zNCAzLjc4MDAyIDE1LjQ2QzMuODMwMDIgMTUuNTkgMy44NTAwMiAxNS43MiAzLjgyMDAyIDE1Ljg1QzMuODAwMDIgMTUuOTggMy43NDAwMiAxNi4wOSAzLjY1MDAyIDE2LjE5TDMuNjAwMDIgMTYuMjRDMy4zMjAwMiAxNi41MiAzLjEwMDAyIDE2Ljg1IDIuOTUwMDIgMTcuMjFDMi44MDAwMiAxNy41NyAyLjcyMDAyIDE3Ljk2IDIuNzIwMDIgMTguMzZDMi43MjAwMiAxOC43NiAyLjgwMDAyIDE5LjE0IDIuOTUwMDIgMTkuNTFDMy4xMDAwMiAxOS44NyAzLjMyMDAyIDIwLjIxIDMuNjAwMDIgMjAuNDhDMy44ODAwMiAyMC43NiA0LjIxMDAyIDIwLjk4IDQuNTcwMDIgMjEuMTNDNC45MzAwMiAyMS4yOCA1LjMyMDAyIDIxLjM2IDUuNzIwMDIgMjEuMzZDNi4xMjAwMiAyMS4zNiA2LjUwMDAyIDIxLjI4IDYuODcwMDIgMjEuMTNDNy4yMzAwMiAyMC45OCA3LjU3MDAyIDIwLjc2IDcuODQwMDIgMjAuNDhMNy44OTAwMiAyMC40M0M3Ljk4MDAyIDIwLjM0IDguMTAwMDIgMjAuMjggOC4yMzAwMiAyMC4yNkM4LjM2MDAyIDIwLjI0IDguNDkwMDIgMjAuMjYgOC42MTAwMiAyMC4zQzguNjMwMDIgMjAuMyA4LjY1MDAyIDIwLjMyIDguNjcwMDIgMjAuMzJDOC43OTAwMiAyMC4zNyA4LjkwMDAyIDIwLjQ1IDguOTcwMDIgMjAuNTVDOS4wNDAwMiAyMC42NSA5LjA5MDAyIDIwLjc4IDkuMDkwMDIgMjAuOVYyMC45OEM5LjA5MDAyIDIxLjc4IDkuNDEwMDIgMjIuNTQgOS45NzAwMiAyMy4xQzEwLjUzIDIzLjY2IDExLjMgMjMuOTggMTIuMDkgMjMuOThDMTIuODggMjMuOTggMTMuNjUgMjMuNjYgMTQuMjEgMjMuMUMxNC43NyAyMi41NCAxNS4wOSAyMS43NyAxNS4wOSAyMC45OFYyMC44MUMxNS4wOSAyMC42OCAxNS4xMyAyMC41NiAxNS4yIDIwLjQ2QzE1LjI3IDIwLjM1IDE1LjM3IDIwLjI3IDE1LjQ5IDIwLjIyQzE1LjYxIDIwLjE2IDE1Ljc0IDIwLjE1IDE1Ljg3IDIwLjE3QzE2IDIwLjE5IDE2LjExIDIwLjI1IDE2LjIxIDIwLjM0TDE2LjI3IDIwLjRDMTYuNTUgMjAuNjggMTYuODggMjAuOSAxNy4yNCAyMS4wNUMxNy42IDIxLjIgMTcuOTkgMjEuMjggMTguMzkgMjEuMjhDMTguNzkgMjEuMjggMTkuMTcgMjEuMiAxOS41NCAyMS4wNUMxOS45IDIwLjkgMjAuMjMgMjAuNjggMjAuNTEgMjAuNE0xOS40NSAxMy40NEMxOS4wMiAxMy43MiAxOC42OCAxNC4xMyAxOC40OCAxNC42QzE4LjI3IDE1LjA4IDE4LjIgMTUuNjIgMTguMyAxNi4xNEMxOC4zOSAxNi42NiAxOC42NCAxNy4xNCAxOS4wMSAxNy41MkwxOS4wOCAxNy41OUMxOS4xNyAxNy42OCAxOS4yNSAxNy43OSAxOS4zIDE3LjkxQzE5LjM1IDE4LjAzIDE5LjM4IDE4LjE2IDE5LjM4IDE4LjI5QzE5LjM4IDE4LjQyIDE5LjM1IDE4LjU1IDE5LjMgMTguNjdDMTkuMjUgMTguNzkgMTkuMTggMTguOSAxOS4wOCAxOC45OUMxOC45OSAxOS4wOCAxOC44OCAxOS4xNiAxOC43NiAxOS4yMUMxOC42NCAxOS4yNiAxOC41MSAxOS4yOSAxOC4zOCAxOS4yOUMxOC4yNSAxOS4yOSAxOC4xMiAxOS4yNiAxOCAxOS4yMUMxNy44OCAxOS4xNiAxNy43NyAxOS4wOSAxNy42OCAxOC45OUwxNy42MiAxOC45M0MxNy4yNCAxOC41NSAxNi43NiAxOC4zIDE2LjI0IDE4LjIxQzE1LjcyIDE4LjEyIDE1LjE5IDE4LjE4IDE0LjcgMTguMzlDMTQuMjMgMTguNTkgMTMuODIgMTguOTMgMTMuNTQgMTkuMzZDMTMuMjUgMTkuNzkgMTMuMSAyMC4zIDEzLjEgMjAuODFWMjAuOThDMTMuMSAyMS4yNSAxMi45OSAyMS41IDEyLjgxIDIxLjY5QzEyLjYzIDIxLjg4IDEyLjM3IDIxLjk4IDEyLjEgMjEuOThDMTEuODMgMjEuOTggMTEuNTggMjEuODcgMTEuMzkgMjEuNjlDMTEuMiAyMS41MSAxMS4xIDIxLjI1IDExLjEgMjAuOThWMjAuODdDMTEuMDkgMjAuMzQgMTAuOTIgMTkuODIgMTAuNjEgMTkuMzlDMTAuMzEgMTguOTcgOS44OTAwMiAxOC42NCA5LjQwMDAyIDE4LjQ2QzguOTIwMDIgMTguMjYgOC40MDAwMiAxOC4yIDcuODkwMDIgMTguMjlDNy4zNzAwMiAxOC4zOCA2Ljg5MDAyIDE4LjYzIDYuNTEwMDIgMTlMNi40NDAwMiAxOS4wN0M2LjM1MDAyIDE5LjE2IDYuMjQwMDIgMTkuMjQgNi4xMjAwMiAxOS4yOUM2LjAwMDAyIDE5LjM0IDUuODcwMDIgMTkuMzcgNS43NDAwMiAxOS4zN0M1LjYxMDAyIDE5LjM3IDUuNDgwMDIgMTkuMzQgNS4zNjAwMiAxOS4yOUM1LjI0MDAyIDE5LjI0IDUuMTMwMDIgMTkuMTcgNS4wNDAwMiAxOS4wN0M0Ljk1MDAyIDE4Ljk4IDQuODcwMDIgMTguODcgNC44MjAwMiAxOC43NEM0Ljc3MDAyIDE4LjYyIDQuNzQwMDIgMTguNDkgNC43NDAwMiAxOC4zNkM0Ljc0MDAyIDE4LjIzIDQuNzcwMDIgMTguMSA0LjgyMDAyIDE3Ljk4QzQuODcwMDIgMTcuODYgNC45NDAwMiAxNy43NSA1LjA0MDAyIDE3LjY1TDUuMTAwMDIgMTcuNTlDNS40NzAwMiAxNy4yIDUuNzIwMDIgMTYuNzIgNS44MTAwMiAxNi4yQzUuOTAwMDIgMTUuNjggNS44NDAwMiAxNS4xNSA1LjYzMDAyIDE0LjY2QzUuNDMwMDIgMTQuMTkgNS4wOTAwMiAxMy43OCA0LjY2MDAyIDEzLjVDNC4yMzAwMiAxMy4yMSAzLjcyMDAyIDEzLjA2IDMuMjEwMDIgMTMuMDZIMy4wNDAwMkMyLjc3MDAyIDEzLjA2IDIuNTIwMDIgMTIuOTUgMi4zMzAwMiAxMi43N0MyLjE0MDAyIDEyLjU4IDIuMDQwMDIgMTIuMzMgMi4wNDAwMiAxMi4wNkMyLjA0MDAyIDExLjc5IDIuMTUwMDIgMTEuNTQgMi4zMzAwMiAxMS4zNUMyLjUyMDAyIDExLjE2IDIuNzcwMDIgMTEuMDYgMy4wNDAwMiAxMS4wNkgzLjE1MDAyQzMuNjgwMDIgMTEuMDUgNC4yMDAwMiAxMC44OCA0LjYzMDAyIDEwLjU3QzUuMDUwMDIgMTAuMjcgNS4zODAwMiA5Ljg0OTk5IDUuNTYwMDIgOS4zNTk5OUM1Ljc2MDAyIDguODc5OTkgNS44MjAwMiA4LjM1OTk5IDUuNzMwMDIgNy44NDk5OUM1LjY0MDAyIDcuMzI5OTkgNS4zOTAwMiA2Ljg0OTk5IDUuMDIwMDIgNi40Njk5OUw0Ljk1MDAyIDYuMzk5OTlDNC44NjAwMiA2LjMwOTk5IDQuNzgwMDIgNi4xOTk5OSA0LjczMDAyIDYuMDc5OTlDNC42ODAwMiA1Ljk1OTk5IDQuNjUwMDIgNS44Mjk5OSA0LjY1MDAyIDUuNjk5OTlDNC42NTAwMiA1LjU2OTk5IDQuNjgwMDIgNS40Mzk5OSA0LjczMDAyIDUuMzE5OTlDNC43ODAwMiA1LjE5OTk5IDQuODUwMDIgNS4wODk5OSA0Ljk1MDAyIDQuOTk5OTlDNS4wNDAwMiA0LjkwOTk5IDUuMTUwMDIgNC44Mjk5OSA1LjI3MDAyIDQuNzc5OTlDNS4zOTAwMiA0LjcyOTk5IDUuNTIwMDIgNC42OTk5OSA1LjY1MDAyIDQuNjk5OTlDNS43ODAwMiA0LjY5OTk5IDUuOTEwMDIgNC43Mjk5OSA2LjAzMDAyIDQuNzc5OTlDNi4xNTAwMiA0LjgyOTk5IDYuMjYwMDIgNC44OTk5OSA2LjM1MDAyIDQuOTk5OTlMNi40MTAwMiA1LjA1OTk5QzYuNzkwMDIgNS40Mzk5OSA3LjI3MDAyIDUuNjg5OTkgNy43OTAwMiA1Ljc3OTk5QzguMjQwMDIgNS44NTk5OSA4LjcxMDAyIDUuODE5OTkgOS4xNDAwMiA1LjY2OTk5QzkuMjMwMDIgNS42NTk5OSA5LjMyMDAyIDUuNjI5OTkgOS40MDAwMiA1LjU5OTk5QzkuODgwMDIgNS4zOTk5OSAxMC4yOCA1LjA1OTk5IDEwLjU3IDQuNjI5OTlDMTAuODYgNC4xOTk5OSAxMS4wMSAzLjY4OTk5IDExLjAxIDMuMTc5OTlWMy4wMDk5OUMxMS4wMSAyLjczOTk5IDExLjEyIDIuNDg5OTkgMTEuMyAyLjI5OTk5QzExLjQ5IDIuMTA5OTkgMTEuNzQgMi4wMDk5OSAxMi4wMSAyLjAwOTk5QzEyLjI4IDIuMDA5OTkgMTIuNTMgMi4xMTk5OSAxMi43MiAyLjI5OTk5QzEyLjkxIDIuNDg5OTkgMTMuMDEgMi43Mzk5OSAxMy4wMSAzLjAwOTk5VjMuMDk5OTlDMTMuMDEgMy42MTk5OSAxMy4xNyA0LjEyOTk5IDEzLjQ1IDQuNTU5OTlDMTMuNzMgNC45ODk5OSAxNC4xNCA1LjMyOTk5IDE0LjYxIDUuNTI5OTlDMTUuMDkgNS43Mzk5OSAxNS42MyA1LjgwOTk5IDE2LjE1IDUuNzA5OTlDMTYuNjcgNS42MTk5OSAxNy4xNSA1LjM2OTk5IDE3LjUzIDQuOTk5OTlMMTcuNiA0LjkyOTk5QzE3LjY5IDQuODM5OTkgMTcuOCA0Ljc1OTk5IDE3LjkyIDQuNzA5OTlDMTguMDQgNC42NTk5OSAxOC4xNyA0LjYyOTk5IDE4LjMgNC42Mjk5OUMxOC40MyA0LjYyOTk5IDE4LjU2IDQuNjU5OTkgMTguNjggNC43MDk5OUMxOC44IDQuNzU5OTkgMTguOTEgNC44Mjk5OSAxOSA0LjkyOTk5QzE5LjA5IDUuMDE5OTkgMTkuMTcgNS4xMjk5OSAxOS4yMiA1LjI1OTk5QzE5LjI3IDUuMzc5OTkgMTkuMyA1LjUwOTk5IDE5LjMgNS42Mzk5OUMxOS4zIDUuNzY5OTkgMTkuMjcgNS44OTk5OSAxOS4yMiA2LjAxOTk5QzE5LjE3IDYuMTM5OTkgMTkuMSA2LjI0OTk5IDE5IDYuMzM5OTlMMTguOTQgNi4zOTk5OUMxOC41NyA2Ljc4OTk5IDE4LjMyIDcuMjY5OTkgMTguMjMgNy43ODk5OUMxOC4xNSA4LjIzOTk5IDE4LjE5IDguNzA5OTkgMTguMzQgOS4xMzk5OUMxOC4zNSA5LjIyOTk5IDE4LjM4IDkuMzE5OTkgMTguNDEgOS4zOTk5OUMxOC42MSA5Ljg3OTk5IDE4Ljk1IDEwLjI4IDE5LjM4IDEwLjU3QzE5LjgxIDEwLjg2IDIwLjMyIDExLjAxIDIwLjgzIDExLjAxSDIxQzIxLjI3IDExLjAxIDIxLjUyIDExLjEyIDIxLjcxIDExLjNDMjEuOSAxMS40OCAyMiAxMS43NCAyMiAxMi4wMUMyMiAxMi4yOCAyMS44OSAxMi41MyAyMS43MSAxMi43MkMyMS41MyAxMi45MSAyMS4yNyAxMy4wMSAyMSAxMy4wMUgyMC45MUMyMC4zOSAxMy4wMSAxOS44OSAxMy4xNyAxOS40NiAxMy40NUwxOS40NSAxMy40NFoiIGZpbGw9IiMwMDAzMEQiLz4KPC9nPgo8ZGVmcz4KPGNsaXBQYXRoIGlkPSJjbGlwMF80XzM1MjQ0Ij4KPHJlY3Qgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiBmaWxsPSJ3aGl0ZSIvPgo8L2NsaXBQYXRoPgo8L2RlZnM+Cjwvc3ZnPgo=";

export const SUMMARY_B64 =
  "PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik00IDRDMy43MzQ3OCA0IDMuNDgwNDMgNC4xMDUzNiAzLjI5Mjg5IDQuMjkyODlDMy4xMDUzNiA0LjQ4MDQzIDMgNC43MzQ3OCAzIDVWMTlDMyAxOS4yNjUyIDMuMTA1MzYgMTkuNTE5NiAzLjI5Mjg5IDE5LjcwNzFDMy40ODA0MyAxOS44OTQ2IDMuNzM0NzggMjAgNCAyMEgyMEMyMC4yNjUyIDIwIDIwLjUxOTYgMTkuODk0NiAyMC43MDcxIDE5LjcwNzFDMjAuODk0NiAxOS41MTk2IDIxIDE5LjI2NTIgMjEgMTlWOEMyMSA3LjczNDc4IDIwLjg5NDYgNy40ODA0MyAyMC43MDcxIDcuMjkyODlDMjAuNTE5NiA3LjEwNTM2IDIwLjI2NTIgNyAyMCA3SDExQzEwLjY2NTYgNyAxMC4zNTM0IDYuODMyOSAxMC4xNjc5IDYuNTU0N0w4LjQ2NDgyIDRINFpNMS44Nzg2OCAyLjg3ODY4QzIuNDQxMjkgMi4zMTYwNyAzLjIwNDM1IDIgNCAySDlDOS4zMzQzNSAyIDkuNjQ2NTggMi4xNjcxIDkuODMyMDUgMi40NDUzTDExLjUzNTIgNUgyMEMyMC43OTU3IDUgMjEuNTU4NyA1LjMxNjA3IDIyLjEyMTMgNS44Nzg2OEMyMi42ODM5IDYuNDQxMjkgMjMgNy4yMDQzNSAyMyA4VjE5QzIzIDE5Ljc5NTcgMjIuNjgzOSAyMC41NTg3IDIyLjEyMTMgMjEuMTIxM0MyMS41NTg3IDIxLjY4MzkgMjAuNzk1NyAyMiAyMCAyMkg0QzMuMjA0MzUgMjIgMi40NDEyOSAyMS42ODM5IDEuODc4NjggMjEuMTIxM0MxLjMxNjA3IDIwLjU1ODcgMSAxOS43OTU3IDEgMTlWNUMxIDQuMjA0MzUgMS4zMTYwNyAzLjQ0MTI5IDEuODc4NjggMi44Nzg2OFoiIGZpbGw9IiMwMDAzMEQiLz4KPC9zdmc+Cg==";

export const FOLDER_B64 =
  "PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik01IDRDNC40NDc3MiA0IDQgNC40NDc3MiA0IDVWOEgyMFY1QzIwIDQuNDQ3NzEgMTkuNTUyMyA0IDE5IDRINVpNMjIgNUMyMiAzLjM0MzE1IDIwLjY1NjkgMiAxOSAySDVDMy4zNDMxNSAyIDIgMy4zNDMxNSAyIDVWMTlDMiAyMC42NTY5IDMuMzQzMTUgMjIgNSAyMkgxOUMyMC42NTY5IDIyIDIyIDIwLjY1NjkgMjIgMTlWNVpNMjAgMTBIMTBWMjBIMTlDMTkuNTUyMyAyMCAyMCAxOS41NTIzIDIwIDE5VjEwWk04IDIwVjEwSDRWMTlDNCAxOS41NTIzIDQuNDQ3NzEgMjAgNSAyMEg4WiIgZmlsbD0iIzAwMDMwRCIvPgo8L3N2Zz4K";

export const CLOCK_B64 =
  "PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xMiAzQzcuMDI5NDQgMyAzIDcuMDI5NDQgMyAxMkMzIDE2Ljk3MDYgNy4wMjk0NCAyMSAxMiAyMUMxNi45NzA2IDIxIDIxIDE2Ljk3MDYgMjEgMTJDMjEgNy4wMjk0NCAxNi45NzA2IDMgMTIgM1pNMSAxMkMxIDUuOTI0ODcgNS45MjQ4NyAxIDEyIDFDMTguMDc1MSAxIDIzIDUuOTI0ODcgMjMgMTJDMjMgMTguMDc1MSAxOC4wNzUxIDIzIDEyIDIzQzUuOTI0ODcgMjMgMSAxOC4wNzUxIDEgMTJaIiBmaWxsPSJibGFjayIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTEyIDVDMTIuNTUyMyA1IDEzIDUuNDQ3NzIgMTMgNlYxMS4zODJMMTYuNDQ3MiAxMy4xMDU2QzE2Ljk0MTIgMTMuMzUyNiAxNy4xNDE0IDEzLjk1MzIgMTYuODk0NCAxNC40NDcyQzE2LjY0NzQgMTQuOTQxMiAxNi4wNDY4IDE1LjE0MTQgMTUuNTUyOCAxNC44OTQ0TDExLjU1MjggMTIuODk0NEMxMS4yMTQgMTIuNzI1IDExIDEyLjM3ODggMTEgMTJWNkMxMSA1LjQ0NzcyIDExLjQ0NzcgNSAxMiA1WiIgZmlsbD0iYmxhY2siLz4KPC9zdmc+Cg==";

export const DEFAULT_B64 =
  "PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik01IDRDNC40NDc3MiA0IDQgNC40NDc3MiA0IDVWOEgyMFY1QzIwIDQuNDQ3NzEgMTkuNTUyMyA0IDE5IDRINVpNMjIgNUMyMiAzLjM0MzE1IDIwLjY1NjkgMiAxOSAySDVDMy4zNDMxNSAyIDIgMy4zNDMxNSAyIDVWMTlDMiAyMC42NTY5IDMuMzQzMTUgMjIgNSAyMkgxOUMyMC42NTY5IDIyIDIyIDIwLjY1NjkgMjIgMTlWNVpNMjAgMTBIMTBWMjBIMTlDMTkuNTUyMyAyMCAyMCAxOS41NTIzIDIwIDE5VjEwWk04IDIwVjEwSDRWMTlDNCAxOS41NTIzIDQuNDQ3NzEgMjAgNSAyMEg4WiIgZmlsbD0iIzAwMDMwRCIvPgo8L3N2Zz4K";

```

## Archivo: `packages/ComponentLibrary/src/components/Drawer/MenuTitle/index.tsx`

```typescript
"use client";
import React from "react";
import ChevronDown from "../../../assets/icons/chevron-down.svg";
import type { MenuTitleProps } from "../types";
import { DEFAULT_B64, PROCESS_B64, REPORT_B64, SUMMARY_B64 } from "./constants";

export const MenuTitle: React.FC<MenuTitleProps> = React.memo(
  ({ item, onClick, selected, expanded, open, popperOpen, isParentActive }) => {
    const getIconSrc = () => {
      if (item.icon) return `data:image/svg+xml;base64,${item.icon}`;
      switch (item.type) {
        case "Report":
          return `data:image/svg+xml;base64,${REPORT_B64}`;
        case "ProcessDefinition":
        case "ProcessManual":
          return `data:image/svg+xml;base64,${PROCESS_B64}`;
        case "Summary":
          return `data:image/svg+xml;base64,${SUMMARY_B64}`;
        default:
          return `data:image/svg+xml;base64,${DEFAULT_B64}`;
      }
    };

    return (
      <button
        type="button"
        onClick={onClick}
        className={`${open && "hover:[&_img]:filter-[brightness(0)_saturate(100%)_invert(18%)_sepia(40%)_saturate(7101%)_hue-rotate(215deg)_brightness(91%)_contrast(102%)]"}
 relative flex items-center transition-colors duration-300 cursor-pointer hover:${selected ? "bg-dynamic-main text-white hover:[&_img]:filter-[brightness(0)_saturate(100%)_invert(100%)_sepia(45%)_saturate(0%)_hue-rotate(45deg)_brightness(113%)_contrast(100%)]" : "bg-dynamic-contrast-text"} ${isParentActive && open && "[&_img]:filter-[brightness(0)_saturate(100%)_invert(18%)_sepia(40%)_saturate(7101%)_hue-rotate(215deg)_brightness(91%)_contrast(102%)] text-dynamic-main"}  ${
   open
     ? `rounded-lg text-xl justify-between p-1 ${
         selected
           ? "bg-dynamic-main text-white [&_img]:filter-[brightness(0)_saturate(100%)_invert(100%)_sepia(45%)_saturate(0%)_hue-rotate(45deg)_brightness(113%)_contrast(100%)]"
           : "text-baseline-80 hover:text-dynamic-main"
       } w-full`
     : `p-2.5 rounded-full hover:bg-dynamic-main hover:[&_img]:filter-[brightness(0)_saturate(100%)_invert(100%)_sepia(45%)_saturate(0%)_hue-rotate(45deg)_brightness(113%)_contrast(100%)] "  ${
         isParentActive &&
         "bg-dynamic-main [&_img]:filter-[brightness(0)_saturate(100%)_invert(100%)_sepia(45%)_saturate(0%)_hue-rotate(45deg)_brightness(113%)_contrast(100%)]"
       }`
 }`}>
        <div className={`flex items-center ${open ? "overflow-hidden" : ""}`}>
          <div className={`${open ? "w-8" : "w-full h-full"} flex justify-center items-center`}>
            {item.icon ? (
              <img
                alt="img"
                src={`data:image/svg+xml;base64,${item.icon}`}
                className="filter-[brightness(0)_saturate(100%)_invert(9%)_sepia(100%)_saturate(3080%)_hue-rotate(212deg)_brightness(97%)_contrast(101%)] w-5 h-5"
              />
            ) : (
              <span className="text-base">
                <img
                  alt={item.type || "icon"}
                  src={getIconSrc()}
                  className="filter-[brightness(0)_saturate(100%)_invert(9%)_sepia(100%)_saturate(3080%)_hue-rotate(212deg)_brightness(97%)_contrast(101%)] w-5 h-5"
                />
              </span>
            )}
          </div>
          {open && (
            <div className="relative group flex items-center py-1.5 flex-1 min-w-0">
              <span className="ml-2 font-medium text-sm whitespace-nowrap overflow-hidden text-ellipsis flex-1 min-w-0">
                {item.name}
              </span>
            </div>
          )}
        </div>
        {open && item.children && !popperOpen && (
          <div className={`transition-transform duration-300 flex justify-center ${expanded ? "rotate-180" : ""}`}>
            <ChevronDown />
          </div>
        )}
      </button>
    );
  }
);

MenuTitle.displayName = "MenuTitle";
export default MenuTitle;

```

## Archivo: `packages/ComponentLibrary/src/components/Drawer/Search/index.tsx`

```typescript
import React, { useRef } from "react";
import DrawerSection from "../DrawerSection";
import type { DrawerItemsProps, ToggleFunctions } from "../types";

export const DrawerItems: React.FC<DrawerItemsProps> = React.memo(
  ({
    items,
    onClick,
    open,
    expandedItems,
    toggleItemExpansion,
    searchValue,
    windowId,
    onReportClick,
    onProcessClick,
  }) => {
    const toggleFunctions = useRef<ToggleFunctions>({});

    return (
      <>
        {Array.isArray(items)
          ? items.map((item) => {
              if (!toggleFunctions.current[item.id]) {
                toggleFunctions.current[item.id] = () => toggleItemExpansion(item.id);
              }
              return (
                <DrawerSection
                  key={item.id}
                  item={item}
                  onClick={onClick}
                  onReportClick={onReportClick}
                  onProcessClick={onProcessClick}
                  open={open}
                  isExpanded={expandedItems.has(item.id) || Boolean(searchValue)}
                  onToggleExpand={toggleFunctions.current[item.id]}
                  hasChildren={Array.isArray(item.children) && item.children.length > 0}
                  isExpandable={!searchValue && Array.isArray(item.children) && item.children.length > 0}
                  isSearchActive={Boolean(searchValue)}
                  windowId={windowId}
                />
              );
            })
          : null}
      </>
    );
  }
);

export default DrawerItems;

```

## Archivo: `packages/ComponentLibrary/src/components/Drawer/index.tsx`

```typescript
"use client";
import type { Menu } from "@workspaceui/api-client/src/api/types";
import { useCallback, useEffect, useMemo, useRef, useState } from "react";
import { getAllItemTitles } from "../../utils/searchUtils";
import TextInputAutocomplete from "../Input/TextInput/TextInputAutocomplete";
import DrawerHeader from "./Header";
import { DrawerItems } from "./Search";
import type { DrawerProps } from "./types";
import ResizeHandle from "../ResizeHandle";

const DRAWER_STATE_KEY = "etendo-drawer-open";
interface RecentlyViewedHandler {
  handleWindowAccess?: (item: Menu) => void;
}

const DRAWER_OPEN_WIDTH = 16.25;
const DRAWER_CLOSED_WIDTH = 3.5;
const DRAWER_MAX_WIDTH = 50;

const Drawer: React.FC<DrawerProps> = ({
  windowId,
  items = [],
  logo,
  title,
  onClick,
  onReportClick,
  onProcessClick,
  RecentlyViewedComponent,
  getTranslatedName,
  searchContext,
}) => {
  const [open, setOpen] = useState<boolean>(() => {
    if (typeof window !== "undefined") {
      const savedState = localStorage.getItem(DRAWER_STATE_KEY);
      return savedState ? JSON.parse(savedState) : false;
    }
    return false;
  });
  const [drawerWidth, setDrawerWidth] = useState<number>(DRAWER_OPEN_WIDTH);

  const searchInputRef = useRef<HTMLInputElement>(null);

  const drawerRefs = useRef<{
    recentlyViewedHandler: RecentlyViewedHandler;
  }>({
    recentlyViewedHandler: {},
  });

  const { searchValue, setSearchValue, filteredItems, expandedItems, setExpandedItems, searchIndex } = searchContext;

  useEffect(() => {
    setDrawerWidth(open ? DRAWER_OPEN_WIDTH : DRAWER_CLOSED_WIDTH);
    if (typeof window !== "undefined") {
      localStorage.setItem(DRAWER_STATE_KEY, JSON.stringify(open));
    }
  }, [open]);

  useEffect(() => {
    if (open && searchInputRef.current) {
      searchInputRef.current.focus();
    }
  }, [open]);

  const allItemTitles = useMemo(() => (searchIndex ? getAllItemTitles(searchIndex) : []), [searchIndex]);

  const handleHeaderClick = useCallback(() => setOpen((prev) => !prev), []);

  const toggleItemExpansion = useCallback(
    (itemId: string) => {
      setExpandedItems((prev: Set<string>) => {
        const newSet = new Set(prev);
        if (newSet.has(itemId)) {
          newSet.delete(itemId);
        } else {
          newSet.add(itemId);
        }
        return newSet;
      });
    },
    [setExpandedItems]
  );

  const handleItemClick = useCallback(
    (item: Menu) => {
      drawerRefs.current.recentlyViewedHandler.handleWindowAccess?.(item);
      onClick(item);
    },
    [onClick]
  );

  const setRecentlyViewedRef = useCallback((ref: RecentlyViewedHandler) => {
    drawerRefs.current.recentlyViewedHandler = ref;
  }, []);
  return (
    <ResizeHandle
      initialWidth={drawerWidth}
      onWidthChange={setDrawerWidth}
      minWidth={open ? DRAWER_OPEN_WIDTH : DRAWER_CLOSED_WIDTH}
      maxWidth={open ? DRAWER_MAX_WIDTH : DRAWER_CLOSED_WIDTH}
      maxOffsetRem={9}
      hideHandle
      direction="horizontal">
      <div
        style={{ width: `${drawerWidth}rem` }}
        className={`h-screen max-h-screen transition-all duration-500 ease-in-out
             bg-(--color-baseline-0) border-none
             rounded-tr-xl rounded-br-xl flex flex-col overflow-hidden pb-4  ${open ? "w-[16.25rem]" : "w-[3.5rem]"}`}>
        <DrawerHeader logo={logo} title={title} open={open} onClick={handleHeaderClick} tabIndex={-1} />
        {open && (
          <div className="p-2 pb-0">
            <TextInputAutocomplete
              value={searchValue}
              setValue={setSearchValue}
              placeholder="Search"
              autoCompleteTexts={allItemTitles}
              inputRef={searchInputRef}
            />
          </div>
        )}
        {RecentlyViewedComponent && (
          <RecentlyViewedComponent
            onClick={handleItemClick}
            open={open}
            items={items}
            windowId={windowId}
            getTranslatedName={getTranslatedName}
            ref={setRecentlyViewedRef}
          />
        )}
        <div className={`flex-grow overflow-y-auto ${!open && "flex flex-col gap-2"}`}>
          <DrawerItems
            items={searchValue ? filteredItems : items}
            onClick={handleItemClick}
            onReportClick={onReportClick}
            onProcessClick={onProcessClick}
            open={open}
            expandedItems={expandedItems}
            toggleItemExpansion={toggleItemExpansion}
            searchValue={searchValue}
            windowId={windowId}
          />
        </div>
      </div>
    </ResizeHandle>
  );
};

export { Drawer };

export default Drawer;

```

## Archivo: `packages/ComponentLibrary/src/components/Drawer/types.ts`

```typescript
import type { Menu } from "@workspaceui/api-client/src/api/types";

type NavigateFn = (item: Menu) => void;

export interface SearchContextType {
  searchValue: string;
  setSearchValue: (value: string) => void;
  filteredItems: Menu[];
  expandedItems: Set<string>;
  searchExpandedItems: Set<string>;
  setExpandedItems: React.Dispatch<React.SetStateAction<Set<string>>>;
  searchIndex: SearchIndex;
}

export interface DrawerProps {
  items: Menu[];
  logo?: string | React.ReactNode;
  title: string;
  onClick: NavigateFn;
  onReportClick: NavigateFn;
  onProcessClick: NavigateFn;
  // Mock Props
  headerImage?: string;
  headerTitle?: string;
  children?: React.ReactNode;
  sectionGroups?: SectionGroup[];
  windowId?: string;
  // biome-ignore lint/suspicious/noExplicitAny: <explanation>
  RecentlyViewedComponent?: any;
  getTranslatedName?: (item: Menu) => string;
  searchContext: SearchContextType;
}

export interface MenuTitleProps {
  item: Menu;
  onClick: (event: React.MouseEvent<HTMLElement>) => void;
  selected?: boolean;
  expanded?: boolean;
  open?: boolean;
  isExpandable?: boolean;
  popperOpen?: boolean;
  isParentActive?: boolean;
}

export interface DrawerSectionProps extends React.PropsWithChildren {
  item: Menu;
  onClick: NavigateFn;
  onReportClick?: NavigateFn;
  onProcessClick?: NavigateFn;
  open?: boolean;
  onToggleExpand: () => void;
  hasChildren: boolean;
  isExpanded: boolean;
  isExpandable: boolean;
  isSearchActive: boolean;
  reportId?: string;
  windowId?: string;
  parentId?: string;
}

export interface Section {
  id: string;
  label: string;
  icon: React.ReactNode;
  isSelected?: boolean;
  subSections?: Section[];
  badge?: string;
}

export interface SectionGroup {
  id: string | number;
  sections: Section[];
}

export interface IndexedMenu extends Menu {
  path: string[];
  fullPath: string;
}

export interface SearchIndex {
  byId: Map<string, IndexedMenu>;
  byPhrase: Map<string, Set<string>>;
}

export interface DrawerItemsProps {
  items: Menu[];
  onClick: NavigateFn;
  onReportClick?: NavigateFn;
  onProcessClick?: NavigateFn;
  open: boolean;
  expandedItems: Set<string>;
  toggleItemExpansion: (itemId: string) => void;
  searchValue: string;
  windowId?: string;
  reportId?: string;
}

export interface ToggleFunctions {
  [key: string]: () => void;
}

export interface RecentItem {
  id: string;
  name: string;
  windowId: string;
  type: string | "Window" | "Process" | "Report";
}

export interface DrawerHeaderProps {
  title: string;
  logo: string | React.ReactNode;
  open?: boolean;
  onClick: () => unknown;
  tabIndex?: number;
}

export interface RecentlyViewedProps {
  onClick: (item: Menu) => void;
  open: boolean;
  onWindowAccess?: (item: RecentItem) => void;
  recentItems?: RecentItem[];
  windowId?: string;
  items: Menu[];
  getTranslatedName?: (item: Menu) => string;
}

```

## Archivo: `packages/ComponentLibrary/src/components/IconButton/index.tsx`

```typescript
import type React from "react";
import Tooltip from "../Tooltip";
import { cleanDefaultClasses } from "../../utils/classUtil";

/**
 * Props for the IconButton component.
 * Extends all native button attributes with additional optional props.
 */
export interface IconButtonProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {
  /** Whether the button is disabled */
  disabled?: boolean;
  /** Accessibility label for screen readers */
  ariaLabel?: string;
  /** Text to display in a tooltip on hover */
  tooltip?: string;
  /** Position of the tooltip */
  tooltipPosition?: "top" | "bottom" | "left" | "right";
  /** Additional CSS classes to customize styling */
  className?: string;
  /** Optional text to show alongside the icon */
  iconText?: string;
  /** Ref forwarded to the underlying button element */
  ref?: React.LegacyRef<HTMLButtonElement>;
  /** Additional CSS classes to customize the container */
  containerClassName?: string;
}

/**
 * A customizable icon button component with optional tooltip and icon text.
 *
 * It merges default styling classes with any user-provided classes using `cleanDefaultClasses`.
 * The button supports disabling and accessibility features via aria-label.
 * If `tooltip` prop is provided, the button is wrapped inside a Tooltip component.
 *
 * @param {IconButtonProps} props - Props to configure the button
 * @returns {JSX.Element} The rendered icon button element
 */
const IconButton = ({
  className = "",
  children,
  disabled = false,
  ariaLabel,
  tooltip,
  tooltipPosition,
  iconText,
  ref,
  containerClassName,
  ...rest
}: IconButtonProps) => {
  const DEFAULT_BUTTON_CLASSES = `
    transition
    duration-400
    disabled:bg-transparent
    disabled:text-(--color-transparent-neutral-30)
    rounded-full
    text-(--color-baseline-80)
    bg-(--color-baseline-0)
    hover:text-(--color-baseline-0)
    hover:bg-(--color-dynamic-main)
    inline-flex
    items-center
    justify-center
    text-[0.825rem]
    min-w-max
    [&>svg]:text-[1.5rem]
    [&>svg]:fill-current
    ${iconText ? "px-2 gap-2" : "w-8 h-8"}
  `;

  return (
    <Tooltip title={tooltip} position={tooltipPosition} containerClassName={containerClassName}>
      <button
        ref={ref}
        type="button"
        aria-label={ariaLabel}
        disabled={disabled}
        className={cleanDefaultClasses(DEFAULT_BUTTON_CLASSES, className)}
        {...rest}>
        {children}
        {iconText && <span>{iconText}</span>}
      </button>
    </Tooltip>
  );
};

IconButton.displayName = "IconButton";
export default IconButton;

```

## Archivo: `packages/ComponentLibrary/src/components/IconButton/styles.ts`

```typescript
import { type SxProps, type Theme, useTheme } from "@mui/material";
import { useMemo } from "react";

export const useStyle = () => {
  const theme = useTheme();

  return useMemo(
    () => ({
      styles: {
        defaultContainer: {
          borderRadius: "6.25rem",
          display: "flex",
          alignItems: "center",
          justifyContent: "center",
          transition: "all 0.3s ease",
          background: theme.palette.baselineColor.neutral[0],
          "&:hover": {
            backgroundColor: theme.palette.dynamicColor.main,
          },
        },
        buttonContainer: {
          display: "flex",
          alignItems: "center",
          justifyContent: "center",
        },
        iconText: {
          marginLeft: "0.5rem",
          whiteSpace: "nowrap",
          fontSize: "0.825rem",
        },
      } as { [key: string]: SxProps<Theme> },
    }),
    [theme]
  );
};

```

## Archivo: `packages/ComponentLibrary/src/components/IconButton/types.ts`

```typescript
import type { IconButtonProps } from "@mui/material";

export interface IIconComponentProps extends React.PropsWithChildren<Omit<IconButtonProps, "children">> {
  fill?: string;
  hoverFill?: string;
  width?: number;
  height?: number;
  tooltip?: string;
  isHovered?: boolean;
  iconText?: string;
}

```

## Archivo: `packages/ComponentLibrary/src/components/IconButtonWithText/constants.ts`

```typescript
export const FILLED_BUTTON_TYPE = "filled";
export const OUTLINED_BUTTON_TYPE = "outlined";

```

## Archivo: `packages/ComponentLibrary/src/components/IconButtonWithText/index.tsx`

```typescript
import type React from "react";
import { cleanDefaultClasses } from "../../utils/classUtil";
import type { ButtonType } from "./types";
import { FILLED_BUTTON_TYPE, OUTLINED_BUTTON_TYPE } from "./constants";

const FILLED_DEFAULT_STYLES = `
  bg-[var(--color-baseline-100)]
  hover:bg-[var(--color-dynamic-main)]
  disabled:bg-[var(--color-transparent-neutral-20)]
  text-[var(--color-baseline-0)]
  font-medium
`;

const OUTLINED_DEFAULT_STYLES = `
  border: 1px solid var(--color-transparent-neutral-20);
  bg-[var(--color-transparent-neutral-0)]
  hover:bg-[var(--color-etendo-dark)]
  hover:border-none
  hover:text-[var(--color-baseline-0)]
  disabled:bg-[var(--color-transparent-neutral-10)]
  disabled:opacity-30
  text-[var(--color-baseline-70)]
`;

const getCurrentStyles = (buttonType: ButtonType) => {
  switch (buttonType) {
    case FILLED_BUTTON_TYPE:
      return FILLED_DEFAULT_STYLES;
    case OUTLINED_BUTTON_TYPE:
      return OUTLINED_DEFAULT_STYLES;
    default:
      return "";
  }
};

/**
 * Props for the Button component.
 * Extends all native button attributes with additional optional props.
 */
export interface IconButtonWithTextProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {
  /** Type of the button */
  buttonType: ButtonType;
  /** Text to show inside the button */
  text: string;
  /** Icon to show inside at the left of the button */
  leftIcon: React.ReactNode;
  /** Icon to show inside at the right of the button */
  rightIcon?: React.ReactNode;
  /** Whether the button is disabled */
  disabled?: boolean;
  /** Accessibility label for screen readers */
  ariaLabel?: string;
  /** Custom styles for the container */
  customContainerStyles?: string;
  /** Custom styles for the text */
  customTextStyles?: string;
  /** Ref forwarded to the underlying button element */
  ref?: React.LegacyRef<HTMLButtonElement>;
}

/**
 * A customizable button component with a required icon and text.
 *
 * It merges default styling classes with any user-provided classes using `cleanDefaultClasses`.
 * The button supports disabling and accessibility features via aria-label.
 *
 * @param {IconButtonWithTextProps} props - Props to configure the button
 * @returns {JSX.Element} The rendered button element
 */
const IconButtonWithText = ({
  buttonType = FILLED_BUTTON_TYPE,
  text,
  leftIcon,
  rightIcon,
  disabled = false,
  ariaLabel,
  customContainerStyles,
  customTextStyles,
  ref,
  ...rest
}: IconButtonWithTextProps): JSX.Element => {
  const DEFAULT_STYLES = `
    transition
    duration-400
    rounded-full
    inline-flex
    items-center
    justify-center
    text-[0.825rem]
    font-medium
    min-w-max
    gap-1
    [&>svg]:text-[1.5rem]
    [&>svg]:fill-current
  `;

  const currentDefaultStyles = cleanDefaultClasses(DEFAULT_STYLES, getCurrentStyles(buttonType));

  return (
    <button
      ref={ref}
      type="button"
      aria-label={ariaLabel}
      disabled={disabled}
      className={cleanDefaultClasses(currentDefaultStyles, customContainerStyles)}
      {...rest}>
      {leftIcon}
      <span className={customTextStyles}>{text}</span>
      {rightIcon}
    </button>
  );
};

IconButtonWithText.displayName = "IconButtonWithText";
export default IconButtonWithText;

```

## Archivo: `packages/ComponentLibrary/src/components/IconButtonWithText/styles.ts`

```typescript

```

## Archivo: `packages/ComponentLibrary/src/components/IconButtonWithText/types.ts`

```typescript
import type { FILLED_BUTTON_TYPE, OUTLINED_BUTTON_TYPE } from "./constants";

export type ButtonType = typeof FILLED_BUTTON_TYPE | typeof OUTLINED_BUTTON_TYPE;

```

## Archivo: `packages/ComponentLibrary/src/components/Input/Select/index.tsx`

```typescript
"use client";

import CancelIcon from "@mui/icons-material/Cancel";
import CheckCircleIcon from "@mui/icons-material/CheckCircle";
import ExpandMoreIcon from "@mui/icons-material/ExpandMore";
import {
  Autocomplete,
  type AutocompleteRenderInputParams,
  FormHelperText,
  InputAdornment,
  Paper,
  type PaperProps,
  TextField,
  Typography,
  useTheme,
} from "@mui/material";
import type React from "react";
import { useState } from "react";
import { useStyle } from "./style";
import type { ISelectInput, Option as BaseOption } from "./types";

type OptionProps = React.HTMLAttributes<HTMLLIElement> & { key?: string };
type Option<T extends string = string> = BaseOption<T> & {
  iconLeft?: React.ReactNode;
};

const Select: React.FC<ISelectInput> = ({
  title,
  iconLeft,
  options = [],
  disabled = false,
  helperText,
  name,
  ...props
}) => {
  const { sx } = useStyle();
  const theme = useTheme();
  const [inputValue, setInputValue] = useState<string>("");
  const [focused, setFocused] = useState<boolean>(false);

  const CustomPaper: React.FC<PaperProps> = (paperProps) => {
    return <Paper {...paperProps} sx={sx.optionsContainer} />;
  };

  const handleInputChange = (event: React.ChangeEvent<HTMLInputElement>) => {
    setInputValue(event.target.value);
  };

  const handleFocus = () => {
    setFocused(true);
  };

  const handleBlur = () => {
    setFocused(false);
    setInputValue("");
  };

  const handleSelectionChange = (event: React.SyntheticEvent<Element, Event>, value: Option | null) => {
    props.onChange?.(event, value);
  };

  const getBackgroundFocus = (): string => {
    if (!focused || inputValue) {
      return "transparent";
    }
    return theme.palette.baselineColor.neutral[0];
  };

  const renderInput = (params: AutocompleteRenderInputParams) => (
    <TextField
      {...params}
      sx={{
        ...sx.root,
        "& .MuiInput-root": {
          ...sx.root["& .MuiInput-root"],
          backgroundColor: getBackgroundFocus(),
        },
      }}
      InputLabelProps={{
        style: sx.labelProps,
        shrink: true,
      }}
      InputProps={{
        ...params.InputProps,
        name,
        sx: sx.props,
        startAdornment: iconLeft && <InputAdornment position="start">{iconLeft}</InputAdornment>,
        endAdornment: <div style={sx.buttonsContainer}>{params.InputProps.endAdornment}</div>,
      }}
      label={title}
      variant="standard"
      onChange={handleInputChange}
      onFocus={handleFocus}
      onBlur={handleBlur}
      name={name}
    />
  );

  const renderOption = (params: OptionProps, option: Option<string>, { selected }: { selected: boolean }) => {
    const { key, ...otherParams } = params;
    return (
      <li
        key={option.value + params.key}
        style={{
          ...sx.optionContainer,
          backgroundColor: selected ? theme.palette.baselineColor.neutral[0] : undefined,
        }}
        {...otherParams}>
        {option?.iconLeft && <div style={{ marginRight: "0.5rem" }}>{option.iconLeft}</div>}
        <Typography
          className="textOption"
          color={selected ? theme.palette.dynamicColor.dark : theme.palette.baselineColor.neutral[90]}
          style={sx.optionText}>
          {option.title}
        </Typography>
        {selected && <CheckCircleIcon style={sx.checkIcon} />}
      </li>
    );
  };

  return (
    <>
      <Autocomplete
        {...props}
        disabled={disabled}
        options={options}
        getOptionLabel={(option) => option.title}
        clearIcon={<CancelIcon style={sx.dropdownIcons} />}
        popupIcon={<ExpandMoreIcon style={sx.dropdownIcons} />}
        renderInput={renderInput}
        sx={sx.autocomplete}
        PaperComponent={CustomPaper}
        ListboxProps={{
          sx: sx.listBox,
        }}
        onChange={handleSelectionChange}
        renderOption={renderOption}
      />
      {helperText && (
        <FormHelperText component="div" style={sx.helperTextContainer}>
          {helperText.icon}
          {helperText.label && <span style={sx.helperText}>{helperText.label}</span>}
        </FormHelperText>
      )}
    </>
  );
};

export default Select;

```

## Archivo: `packages/ComponentLibrary/src/components/Input/Select/style.ts`

```typescript
import { useMemo } from "react";
import { type Theme, type SxProps, useTheme } from "@mui/material";

export const useStyle = () => {
  const theme = useTheme();

  return useMemo(() => {
    return {
      sx: {
        root: {
          "& .MuiInput-root": {
            fontSize: "0.875rem",
            fontWeight: 500,
            textAlign: "left",
            color: theme.palette.baselineColor.neutral[100],
            borderRadius: "0.75rem 0.75rem 0 0",
            "&:after": {
              borderColor: theme.palette.baselineColor.transparentNeutral[10],
              borderWidth: "0 0 2px",
            },
            "&.Mui-disabled": {
              color: theme.palette.baselineColor.transparentNeutral[50],
              backgroundColor: theme.palette.baselineColor.transparentNeutral[10],
              "&:before": {
                borderColor: theme.palette.baselineColor.transparentNeutral[10],
              },
              "&:after": {
                borderColor: theme.palette.baselineColor.transparentNeutral[10],
              },
            },
            "&:focus-within": {
              "&:after": {
                borderColor: theme.palette.baselineColor.etendoPrimary.main,
                borderWidth: "0 0 2px",
              },
            },
          },
          "& .MuiInputLabel-root": {
            color: theme.palette.baselineColor.neutral[80],
            fontWeight: "bold",
          },
        },
        labelProps: {
          fontSize: "0.875rem",
          fontWeight: 500,
          lineHeight: "1.25rem",
          color: theme.palette.baselineColor.neutral[80],
          overflow: "hidden",
        },
        props: {
          height: "3rem",
          padding: "0px 0.5rem",
        },
        startAdornment: {
          height: "1rem",
          width: "1rem",
          marginRight: "0.5rem",
        },
        imgIconLeft: {
          width: "1rem",
          height: "1rem",
          marginRight: "0.5rem",
        },
        buttonsContainer: {
          display: "flex",
          alignItems: "center",
        },
        helperTextContainer: {
          display: "flex",
          alignItems: "center",
          marginTop: "0.25rem",
          overflow: "hidden",
        },
        helperText: {
          fontSize: "0.875rem",
          fontWeight: 500,
          lineHeight: "1.25rem",
          color: theme.palette.baselineColor.transparentNeutral[50],
        },
        helperTextIcon: {
          width: "0.875rem",
          height: "0.875rem",
          marginRight: "0.188rem",
        },
        optionsContainer: {
          borderRadius: "0.75rem",
          border: "1px",
          boxShadow: `0px 0.25rem 0.625rem 0px ${theme.palette.baselineColor.transparentNeutral[10]}`,
          padding: "0.5rem",
          "& .MuiAutocomplete-listbox .MuiAutocomplete-option.Mui-focused": {
            bgcolor: theme.palette.baselineColor.neutral[0],
          },
          "& .MuiAutocomplete-listbox .MuiAutocomplete-option.Mui-focused .textOption": {
            color: theme.palette.dynamicColor.dark,
          },
        },
        optionContainer: {
          padding: "0.5rem",
          marginRight: "0.5rem",
          borderRadius: "0.5rem",
          display: "flex",
          alignItems: "center",
          marginBottom: "0.5rem",
        },
        optionText: {
          flex: 1,
          fontSize: "0.875rem",
          fontWeight: 500,
          lineHeight: "1.25rem",
          whiteSpace: "nowrap",
          overflow: "hidden",
          textOverflow: "ellipsis",
        },
        dropdownIcons: {
          width: "0.938rem",
          height: "0.938rem",
        },
        checkIcon: {
          width: "0.875rem",
          height: "0.875rem",
          marginLeft: "0.5rem",
        },
        autocomplete: {
          "& .MuiAutocomplete-endAdornment": {
            marginRight: "0.5rem",
          },
          "& .MuiAutocomplete-clearIndicator": {
            marginRight: "0.063rem",
          },
        },
        listBox: {
          "&::-webkit-scrollbar": {
            width: "0.375rem",
          },
          "&::-webkit-scrollbar-thumb": {
            backgroundColor: theme.palette.baselineColor.transparentNeutral[10],
            borderRadius: "0.625rem",
            "&:hover": {
              backgroundColor: theme.palette.baselineColor.transparentNeutral[50],
            },
          },
        },
      } satisfies Record<string, SxProps<Theme>>,
    };
  }, [theme]);
};

```

## Archivo: `packages/ComponentLibrary/src/components/Input/Select/types.ts`

```typescript
import type { AutocompleteProps } from "@mui/material";
import type { Option } from "@workspaceui/api-client/src/api/types";

export type { Option };

export interface ISelectInput<T extends string = string>
  extends Omit<AutocompleteProps<Option<T>, false, false, false>, "renderInput"> {
  title?: string;
  iconLeft?: React.ReactElement;
  options: Option<T>[];
  disabled?: boolean;
  helperText?: {
    label?: string;
    icon?: React.ReactElement;
  };
  value?: Option<T> | null;
  name?: string;
  onChange?: (event: React.SyntheticEvent<Element, Event>, value: Option<T> | null) => void;
}

```

## Archivo: `packages/ComponentLibrary/src/components/Input/TextInput/TextInputAutocomplete/SearchInputWithVoice/index.tsx`

```typescript
"use client";

import { memo, useCallback, useState } from "react";
import { InputAdornment, Box } from "@mui/material";
import SearchIcon from "@mui/icons-material/Search";
import FilterIcon from "@mui/icons-material/FilterList";
import MicIcon from "../../../../../assets/icons/mic.svg";
import MicOffIcon from "../../../../../assets/icons/mic-off.svg";
import type { TextInputProps } from "../TextInputComplete.types";
import TextInputAutoComplete from "../TextInputAutocomplete";
import IconButton from "../../../../IconButton";

export interface SearchInputWithVoiceProps extends TextInputProps {
  onVoiceClick?: () => void;
  disabled?: boolean;
}

const StartAdornment = () => {
  return (
    <InputAdornment position="start">
      <SearchIcon />
    </InputAdornment>
  );
};

const EndAdornment = () => {
  return (
    <InputAdornment position="end">
      <IconButton>
        <FilterIcon />
      </IconButton>
    </InputAdornment>
  );
};

const SearchInputWithVoice = ({ onVoiceClick, disabled = false, ...props }: SearchInputWithVoiceProps) => {
  const [isRecording, setIsRecording] = useState(false);

  const handleVoiceClick = useCallback(() => {
    if (disabled) return;
    setIsRecording(!isRecording);
    onVoiceClick?.();
  }, [isRecording, onVoiceClick, disabled]);

  const wrapperStyle = {
    display: "flex",
    alignItems: "center",
    gap: "0.25rem",
    cursor: disabled ? "not-allowed" : "default",
    pointerEvents: disabled ? "none" : "auto",
    position: "relative",
  };

  const overlayStyle = disabled
    ? {
        position: "absolute" as const,
        top: 0,
        left: 0,
        right: 0,
        bottom: 0,
        backgroundColor: "transparent",
        cursor: "not-allowed",
        zIndex: 10,
        pointerEvents: "auto" as const,
      }
    : {};

  return (
    <Box sx={{ position: "relative" }}>
      <Box sx={wrapperStyle}>
        <TextInputAutoComplete
          {...props}
          InputProps={{
            ...props.InputProps,
            startAdornment: props.InputProps?.startAdornment || <StartAdornment />,
            endAdornment: props.InputProps?.endAdornment || <EndAdornment />,
            style: { height: "2.5rem" },
          }}
          disabled={disabled}
        />
        <Box
          sx={{
            width: "2.5rem",
            height: "2.5rem",
            display: "flex",
            alignItems: "center",
            justifyContent: "center",
            borderRadius: "6.25rem",
          }}>
          <IconButton onClick={handleVoiceClick} className="w-10 h-10" disabled={true}>
            {isRecording ? <MicOffIcon className="w-6 h-6" /> : <MicIcon className="w-6 h-6" />}
          </IconButton>
        </Box>
      </Box>
      {disabled && <Box sx={overlayStyle} onClick={(e) => e.preventDefault()} />}
    </Box>
  );
};

export default memo(SearchInputWithVoice);

```

## Archivo: `packages/ComponentLibrary/src/components/Input/TextInput/TextInputAutocomplete/SuggestionBox/index.tsx`

```typescript
import { Box } from "@mui/material";
import TabIcon from "@mui/icons-material/KeyboardTab";
import t from "../TextInputAutocomplete.translations.json";
import { useStyle } from "../TextInputAutocomplete.styles";

export interface SuggestionBoxProps {
  suggestion: string;
  value: string;
}

const SuggestionBox = ({ suggestion, value }: SuggestionBoxProps) => {
  const { sx, styles } = useStyle();
  return (
    <Box sx={sx.suggestionBox}>
      <span style={styles.spanOpacity}>{value}</span>
      <span style={styles.suggestionText}>{suggestion.slice(value.length)}</span>
      <Box sx={sx.tabBox}>
        <TabIcon sx={sx.tabIcon} />
        <p style={styles.tabText}>{t.tab}</p>
      </Box>
    </Box>
  );
};

export default SuggestionBox;

```

## Archivo: `packages/ComponentLibrary/src/components/Input/TextInput/TextInputAutocomplete/TextInputAutocomplete.constants.ts`

```typescript
export const DEFAULT_CONSTANTS = {
  TIMEOUT_DURATION: 2000,
  CIRCULAR_PROGRESS_SIZE: 16,
  CIRCULAR_PROGRESS_THICKNESS: 6,
  ICON_FONT_SIZE: 14,
  PLACEHOLDER_OPACITY_TRANSITION_DURATION: 0.3,
};

```

## Archivo: `packages/ComponentLibrary/src/components/Input/TextInput/TextInputAutocomplete/TextInputAutocomplete.styles.ts`

```typescript
import { type CSSProperties, useMemo } from "react";
import { type SxProps, type Theme, useTheme } from "@mui/material";

const FONT_SIZE_14 = "0.875rem";
const WIDTH_FULL = "100%";

type StylesType = {
  styles: { [key: string]: CSSProperties };
  sx: { [key: string]: SxProps<Theme> };
  gradients: {
    linearGradient: string;
    webkitMaskGradient: string;
  };
};

export const useStyle = () => {
  const theme = useTheme();

  return useMemo(
    () =>
      ({
        styles: {
          inputProps: {
            position: "relative",
            color: theme.palette.baselineColor.neutral[100],
            fontSize: FONT_SIZE_14,
          },
          inputCommon: {
            borderRadius: "6.25rem",
            position: "relative",
            transition: "background-color 0.3s, border-color 0.3s",
          },
          tabText: {
            fontSize: FONT_SIZE_14,
            fontWeight: 500,
            color: theme.palette.baselineColor.transparentNeutral[15],
            marginLeft: "0.25rem",
          },
          suggestionText: {
            color: theme.palette.baselineColor.neutral[20],
          },
          spanOpacity: {
            opacity: 0,
          },
        },
        sx: {
          input: {
            padding: "0.5rem 0.75rem 0.5rem 0.75rem",
            height: "2.5rem",
            borderRadius: "6.25rem",
            backgroundColor: theme.palette.baselineColor.neutral[0],
            transition: "background-color 0.5s ease",
            "&.Mui-disabled": {
              backgroundColor: theme.palette.baselineColor.transparentNeutral[5],
            },
          },
          containerBox: {
            position: "relative",
            width: WIDTH_FULL,
          },
          innerBox: {
            position: "relative",
          },
          startAdornment: {
            width: "1.5rem",
            display: "flex",
            justifyContent: "center",
            gap: "0.5rem",
          },
          tabBox: {
            display: "flex",
            alignItems: "center",
            marginLeft: "0.25rem",
            backgroundColor: theme.palette.baselineColor.neutral[10],
            height: "1.5rem",
            padding: "0.5rem",
            borderRadius: 100,
            border: `1px solid ${theme.palette.baselineColor.transparentNeutral[10]}`,
          },
          suggestionBox: {
            position: "absolute",
            top: "50%",
            left: 44,
            transform: "translateY(-50%)",
            color: theme.palette.baselineColor.transparentNeutral[70],
            fontSize: FONT_SIZE_14,
            pointerEvents: "none",
            whiteSpace: "nowrap",
            overflow: "hidden",
            textOverflow: "ellipsis",
            display: "flex",
            alignItems: "center",
          },
          iconWidth: {
            width: "1.375rem",
          },
          clearButton: {
            "&:hover": {
              backgroundColor: "transparent",
              textDecoration: "underline",
            },
          },
          rightButton: {
            "&:hover": {
              backgroundColor: "transparent",
            },
          },
          tabIcon: {
            fontSize: FONT_SIZE_14,
            color: theme.palette.baselineColor.neutral[80],
          },
          clearButtonHover: {
            width: "2rem",
            height: "2rem",
            transition: "background-color 0.3s, color 0.3s",
            "&:hover": {
              borderRadius: "50%",
              "& .MuiSvgIcon-root": {
                color: theme.palette.baselineColor.neutral[100],
              },
            },
          },
          rightButtonHover: {
            backgroundColor: theme.palette.baselineColor.neutral[0],
            borderRadius: "50%",
            width: "2rem",
            height: "2rem",
            transition: "background-color 0.3s, color 0.3s",
            "&:hover": {
              backgroundColor: theme.palette.baselineColor.neutral[0],
              borderRadius: "50%",
              "& .MuiSvgIcon-root": {
                color: theme.palette.baselineColor.neutral[100],
              },
            },
          },
          iconDefault: {
            color: theme.palette.baselineColor.neutral[70],
          },
          containerIcon: {
            display: "flex",
            alignItems: "center",
            gap: "0.25rem",
          },
        } satisfies Record<string, SxProps<Theme>>,
        gradients: {
          linearGradient: "linear-gradient(90deg, #5D9FFF, #FFEA7D, #F3A6FA, #A685FF)",
          webkitMaskGradient: `
          linear-gradient(white 0 0) padding-box,
          linear-gradient(white 0 0)
        `,
        },
      }) satisfies StylesType,
    [theme]
  );
};

```

## Archivo: `packages/ComponentLibrary/src/components/Input/TextInput/TextInputAutocomplete/TextInputAutocomplete.tsx`

```typescript
"use client";

import { Box, InputAdornment, TextField, useTheme } from "@mui/material";
import { type KeyboardEvent, useCallback, useEffect, useState } from "react";
import SuggestionBox from "./SuggestionBox";
import { DEFAULT_CONSTANTS } from "./TextInputAutocomplete.constants";
import { useStyle } from "./TextInputAutocomplete.styles";
import type { TextInputProps } from "./TextInputComplete.types";

import SmartButton from "../../../../assets/icons/box.svg";
import FilterIcon from "../../../../assets/icons/filter.svg";
import CloseIcon from "../../../../assets/icons/menu-close.svg";
import SearchIcon from "../../../../assets/icons/search.svg";
import IconButton from "../../../IconButton";

const TextInputAutoComplete = (props: TextInputProps) => {
  const { value, setValue, autoCompleteTexts = [], rightIcon, onLeftIconClick, ...textFieldProps } = props;

  const [isFocused, setIsFocused] = useState<boolean>(false);
  const [suggestion, setSuggestion] = useState<string>("");
  const [smartIconActive, setSmartIconActive] = useState(false);
  const theme = useTheme();
  const { sx, styles, gradients } = useStyle();
  const onChange = textFieldProps.onChange;

  const handleSmartIconClick = useCallback(() => {
    setSmartIconActive((prev) => !prev);
  }, []);

  const handleBlur = useCallback(() => {
    setIsFocused(false);
    setSmartIconActive(false);
  }, []);

  useEffect(() => {
    if (autoCompleteTexts && isFocused && value) {
      const match = autoCompleteTexts.find((text) => text.toLowerCase().startsWith(value.toLowerCase()));
      setSuggestion(match && match.toLowerCase() !== value.toLowerCase() ? match : "");
    } else {
      setSuggestion("");
    }
  }, [value, isFocused, autoCompleteTexts]);

  const handleClear = useCallback(() => {
    setValue?.("");
    setSuggestion("");
  }, [setValue]);

  const handleKeyDown = useCallback(
    (e: KeyboardEvent<HTMLDivElement>) => {
      if (e.key === "Tab" && suggestion) {
        e.preventDefault();
        setValue?.(suggestion);
        setSuggestion("");
      }
    },
    [suggestion, setValue]
  );

  const handleInputChange = useCallback(
    (e: React.ChangeEvent<HTMLInputElement>) => {
      setValue?.(e.target.value);
      onChange?.(e);
    },
    [setValue, onChange]
  );

  const renderStartAdornment = () => {
    return (
      <IconButton
        className={`[&>svg]:w-4 [&>svg]:h-4 w-6 h-6 mr-2 bg-transparent hover:bg-transparent hover:text- ${value && isFocused ? "text-(--color-dynamic-main)" : ""}`}
        onClick={onLeftIconClick}>
        <SearchIcon />
      </IconButton>
    );
  };

  const renderEndAdornment = () =>
    rightIcon &&
    !props.disabled && (
      <InputAdornment position="end">
        {value && (
          <IconButton onClick={handleClear}>
            <CloseIcon />
          </IconButton>
        )}
        <Box sx={sx.containerIcon}>
          <IconButton
            onClick={() => {
              handleSmartIconClick();
            }}>
            <SmartButton />
          </IconButton>
          <IconButton>
            <FilterIcon />
          </IconButton>
        </Box>
      </InputAdornment>
    );

  const textFieldSx = {
    ...styles.inputCommon,
    opacity: props.disabled ? 0.4 : 1,
    backgroundColor: theme.palette.baselineColor.neutral[0],
    "& .MuiOutlinedInput-root": {
      "& fieldset": {
        borderColor: smartIconActive ? "transparent" : theme.palette.baselineColor.neutral[20],
        border: smartIconActive ? "2px solid" : undefined,
        borderImage: smartIconActive ? `${gradients.linearGradient} 1` : undefined,
        background: smartIconActive ? gradients.linearGradient : undefined,
        WebkitMask: `${gradients.webkitMaskGradient}`,
        WebkitMaskComposite: "xor",
        maskComposite: "exclude",
        transition: "border-color 0.5s",
        borderRadius: "6.25rem",
      },
      "&:hover fieldset": {
        borderWidth: props.disabled ? undefined : 2,
        borderColor: props.disabled ? undefined : theme.palette.baselineColor.neutral[100],
      },
      "&.Mui-focused fieldset": {
        borderColor: theme.palette.dynamicColor.main,
      },
      "&.Mui-focused": {
        backgroundColor: value ? theme.palette.baselineColor.neutral[0] : theme.palette.dynamicColor.contrastText,
        borderRadius: "12.25rem",
      },
    },
    ...props.sx,
  };

  return (
    <Box sx={sx.containerBox}>
      <Box sx={sx.innerBox}>
        <TextField
          placeholder={props.placeholder}
          onBlur={handleBlur}
          variant="outlined"
          fullWidth
          value={value}
          onChange={handleInputChange}
          onFocus={() => setIsFocused(true)}
          onKeyDown={handleKeyDown}
          disabled={props.disabled}
          InputProps={{
            ...textFieldProps.InputProps,
            sx: {
              ...sx.input,
              "& .MuiOutlinedInput-input": {
                "&::placeholder": {
                  color: theme.palette.baselineColor.transparentNeutral[70],
                  opacity: isFocused ? 0 : 1,
                  transition: `opacity ${DEFAULT_CONSTANTS.PLACEHOLDER_OPACITY_TRANSITION_DURATION}s`,
                },
              },
              ...props.InputProps?.sx,
            },
            startAdornment: renderStartAdornment(),
            endAdornment: renderEndAdornment(),
          }}
          {...textFieldProps}
          sx={textFieldSx}
          inputProps={{
            ...props.inputProps,
            style: {
              ...styles.inputProps,
              ...props.inputProps?.style,
            },
          }}
        />
        {suggestion && <SuggestionBox suggestion={suggestion} value={value} />}
      </Box>
    </Box>
  );
};

export default TextInputAutoComplete;

```

## Archivo: `packages/ComponentLibrary/src/components/Input/TextInput/TextInputAutocomplete/TextInputComplete.types.ts`

```typescript
import type { StandardTextFieldProps, FormControlOwnProps } from "@mui/material";

export interface TextInputProps extends StandardTextFieldProps {
  value: string;
  setValue?: (value: string) => void;
  label?: string;
  autoCompleteTexts?: string[];
  fetchSuggestions?: (query: string) => Promise<void>;
  leftIcon?: React.ReactNode;
  rightIcon?: React.ReactNode;
  onLeftIconClick?: () => void;
  onRightIconClick?: () => void;
  placeholder?: string | undefined;
  margin?: FormControlOwnProps["margin"];
  disabled?: boolean;
  readOnly?: boolean;
}

```

## Archivo: `packages/ComponentLibrary/src/components/Input/TextInput/TextInputAutocomplete/index.tsx`

```typescript
export { default } from "./TextInputAutocomplete";

```

## Archivo: `packages/ComponentLibrary/src/components/Input/TextInput/TextInputBase/InputPassword/index.tsx`

```typescript
"use client";

import { useCallback, useState } from "react";
import { Icon, useTheme } from "@mui/material";
import { VisibilityOutlined, VisibilityOffOutlined } from "@mui/icons-material";
import TextInputBase from "../TextInputBase";
import type { TextInputProps } from "../../TextInputAutocomplete/TextInputComplete.types";

const InputPassword = (props: TextInputProps) => {
  const theme = useTheme();
  const { value, setValue, label, leftIcon, onLeftIconClick, ...otherProps } = props;

  const [showPassword, setShowPassword] = useState<boolean>(false);

  const handleClickShowPassword = useCallback(() => {
    setShowPassword((prev) => !prev);
  }, []);

  const handleMouseDownPassword = useCallback((event: React.MouseEvent<HTMLButtonElement>) => {
    event.preventDefault();
  }, []);

  return (
    <TextInputBase
      value={value}
      setValue={setValue}
      label={label}
      leftIcon={leftIcon}
      onLeftIconClick={onLeftIconClick}
      type={showPassword ? "text" : "password"}
      rightIcon={
        <Icon
          aria-label="toggle password visibility"
          onClick={handleClickShowPassword}
          onMouseDown={handleMouseDownPassword}
          sx={{ color: theme.palette.baselineColor.neutral[60] }}>
          {showPassword ? <VisibilityOutlined sx={{ width: 20 }} /> : <VisibilityOffOutlined sx={{ width: 20 }} />}
        </Icon>
      }
      {...otherProps}
    />
  );
};

export default InputPassword;

```

## Archivo: `packages/ComponentLibrary/src/components/Input/TextInput/TextInputBase/TextInputBase.contants.ts`

```typescript
export const BASE_CONSTANTS = {
  PLACEHOLDER_OPACITY_TRANSITION_DURATION: 0.3,
};

```

## Archivo: `packages/ComponentLibrary/src/components/Input/TextInput/TextInputBase/TextInputBase.styles.ts`

```typescript
import { useMemo } from "react";
import { type SxProps, type Theme, useTheme } from "@mui/material";

type StylesType = {
  styles: { [key: string]: React.CSSProperties };
  sx: { [key: string]: SxProps<Theme> };
  cssString: string;
};

export const useStyle = () => {
  const theme = useTheme();

  return useMemo(
    () =>
      ({
        styles: {
          inputAdornment: {
            paddingY: "4px",
          },
          inputStyle: {
            padding: "0.25rem 0",
            fontSize: "14px",
            color: theme.palette.baselineColor.transparentNeutral[100],
            fontFamily: "Inter, sans-serif",
            fontWeight: 500,
          },
        } as { [key: string]: React.CSSProperties },

        sx: {
          inputBase: {
            "& .MuiInput-underline:before": {
              borderBottomWidth: "1px",
              borderBottomStyle: "solid",
            },
            "& .MuiInput-underline:hover:before": {
              borderBottomColor: theme.palette.baselineColor.neutral[80],
            },
            "& .MuiInput-underline:after": {
              borderBottomColor: theme.palette.baselineColor.neutral[80],
            },
            "& .MuiInputBase-input": {
              fontFamily: "Inter, sans-serif",
              fontWeight: 500,
            },
          },
        } as { [key: string]: SxProps<Theme> },

        cssString: `
        #password-input::placeholder {
          color: transparent;
        }
        #password-input-label {
          font-weight: 500;
          font-size: 18px;
          font-family: 'Inter', sans-serif;
        }
        .MuiFormLabel-root {
          color: ${theme.palette.baselineColor.neutral[80]};
        }
        .MuiFormLabel-root.Mui-focused {
          color: ${theme.palette.baselineColor.neutral[80]};
        }
        .MuiFormLabel-asterisk {
          color: ${theme.palette.specificColor.error.main};
        }
        #password-input {
          font-size: 14px;
          font-family: 'Inter', sans-serif;
          font-weight: 500;
        }
      `,
      }) satisfies StylesType,
    [theme]
  );
};

```

## Archivo: `packages/ComponentLibrary/src/components/Input/TextInput/TextInputBase/TextInputBase.tsx`

```typescript
import type React from "react";
import { TextField, InputAdornment } from "@mui/material";
import type { TextInputProps } from "../TextInputAutocomplete/TextInputComplete.types";
import { useStyle } from "./TextInputBase.styles";
import IconButton from "../../../IconButton";
const TextInputBase = (props: TextInputProps) => {
  const {
    value,
    setValue,
    label,
    leftIcon,
    rightIcon,
    onLeftIconClick,
    onRightIconClick,
    type,
    disabled,
    readOnly,
    ...otherProps
  } = props;
  const { styles, sx, cssString } = useStyle();

  const isDisabled = disabled || readOnly;

  const handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {
    setValue?.(event.target.value);
  };

  return (
    <>
      <style>{cssString}</style>
      <TextField
        id={props.name}
        variant="standard"
        required
        fullWidth
        value={value}
        onChange={handleChange}
        disabled={isDisabled}
        InputLabelProps={{
          htmlFor: props.name,
        }}
        label={label}
        type={type}
        InputProps={{
          name: props.name,
          startAdornment: leftIcon && (
            <InputAdornment position="start" sx={styles.inputAdornment}>
              <IconButton aria-label="left icon" onClick={onLeftIconClick}>
                {leftIcon}
              </IconButton>
            </InputAdornment>
          ),
          endAdornment: rightIcon && (
            <InputAdornment position="end" sx={styles.inputAdornment}>
              <IconButton aria-label="right-icon" onClick={onRightIconClick}>
                {rightIcon}
              </IconButton>
            </InputAdornment>
          ),
          style: styles.inputStyle,
        }}
        sx={sx.inputBase}
        placeholder={props.placeholder}
        {...otherProps}
      />
    </>
  );
};

export default TextInputBase;

```

## Archivo: `packages/ComponentLibrary/src/components/Input/TextInput/TextInputBase/index.tsx`

```typescript
export { default } from "./TextInputBase";

```

## Archivo: `packages/ComponentLibrary/src/components/Logo/index.tsx`

```typescript
interface ILogo {
  title?: string;
  logo?: string | React.ReactNode;
}

const Logo = ({ logo, title }: ILogo) => {
  const commonClasses = "w-9 h-9";
  if (typeof logo === "string") {
    return <img src={logo} className={commonClasses} alt={`${title} Logo`} />;
  }
  return <div className={commonClasses}>{logo}</div>;
};

export default Logo;

```

## Archivo: `packages/ComponentLibrary/src/components/MUI/index.ts`

```typescript
export { Button, Grid, TextField, Box } from "@mui/material";

```

## Archivo: `packages/ComponentLibrary/src/components/Menu/index.tsx`

```typescript
import { useCallback, useEffect, useRef, useState } from "react";
import { createPortal } from "react-dom";
import { useClickOutside, useEscapeKey, useWindowResize } from "../../hooks/useEventListeners";
import { cleanDefaultClasses } from "../../utils/classUtil";

type DropdownMenuProps = {
  /**
   * The element to which the menu will be anchored (positioned relative to).
   * If `null`, the menu will not be displayed.
   */
  anchorEl: HTMLElement | null;
  /**
   * Callback fired when the menu requests to be closed.
   * Typically triggered by clicking outside or pressing the Escape key.
   */
  onClose: () => void;
  /**
   * The content of the menu to render inside the dropdown.
   */
  children: React.ReactNode;
  /**
   * Optional additional CSS classes to customize the menu style.
   * Merged with default classes via `cleanDefaultClasses`.
   */
  className?: string;
  /**
   * Horizontal offset (in pixels) applied to the menu's calculated X position.
   * Useful for fine-tuning alignment when the anchor element and menu don't visually align.
   * @default 0
   */
  offsetX?: number;
  /**
   * Vertical offset (in pixels) applied to the menu's calculated Y position.
   * Useful for creating spacing or shifting the menu up/down relative to the anchor.
   * @default 0
   */
  offsetY?: number;
  /**
   * Ref to expose a function allowing manual recalculation of the menu position.
   * Can be used when the content or layout changes dynamically.
   */
  menuRef?: React.MutableRefObject<{ recalculatePosition: () => void } | null>;
};

/**
 * A floating dropdown menu component that positions itself relative to an anchor element.
 * It uses a React portal to render the menu at the document body level.
 *
 * The menu automatically calculates and updates its position on mount and when the anchor changes.
 * It closes when clicking outside or when `onClose` is triggered.
 *
 * The `className` prop allows customizing the menu styles while preserving default classes with proper merging.
 */
const Menu: React.FC<DropdownMenuProps> = ({
  anchorEl,
  onClose,
  children,
  className = "",
  offsetX,
  offsetY,
  menuRef: externalMenuRef,
}) => {
  const [position, setPosition] = useState({ x: 0, y: 0 });
  const [visible, setVisible] = useState(false);

  const menuRef = useRef<HTMLDivElement>(null);
  const timeoutRef = useRef<NodeJS.Timeout | null>(null);
  const mutationObserverRef = useRef<MutationObserver | null>(null);

  const adjustHorizontalPosition = (anchorRect: DOMRect, menuWidth: number, offsetX = 0) => {
    let x = anchorRect.left + offsetX;
    if (x + menuWidth > window.innerWidth) {
      x = anchorRect.right - menuWidth - offsetX;
      if (x < 0) x = 8;
    }
    return Math.max(8, Math.min(x, window.innerWidth - menuWidth - 8));
  };

  const adjustVerticalPosition = (
    anchorRect: DOMRect,
    menuHeight: number,
    menuElement: HTMLDivElement,
    offsetY = 0
  ) => {
    const spaceBelow = window.innerHeight - anchorRect.bottom;
    const spaceAbove = anchorRect.top;
    let y = anchorRect.bottom + offsetY;

    const setMaxHeight = (maxHeight: number) => {
      menuElement.style.maxHeight = `${maxHeight}px`;
      menuElement.style.overflowY = "auto";
    };

    if (menuHeight > spaceBelow) {
      if (spaceAbove > spaceBelow && menuHeight <= spaceAbove) {
        y = anchorRect.top - menuHeight - offsetY;
      } else if (spaceBelow > spaceAbove) {
        y = anchorRect.bottom + offsetY;
        const maxHeight = spaceBelow - 16;
        if (menuHeight > maxHeight) setMaxHeight(maxHeight);
      } else {
        y = 8;
        const maxHeight = spaceAbove - 16;
        if (menuHeight > maxHeight) setMaxHeight(maxHeight);
      }
    }

    return Math.max(8, Math.min(y, window.innerHeight - Math.min(menuHeight, window.innerHeight - 16) - 8));
  };

  const calculatePosition = useCallback(() => {
    if (!anchorEl || !menuRef.current) return;

    const anchorRect = anchorEl.getBoundingClientRect();
    const menuElement = menuRef.current;

    menuElement.style.maxHeight = "";
    menuElement.style.overflowY = "";

    const x = adjustHorizontalPosition(anchorRect, menuElement.offsetWidth, offsetX);
    const y = adjustVerticalPosition(anchorRect, menuElement.offsetHeight, menuElement, offsetY);

    setPosition({ x, y });
  }, [anchorEl, offsetX, offsetY]);

  useEffect(() => {
    if (!anchorEl) {
      setVisible(false);
      return;
    }

    const timer = setTimeout(() => {
      calculatePosition();
      setVisible(true);
    }, 0);

    return () => clearTimeout(timer);
  }, [anchorEl, calculatePosition]);

  useEffect(() => {
    if (externalMenuRef) {
      externalMenuRef.current = {
        recalculatePosition: calculatePosition,
      };
    }
  }, [calculatePosition, externalMenuRef]);

  useEffect(() => {
    if (!menuRef.current || !visible) return;

    mutationObserverRef.current = new MutationObserver((mutations) => {
      let shouldRecalculate = false;

      for (const mutation of mutations) {
        if (
          mutation.type === "attributes" &&
          (mutation.attributeName === "class" || mutation.attributeName === "style")
        ) {
          shouldRecalculate = true;
        }

        if (mutation.type === "childList") {
          shouldRecalculate = true;
        }
      }

      if (shouldRecalculate) {
        requestAnimationFrame(() => {
          calculatePosition();
        });
      }
    });

    mutationObserverRef.current.observe(menuRef.current, {
      childList: true,
      subtree: true,
      attributes: true,
      attributeFilter: ["class", "style"],
    });

    return () => {
      if (mutationObserverRef.current) {
        mutationObserverRef.current.disconnect();
      }
    };
  }, [visible, calculatePosition]);

  const handleClose = () => {
    setVisible(false);
    timeoutRef.current = setTimeout(() => {
      onClose();
    }, 200);
  };

  useEffect(() => {
    return () => {
      if (timeoutRef.current) {
        clearTimeout(timeoutRef.current);
      }
    };
  }, []);

  useClickOutside(menuRef, handleClose);
  useEscapeKey(handleClose);
  useWindowResize(calculatePosition);

  const DEFAULT_MENU_CLASSES = `${visible ? "opacity-100" : "opacity-0"} fixed z-[999] bg-white shadow-lg shadow-(--color-transparent-neutral-30) transition-opacity duration-200 rounded-xl`;

  return (
    anchorEl &&
    createPortal(
      <div
        role="menu"
        ref={menuRef}
        className={`${cleanDefaultClasses(DEFAULT_MENU_CLASSES, className)}`}
        style={{
          top: position.y,
          left: position.x,
          visibility: visible ? "visible" : "hidden",
        }}>
        {children}
      </div>,
      document.body
    )
  );
};

Menu.displayName = "Menu";
export default Menu;

```

## Archivo: `packages/ComponentLibrary/src/components/ModalDivider/index.tsx`

```typescript
import Divider from "@mui/material/Divider";

const ModalDivider = () => <Divider />;

export default ModalDivider;

```

## Archivo: `packages/ComponentLibrary/src/components/Nav/Nav.styles.ts`

```typescript
import { type CSSProperties, useMemo } from "react";
import { useTheme } from "@mui/material";

export const useStyle = () => {
  const theme = useTheme();

  return useMemo(
    () => ({
      styles: {
        NavStyles: {
          display: "flex",
          justifyContent: "space-between",
          alignItems: "center",
          width: "100%",
          height: "100%",
        },
        LeftItems: {
          width: "22.75rem",
          height: "100%",
          padding: "0.25rem",
          borderRadius: "6.25rem",
          background: `var(--Neutral-0, ${theme.palette.baselineColor.transparentNeutral[5]})`,
        },
        RightItems: {
          height: "3rem",
          padding: "0.25rem",
          display: "flex",
          borderRadius: "6.25rem",
          background: `var(--Neutral-0, ${theme.palette.baselineColor.transparentNeutral[5]})`,
        },
        childBox: {
          display: "flex",
          gap: "0.25rem",
        },
      } as { [key: string]: CSSProperties },
    }),
    [theme]
  );
};

```

## Archivo: `packages/ComponentLibrary/src/components/Nav/Nav.tsx`

```typescript
"use client";

import type React from "react";
import { type ReactNode, useCallback, useState } from "react";
import RightButtons from "./RigthComponents/RightButtons";
import SearchInputWithVoice from "../Input/TextInput/TextInputAutocomplete/SearchInputWithVoice";
import { useStyle } from "./Nav.styles";
export interface NavProps {
  children?: ReactNode;
  searchDisabled?: boolean;
  title?: string;
}

const Nav: React.FC<NavProps> = ({ children, searchDisabled = true, title }) => {
  const { styles } = useStyle();
  const [value, setValue] = useState("");
  const handleVoiceClick = useCallback(() => alert("Voice activated"), []);

  return (
    <nav style={styles.NavStyles}>
      <div style={styles.LeftItems} title={title}>
        <SearchInputWithVoice
          value={value}
          setValue={setValue}
          placeholder="Search"
          onVoiceClick={handleVoiceClick}
          disabled={searchDisabled}
        />
      </div>
      <div style={styles.RightItems}>
        <RightButtons>{children}</RightButtons>
      </div>
    </nav>
  );
};

export default Nav;

```

## Archivo: `packages/ComponentLibrary/src/components/Nav/RigthComponents/RightButtons.tsx`

```typescript
import Box from "@mui/material/Box";
import type { ReactNode } from "react";
import { useStyle } from "../Nav.styles";

interface RightButtonsProps {
  children?: ReactNode;
}

const RightButtons: React.FC<RightButtonsProps> = ({ children }) => {
  const { styles } = useStyle();
  return (
    <Box style={styles.boxStyles}>
      <Box sx={styles.childBox}>{children}</Box>
    </Box>
  );
};

export default RightButtons;

```

## Archivo: `packages/ComponentLibrary/src/components/NotificationItem/index.tsx`

```typescript
import { ListItem, Typography, Button, Box } from "@mui/material";
import ReactMarkdown from "react-markdown";
import type { NotificationItemProps } from "./types";
import Tag from "../Tag";
import { useStyle } from "./styles";
import CalendarTodayOutlinedIcon from "@mui/icons-material/CalendarTodayOutlined";
import CloseIcon from "../../assets/icons/x.svg";
import IconButton from "../IconButton";

const NotificationItem: React.FC<NotificationItemProps> = ({
  description,
  priority,
  tagType,
  date,
  icon: IconComponent,
  ctaButtons,
}) => {
  const { styles, sx } = useStyle();
  const markdownComponents = {
    a: ({ ...props }) => <a style={styles.anchorStyles} {...props} />,
    p: ({ ...props }) => <div {...props} />,
  };

  return (
    <ListItem component="div" sx={sx.listItem}>
      <Box sx={sx.notificationBox}>
        <IconButton>
          <CloseIcon className="closeIcon" />
        </IconButton>
        <div style={styles.iconContainerStyles}>
          <IconComponent />
        </div>
        <div style={styles.textContainerStyles} className="textContainer">
          <ReactMarkdown components={markdownComponents}>{description}</ReactMarkdown>
          {priority && tagType && <Tag type={tagType} label={priority} />}
          {ctaButtons && (
            <div style={styles.ctaButtonContainer}>
              {ctaButtons.map((button) => (
                <Button
                  key={button.key}
                  variant="contained"
                  onClick={button.action}
                  sx={button.sx}
                  startIcon={button.icon ? <button.icon /> : null}>
                  {button.label}
                </Button>
              ))}
            </div>
          )}
          <div style={styles.dateContainer}>
            <CalendarTodayOutlinedIcon style={styles.dateStyles} />
            <Typography variant="body2" color="textSecondary" style={styles.dateStyles}>
              {date}
            </Typography>
          </div>
        </div>
      </Box>
    </ListItem>
  );
};

export default NotificationItem;

```

## Archivo: `packages/ComponentLibrary/src/components/NotificationItem/styles.ts`

```typescript
import { type CSSProperties, useMemo } from "react";
import { type SxProps, type Theme, useTheme } from "@mui/material";

export const useStyle = () => {
  const theme = useTheme();

  return useMemo(
    () => ({
      styles: {
        iconContainerStyles: {
          width: "2.25rem",
          height: "2.25rem",
          display: "flex",
          justifyContent: "center",
          alignContent: "center",
          flexWrap: "wrap",
          background: theme.palette.dynamicColor.contrastText,
          borderRadius: "100%",
        },
        textContainerStyles: {
          marginLeft: "0.5rem",
          width: "22.25rem",
          overflow: "hidden",
          textOverflow: "ellipsis",
        },
        descriptionStyles: {
          fontSize: "0.875rem",
          fontWeight: "500",
          lineHeight: "1.25rem",
        },
        ctaButtonContainer: {
          marginTop: "10px",
          display: "flex",
          gap: "10px",
        },
        dateContainer: {
          display: "flex",
          alignItems: "center",
          gap: "0.25rem",
        },
        dateStyles: {
          fontSize: "0.75rem",
          fontWeight: "500",
          marginTop: "0.25rem",
        },
        anchorStyles: {
          fontSize: "0.875rem",
          fontWeight: "500",
          lineHeight: "1.063rem",
          color: theme.palette.dynamicColor.main,
          textDecoration: "none",
        },
      } as { [key: string]: CSSProperties },
      sx: {
        listItem: {
          padding: 0,
        },
        notificationBox: {
          width: "27.25rem",
          borderRadius: "0.75rem",
          margin: "0.25rem 0.75rem",
          padding: "0.75rem 1rem",
          display: "flex",
          backgroundColor: theme.palette.baselineColor.neutral[0],
          border: `1px solid ${theme.palette.baselineColor.transparentNeutral[10]}`,
          "&:hover": {
            backgroundColor: theme.palette.baselineColor.neutral[10],
            outline: `2px solid ${theme.palette.dynamicColor.main}`,
            "& .closeIcon": {
              visibility: "visible",
            },
            "& > .textContainer": {
              paddingRight: "1.5rem",
            },
          },
        },
        closeIconButton: {
          position: "absolute",
          top: "0.5rem",
          right: "0.5rem",
          visibility: "hidden",
          "& .closeIcon": {
            fill: theme.palette.baselineColor.neutral[80],
            width: "1rem",
            height: "1rem",
          },
        },
        leftButton: {
          background: theme.palette.baselineColor.transparentNeutral[10],
          color: theme.palette.baselineColor.transparentNeutral[70],
          height: "2rem",
          borderRadius: "6.25rem",
          padding: "0.5rem 1rem",
          border: `1px solid ${theme.palette.baselineColor.transparentNeutral[10]}`,
          "&:hover": {
            border: "none",
            background: theme.palette.dynamicColor.main,
            color: theme.palette.baselineColor.neutral[10],
          },
        },
        rightButton: {
          background: theme.palette.baselineColor.neutral[100],
          color: theme.palette.baselineColor.neutral[0],
          height: "2rem",
          borderRadius: "6.25rem",
          padding: "0.5rem 1rem",
          "&:hover": {
            border: "none",
            background: theme.palette.dynamicColor.main,
            color: theme.palette.baselineColor.neutral[10],
          },
        },
      } as { [key: string]: SxProps<Theme> },
    }),
    [theme]
  );
};

```

## Archivo: `packages/ComponentLibrary/src/components/NotificationItem/types.ts`

```typescript
import type { SxProps, Theme } from "@mui/material";
import type { TagType } from "../Tag/types";

export interface CtaButton {
  key: string;
  label: string;
  action: () => void;
  icon?: React.ComponentType;
  sx?: SxProps<Theme>;
}

export interface NotificationItemProps {
  description: string;
  priority?: string;
  tagType?: TagType;
  date: string;
  icon: React.ComponentType;
  ctaButtons?: CtaButton[];
}

```

## Archivo: `packages/ComponentLibrary/src/components/NotificationItemAllStates/index.tsx`

```typescript
import { List } from "@mui/material";
import NotificationItem from "../NotificationItem";
import type { NotificationItemStatesProps } from "./types";

const NotificationItemStates: React.FC<NotificationItemStatesProps> = ({ notifications = [], type }) => {
  const filteredNotifications = notifications.filter((notification) => notification.type === type);
  return (
    <List>
      {filteredNotifications.map((notification) => (
        <NotificationItem
          key={notification.data.id}
          description={notification.data.description}
          priority={notification.data.priority}
          date={notification.data.date}
          icon={notification.data.icon}
          tagType={notification.data.tagType}
          ctaButtons={notification.data.ctaButtons}
        />
      ))}
    </List>
  );
};

export default NotificationItemStates;

```

## Archivo: `packages/ComponentLibrary/src/components/NotificationItemAllStates/styles.ts`

```typescript
import { type SxProps, type Theme, useTheme } from "@mui/material";
import { useMemo } from "react";

export const useStyle = () => {
  const theme = useTheme();

  return useMemo(
    () => ({
      sx: {
        rightButton: {
          background: theme.palette.baselineColor.neutral[100],
          color: theme.palette.baselineColor.neutral[0],
          height: "2rem",
          borderRadius: "6.25rem",
          padding: "0.5rem 1rem",
          "&:hover": {
            border: "none",
            background: theme.palette.dynamicColor.main,
            color: theme.palette.dynamicColor.contrastText,
          },
        },
        leftButton: {
          background: theme.palette.baselineColor.neutral[10],
          color: theme.palette.baselineColor.transparentNeutral[100],
          height: "2rem",
          borderRadius: "6.25rem",
          padding: "0.5rem 1rem",
          border: `1px solid ${theme.palette.baselineColor.neutral[10]}`,
          "&:hover": {
            border: "none",
            background: theme.palette.dynamicColor.main,
            color: theme.palette.dynamicColor.contrastText,
          },
        },
      } as { [key: string]: SxProps<Theme> },
    }),
    [theme]
  );
};

```

## Archivo: `packages/ComponentLibrary/src/components/NotificationItemAllStates/types.ts`

```typescript
import type { CtaButton } from "../../commons";
import type { TagType } from "../Tag/types";

export interface IallNotifications {
  type: string;
  data: {
    id: string;
    description: string;
    date: string;
    priority?: string;
    tagType?: TagType;
    icon: React.ComponentType;
    ctaButtons?: CtaButton[];
  };
}

export interface NotificationItemStatesProps {
  notifications: IallNotifications[];
  type: string;
}

```

## Archivo: `packages/ComponentLibrary/src/components/NotificationsButton/constants.ts`

```typescript
export const notificationMax: number = 99;

```

## Archivo: `packages/ComponentLibrary/src/components/NotificationsButton/index.tsx`

```typescript
"use client";
import { Badge } from "@mui/material";
import React, { useRef, useState } from "react";
import IconButton from "../IconButton";
import { notificationMax } from "./constants";
import { useStyle } from "./styles";
import type { ExtendedNotificationButtonProps, NotificationModalProps } from "./types";

const NotificationButton: React.FC<ExtendedNotificationButtonProps> = ({
  notifications = [],
  children,
  icon,
  tooltipTitle = "Notifications",
}) => {
  const { sx } = useStyle();
  const buttonRef = useRef<HTMLButtonElement | null>(null);
  const [isOpenMenu, setIsOpenMenu] = useState<boolean>(false);
  const handleClick = () => {
    setIsOpenMenu(true);
  };

  const handleClose = () => {
    setIsOpenMenu(false);
  };

  const notificationCount: number = notifications.length;

  return (
    <>
      <Badge
        badgeContent={notificationCount > notificationMax ? `${notificationMax}+` : notificationCount}
        color="error"
        sx={sx.badgeStyles}
        component="div">
        <IconButton tooltip={tooltipTitle} onClick={handleClick} disabled={true} className="w-10 h-10">
          {icon}
        </IconButton>
      </Badge>
      {children &&
        React.cloneElement(children, {
          anchorRef: buttonRef,
          open: isOpenMenu,
          onClose: handleClose,
          notifications,
        } as unknown as NotificationModalProps)}
    </>
  );
};

export default NotificationButton;

```

## Archivo: `packages/ComponentLibrary/src/components/NotificationsButton/styles.ts`

```typescript
import { type SxProps, type Theme, useTheme } from "@mui/material/styles";
import { useMemo } from "react";

export const useStyle = () => {
  const theme = useTheme();

  return useMemo(
    () => ({
      sx: {
        hoverStyles: {
          background: "white",
          "&:hover": {
            backgroundColor: theme.palette.dynamicColor.main,
            "& .MuiSvgIcon-root": {
              color: theme.palette.baselineColor.neutral[0],
            },
          },
        },
        iconStyles: {
          width: "1.5rem",
          height: "1.5rem",
          color: theme.palette.baselineColor.neutral[80],
        },
        badgeStyles: {
          "& .MuiBadge-badge": {
            top: "25%",
            right: "30%",
            fontSize: "0.75rem",
          },
        },
      } as { [key: string]: SxProps<Theme> },
    }),
    [theme]
  );
};

```

## Archivo: `packages/ComponentLibrary/src/components/NotificationsButton/types.ts`

```typescript
import type { ReactElement } from "react";
import type { Inotifications } from "../../commons";

export interface NotificationButtonProps {
  children?: ReactElement<NotificationModalProps>;
  notifications: Inotifications[];
}

export interface NotificationModalProps {
  notifications: Inotifications[];
  anchorEl: HTMLElement | null;
  open: boolean;
  onClose: () => void;
}

export interface ExtendedNotificationButtonProps extends NotificationButtonProps {
  icon: string | React.ReactNode;
  tooltipTitle?: string;
  renderMenuContent?: (notifications: Inotifications[], handleClose: () => void) => React.ReactNode;
}

```

## Archivo: `packages/ComponentLibrary/src/components/NotificationsModal/index.tsx`

```typescript
import { List, Link, Button } from "@mui/material";
import IconButton from "../IconButton";
import type { INotificationModalProps } from "./types";
import { useStyle } from "./styles";
import { Settings } from "@mui/icons-material";
import MoreVert from "../../assets/icons/more-vertical.svg";
import NotificationItem from "../NotificationItem";
import Image from "../../assets/images/NotificationModal/empty-state-notifications.svg?url";
import Menu from "../Menu";

const NotificationModalCustom: React.FC<INotificationModalProps> = ({
  title,
  linkTitle,
  emptyStateImageAlt,
  emptyStateMessage,
  emptyStateDescription,
  actionButtonLabel,
  notifications = [],
  onClose,
  anchorEl,
  ...props
}) => {
  const { styles, sx } = useStyle();
  return (
    <Menu {...props} onClose={onClose} anchorEl={anchorEl}>
      <div style={styles.titleModalContainer}>
        <div style={styles.titleModalImageContainer}>
          {title?.icon && <div style={styles.titleModalImageRadius}>{title?.icon}</div>}
          <div style={styles.titleModal}>{title?.label}</div>
        </div>
        <div style={styles.rigthContainer}>
          {linkTitle && (
            <Link sx={sx.linkStyles} href={linkTitle.url}>
              {linkTitle.label}
            </Link>
          )}
          <div style={styles.titleModalButtonContainer}>
            <IconButton className="w-5 h-5">
              <MoreVert />
            </IconButton>
          </div>
        </div>
      </div>
      <div style={styles.listContainer}>
        {notifications.length === 0 ? (
          <div style={styles.emptyState}>
            <img src={Image} alt={emptyStateImageAlt} style={styles.emptyStateImage} />
            <div style={styles.emptyTextContainer}>
              <div style={styles.emptyHeader}>{emptyStateMessage}</div>
              <div style={styles.emptyText}>{emptyStateDescription}</div>
            </div>
            <div style={styles.actionButtonContainer}>
              <Button style={styles.actionButton} variant="contained" startIcon={<Settings />} sx={sx.actionButton}>
                <div style={styles.actionButtonText}>{actionButtonLabel}</div>
              </Button>
            </div>
          </div>
        ) : (
          <List>
            {notifications.map((notification) => (
              <NotificationItem
                key={notification.id}
                description={notification.description}
                priority={notification.priority}
                date={notification.date}
                tagType={notification.tagType}
                ctaButtons={notification.ctaButtons}
                icon={notification.icon}
              />
            ))}
          </List>
        )}
      </div>
    </Menu>
  );
};

export default NotificationModalCustom;

```

## Archivo: `packages/ComponentLibrary/src/components/NotificationsModal/styles.ts`

```typescript
import { type CSSProperties, useMemo } from "react";
import { type SxProps, type Theme, useTheme } from "@mui/material";

export const menuSyle = { padding: 0 };

export const useStyle = () => {
  const theme = useTheme();

  return useMemo(
    () => ({
      styles: {
        menuContainer: {},
        titleModalContainer: {
          display: "flex",
          flexDirection: "row",
          alignItems: "center",
          justifyContent: "space-between",
          padding: "0.75rem",
          background: theme.palette.baselineColor.neutral[0],
          borderBottom: `1px solid ${theme.palette.dynamicColor.contrastText}`,
        },
        titleModalImageContainer: {
          display: "flex",
          flexDirection: "row",
          alignItems: "center",
        },
        titleModalImageRadius: {
          width: "2rem",
          height: "2rem",
          alignItems: "center",
          justifyContent: "center",
          display: "flex",
          background: theme.palette.baselineColor.neutral[10],
          borderRadius: "2rem",
          marginRight: "0.25rem",
        },
        titleModalButtonContainer: {
          width: "2rem",
          height: "2rem",
          alignItems: "center",
          justifyContent: "center",
          display: "flex",
        },
        titleModalImage: {
          width: "1rem",
          height: "1rem",
        },
        rigthContainer: {
          alignItems: "center",
          display: "flex",
        },
        titleModal: {
          fontSize: "1rem",
          fontWeight: "600",
        },
        listContainer: {},
        emptyState: {
          width: "28.75rem",
          background: theme.palette.dynamicColor.contrastText,
          padding: "1.25rem",
          display: "flex",
          flexDirection: "column",
          alignItems: "center",
        },
        emptyStateImage: {
          width: "12.5rem",
          height: "12.5rem",
          marginBottom: "1rem",
        },
        emptyTextContainer: {
          maxWidth: "24.75rem",
          display: "flex",
          flexDirection: "column",
          alignItems: "center",
        },
        emptyHeader: {
          padding: "0.5rem",
          fontSize: "1.375rem",
          fontWeight: "600",
          color: theme.palette.baselineColor.neutral[80],
        },
        emptyText: {
          fontSize: "0.875rem",
          fontWeight: "500",
          lineHeight: "1.25rem",
          paddingBottom: "0.5rem",
          textAlign: "center",
          color: theme.palette.baselineColor.transparentNeutral[10],
        },
        actionButton: {
          border: `1px solid ${theme.palette.baselineColor.transparentNeutral[10]}`,
          borderRadius: "6.25rem",
          padding: "0.5rem 1rem",
        },
        actionButtonText: {
          fontSize: "0.875rem",
          lineHeight: "1.25rem  ",
        },
        paperStyleMenu: {
          borderRadius: "0.75rem",
          background: theme.palette.dynamicColor.contrastText,
        },
      } as { [key: string]: CSSProperties },
      sx: {
        actionButton: {
          background: theme.palette.baselineColor.neutral[10],
          color: theme.palette.baselineColor.transparentNeutral[10],
          "&:hover": {
            border: "none",
            background: theme.palette.dynamicColor.main,
            color: theme.palette.baselineColor.neutral[10],
          },
        },
        linkStyles: {
          fontSize: "0.875rem",
          fontWeight: "500",
          lineHeight: "1rem",
          color: theme.palette.dynamicColor.main,
          textDecoration: "none",
          paddingRight: "0.5rem",
          cursor: "pointer",
          "&:hover": {
            textDecoration: "underline",
          },
        },

        badgeStyles: {
          ".MuiBadge-badge": {
            fontSize: "0.75rem",
          },
        },
      } as { [key: string]: SxProps<Theme> },
    }),
    [theme]
  );
};

```

## Archivo: `packages/ComponentLibrary/src/components/NotificationsModal/types.ts`

```typescript
import type { ReactNode } from "react";
import type { Inotifications } from "../../commons";

export interface INotificationModalProps {
  icon?: string;
  title?: { icon?: ReactNode | string; label?: string };
  linkTitle?: { url?: string; label?: string };
  notifications?: Inotifications[];
  emptyStateImageAlt?: string;
  emptyStateMessage?: string;
  emptyStateDescription?: string;
  actionButtonLabel?: string;
  anchorEl: HTMLElement | null;
  onClose: () => void;
}

```

## Archivo: `packages/ComponentLibrary/src/components/PrimaryTab/index.tsx`

```typescript
"use client";

import CheckIcon from "@mui/icons-material/Check";
import { Box, ListItemIcon, MenuItem, Tab, Tabs } from "@mui/material";
import React, { useCallback, useState, useMemo } from "react";
import IconButton from "../IconButton";
import Menu from "../Menu";
import Tooltip from "../Tooltip";
import { tabIndicatorProps, useStyle } from "./styles";
import type { PrimaryTabsProps } from "./types";

const PrimaryTabs: React.FC<PrimaryTabsProps> = React.memo(({ tabs, onChange, icon }) => {
  const [selectedTab, setSelectedTab] = useState(tabs[0]?.id || "");
  const [hoveredTab, setHoveredTab] = useState<string | null>(null);
  const [anchorEl, setAnchorEl] = useState<HTMLElement | null>(null);

  const { sx, styles } = useStyle();

  const handleChange = useCallback(
    (event: React.SyntheticEvent, newValue: string) => {
      event.preventDefault();
      setSelectedTab(newValue);
      onChange?.(newValue);
    },
    [onChange]
  );

  const handleMenuOpen = useCallback((event: React.MouseEvent<HTMLButtonElement>) => {
    setAnchorEl(event.currentTarget);
  }, []);

  const handleMenuClose = useCallback(() => {
    setAnchorEl(null);
  }, []);

  const handleMenuItemClick = useCallback(
    (id: string) => {
      setSelectedTab(id);
      onChange?.(id);
      handleMenuClose();
    },
    [handleMenuClose, onChange]
  );

  const handleMouseEnter = useCallback((id: string) => {
    setHoveredTab(id);
  }, []);

  const handleMouseLeave = useCallback(() => {
    setHoveredTab(null);
  }, []);

  const buildTabs = useMemo(
    () =>
      tabs.map((tab) => {
        const isSelected = selectedTab === tab.id;
        const isHovered = hoveredTab === tab.id;

        const showIcon = tab.showInTab !== "label" && tab.icon && (isSelected || tab.showInTab === "icon");

        return (
          <Tab
            key={tab.id}
            value={tab.id}
            icon={
              showIcon
                ? React.cloneElement(tab.icon as React.ReactElement, {
                    style: {
                      fill: isSelected ? tab.fill : isHovered ? tab.hoverFill : tab.fill,
                      transition: "fill 0.3s",
                    },
                  })
                : undefined
            }
            label={tab.showInTab !== "icon" ? tab.label : undefined}
            iconPosition="start"
            onMouseEnter={() => handleMouseEnter(tab.id)}
            onMouseLeave={handleMouseLeave}
            sx={sx.tab}
            onClick={(event) => {
              event.preventDefault();
              handleChange(event, tab.id);
            }}
          />
        );
      }),
    [tabs, selectedTab, hoveredTab, handleMouseLeave, sx.tab, handleMouseEnter, handleChange]
  );

  return (
    <Box sx={styles.containerBox}>
      <Box sx={styles.tabsContainer}>
        <Tabs
          value={selectedTab}
          onChange={handleChange}
          scrollButtons="auto"
          variant="scrollable"
          TabIndicatorProps={tabIndicatorProps}
          aria-label="primary tabs"
          sx={sx.tabs}>
          {buildTabs}
        </Tabs>
      </Box>
      <IconButton onClick={handleMenuOpen}>{icon}</IconButton>
      <Menu anchorEl={anchorEl} onClose={handleMenuClose}>
        {tabs.map((tab) => {
          const isSelected = selectedTab === tab.id;
          return (
            <MenuItem
              key={tab.id}
              onClick={() => handleMenuItemClick(tab.id)}
              sx={() => ({
                ...sx.menuItem,
                ...(isSelected ? sx.selectedMenuItem : {}),
              })}>
              <Box sx={sx.iconBox}>
                {tab.icon &&
                  React.cloneElement(tab.icon as React.ReactElement, {
                    style: { fill: tab.fill, flexShrink: 0 },
                  })}
                <Tooltip title={tab.label}>
                  <span>{tab.label}</span>
                </Tooltip>
              </Box>
              {isSelected && (
                <ListItemIcon
                  sx={{
                    visibility: isSelected ? "visible" : "hidden",
                    flexShrink: 0,
                  }}>
                  <CheckIcon sx={{ color: tab.fill }} />
                </ListItemIcon>
              )}
            </MenuItem>
          );
        })}
      </Menu>
    </Box>
  );
});

export default PrimaryTabs;

```

## Archivo: `packages/ComponentLibrary/src/components/PrimaryTab/styles.ts`

```typescript
import { type CSSProperties, useMemo } from "react";
import { type SxProps, type Theme, useTheme } from "@mui/material";

export const tabIndicatorProps = { style: { display: "none" } };
export const menuStyle = { paddingY: 0 };

export const useStyle = () => {
  const theme = useTheme();

  return useMemo(
    () => ({
      styles: {
        containerBox: {
          width: "100%",
          height: "3rem",
          display: "flex",
          background: theme.palette.baselineColor.transparentNeutral[5],
          borderRadius: "6.25rem",
          alignItems: "center",
          justifyContent: "space-between",
        },
        tabsContainer: {
          flexGrow: 1,
          maxHeight: "3rem",
          paddingLeft: "0.25rem",
          paddingRight: "0.25rem",
          overflowX: "auto",
        },
        iconButtonMore: {
          marginLeft: "0.25rem",
          padding: "0.5rem",
        },
      } as { [key: string]: CSSProperties },
      sx: {
        tabs: {
          minHeight: "3rem",
          maxHeight: "3rem",
          "& .MuiTabs-scrollButtons": {
            "&.Mui-disabled": {
              opacity: 0.3,
            },
          },
          "& .MuiTabs-scroller": {
            display: "flex",
          },
          "& .MuiTabs-flexContainer": {
            gap: "0.25rem",
            height: "100%",
            maxHeight: "2.5rem",
            alignSelf: "center",
          },
          "& .MuiTab-root": {
            maxHeight: "2.5rem",
            minHeight: "2.5rem",
          },
        },
        tab: {
          maxHeight: "2.5rem",
          textTransform: "none",
          borderRadius: "12.5rem",
          transition: "background-color 0.3s, color 0.4s",
          color: theme.palette.baselineColor.neutral[90],
          padding: "0.25rem 1rem",
          whiteSpace: "nowrap",
          "& .MuiTab-iconWrapper": {
            marginRight: "0.5rem",
          },
          "&.Mui-selected": {
            background: theme.palette.baselineColor.neutral[0],
            color: theme.palette.baselineColor.neutral[90],
          },
          "&:hover:not(.Mui-selected)": {
            color: theme.palette.baselineColor.neutral[0],
            background: theme.palette.dynamicColor.main,
          },
        },
        menu: {
          borderRadius: "0.75rem",
          "& .MuiPaper-root": {
            borderRadius: "0.75rem",
            background: theme.palette.dynamicColor.contrastText,
          },
        },
        menuItem: {
          display: "flex",
          width: "15rem",
          justifyContent: "space-between",
          alignItems: "center",
          margin: "0.5rem",
          padding: "0.5rem",
          borderRadius: "0.5rem",
          "&.Mui-selected": {
            background: theme.palette.baselineColor.neutral[10],
          },
          "&:hover": {
            background: "",
            color: theme.palette.baselineColor.neutral[80],
          },
        },
        selectedMenuItem: {
          backgroundColor: theme.palette.dynamicColor.contrastText,
        },
        iconBox: {
          display: "flex",
          alignItems: "center",
          maxWidth: "10rem",
          overflow: "hidden",
          "& span": {
            whiteSpace: "nowrap",
            overflow: "hidden",
            textOverflow: "ellipsis",
            marginLeft: "0.5rem",
          },
        },
      } as { [key: string]: SxProps<Theme> },
    }),
    [theme]
  );
};

```

## Archivo: `packages/ComponentLibrary/src/components/PrimaryTab/types.ts`

```typescript
export interface TabItem {
  id: string;
  icon?: React.ReactNode;
  label?: string;
  fill?: string;
  hoverFill?: string;
  showInTab?: "icon" | "label" | "both" | boolean;
}

export interface PrimaryTabsProps {
  icon: string | React.ReactNode;
  tabs: TabItem[];
  onChange?: (tabId: string) => void;
  selectedTab?: string;
}

```

## Archivo: `packages/ComponentLibrary/src/components/RadioButton/index.tsx`

```typescript
import type { RadioButtonItemProps } from "./types";

const RadioButtonItem: React.FC<RadioButtonItemProps> = ({ id, title, description, isSelected, onSelect }) => {
  return (
    <button
      type="button"
      className={`w-34 rounded-xl flex flex-col gap-2 p-2 mb-2 cursor-pointer ${
        isSelected ? "bg-opacity-5" : "bg-transparent"
      }`}
      style={{
        border: isSelected ? "1px solid var(--color-etendo-main)" : "1px solid var(--color-transparent-neutral-10)",
        backgroundColor: isSelected ? "var(--color-transparent-neutral-5)" : "transparent",
      }}
      onClick={() => onSelect(id)}>
      <div className="flex items-start">
        <div
          className={`w-5 h-5 rounded-full border flex items-center justify-center flex-shrink-0 mr-2 ${
            isSelected ? "border-blue-600" : "border-gray-400"
          }`}
          style={{
            borderColor: isSelected ? "var(--color-etendo-main)" : "var(--color-baseline-70)",
          }}>
          {isSelected && (
            <div className="w-3 h-3 rounded-full" style={{ backgroundColor: "var(--color-etendo-main)" }} />
          )}
        </div>
        <div className="w-full">
          <h4 className="font-bold mb-1 text-sm leading-tight" style={{ color: "var(--color-baseline-100)" }}>
            {title}
          </h4>
          <p className="text-xs leading-tight break-words" style={{ color: "var(--color-baseline-80)" }}>
            {description}
          </p>
        </div>
      </div>
    </button>
  );
};

export default RadioButtonItem;

```

## Archivo: `packages/ComponentLibrary/src/components/RadioButton/types.ts`

```typescript
export interface RadioButtonItemProps {
  id: number;
  title: string;
  description: string;
  isSelected: boolean;
  onSelect: (id: number) => void;
}

```

## Archivo: `packages/ComponentLibrary/src/components/RadioGrid/index.tsx`

```typescript
import type React from "react";

export interface RadioGridOption {
  value: string;
  label: string;
  description?: string;
  icon?: React.ReactNode;
}

export interface RadioGridProps {
  options: RadioGridOption[];
  selectedValue: string | null;
  onSelect: (value: string) => void;
  className?: string;
  columns?: 1 | 2 | 3 | 4;
  disabled?: boolean;
  name?: string;
}

const RadioGrid: React.FC<RadioGridProps> = ({
  options,
  selectedValue,
  onSelect,
  className = "",
  columns = 3,
  disabled = false,
  name = "radio-grid",
}) => {
  const getGridCols = () => {
    switch (columns) {
      case 1:
        return "grid-cols-1";
      case 2:
        return "grid-cols-1 sm:grid-cols-2";
      case 3:
        return "grid-cols-1 sm:grid-cols-2 md:grid-cols-3";
      case 4:
        return "grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4";
      default:
        return "grid-cols-1 sm:grid-cols-2 md:grid-cols-3";
    }
  };

  return (
    <div className={`grid ${getGridCols()} gap-4 ${className}`}>
      {options.map((option) => (
        <button
          key={option.value}
          type="button"
          disabled={disabled}
          className={`rounded-lg flex flex-col cursor-pointer min-w-0 text-left transition-colors ${
            disabled
              ? "opacity-50 cursor-not-allowed"
              : selectedValue === option.value
                ? "bg-(--color-transparent-neutral-5) border border-(--color-etendo-main) hover:bg-(--color-transparent-neutral-10)"
                : "bg-(--color-baseline-10) border border-(--color-baseline-30) hover:bg-(--color-transparent-neutral-5)"
          }`}
          onClick={() => !disabled && onSelect(option.value)}
          aria-label={`Seleccionar ${option.label}`}>
          <div className="flex items-start p-4">
            <div
              className={`w-5 h-5 rounded-full border flex items-center justify-center flex-shrink-0 mr-3 ${
                selectedValue === option.value ? "border-(--color-etendo-main)" : "border-gray-400"
              }`}>
              {selectedValue === option.value && <div className="w-3 h-3 rounded-full bg-(--color-etendo-main)" />}
            </div>
            <div className="w-full">
              {option.icon && <div className="mb-2">{option.icon}</div>}
              <h4
                className={`font-bold text-base ${
                  selectedValue === option.value ? "text-(--color-etendo-main)" : "text-gray-800"
                }`}>
                {option.label}
              </h4>
              {option.description && <p className="text-xs text-gray-500 mt-1">{option.description}</p>}
            </div>
          </div>
        </button>
      ))}
      <input type="hidden" name={name} value={selectedValue || ""} readOnly />
    </div>
  );
};

export default RadioGrid;

```

## Archivo: `packages/ComponentLibrary/src/components/RegisterModal/index.tsx`

```typescript
import { useState } from "react";
import { Button, List, useTheme } from "@mui/material";
import type { RegisterModalProps } from "./types";
import { useStyle } from "./styles";
import CloseRecordIcon from "../../assets/icons/close-record.svg";
import Modal from "../BasicModal";
import { processMock } from "@workspaceui/storybook/src/stories/Components/RegisterModal/registerMock";
import RadioButtonItem from "../RadioButton";
import CheckIcon from "../../assets/icons/check-circle.svg";

const RegisterModal: React.FC<RegisterModalProps> = ({ registerText, translations }) => {
  const [selectedOption, setSelectedOption] = useState<number | null>(null);
  const [isHovering, setIsHovering] = useState(false);
  const theme = useTheme();
  const { sx } = useStyle();
  const handleMouseEnter = () => setIsHovering(true);
  const handleMouseLeave = () => setIsHovering(false);

  const handleOptionSelect = (id: number) => {
    setSelectedOption(id);
  };

  return (
    <Modal
      tittleHeader={translations.register}
      descriptionText={translations.descriptionText}
      saveButtonLabel={translations.save}
      secondaryButtonLabel={translations.cancel}
      SaveIcon={CheckIcon}
      HeaderIcon={CloseRecordIcon}
      showHeader
      isFullScreenEnabled
      customTrigger={
        <Button
          sx={sx.registerButton}
          onMouseEnter={handleMouseEnter}
          onMouseLeave={handleMouseLeave}
          startIcon={
            <CloseRecordIcon
              fill={isHovering ? theme.palette.baselineColor.neutral[0] : theme.palette.baselineColor.neutral[80]}
            />
          }>
          {registerText}
        </Button>
      }>
      <List sx={sx.itemList}>
        {processMock.map((item) => (
          <RadioButtonItem
            key={item.id}
            id={item.id}
            title={item.title}
            description={item.description}
            isSelected={selectedOption === item.id}
            onSelect={handleOptionSelect}
          />
        ))}
      </List>
    </Modal>
  );
};

export default RegisterModal;

```

## Archivo: `packages/ComponentLibrary/src/components/RegisterModal/styles.ts`

```typescript
import { type SxProps, type Theme, useTheme } from "@mui/material";
import { useMemo } from "react";

export const useStyle = () => {
  const theme = useTheme();

  return useMemo(
    () => ({
      sx: {
        itemList: {
          display: "flex",
          gap: "1rem",
          marginBottom: "1rem",
          flexWrap: "wrap",
          justifyContent: "flex-start",
        },
        registerButton: {
          fontWeight: "600",
          fontSize: "0.875rem",
          padding: "0.5rem 1rem",
          width: "8.5rem",
          height: "2.5rem",
          borderRadius: "6.25rem",
          border: `1px solid ${theme.palette.baselineColor.transparentNeutral[20]}`,
          flex: "1 0 0",
          color: theme.palette.baselineColor.transparentNeutral[70],
          background: theme.palette.baselineColor.transparentNeutral[0],
          "&:hover": {
            borderRadius: "6.25rem",
            background: theme.palette.dynamicColor.dark,
            color: theme.palette.baselineColor.neutral[0],
          },
        },
      } as { [key: string]: SxProps<Theme> },
    }),
    [theme]
  );
};

```

## Archivo: `packages/ComponentLibrary/src/components/RegisterModal/types.ts`

```typescript
export interface Translations {
  register: string;
  descriptionText: string;
  save: string;
  cancel: string;
  noIdentifier: string;
  noTitle: string;
}

export interface RegisterModalProps {
  registerText: string;
  translations: Translations;
}

```

## Archivo: `packages/ComponentLibrary/src/components/ResizeHandle/index.tsx`

```typescript
import { useCallback, useEffect, useRef, useState } from "react";
import { useThrottle } from "../../hooks/useThrottle";

interface ResizeHandleProps {
  onHeightChange?: (height: number) => void;
  onWidthChange?: (width: number) => void;
  initialHeight?: number;
  initialWidth?: number;
  minHeight?: number;
  minWidth?: number;
  maxHeight?: number;
  maxWidth?: number;
  maxOffsetRem?: number;
  children?: React.ReactNode;
  hideHandle?: boolean;
  direction?: "vertical" | "horizontal";
}

const ResizeHandle = ({
  onHeightChange,
  onWidthChange,
  initialHeight = 50,
  initialWidth = 50,
  minHeight = 10,
  minWidth = 10,
  maxHeight = 100,
  maxWidth = 50,
  maxOffsetRem = 9,
  children,
  hideHandle = false,
  direction = "vertical",
}: ResizeHandleProps) => {
  const [isDragging, setIsDragging] = useState(false);
  const [currentHeight, setCurrentHeight] = useState(initialHeight);
  const [currentWidth, setCurrentWidth] = useState(initialWidth);
  const startY = useRef(0);
  const startX = useRef(0);
  const startHeight = useRef(0);
  const startWidth = useRef(0);

  const isVertical = direction === "vertical";

  const calculateHeightLimits = useCallback(() => {
    const remInPx = Number.parseFloat(getComputedStyle(document.documentElement).fontSize) || 16;
    const maxHeightPx = window.innerHeight - maxOffsetRem * remInPx;
    const maxHeightPercentage = (maxHeightPx / window.innerHeight) * 100;
    const clampedMax = maxHeight ? Math.min(maxHeight, maxHeightPercentage) : maxHeightPercentage;
    return {
      min: minHeight,
      max: Math.max(clampedMax, minHeight),
    };
  }, [minHeight, maxOffsetRem, maxHeight]);

  const calculateWidthLimits = useCallback(() => {
    const remInPx = Number.parseFloat(getComputedStyle(document.documentElement).fontSize) || 16;
    const maxWidthPx = window.innerWidth - maxOffsetRem * remInPx;
    const maxWidthPercentage = (maxWidthPx / window.innerWidth) * 100;
    const clampedMax = maxWidth ? Math.min(maxWidth, maxWidthPercentage) : maxWidthPercentage;
    return {
      min: minWidth,
      max: Math.max(clampedMax, minWidth),
    };
  }, [minWidth, maxOffsetRem, maxWidth]);

  const throttledWindowResize = useThrottle(
    useCallback(() => {
      if (isVertical && onHeightChange) {
        const { min, max } = calculateHeightLimits();
        if (currentHeight > max) {
          const clampedHeight = max;
          setCurrentHeight(clampedHeight);
          onHeightChange(clampedHeight);
        } else if (currentHeight < min) {
          const clampedHeight = min;
          setCurrentHeight(clampedHeight);
          onHeightChange(clampedHeight);
        }
      } else if (!isVertical && onWidthChange) {
        const { min, max } = calculateWidthLimits();
        if (currentWidth > max) {
          const clampedWidth = max;
          setCurrentWidth(clampedWidth);
          onWidthChange(clampedWidth);
        } else if (currentWidth < min) {
          const clampedWidth = min;
          setCurrentWidth(clampedWidth);
          onWidthChange(clampedWidth);
        }
      }
    }, [
      currentHeight,
      currentWidth,
      calculateHeightLimits,
      calculateWidthLimits,
      onHeightChange,
      onWidthChange,
      isVertical,
    ]),
    50
  );

  const handleMouseDown = useCallback(
    (e: React.MouseEvent) => {
      const target = e.target as HTMLElement;

      if (
        target.tagName === "INPUT" ||
        target.tagName === "BUTTON" ||
        target.tagName === "TEXTAREA" ||
        target.closest("input") ||
        target.closest("button") ||
        target.closest("textarea") ||
        target.closest('[role="button"]') ||
        target.closest("[tabindex]")
      ) {
        return;
      }

      e.preventDefault();
      setIsDragging(true);
      limitsRef.current = null;

      if (isVertical) {
        startY.current = e.clientY;
        startHeight.current = currentHeight;
      } else {
        startX.current = e.clientX;
        startWidth.current = currentWidth;
      }
    },
    [currentHeight, currentWidth, isVertical]
  );

  const limitsRef = useRef<{ min: number; max: number } | null>(null);

  const handleMouseMove = useCallback(
    (e: MouseEvent) => {
      if (!isDragging) return;

      if (isVertical && onHeightChange) {
        const totalDeltaY = startY.current - e.clientY;
        const percentageDelta = (totalDeltaY / window.innerHeight) * 100;

        if (!limitsRef.current) {
          limitsRef.current = calculateHeightLimits();
        }
        const { min, max } = limitsRef.current;

        const newHeight = Math.min(Math.max(startHeight.current + percentageDelta, min), max);

        document.body.style.cursor = "ns-resize";
        document.body.style.userSelect = "none";
        setCurrentHeight(newHeight);
        onHeightChange(newHeight);
      } else if (!isVertical && onWidthChange) {
        const totalDeltaX = e.clientX - startX.current;
        const percentageDelta = (totalDeltaX / window.innerWidth) * 100;

        if (!limitsRef.current) {
          limitsRef.current = calculateWidthLimits();
        }
        const { min, max } = limitsRef.current;

        const newWidth = Math.min(Math.max(startWidth.current + percentageDelta, min), max);

        document.body.style.cursor = "ew-resize";
        document.body.style.userSelect = "none";
        setCurrentWidth(newWidth);
        onWidthChange(newWidth);
      }
    },
    [isDragging, calculateHeightLimits, calculateWidthLimits, onHeightChange, onWidthChange, isVertical]
  );

  const handleMouseUp = useCallback(() => {
    setIsDragging(false);
    limitsRef.current = null;
    document.body.style.cursor = "";
    document.body.style.userSelect = "";
  }, []);

  useEffect(() => {
    if (isDragging) {
      document.addEventListener("mousemove", handleMouseMove);
      document.addEventListener("mouseup", handleMouseUp);
      return () => {
        document.removeEventListener("mousemove", handleMouseMove);
        document.removeEventListener("mouseup", handleMouseUp);
      };
    }
  }, [isDragging, handleMouseMove, handleMouseUp]);

  useEffect(() => {
    window.addEventListener("resize", throttledWindowResize);
    return () => window.removeEventListener("resize", throttledWindowResize);
  }, [throttledWindowResize]);

  const handleDoubleClick = useCallback(() => {
    if (isVertical && onHeightChange) {
      setCurrentHeight(50);
      onHeightChange(50);
    }
  }, [onHeightChange, isVertical]);

  const getHandleClasses = () => {
    const baseClasses = "absolute transition-all duration-200";
    const activeClasses = isDragging
      ? "bg-blue-400 shadow-lg scale-110"
      : "bg-(--color-baseline-30) group-hover:bg-(--color-baseline-40) group-hover:scale-105";

    if (isVertical) {
      return `${baseClasses} top-0 left-1/2 -translate-x-1/2 w-10 h-1 mt-1 rounded-lg ${activeClasses}`;
    }

    return `${baseClasses} right-0 top-1/2 -translate-y-1/2 w-1 h-10 ml-1 rounded-lg ${activeClasses}`;
  };

  const getOverflowClass = () => {
    return isVertical ? "overflow-auto h-full" : "overflow-auto w-full";
  };
  const cursorClass = !isDragging ? (isVertical ? "cursor-ns-resize" : "cursor-ew-resize") : "";

  return (
    <div className={`relative group ${cursorClass}`} onMouseDown={handleMouseDown} onDoubleClick={handleDoubleClick}>
      <div
        className={`
          relative
          flex items-center justify-center
          transition-colors duration-200
          bg-(--color-transparent-neutral-5)
        `}>
        {!hideHandle && (
          <div className="flex space-x-1 transition-opacity duration-200">
            <div data-resizer className={getHandleClasses()} />
          </div>
        )}
      </div>
      <div className={getOverflowClass()}>{children}</div>
    </div>
  );
};

export default ResizeHandle;

```

## Archivo: `packages/ComponentLibrary/src/components/SearchModal/SubComponents/DefaultContent/index.tsx`

```typescript
import { Box, Typography } from "@mui/material";
import type { DefaultContentProps } from "./types";
import { useStyle } from "./styles";

export const DefaultContent: React.FC<DefaultContentProps> = ({ sections }) => {
  const { styles } = useStyle();

  return (
    <Box sx={styles.container}>
      {sections.map((section, index) => (
        <Box key={index} sx={styles.sectionContainer}>
          <Box sx={styles.sectionBox}>
            <Typography sx={styles.sectionTitle}>
              {section.title} ({section.items.length})
            </Typography>
            <Box sx={styles.itemsContainer}>
              {section.items.map((item, itemIndex) => (
                <Box key={itemIndex} sx={styles.itemBox}>
                  <Box sx={styles.itemIcon}>{item.icon}</Box>
                  <Typography sx={styles.itemText}>{item.name}</Typography>
                </Box>
              ))}
            </Box>
          </Box>
        </Box>
      ))}
    </Box>
  );
};

```

## Archivo: `packages/ComponentLibrary/src/components/SearchModal/SubComponents/DefaultContent/styles.ts`

```typescript
import { useTheme } from "@mui/material";
import { type CSSProperties, useMemo } from "react";

export const useStyle = () => {
  const theme = useTheme();

  return useMemo(
    () => ({
      styles: {
        container: {
          padding: "0.75rem",
          display: "flex",
          flexDirection: "column",
          gap: "0.75rem",
        },
        sectionContainer: {
          display: "flex",
          flexDirection: "column",
          gap: "0.75rem",
        },
        sectionBox: {
          margin: 0,
          display: "flex",
          flexDirection: "column",
          borderRadius: "0.75rem",
          backgroundColor: theme.palette.baselineColor.neutral[0],
          padding: "0.75rem 1rem",
          border: `1px solid ${theme.palette.baselineColor.transparentNeutral[10]}`,
        },
        sectionTitle: {
          display: "flex",
          alignItems: "center",
          fontSize: "0.875rem",
          fontWeight: 500,
          marginBottom: "0.5rem",
          color: theme.palette.baselineColor.neutral[90],
        },
        itemsContainer: {
          display: "flex",
          flexDirection: "column",
          gap: "0.25rem",
        },
        itemBox: {
          display: "flex",
          cursor: "pointer",
          alignItems: "center",
          gap: "0.5rem",
          padding: "0.5rem",
          borderRadius: "0.5rem",
          transition: "background-color 500ms, color 500ms",
          "&:hover": {
            backgroundColor: theme.palette.dynamicColor.contrastText,
            color: theme.palette.dynamicColor.main,
          },
        },
        itemIcon: {
          fontSize: "0.875rem",
          lineHeight: "1.25rem",
          fontWeight: 500,
        },
        itemText: {
          fontSize: "0.875rem",
          lineHeight: "1.25rem",
          fontWeight: 500,
          opacity: 1,
          whiteSpace: "nowrap",
          overflow: "hidden",
          textOverflow: "ellipsis",
        },
      } as { [key: string]: CSSProperties },
    }),
    [theme]
  );
};

```

## Archivo: `packages/ComponentLibrary/src/components/SearchModal/SubComponents/DefaultContent/types.ts`

```typescript
import type { ReactNode } from "react";

export interface Item {
  name: string;
  icon: ReactNode;
  isNew?: boolean;
  newLabel?: string;
}

export interface Section {
  title: string;
  items: Item[];
}

export interface TabContent {
  icon: ReactNode;
  label: string;
  onClick: () => void;
  items: Item[];
}

export interface SearchModalProps {
  defaultContent?: Section[];
  tabsContent: TabContent[];
  variant: "default" | "tabs";
}

export interface DefaultContentProps {
  sections: Section[];
}

export interface TabContentProps {
  tabsContent: TabContent[];
  activeTab: number;
}

```

## Archivo: `packages/ComponentLibrary/src/components/SearchModal/SubComponents/HeaderSection/index.tsx`

```typescript
import type React from "react";
import { Box, Typography } from "@mui/material";
import SearchIcon from "@mui/icons-material/Search";
import { useStyle } from "./styles";
import type { HeaderSectionProps } from "./types";

export const HeaderSection: React.FC<HeaderSectionProps> = ({ title }) => {
  const { styles } = useStyle();

  return (
    <Box sx={styles.headerSection}>
      <Box sx={styles.searchIconContainer}>
        <SearchIcon sx={styles.iconSearchStyles} />
      </Box>
      <Typography variant="h6" sx={styles.headerTitle}>
        {title}
      </Typography>
    </Box>
  );
};

```

## Archivo: `packages/ComponentLibrary/src/components/SearchModal/SubComponents/HeaderSection/styles.ts`

```typescript
import { useTheme } from "@mui/material";

export const useStyle = () => {
  const theme = useTheme();

  return {
    styles: {
      headerSection: {
        display: "flex",
        padding: "0.75rem 1.25rem 0.75rem 0.75rem",
        alignItems: "center",
        backgroundColor: theme.palette.baselineColor.neutral[0],
      },
      searchIconContainer: {
        position: "relative",
        backgroundColor: theme.palette.baselineColor.etendoPrimary.contrastText,
        borderRadius: "12.5rem",
        width: "2rem",
        height: "2rem",
        display: "flex",
        justifyContent: "center",
        alignItems: "center",
      },
      iconSearchStyles: {
        color: theme.palette.dynamicColor.main,
        height: "1.25rem",
        width: "1.25rem",
      },
      headerTitle: {
        fontSize: "1rem",
        color: theme.palette.baselineColor.neutral[90],
        marginLeft: 1,
        fontWeight: 600,
      },
    },
  };
};

```

## Archivo: `packages/ComponentLibrary/src/components/SearchModal/SubComponents/HeaderSection/types.ts`

```typescript
export interface HeaderSectionProps {
  title: string;
}

```

## Archivo: `packages/ComponentLibrary/src/components/SearchModal/SubComponents/ItemContent/index.tsx`

```typescript
import type React from "react";
import { Box, Typography } from "@mui/material";
import type { ItemContentProps } from "./types";
import { useStyle } from "./styles";

export const ItemContent: React.FC<ItemContentProps> = ({ item }) => {
  const { styles } = useStyle();

  return (
    <Box sx={styles.itemBox}>
      <Box sx={styles.itemIcon}>{item.icon}</Box>
      <Typography sx={styles.itemText}>{item.name}</Typography>
      {item.isNew && <Box sx={styles.newLabel}>{item.newLabel}</Box>}
    </Box>
  );
};

```

## Archivo: `packages/ComponentLibrary/src/components/SearchModal/SubComponents/ItemContent/styles.ts`

```typescript
import { useTheme } from "@mui/material";

export const useStyle = () => {
  const theme = useTheme();

  return {
    styles: {
      itemBox: {
        display: "flex",
        alignItems: "center",
        gap: "1rem",
        padding: "0.5rem",
        borderRadius: "0.5rem",
        cursor: "pointer",
        transition: "background-color 500ms, color 500ms",
        "&:hover": {
          backgroundColor: theme.palette.dynamicColor.contrastText,
          color: theme.palette.dynamicColor.main,
        },
      },
      itemIcon: {
        fontSize: "0.875rem",
        lineHeight: "1.25rem",
        fontWeight: 500,
      },
      itemText: {
        fontSize: "0.875rem",
        lineHeight: "1.25rem",
        fontWeight: 500,
        opacity: 1,
        whiteSpace: "nowrap",
        overflow: "hidden",
        textOverflow: "ellipsis",
      },
      newLabel: {
        backgroundColor: theme.palette.baselineColor.etendoPrimary.main,
        color: theme.palette.baselineColor.neutral[0],
        borderRadius: "6.25rem",
        padding: "0 1rem",
        fontSize: "0.875rem",
        fontWeight: 500,
      },
    },
  };
};

```

## Archivo: `packages/ComponentLibrary/src/components/SearchModal/SubComponents/ItemContent/types.ts`

```typescript
import type { Item } from "../../../SecondaryTabs/types";

export interface ItemContentProps {
  item: Item;
}

```

## Archivo: `packages/ComponentLibrary/src/components/SearchModal/SubComponents/SectionContent/index.tsx`

```typescript
import { Box, Typography } from "@mui/material";
import ArrowForwardIcon from "@mui/icons-material/ArrowForward";
import type { Section } from "../../../SecondaryTabs/types";
import { useStyle } from "./styles";
import { ItemContent } from "../ItemContent";

export const SectionContent: React.FC<{ section: Section; isLast: boolean; variant: "default" | "tabs" }> = ({
  section,
  isLast,
}) => {
  const { styles } = useStyle();

  return (
    <Box sx={styles.sectionContent}>
      <Box sx={styles.sectionBox(isLast)}>
        <Box sx={styles.sectionInnerBox}>
          <Box sx={styles.contentWrapper}>
            <Box sx={styles.sectionTitleContainer}>
              <Typography sx={styles.sectionTitle}>
                {section.title} ({section.items.length})
              </Typography>
              <ArrowForwardIcon sx={styles.arrowIcon} />
            </Box>
            <Box sx={styles.itemsContainer}>
              {section.items.map((item, index) => (
                <ItemContent key={index} item={item} />
              ))}
            </Box>
          </Box>
        </Box>
      </Box>
    </Box>
  );
};

```

## Archivo: `packages/ComponentLibrary/src/components/SearchModal/SubComponents/SectionContent/styles.ts`

```typescript
import { useTheme } from "@mui/material";
import { useMemo } from "react";

export const useStyle = () => {
  const theme = useTheme();

  return useMemo(
    () => ({
      styles: {
        sectionContent: {
          display: "flex",
          flexDirection: "column",
          gap: "0.75rem",
        },
        sectionBox: (isLast: boolean) => ({
          borderBottom: isLast ? "none" : `1px solid ${theme.palette.baselineColor.transparentNeutral[10]}`,
        }),
        sectionInnerBox: {
          padding: "0.75rem",
          paddingBottom: "0.25rem",
          margin: 0,
          display: "flex",
          flexDirection: "column",
          gap: "0.75rem",
        },
        contentWrapper: {
          borderRadius: "0.75rem",
        },
        sectionTitleContainer: {
          display: "inline-flex",
          alignItems: "center",
          gap: "0.25rem",
          marginBottom: "0.25rem",
          borderBottom: "1px solid transparent",
          "&:hover": {
            borderBottom: `1px solid ${theme.palette.baselineColor.etendoPrimary.main}`,
            cursor: "pointer",
          },
        },
        sectionTitle: {
          color: theme.palette.baselineColor.etendoPrimary.main,
          fontSize: "0.875rem",
          lineHeight: "1.25rem",
          fontWeight: 500,
        },
        arrowIcon: {
          rotate: "320deg",
          color: theme.palette.baselineColor.etendoPrimary.main,
          fontSize: "1rem",
        },
        itemsContainer: {
          display: "flex",
          flexDirection: "column",
          gap: "0.25rem",
        },
      },
    }),
    [theme]
  );
};

```

## Archivo: `packages/ComponentLibrary/src/components/SearchModal/SubComponents/SectionContent/types.ts`

```typescript
import type { Section } from "../../../SecondaryTabs/types";

export interface SectionContentProps {
  section: Section;
  isLast: boolean;
  variant: "default" | "tabs";
}

```

## Archivo: `packages/ComponentLibrary/src/components/SearchModal/SubComponents/TabContent/index.tsx`

```typescript
import type React from "react";
import { SectionContent } from "../SectionContent";

// biome-ignore lint/suspicious/noExplicitAny: <explanation>
export const TabContent: React.FC<{ tabsContent: any[]; activeTab: number }> = ({ tabsContent, activeTab }) => {
  if (activeTab === 0) {
    return (
      <>
        {tabsContent.slice(1).map((tab, index) => (
          <SectionContent
            key={index}
            section={{ title: tab.label, items: tab.items }}
            isLast={index === tabsContent.length - 2}
            variant="tabs"
          />
        ))}
      </>
    );
  }
  const activeTabConfig = tabsContent[activeTab];
  return (
    <SectionContent
      section={{ title: activeTabConfig.label, items: activeTabConfig.items }}
      isLast={true}
      variant="tabs"
    />
  );
};

```

## Archivo: `packages/ComponentLibrary/src/components/SearchModal/index.tsx`

```typescript
import { Box } from "@mui/material";
import { useState } from "react";
import SecondaryTabs from "../SecondaryTabs";
import type { SearchModalProps } from "../SecondaryTabs/types";
import { DefaultContent } from "./SubComponents/DefaultContent";
import { HeaderSection } from "./SubComponents/HeaderSection";
import { TabContent as TabContentComponent } from "./SubComponents/TabContent";
import { DEFAULT_MODAL_WIDTH, useStyle } from "./styles";

const SearchModal: React.FC<SearchModalProps> = ({
  defaultContent,
  tabsContent,
  variant,
  modalWidth = DEFAULT_MODAL_WIDTH,
}) => {
  const [activeTab, setActiveTab] = useState(0);
  const { sx } = useStyle();

  const renderContent = () => {
    if (variant === "default" && defaultContent) {
      return (
        <>
          <HeaderSection title={defaultContent.headerTitle} />
          <DefaultContent sections={defaultContent.sections} />
        </>
      );
    }
    if (variant === "tabs" && tabsContent && tabsContent.length > 0) {
      return (
        <>
          <SecondaryTabs content={tabsContent} selectedTab={activeTab} onChange={setActiveTab} />
          <TabContentComponent tabsContent={tabsContent} activeTab={activeTab} />
        </>
      );
    }
    return null;
  };

  return (
    <Box sx={[sx.container, { width: modalWidth }]}>
      <Box sx={sx.content(variant)}>{renderContent()}</Box>
    </Box>
  );
};

export default SearchModal;

```

## Archivo: `packages/ComponentLibrary/src/components/SearchModal/styles.ts`

```typescript
import { useTheme } from "@mui/material";
import { useMemo } from "react";

export const DEFAULT_MODAL_WIDTH = "25.625rem";

export const useStyle = () => {
  const theme = useTheme();

  return useMemo(
    () => ({
      sx: {
        container: () => ({
          padding: 0,
          height: "auto",
          "&:focus-visible": { outline: "none" },
          border: `1px solid ${theme.palette.baselineColor.transparentNeutral[10]}`,
          boxShadow: `0 0.25rem 0.625rem 0 ${theme.palette.baselineColor.transparentNeutral[10]}`,
          borderRadius: "0.75rem",
          backgroundColor: theme.palette.baselineColor.neutral[0],
        }),
        content: (variant: unknown) => ({
          overflow: "auto",
          maxHeight: "calc(100vh - 3.125rem)",
          borderRadius: "0.75rem",
          backgroundColor:
            variant === "default" ? theme.palette.baselineColor.neutral[10] : theme.palette.baselineColor.neutral[0],
        }),
        sectionContent: {
          display: "flex",
          flexDirection: "column",
          gap: "0.75rem",
        },
        sectionBox: (isLast: boolean) => ({
          borderBottom: isLast ? "none" : `1px solid ${theme.palette.baselineColor.transparentNeutral[10]}`,
          backgroundColor: theme.palette.baselineColor.neutral[0],
        }),
        sectionInnerBox: (isLast: boolean) => ({
          padding: "0.75rem",
          paddingBottom: isLast ? "0.5rem" : "0.5rem",
          margin: 0,
          display: "flex",
          flexDirection: "column",
          gap: "0.75rem",
        }),
        itemBox: {
          display: "flex",
          alignItems: "center",
          gap: "0.5rem",
          padding: "0.5rem",
          borderRadius: "0.5rem",
          cursor: "pointer",
          transition: "background-color 500ms, color 500ms",
          "&:hover": {
            backgroundColor: theme.palette.dynamicColor.contrastText,
            color: theme.palette.dynamicColor.main,
          },
        },
        newLabel: () => ({
          backgroundColor: theme.palette.baselineColor.etendoPrimary.main,
          color: theme.palette.baselineColor.neutral[0],
          borderRadius: "12.5rem",
          padding: "0 0.5rem",
          fontSize: "10.25rem",
          fontWeight: 500,
        }),
      },
    }),
    [theme]
  );
};

```

## Archivo: `packages/ComponentLibrary/src/components/SecondaryTabs/components/TabLabel/index.tsx`

```typescript
import { Box, Badge, CircularProgress, useTheme } from "@mui/material";
import type { TabLabelProps } from "./types";
import { useStyle } from "./styles";

const TabLabel: React.FC<TabLabelProps & { isSelected?: boolean }> = ({ icon, text, count, isLoading }) => {
  const theme = useTheme();
  const { styles } = useStyle();

  return (
    <Box sx={styles.tabLabelContainerStyles}>
      <Box sx={styles.tabLabelContainerStyles}>{icon}</Box>
      <span style={{ ...styles.badgeTextStyles }}>{text}</span>
      {isLoading ? (
        <CircularProgress size={16} sx={{ color: theme.palette.baselineColor.neutral[80] }} />
      ) : (
        !!count && <Badge badgeContent={count} color="secondary" sx={styles.badgeStyles} />
      )}
    </Box>
  );
};

export default TabLabel;

```

## Archivo: `packages/ComponentLibrary/src/components/SecondaryTabs/components/TabLabel/styles.ts`

```typescript
import { type SxProps, type Theme, useTheme } from "@mui/material";
import { type CSSProperties, useMemo } from "react";

type StylesType = {
  styles: {
    tabLabelContainerStyles: SxProps<Theme>;
    badgeTextStyles: CSSProperties;
    badgeStyles: SxProps<Theme>;
  };
};

export const useStyle = (): StylesType => {
  const theme = useTheme();

  return useMemo(
    () => ({
      styles: {
        tabLabelContainerStyles: {
          display: "flex",
          alignItems: "center",
          height: "100%",
          "& .MuiBadge-badge": {
            backgroundColor: theme.palette.baselineColor.transparentNeutral[5],
            color: theme.palette.baselineColor.neutral[100],
            fontSize: "0.875rem",
            fontWeight: 500,
            height: "1.5rem",
            borderRadius: "12.5rem",
            paddingX: "0.5rem",
          },
        },
        badgeTextStyles: {
          marginLeft: "0.5rem",
          marginRight: "0.5rem",
          fontSize: "0.875rem",
          fontWeight: 500,
          color: "inherit",
        } as CSSProperties,
        badgeStyles: {
          marginLeft: "0.875rem",
          "& .MuiBadge-badge": {
            backgroundColor: theme.palette.baselineColor.transparentNeutral[5],
            color: theme.palette.baselineColor.neutral[100],
            fontSize: "0.875rem",
            fontWeight: 500,
            height: "1.5rem",
            borderRadius: "12.5rem",
            maxWidth: "1.5rem",
            paddingX: "0.5rem",
          },
        },
      },
    }),
    [theme]
  );
};

```

## Archivo: `packages/ComponentLibrary/src/components/SecondaryTabs/components/TabLabel/types.ts`

```typescript
import type { ReactNode } from "react";

export interface TabLabelProps {
  icon: ReactNode;
  text: string;
  count?: number | boolean;
  isLoading?: boolean;
}

```

## Archivo: `packages/ComponentLibrary/src/components/SecondaryTabs/components/TabPanel/index.tsx`

```typescript
import type React from "react";
import { Box } from "@mui/material";
import type { TabPanelProps } from "./types";

const TabPanel: React.FC<TabPanelProps> = ({ children, value, index, ...other }) => {
  return (
    <Box role="tabpanel" hidden={value !== index} id={`tabpanel-${index}`} aria-labelledby={`tab-${index}`} {...other}>
      {value === index && <Box sx={{ p: 3 }}>{children}</Box>}
    </Box>
  );
};

export default TabPanel;

```

## Archivo: `packages/ComponentLibrary/src/components/SecondaryTabs/components/TabPanel/types.ts`

```typescript
import type { ReactNode } from "react";

export interface TabPanelProps {
  children?: ReactNode;
  value: number;
  index: number;
}

```

## Archivo: `packages/ComponentLibrary/src/components/SecondaryTabs/index.tsx`

```typescript
/* eslint-disable @typescript-eslint/no-explicit-any */
"use client";
import React, { useState, useRef, useEffect, useCallback, useMemo, type ReactElement } from "react";
import { Tabs, Tab, Box, MenuItem, Typography } from "@mui/material";
import KeyboardDoubleArrowRightIcon from "@mui/icons-material/KeyboardDoubleArrowRight";
import TabLabel from "./components/TabLabel";
import { useStyle } from "./styles";
import type { SecondaryTabsProps, TabContent } from "./types";
import IconButton from "../IconButton";
import Menu from "../Menu";

const tabSize = 150;

const renderIcon = (icon: TabContent["icon"], style: React.CSSProperties | undefined): ReactElement => {
  const safeStyle = style || {};
  if (React.isValidElement<{ style?: React.CSSProperties }>(icon)) {
    return React.cloneElement(icon, {
      style: { ...icon.props.style, ...safeStyle },
    });
  }
  if (typeof icon === "string") {
    return <Typography style={safeStyle}>{icon}</Typography>;
  }
  if (typeof icon === "function") {
    return icon({ style: safeStyle });
  }
  return <></>;
};

const SecondaryTabs: React.FC<SecondaryTabsProps> = ({ content, selectedTab, onChange }) => {
  const [visibleCount, setVisibleCount] = useState(5);
  const tabsRef = useRef<HTMLDivElement>(null);
  const { sx } = useStyle();

  const [anchorEl, setAnchorEl] = useState<HTMLElement | null>(null);

  const updateVisibleCount = useCallback(() => {
    if (tabsRef.current) {
      const width = tabsRef.current.clientWidth;
      const tabWidth = tabSize;
      const newVisibleCount = Math.max(1, Math.floor((width - 40) / tabWidth));
      setVisibleCount(newVisibleCount);
    }
  }, []);

  useEffect(() => {
    updateVisibleCount();
    window.addEventListener("resize", updateVisibleCount);
    return () => window.removeEventListener("resize", updateVisibleCount);
  }, [updateVisibleCount]);

  const handleChange = useCallback(
    (event: React.SyntheticEvent, newValue: number) => {
      event.preventDefault();
      onChange(newValue);
      content[newValue].onClick();
    },
    [content, onChange]
  );

  const handleMenu = useCallback((event: React.MouseEvent<HTMLButtonElement>) => {
    setAnchorEl(event.currentTarget);
  }, []);

  const handleClose = () => {
    setAnchorEl(null);
  };

  const visibleTabs = useMemo(() => content.slice(0, visibleCount), [content, visibleCount]);
  const hiddenTabs = useMemo(() => content.slice(visibleCount), [content, visibleCount]);

  const renderTab = useCallback(
    (tab: TabContent, index: number) => (
      <Tab
        key={index}
        label={
          <TabLabel
            icon={
              <Box component="span" sx={sx.iconContainer}>
                {renderIcon(tab.icon, sx.menuItemIcon)}
              </Box>
            }
            text={tab.label}
            isLoading={tab.isLoading}
            count={tab.numberOfItems}
          />
        }
        iconPosition="start"
        sx={sx.tab}
      />
    ),
    [sx.iconContainer, sx.menuItemIcon, sx.tab]
  );

  return (
    <Box sx={sx.container}>
      <Box ref={tabsRef} sx={sx.tabsContainer}>
        <Tabs value={selectedTab} onChange={handleChange} variant="scrollable" scrollButtons="auto">
          {visibleTabs.map(renderTab)}
        </Tabs>
        {hiddenTabs.length > 0 && (
          <Box sx={sx.rightButtonContainer}>
            <IconButton onClick={handleMenu}>
              <KeyboardDoubleArrowRightIcon />
            </IconButton>
          </Box>
        )}
      </Box>
      <Menu anchorEl={anchorEl} onClose={handleClose}>
        {hiddenTabs.map((tab: TabContent, index: number) => (
          <MenuItem
            key={index}
            onClick={() => {
              onChange(index + visibleCount);
              tab.onClick();
              handleClose();
            }}
            sx={sx.menuItem}>
            {renderIcon(tab.icon, sx.menuItemTypography)}
            {tab.label}
          </MenuItem>
        ))}
      </Menu>
      {content[selectedTab].content}
    </Box>
  );
};

export default SecondaryTabs;

```

## Archivo: `packages/ComponentLibrary/src/components/SecondaryTabs/styles.ts`

```typescript
import { type Theme, useTheme } from "@mui/material";
import { useMemo } from "react";

export const useStyle = () => {
  const theme = useTheme();

  return useMemo(
    () => ({
      sx: {
        container: {
          display: "flex",
          flexDirection: "column",
        },
        tabsContainer: {
          overflow: "hidden",
          cursor: "grab",
          height: "2.25rem",
          display: "flex",
          alignItems: "center",
          padding: "0 0.5rem",
          width: "100%",
          position: "relative",
          "& .MuiTabs-root": {
            minHeight: "2.25rem",
          },
          "& .MuiTabs-scroller": {
            overflow: "hidden !important",
          },
        },
        rightButtonContainer: {
          position: "absolute",
          right: "0.5rem",
          top: "50%",
          transform: "translateY(-50%)",
          display: "flex",
          alignItems: "center",
          height: "100%",
          zIndex: 1,
        },
        iconContainer: {
          display: "flex",
          alignItems: "center",
          justifyContent: "center",
        },
        menuItemTypography: {
          marginRight: "0.5rem",
          fontSize: "0.875rem",
          fontWeight: 500,
          color: theme.palette.baselineColor.neutral[90],
          transition: "color 0.5s ease",
        },
        menuItemIcon: {
          width: "1rem",
          height: "1rem",
          color: theme.palette.baselineColor.neutral[70],
        },
        tab: {
          minWidth: "auto",
          padding: "0 0.725rem",
          backgroundColor: "transparent",
          position: "relative",
          transition: "color 0.3s ease",
          "&::after": {
            content: '""',
            position: "absolute",
            bottom: 0,
            left: 0,
            width: "100%",
            height: "2px",
            backgroundColor: theme.palette.baselineColor.neutral[90],
            transform: "scaleX(0)",
            transition: "transform 0.3s ease",
            top: "2.5rem",
          },
          "&.Mui-selected": {
            color: theme.palette.baselineColor.neutral[90],
            "&::after": {
              transform: "scaleX(1)",
            },
          },
          "&:hover": {
            backgroundColor: "transparent",
            color: theme.palette.baselineColor.neutral[90],
          },
        },
        common: {
          width: "2rem",
          height: "2rem",
          backgroundColor: theme.palette.baselineColor.neutral[0],
          borderRadius: "12.5rem",
          marginTop: "0.375rem",
        },
        menuPaper: {
          marginTop: "0.25rem",
          border: `1px solid ${theme.palette.baselineColor.transparentNeutral[10]}`,
          padding: "0.5rem",
          boxShadow: `0 0.25rem 0.625rem 0 ${theme.palette.baselineColor.transparentNeutral[10]}`,
          borderRadius: "0.75rem",
        },
        menuItemRoot: {
          ".MuiList-root": { padding: 0 },
        },
        menuItem: {
          display: "flex",
          alignItems: "center",
          maxHeight: "36.25rem",
          width: "14.5rem",
          padding: "0.5rem",
          fontWeight: 500,
          fontSize: "0.875rem",
          borderRadius: "0.5rem",
          transition: "background-color 500ms, color 500ms",
          "&:hover": {
            backgroundColor: theme.palette.dynamicColor.contrastText,
            color: theme.palette.dynamicColor.main,
          },
        },
        menuItemIconModal: {
          width: "1rem",
          height: "1rem",
          marginRight: "0.5rem",
          color: theme.palette.baselineColor.neutral[60],
        },
      },
    }),
    [theme]
  );
};

export const getRightButtonStyles = (open: boolean, theme: Theme) => ({
  color: open ? theme.palette.dynamicColor.contrastText : theme.palette.baselineColor.neutral[80],
  backgroundColor: open ? theme.palette.baselineColor.neutral[80] : theme.palette.baselineColor.neutral[0],
  borderRadius: "50%",
  boxShadow: "0 0.25rem 0.5rem rgba(0, 0, 0, 0.15)",
  transition: "background-color 0.5s ease, color 0.5s ease, border-radius 0.5s ease, box-shadow 0.5s ease",
  "&:hover": {
    color: theme.palette.dynamicColor.contrastText,
    backgroundColor: theme.palette.baselineColor.neutral[80],
    boxShadow: "0 0.25rem 0.625rem 0 #00030D1A",
    borderRadius: "12.5rem",
  },
  padding: 0,
  height: "1.75rem",
  width: "1.75rem",
  display: "flex",
  alignItems: "center",
  justifyContent: "center",
});

```

## Archivo: `packages/ComponentLibrary/src/components/SecondaryTabs/types.ts`

```typescript
import type { ReactNode } from "react";

export interface Item {
  name: string;
  icon: ReactNode;
  isNew?: boolean;
  newLabel?: string;
}

export interface Section {
  title: string;
  items: Item[];
}

export interface TabContent {
  icon: React.ReactNode | string | ((props: { style?: React.CSSProperties }) => React.ReactElement);
  label: string;
  onClick: () => void;
  items: Item[];
  numberOfItems?: number;
  isLoading?: boolean;
  content?: ReactNode;
}

export interface DefaultContent {
  headerTitle: string;
  sections: Section[];
}

export interface SearchModalProps {
  defaultContent?: DefaultContent;
  tabsContent?: TabContent[];
  variant: "default" | "tabs";
  modalWidth?: string;
}

export interface DefaultContentProps {
  sections: Section[];
}

export interface TabContentProps {
  tabsContent: TabContent[];
  activeTab: number;
}

export interface SecondaryTabsProps {
  content: TabContent[];
  selectedTab: number;
  onChange: (newValue: number) => void;
}

```

## Archivo: `packages/ComponentLibrary/src/components/Select/index.tsx`

```typescript
export default function Select({
  children,
  ...props
}: React.PropsWithChildren<React.SelectHTMLAttributes<HTMLSelectElement>>) {
  return <select {...props}>{children}</select>;
}

```

## Archivo: `packages/ComponentLibrary/src/components/Spinner/index.tsx`

```typescript
import Box from "@mui/material/Box";
import CircularProgress, { type CircularProgressProps } from "@mui/material/CircularProgress";

export default function Spinner(props: CircularProgressProps) {
  return (
    <Box justifyContent="center" alignItems="center" display="flex" flex={1}>
      <CircularProgress {...props} />
    </Box>
  );
}

```

## Archivo: `packages/ComponentLibrary/src/components/StatusModal/ConfirmModal.tsx`

```typescript
import { useMemo, memo } from "react";
import { Box, Typography, useTheme } from "@mui/material";
import { Modal } from "..";
import SaveIcon from "../../assets/icons/trash.svg";
import { useStyle } from "../StatusModal/styles";
import type { ConfirmModalProps } from "./types";

const ConfirmModal = memo(
  ({
    confirmText,
    onConfirm,
    onCancel,
    saveLabel = "Confirm",
    secondaryButtonLabel = "Cancel",
    open = true,
  }: ConfirmModalProps) => {
    const theme = useTheme();
    const { sx } = useStyle();

    const backgroundGradient = useMemo(
      () => `linear-gradient(to bottom, ${theme.palette.specificColor.warning.light}, rgba(255, 255, 255, 0))`,
      [theme.palette.specificColor.warning.light]
    );
    return (
      <Modal
        open={open}
        showHeader={false}
        saveButtonLabel={saveLabel}
        secondaryButtonLabel={secondaryButtonLabel}
        SaveIcon={SaveIcon}
        backgroundGradient={backgroundGradient}
        onSave={onConfirm}
        onCancel={onCancel}>
        <Box sx={sx.statusModalContainer}>
          <Typography sx={sx.statusText}>{confirmText}</Typography>
        </Box>
      </Modal>
    );
  }
);

ConfirmModal.displayName = "ConfirmModal";

export default ConfirmModal;

```

## Archivo: `packages/ComponentLibrary/src/components/StatusModal/index.tsx`

```typescript
import { Box, Typography, useTheme } from "@mui/material";
import { useCallback, useMemo } from "react";
import { Modal } from "..";
import SaveIcon from "../../assets/icons/save.svg";
import { statusConfig } from "./states";
import { useStyle } from "./styles";
import type { StatusModalProps } from "./types";

const StatusModal: React.FC<StatusModalProps> = ({
  statusText,
  statusType,
  errorMessage,
  saveLabel,
  secondaryButtonLabel,
  onClose,
  onAfterClose,
  isDeleteSuccess,
  open = true,
}) => {
  const { gradientColor, iconBackgroundColor, icon: StatusIcon } = statusConfig[statusType];
  const theme = useTheme();
  const { sx } = useStyle();

  const backgroundGradient = useMemo(
    () => `linear-gradient(to bottom, ${gradientColor}, rgba(255, 255, 255, 0))`,
    [gradientColor]
  );
  const handleClose = useCallback(() => {
    if (onClose) {
      onClose();
    }
  }, [onClose]);

  const handleAfterClose = useCallback(() => {
    if (onAfterClose) {
      onAfterClose();
    }
  }, [onAfterClose]);

  const secondaryLabel = isDeleteSuccess ? "" : secondaryButtonLabel;

  return (
    <Modal
      open={open}
      showHeader={false}
      saveButtonLabel={!isDeleteSuccess ? saveLabel : undefined}
      secondaryButtonLabel={secondaryLabel}
      SaveIcon={!isDeleteSuccess ? SaveIcon : undefined}
      backgroundGradient={backgroundGradient}
      onSave={handleClose}
      onAfterClose={handleAfterClose}
      onCancel={handleClose}
      onClose={handleClose}
      buttons={isDeleteSuccess ? null : undefined}>
      <Box sx={sx.statusModalContainer}>
        <Box
          sx={{
            ...sx.statusIcon,
            background: iconBackgroundColor,
          }}>
          <StatusIcon fill={theme.palette.baselineColor.neutral[0]} />
        </Box>
        {statusType === "error" && errorMessage && <Typography sx={sx.errorMessage}>{errorMessage}</Typography>}
        <Typography sx={sx.statusText}>{statusText}</Typography>
      </Box>
    </Modal>
  );
};

export default StatusModal;

```

## Archivo: `packages/ComponentLibrary/src/components/StatusModal/states.ts`

```typescript
import CheckIcon from "../../assets/icons/check.svg";
import ErrorIcon from "../../assets/icons/x-octagon.svg";
import WarningIcon from "../../assets/icons/alert-triangle.svg";
import type { StatusConfig, StatusType } from "./types";
import { theme } from "../../theme";

export const statusConfig: Record<StatusType, StatusConfig> = {
  success: {
    gradientColor: "#BFFFBF",
    iconBackgroundColor: theme.palette.success.main,
    icon: CheckIcon,
  },
  error: {
    gradientColor: "#FFCCD6",
    iconBackgroundColor: theme.palette.error.main,
    icon: ErrorIcon,
  },
  warning: {
    gradientColor: theme.palette.warning.light,
    iconBackgroundColor: theme.palette.warning.main,
    icon: WarningIcon,
  },
  info: {
    gradientColor: theme.palette.warning.light,
    iconBackgroundColor: theme.palette.warning.main,
    icon: WarningIcon,
  },
};

```

## Archivo: `packages/ComponentLibrary/src/components/StatusModal/styles.ts`

```typescript
import { type SxProps, useTheme, type Theme } from "@mui/material";

type StylesType = {
  sx: Record<string, SxProps<Theme>>;
};

export const useStyle = (): StylesType => {
  const theme = useTheme();

  return {
    sx: {
      statusModalContainer: {
        position: "relative",
        display: "flex",
        flexDirection: "column",
        alignItems: "center",
        gap: "1rem",
      },
      statusIcon: {
        width: "2.25rem",
        height: "2.25rem",
        display: "flex",
        alignItems: "center",
        justifyContent: "center",
        borderRadius: "1.125rem",
      },
      statusText: {
        position: "relative",
        zIndex: 1,
        marginBottom: "1rem",
        fontWeight: "600",
        fontSize: "1.350rem",
        color: theme.palette.baselineColor.neutral[90],
      },
    },
  };
};

```

## Archivo: `packages/ComponentLibrary/src/components/StatusModal/types.ts`

```typescript
export type IconComponent = React.FunctionComponent<React.SVGProps<SVGSVGElement> & { title?: string }>;

export interface StatusConfig {
  gradientColor: string;
  icon: IconComponent;
  iconBackgroundColor: string;
}

export type StatusType = "success" | "error" | "warning" | "info";

export interface StatusModalState {
  open: boolean;
  statusType: StatusType;
  statusText: string;
  errorMessage?: string;
  saveLabel?: string;
  secondaryButtonLabel?: string;
  isDeleteSuccess?: boolean;
}

export interface StatusModalProps {
  statusText: string;
  statusType: StatusType;
  errorMessage?: string;
  saveLabel?: string;
  secondaryButtonLabel?: string;
  onClose?: () => void;
  onAfterClose?: () => void;
  isDeleteSuccess?: boolean;
  open?: boolean;
}

export interface ConfirmModalProps {
  confirmText: string;
  onConfirm: () => void;
  onCancel: () => void;
  saveLabel?: string;
  secondaryButtonLabel?: string;
  onAfterClose?: () => void;
  open?: boolean;
}

```

## Archivo: `packages/ComponentLibrary/src/components/Tab/index.tsx`

```typescript
import * as React from "react";
import Tab from "@mui/material/Tab";
import Box from "@mui/material/Box";
import { TabContext, TabList, TabPanel } from "@mui/lab";
import type { TabContent } from "../../interfaces";
import { useTheme } from "@mui/material";

interface TabsMUIProps {
  tabArray: TabContent[];
}
const TabsMUI = ({ tabArray }: TabsMUIProps) => {
  const [value, setValue] = React.useState("0");
  const theme = useTheme();

  const handleChange = (_event: React.SyntheticEvent, newValue: string) => {
    setValue(newValue);
  };

  return (
    <Box sx={{ width: "100%", height: "100%", backgroundColor: theme.palette.dynamicColor.contrastText }}>
      <TabContext value={value}>
        <Box sx={{ borderBottom: 1, borderColor: "divider" }}>
          <TabList
            onChange={handleChange}
            aria-label="lab API tabs example"
            textColor="primary"
            indicatorColor="primary"
            variant="scrollable"
            scrollButtons
            allowScrollButtonsMobile>
            {tabArray.map((tab, index) => (
              <Tab key={index} label={tab.title} value={`${index}`} />
            ))}
          </TabList>
        </Box>

        {tabArray.map((tab, index) => (
          <TabPanel key={index} value={`${index}`} sx={{ height: "100%" }}>
            {tab.children}
          </TabPanel>
        ))}
      </TabContext>
    </Box>
  );
};

export default TabsMUI;

```

## Archivo: `packages/ComponentLibrary/src/components/Table/Sidebar/SidebarContent.tsx`

```typescript
import { Box, Typography } from "@mui/material";
import ContentGrid from "./WidgetContent";
import { useStyle } from "../styles";
import RegisterModal from "../../RegisterModal";
import type { SidebarContentProps } from "./types";

export const SidebarContent: React.FC<SidebarContentProps> = ({ icon, identifier, title, widgets, translations }) => {
  const { sx } = useStyle();

  return (
    <Box sx={sx.sidebarContainer}>
      <Box sx={sx.headerContainer}>
        <Box sx={sx.iconContainer}>{icon}</Box>
        <Box>
          <Typography variant="body2" sx={sx.identifier}>
            {identifier}
          </Typography>
          <Typography variant="h5" sx={sx.title}>
            {title}
          </Typography>
        </Box>
      </Box>
      <Box ml={2.5}>
        <RegisterModal registerText={translations.register} translations={translations} />
      </Box>
      <ContentGrid widgets={widgets} />
    </Box>
  );
};

export default SidebarContent;

```

## Archivo: `packages/ComponentLibrary/src/components/Table/Sidebar/WidgetContent.tsx`

```typescript
import { Box, Grid, Typography } from "@mui/material";
import { useStyle } from "../styles";
import IconButton from "../../IconButton";
import InformationIcon from "../../../assets/icons/info.svg";
import type { ContentGridProps, Widget } from "@workspaceui/storybook/src/stories/Components/Table/types";

const WidgetComponent: React.FC<Widget> = ({
  title,
  icon,
  iconButtonAction,
  tooltip,
  color,
  bgcolor,
  children,
  iconBgColor,
}) => {
  const { sx } = useStyle();

  return (
    <Box sx={{ ...sx.widgetContainer, background: bgcolor, color: color }}>
      <Box sx={sx.widgetHeader}>
        <Box sx={sx.widgetHeaderLeft}>
          <Box
            sx={{
              ...sx.widgetHeaderIcon,
              background: iconBgColor ?? "transparent",
            }}>
            {icon}
          </Box>
          <Typography sx={{ ml: 1 }}>{title}</Typography>
        </Box>
        {iconButtonAction && (
          <IconButton tooltip={tooltip} onClick={iconButtonAction}>
            <InformationIcon />
          </IconButton>
        )}
      </Box>
      <Box sx={sx.widgetBox}>{children}</Box>
    </Box>
  );
};

const ContentGrid: React.FC<ContentGridProps> = ({ widgets }) => {
  const getGridSize = (size?: Widget["size"]) => (size === "full" ? 12 : 6);
  const { sx } = useStyle();

  return (
    <Box sx={sx.gridContainer}>
      <Grid container columnSpacing="0.75rem">
        {widgets.map((widget) => (
          <Grid item key={widget.id} xs={getGridSize(widget.size)}>
            <WidgetComponent {...widget} />
          </Grid>
        ))}
      </Grid>
    </Box>
  );
};

export default ContentGrid;

```

## Archivo: `packages/ComponentLibrary/src/components/Table/Sidebar/index.tsx`

```typescript
import SidebarContent from "./SidebarContent";
import type { SidebarProps } from "./types";

const Sidebar: React.FC<SidebarProps> = ({ isOpen, onClose, selectedItem, widgets, translations }) => {
  return (
    <div className={`sidebar ${isOpen && "open"}`}>
      <SidebarContent
        icon={selectedItem.icon}
        identifier={selectedItem.identifier ?? translations.noIdentifier}
        title={selectedItem.title ?? translations.noTitle}
        widgets={widgets}
        onClose={onClose}
        translations={translations}
      />
    </div>
  );
};

export default Sidebar;

```

## Archivo: `packages/ComponentLibrary/src/components/Table/Sidebar/types.ts`

```typescript
import type { Widget } from "@workspaceui/storybook/src/stories/Components/Table/types";
import type { Translations } from "../../RegisterModal/types";

export interface SidebarContentProps {
  icon: React.ReactNode;
  identifier: string | null;
  title: string | null;
  widgets: Widget[];
  onClose: () => void;
  translations: Translations;
}

export interface SidebarProps {
  isOpen: boolean;
  onClose: () => void;
  selectedItem: {
    icon: React.ReactNode;
    identifier: string | null;
    title: string | null;
  };
  widgets: Widget[];
  translations: Translations;
}

```

## Archivo: `packages/ComponentLibrary/src/components/Table/customExpandButton.tsx`

```typescript
import type React from "react";
import type { MRT_Row } from "material-react-table";
import IconButton from "../IconButton";
import ChevronDownIcon from "../../assets/icons/chevron-down.svg";
import ChevronUpIcon from "../../assets/icons/chevron-up.svg";
import ChevronRightIcon from "../../assets/icons/chevron-right.svg";
import type { Organization } from "@workspaceui/storybook/src/stories/Components/Table/types";

interface CustomExpandButtonProps {
  row: MRT_Row<Organization>;
}

const CustomExpandButton: React.FC<CustomExpandButtonProps> = ({ row }) => {
  const isExpanded = row.getIsExpanded();
  const canExpand = row.getCanExpand();

  if (!canExpand) {
    return (
      <IconButton disabled className="w-4 h-4">
        <ChevronRightIcon />
      </IconButton>
    );
  }

  return (
    <IconButton
      onClick={row.getToggleExpandedHandler()}
      tooltip={isExpanded ? "Collapse" : "Expand"}
      className="w-4 h-4">
      {isExpanded ? <ChevronUpIcon /> : <ChevronDownIcon />}
    </IconButton>
  );
};

export default CustomExpandButton;

```

## Archivo: `packages/ComponentLibrary/src/components/Table/index.tsx`

```typescript
import { getColumns } from "@workspaceui/storybook/src/stories/Components/Table/columns";
import type { OrganizationField, TableProps } from "@workspaceui/storybook/src/stories/Components/Table/types";
import { type MRT_Row, type MRT_TableOptions, MaterialReactTable, useMaterialReactTable } from "material-react-table";
import type React from "react";
import { useMemo } from "react";
import { useStyle } from "./styles";

type TableDataType = Record<string, unknown>;

export interface EnhancedTableProps extends TableProps {
  onRowClick: (row: MRT_Row<TableDataType>) => void;
  onRowDoubleClick: (row: MRT_Row<TableDataType>) => void;
}

const Table: React.FC<EnhancedTableProps> = ({ data = [], onRowClick, onRowDoubleClick }) => {
  const { sx } = useStyle();
  const columns = useMemo(() => getColumns(), []);

  const tableData = useMemo(() => {
    return data.map((item) => {
      const flatItem: TableDataType = {};
      for (const [key, field] of Object.entries(item)) {
        if ("value" in field && typeof field !== "function") {
          flatItem[key] = (field as OrganizationField & { value: unknown }).value;
        }
      }
      return flatItem;
    });
  }, [data]);

  const table = useMaterialReactTable({
    columns,
    data: tableData,
    enableTopToolbar: false,
    enableBottomToolbar: false,
    initialState: {
      density: "compact",
    },
    muiTableBodyRowProps: ({ row }) => ({
      onClick: () => onRowClick(row),
      onDoubleClick: () => onRowDoubleClick(row),
      sx: sx.tableBodyRow,
    }),
    muiTableBodyProps: {
      sx: sx.tableBody,
    },
    muiTableHeadCellProps: {
      sx: sx.tableHeadCell,
    },
    muiTableBodyCellProps: {
      sx: sx.tableBodyCell,
    },
    columnResizeMode: "onChange",
    // biome-ignore lint/suspicious/noExplicitAny: <explanation>
  } as MRT_TableOptions<any>);

  return <MaterialReactTable table={table} />;
};

export default Table;

```

## Archivo: `packages/ComponentLibrary/src/components/Table/styles.ts`

```typescript
import { type SxProps, type Theme, useTheme } from "@mui/material";
import { type CSSProperties, useMemo } from "react";

type StylesType = {
  styles: Record<string, CSSProperties>;
  sx: Record<string, SxProps<Theme>>;
};

export const useStyle = (): StylesType => {
  const theme = useTheme();

  return useMemo(
    () => ({
      styles: {
        iconContainer: {
          flexShrink: 0,
          height: "3rem",
          width: "3rem",
          display: "flex",
          alignItems: "center",
          justifyContent: "center",
        },
      },
      sx: {
        topToolbar: {
          display: "flex",
          justifyContent: "space-between",
          alignItems: "center",
          gap: "0.25rem",
        },
        tableBodyRow: {
          cursor: "pointer",
        },
        tableBody: {
          "& tr": {
            backgroundColor: theme.palette.background.paper,
          },
        },
        tableHeadCell: {
          whiteSpace: "nowrap",
          overflow: "hidden",
          textOverflow: "ellipsis",
          borderRight: `1px solid ${theme.palette.divider}`,
          "&:last-child": {
            borderRight: "none",
          },
          background: theme.palette.baselineColor.transparentNeutral[5],
          fontWeight: "bold",
          color: theme.palette.text.primary,
        },
        tableBodyCell: {
          borderRight: `1px solid ${theme.palette.divider}`,
        },
        link: {
          fontSize: "0.875rem",
          fontWeight: "500",
          lineHeight: "1rem",
          color: theme.palette.dynamicColor.main,
          textDecoration: "none",
          paddingRight: "0.5rem",
          cursor: "pointer",
          "&:hover": {
            textDecoration: "underline",
          },
        },
        leftSection: {
          background: theme.palette.baselineColor.neutral[0],
          display: "flex",
          padding: "0.25rem",
          gap: "0.25rem",
          borderRadius: "6.25rem",
        },
        newLineButton: {
          background: theme.palette.baselineColor.neutral[100],
          width: "9.375rem",
          borderRadius: "6.25rem",
          padding: "0.25rem 0 0.25rem 0.75rem",
          justifyContent: "flex-start",
          paddingLeft: "0.75rem",
          color: theme.palette.baselineColor.neutral[0],
          "&:hover": {
            border: "none",
            background: theme.palette.dynamicColor.main,
            borderRadius: "6.25rem",
          },
        },
        sidebarContainer: {
          display: "flex",
          flexDirection: "column",
        },
        recordContainer: {
          display: "flex",
          flexDirection: "column",
        },
        headerContainer: {
          display: "flex",
          justifyContent: "space-between",
          padding: "1rem",
          gap: 2,
        },
        recordHeader: {
          height: "2.75rem",
          display: "flex",
          justifyContent: "space-between",
          padding: "1rem",
          borderRadius: "1rem 1rem 0 0",
          background: theme.palette.baselineColor.transparentNeutral[5],
        },
        widgetContainer: {
          color: theme.palette.baselineColor.neutral[0],
          borderRadius: "1.5rem",
          padding: "1rem",
          maxHeight: "40rem",
          overflow: "auto",
          marginBottom: "1rem",
          display: "flex",
          gap: "0.75rem",
          flexDirection: "column",
          boxShadow: `0px 4px 10px 0px ${theme.palette.baselineColor.transparentNeutral[10]}`,
        },
        identifier: {
          color: theme.palette.baselineColor.transparentNeutral[70],
          fontWeight: 500,
        },
        title: {
          color: theme.palette.baselineColor.neutral[100],
          fontWeight: 600,
          fontSize: "1.25rem",
        },
        gridContainer: {
          padding: "0.75rem 1rem",
        },
        widgetHeader: {
          width: "100%",
          display: "flex",
          alignItems: "center",
          justifyContent: "space-between",
        },
        widgetBox: {
          borderRadius: "0.25rem",
          display: "flex",
          maxWidth: "100%",
          maxHeight: "100%",
          alignItems: "center",
          padding: "0.5rem",
        },
        widgetHeaderIcon: {
          width: "2rem",
          height: "2rem",
          padding: "0.25rem",
          borderRadius: "1rem",
          display: "flex",
          alignItems: "center",
          justifyContent: "center",
          flexWrap: "nowrap",
        },
        widgetHeaderLeft: {
          display: "flex",
          alignItems: "center",
        },
      },
    }),
    [theme]
  );
};

```

## Archivo: `packages/ComponentLibrary/src/components/Tag/index.tsx`

```typescript
import type React from "react";
import { Chip as MuiChip } from "@mui/material";
import { useStyle } from "./styles";
import type { TagProps } from "./types";

const Tag: React.FC<TagProps> = ({ type, label, icon, onClick }) => {
  const styles = useStyle();
  const coloredIcon = icon && styles.getColoredIcon(icon, type);

  return (
    <MuiChip
      icon={coloredIcon}
      label={label}
      onClick={onClick}
      variant="outlined"
      style={styles.getChipStyles(type)}
      sx={styles.sx.chipLabel(icon)}
    />
  );
};

export default Tag;

```

## Archivo: `packages/ComponentLibrary/src/components/Tag/styles.ts`

```typescript
import React, { type CSSProperties, type ReactElement, useMemo } from "react";
import { type Theme, useTheme, type SxProps } from "@mui/material";
import type { TagType } from "./types";

type StylesType = {
  getColor: (type: TagType) => string;
  getTextColor: (type: TagType) => string;
  getColoredIcon: (icon: ReactElement, type: TagType) => ReactElement;
  getChipStyles: (type: TagType) => CSSProperties;
  sx: {
    chipLabel: (icon?: ReactElement) => SxProps<Theme>;
  };
};

export const useStyle = (): StylesType => {
  const theme = useTheme();
  const self = useMemo(
    () => ({
      getColor: (type: TagType): string => {
        switch (type) {
          case "primary":
            return theme.palette.dynamicColor.main;
          case "success":
            return theme.palette.specificColor.success.main;
          case "warning":
            return theme.palette.specificColor.warning.main;
          case "error":
            return theme.palette.specificColor.error.main;
          case "draft":
            return theme.palette.specificColor.draft.contrastText;
          default:
            return theme.palette.dynamicColor.main;
        }
      },
      getTextColor: (type: TagType): string => {
        switch (type) {
          case "primary":
          case "success":
          case "error":
            return theme.palette.dynamicColor.contrastText;
          case "warning":
          case "draft":
            return theme.palette.baselineColor.neutral[100];
          default:
            return theme.palette.dynamicColor.contrastText;
        }
      },
      getChipStyles: (type: TagType): CSSProperties => ({
        backgroundColor: self.getColor(type),
        color: self.getTextColor(type),
        height: "1.5rem",
        fontWeight: 500,
        cursor: "default",
        padding: "0 0.5rem",
        fontFamily: "Inter, sans-serif",
        border: "none",
      }),
      sx: {
        chipLabel: (icon?: ReactElement): SxProps<Theme> => ({
          "& .MuiChip-label": {
            fontFamily: "Inter",
            fontWeight: 500,
            fontSize: "0.875rem",
            lineHeight: "1.25rem",
            padding: "0",
            margin: "0",
            paddingLeft: icon ? "0.25rem" : "0",
          },
        }),
      },
    }),
    [theme]
  );

  const getColoredIcon = (icon: ReactElement, type: TagType): ReactElement => {
    return React.cloneElement(icon, {
      style: {
        ...icon.props.style,
        color: self.getTextColor(type),
        width: "1rem",
        height: "1rem",
        margin: "0",
        padding: "0",
      },
    });
  };

  return {
    ...self,
    getColoredIcon,
  };
};

```

## Archivo: `packages/ComponentLibrary/src/components/Tag/types.ts`

```typescript
import type { ChipProps as MuiChipProps } from "@mui/material";

export type TagType = "success" | "warning" | "error" | "draft" | "primary";

export interface TagProps extends MuiChipProps {
  type: TagType;
  label: string;
  icon?: React.ReactElement;
}

```

## Archivo: `packages/ComponentLibrary/src/components/ThemeProvider/index.tsx`

```typescript
import { ThemeProvider as MUIThemeProvider, CssBaseline } from "@mui/material";
import { theme } from "../../theme";

export default function ThemeProvider({ children }: React.PropsWithChildren) {
  return (
    <MUIThemeProvider theme={theme}>
      <CssBaseline />
      {children}
    </MUIThemeProvider>
  );
}

```

## Archivo: `packages/ComponentLibrary/src/components/Toggle/ToggleChip.tsx`

```typescript
import type React from "react";
import Switch from "@mui/material/Switch";
import { useStyle } from "./styles";
import type { ToggleChipProps } from "./types";

const ToggleChip: React.FC<ToggleChipProps> = ({ isActive, onToggle }) => {
  const { sx } = useStyle();

  return <Switch checked={isActive} onChange={onToggle} sx={sx.switch} />;
};

export default ToggleChip;

```

## Archivo: `packages/ComponentLibrary/src/components/Toggle/styles.ts`

```typescript
import { type SxProps, type Theme, useTheme } from "@mui/material";
import { useMemo } from "react";

type StylesType = {
  sx: Record<string, SxProps<Theme>>;
};

export const useStyle = (): StylesType => {
  const theme = useTheme();

  return useMemo(
    () => ({
      sx: {
        switch: {
          width: "2.5rem",
          height: "1.25rem",
          padding: 0,
          "& .MuiSwitch-switchBase": {
            padding: 0,
            margin: "0.125rem",
            transitionDuration: "300ms",
            "&.Mui-checked": {
              transform: "translateX(1.25rem)",
              color: theme.palette.baselineColor.neutral[0],
              "& + .MuiSwitch-track": {
                backgroundColor:
                  theme.palette.mode === "dark"
                    ? theme.palette.specificColor.warning
                    : theme.palette.baselineColor.neutral[80],
                opacity: 1,
                border: 0,
              },
              "&.Mui-disabled + .MuiSwitch-track": {
                opacity: 0.5,
              },
            },
            "&.Mui-focusVisible .MuiSwitch-thumb": {
              color: theme.palette.specificColor.warning,
              border: `0.375rem solid ${theme.palette.baselineColor.neutral[0]}`,
            },
            "&.Mui-disabled .MuiSwitch-thumb": {
              color: theme.palette.mode === "light" ? theme.palette.grey[100] : theme.palette.grey[600],
            },
            "&.Mui-disabled + .MuiSwitch-track": {
              opacity: theme.palette.mode === "light" ? 0.7 : 0.3,
            },
          },
          "& .MuiSwitch-thumb": {
            boxSizing: "border-box",
            width: "1rem",
            height: "1rem",
            boxShadow: "none",
          },
          "& .MuiSwitch-track": {
            borderRadius: "1.625rem",
            backgroundColor:
              theme.palette.mode === "light"
                ? theme.palette.baselineColor.neutral[30]
                : theme.palette.specificColor.draft.contrastText,
            opacity: 1,
            transition: theme.transitions.create(["background-color"], {
              duration: 500,
            }),
          },
        },
      },
    }),
    [theme]
  );
};

```

## Archivo: `packages/ComponentLibrary/src/components/Toggle/types.ts`

```typescript
import type { SwitchProps } from "@mui/material";

export interface ToggleChipProps extends SwitchProps {
  isActive: boolean | undefined;
  onToggle: () => void;
}

```

## Archivo: `packages/ComponentLibrary/src/components/Tooltip/index.tsx`

```typescript
import { useRef, useState, useEffect } from "react";
import ReactDOM from "react-dom";

const DEFAULT_MARGIN = 8;
const SHOW_DELAY = 600;

export interface TooltipProps {
  title?: string;
  children: React.ReactNode;
  position?: "top" | "bottom" | "left" | "right";
  containerClassName?: string;
}

const Tooltip: React.FC<TooltipProps> = ({ title, children, position = "bottom", containerClassName }) => {
  const [visible, setVisible] = useState(false);
  const [coords, setCoords] = useState<{ top: number; left: number } | null>(null);

  const wrapperRef = useRef<HTMLDivElement>(null);
  const tooltipRef = useRef<HTMLDivElement>(null);
  const showTimer = useRef<number | null>(null);

  useEffect(() => {
    if (!visible || !wrapperRef.current || !tooltipRef.current) return;

    const triggerRect = wrapperRef.current.getBoundingClientRect();
    const tooltipRect = tooltipRef.current.getBoundingClientRect();

    let top: number | null = null;
    let left: number | null = null;

    switch (position) {
      case "top":
        top = triggerRect.top - tooltipRect.height - DEFAULT_MARGIN;
        left = triggerRect.left + triggerRect.width / 2 - tooltipRect.width / 2;
        break;
      case "bottom":
        top = triggerRect.bottom + DEFAULT_MARGIN;
        left = triggerRect.left + triggerRect.width / 2 - tooltipRect.width / 2;
        break;
      case "left":
        top = triggerRect.top + triggerRect.height / 2 - tooltipRect.height / 2;
        left = triggerRect.left - tooltipRect.width - DEFAULT_MARGIN;
        break;
      case "right":
        top = triggerRect.top + triggerRect.height / 2 - tooltipRect.height / 2;
        left = triggerRect.right + DEFAULT_MARGIN;
        break;
    }

    setCoords({ top, left });
  }, [visible, position]);

  useEffect(() => {
    return () => {
      if (showTimer.current) {
        clearTimeout(showTimer.current);
      }
    };
  }, []);

  const showTooltip = () => {
    if (showTimer.current) clearTimeout(showTimer.current);
    showTimer.current = window.setTimeout(() => {
      setVisible(true);
    }, SHOW_DELAY);
  };

  const hideTooltip = () => {
    if (showTimer.current) {
      clearTimeout(showTimer.current);
      showTimer.current = null;
    }
    setVisible(false);
  };

  const getArrowStyles = () => {
    const base = "absolute w-2 h-2 rotate-45 bg-gray-900";

    switch (position) {
      case "top":
        return `${base} bottom-[-4px] left-1/2 -translate-x-1/2`;
      case "bottom":
        return `${base} top-[-4px] left-1/2 -translate-x-1/2`;
      case "left":
        return `${base} right-[-4px] top-1/2 -translate-y-1/2`;
      case "right":
        return `${base} left-[-4px] top-1/2 -translate-y-1/2`;
    }
  };

  if (!title) return <>{children}</>;

  return (
    <div
      ref={wrapperRef}
      className={`relative group ${containerClassName ?? ""}`}
      onMouseEnter={showTooltip}
      onMouseLeave={hideTooltip}>
      {children}
      {visible &&
        ReactDOM.createPortal(
          <div
            ref={tooltipRef}
            role="tooltip"
            style={{
              top: coords?.top,
              left: coords?.left,
              visibility: coords?.top != null && coords?.left != null ? "visible" : "hidden",
            }}
            className="fixed z-[1000] opacity-100 transition-opacity duration-100 pointer-events-none">
            <div className="relative">
              <div className={getArrowStyles()} />
              <div className="bg-gray-900 text-white text-sm rounded px-2 py-1 shadow-md whitespace-nowrap">
                {title}
              </div>
            </div>
          </div>,
          document.body
        )}
    </div>
  );
};

export default Tooltip;

```

## Archivo: `packages/ComponentLibrary/src/components/Waterfall/WaterfallModal.tsx`

```typescript
"use client";

import { Box, Button, List, MenuItem, styled, useTheme } from "@mui/material";
import { useCallback, useState } from "react";
import NavigateNext from "../../assets/icons/chevron-right.svg";
import Edit from "../../assets/icons/edit.svg";
import DragModalContent from "../DragModal/DragModalContent";
import IconButton from "../IconButton";
import Menu from "../Menu";
import ModalDivider from "../ModalDivider";
import { useStyle } from "./styles";
import type { WaterfallModalProps } from "./types";

const WaterfallDropdown: React.FC<WaterfallModalProps> = ({
  menuItems,
  items,
  setItems,
  backButtonText,
  activateAllText,
  deactivateAllText,
  buttonText,
  customizeText,
  tooltipWaterfallButton,
  icon,
}) => {
  const FadeWrapper = styled("div")({
    transition: "opacity 0.2s ease-in-out",
    opacity: 1,
    "&.fade-out": {
      opacity: 0,
    },
  });

  const theme = useTheme();
  const { sx, styles } = useStyle();
  const [showDragModal, setShowDragModal] = useState(false);
  const [fade, setFade] = useState(false);
  const [anchorEl, setAnchorEl] = useState<HTMLElement | null>(null);

  const handleClick = useCallback((event: React.MouseEvent<HTMLButtonElement>) => {
    setAnchorEl(event.currentTarget);
  }, []);

  const handleClose = () => {
    setAnchorEl(null);
    setShowDragModal(false);
  };

  const handleOpenDragModal = () => {
    setFade(true);
    setTimeout(() => {
      setShowDragModal(true);
      setFade(false);
    }, 200);
  };

  const handleBack = () => {
    setFade(true);
    setTimeout(() => {
      setShowDragModal(false);
      setFade(false);
    }, 200);
  };

  return (
    <>
      <IconButton tooltip={tooltipWaterfallButton} onClick={handleClick} className="w-10 h-10" disabled={true}>
        {icon}
      </IconButton>
      <Menu anchorEl={anchorEl} onClose={handleClose}>
        <FadeWrapper className={fade ? "fade-out" : ""}>
          {!showDragModal ? (
            <>
              <List>
                {menuItems.map((item, index) => (
                  <MenuItem
                    key={item.key}
                    sx={{
                      ...sx.menuItemStyles,
                      marginBottom: index !== menuItems.length - 1 ? "0.5rem" : "0",
                    }}>
                    <span style={styles.SpanStyles}>{item.emoji}</span>
                    <span>{item.label}</span>
                  </MenuItem>
                ))}
              </List>
              <ModalDivider />
              <div style={styles.SectionContainer}>
                <Box sx={sx.headerBox}>
                  <Button
                    onClick={handleOpenDragModal}
                    sx={sx.customizeButton}
                    startIcon={<Edit fill={theme.palette.baselineColor.neutral[60]} style={styles.StartIconStyles} />}>
                    {customizeText}
                    <NavigateNext fill={theme.palette.baselineColor.neutral[60]} style={styles.EndIconStyles} />
                  </Button>
                </Box>
              </div>
            </>
          ) : (
            <DragModalContent
              items={items}
              setItems={setItems}
              onBack={handleBack}
              backButtonText={backButtonText}
              activateAllText={activateAllText}
              deactivateAllText={deactivateAllText}
              buttonText={buttonText}
            />
          )}
        </FadeWrapper>
      </Menu>
    </>
  );
};

export default WaterfallDropdown;

```

## Archivo: `packages/ComponentLibrary/src/components/Waterfall/styles.ts`

```typescript
import { type SxProps, type Theme, useTheme } from "@mui/material";
import { type CSSProperties, useMemo } from "react";

export const menuSyle = { paddingY: 0 };

export const useStyle = () => {
  const theme = useTheme();

  return useMemo(
    () => ({
      styles: {
        SectionContainer: {
          padding: "0.5rem",
        },
        StartIconStyles: {
          marginLeft: "0.5rem",
          maxHeight: "1rem",
          maxWidth: "1rem",
        },
        EndIconStyles: {
          position: "absolute",
          right: "0",
          marginRight: "0.5rem",
        },
        SpanStyles: {
          paddingRight: "0.5rem",
        },
        paperStyleMenu: {
          borderRadius: "0.75rem",
        },
      } as { [key: string]: CSSProperties },
      sx: {
        menuItemStyles: {
          margin: "0 0.5rem",
          padding: "0.5rem",
          "&:hover": {
            borderRadius: "0.5rem",
            background: theme.palette.dynamicColor.contrastText,
          },
        },
        customizeButton: {
          fontWeight: "500",
          fontSize: "1rem",
          width: "100%",
          height: "2.25rem",
          borderRadius: "0.5rem",
          display: "flex",
          justifyContent: "flex-start",
          alignItems: "center",
          position: "relative",
          "&:hover": {
            border: "none",
            color: theme.palette.baselineColor.neutral[80],
          },
        },
        headerBox: {
          "&:hover": {
            background: theme.palette.dynamicColor.contrastText,
            borderRadius: "0.5rem",
          },
        },
      } as { [key: string]: SxProps<Theme> },
    }),
    [theme]
  );
};

```

## Archivo: `packages/ComponentLibrary/src/components/Waterfall/types.tsx`

```typescript
import type { UniqueIdentifier } from "@dnd-kit/core";
import type { ToggleableItem, Item } from "../DragModal/DragModal.types";
import type { ReactNode } from "react";

export interface WaterfallModalProps<T extends ToggleableItem = Item> {
  menuItems: { emoji: string; label: string; key: string }[];
  items: T[];
  setItems: React.Dispatch<React.SetStateAction<T[]>>;
  onBack?: () => void;
  onToggleAll?: () => void;
  onToggle?: (id: UniqueIdentifier) => void;
  backButtonText?: string;
  activateAllText?: string;
  deactivateAllText?: string;
  customizeText?: string;
  buttonText?: string;
  tooltipWaterfallButton?: string;
  icon?: string | ReactNode;
}

```

## Archivo: `packages/ComponentLibrary/src/components/Widgets/TabWidget.tsx`

```typescript
import { Box, Typography } from "@mui/material";
import { useStyle } from "./styles";
import type { TabWidgetProps } from "./types";

const TabWidget: React.FC<TabWidgetProps> = ({ title, content, noRecordText }) => {
  const { sx } = useStyle();

  if (!content) {
    return <Typography variant="h5">{noRecordText}</Typography>;
  }

  return (
    <Box sx={sx.mainContainer}>
      <Box flexGrow={1} overflow="auto" p={2}>
        <Typography variant="h5" fontWeight="medium" mb={2}>
          {title}
        </Typography>
        <Box>{content}</Box>
      </Box>
    </Box>
  );
};

export default TabWidget;

```

## Archivo: `packages/ComponentLibrary/src/components/Widgets/styles.ts`

```typescript
import { type SxProps, type Theme, useTheme } from "@mui/material";
import { type CSSProperties, useMemo } from "react";

export const gridSizes = { xs: 12, sm: 1, md: 12 };
export const dotIntervals = 0;

export const useStyle = () => {
  const theme = useTheme();

  return useMemo(
    () => ({
      styles: {
        buttonContainerStyles: {
          display: "flex",
          padding: "0rem 0.75rem 0.75rem 0.75rem",
          justifyContent: "flex-end",
          alignItems: "center",
          gap: "0.5rem",
          flex: "1 0 0",
        },
      } as { [key: string]: CSSProperties },
      sx: {
        mainContainer: {
          diplay: "flex",
          flexDirection: "column",
          heigh: "100%",
          width: "100%",
        },
        editButtonStyles: {
          fontWeight: "600",
          width: "100%",
          fontSize: "0.875rem",
          color: theme.palette.baselineColor.neutral[0],
          padding: "0.5rem 1rem",
          background: theme.palette.baselineColor.neutral[100],
          borderRadius: "6.25rem",
          border: `1px solid ${theme.palette.baselineColor.transparentNeutral[80]}`,
          height: "2.5rem",
          "&:hover": {
            borderRadius: "6.25rem",
            background: theme.palette.dynamicColor.main,
            color: theme.palette.baselineColor.neutral[0],
          },
        },
        saveButtonStyles: {
          fontWeight: "600",
          fontSize: "0.875rem",
          color: theme.palette.baselineColor.neutral[0],
          padding: "0.5rem 1rem",
          background: theme.palette.baselineColor.neutral[100],
          flex: "1 0 0",
          borderRadius: "6.25rem",
          border: `1px solid ${theme.palette.baselineColor.transparentNeutral[80]}`,
          height: "2.5rem",
          "&:hover": {
            borderRadius: "6.25rem",
            background: theme.palette.dynamicColor.main,
            color: theme.palette.baselineColor.neutral[0],
          },
        },
        cancelbuttonStyles: {
          fontWeight: "600",
          fontSize: "0.875rem",
          padding: "0.5rem 1rem",
          cursor: "pointer",
          height: "2.5rem",
          borderRadius: "6.25rem",
          border: `1px solid ${theme.palette.baselineColor.transparentNeutral[20]}`,
          flex: "1 0 0",
          color: theme.palette.baselineColor.transparentNeutral[70],
          background: theme.palette.baselineColor.neutral[0],
          "&:hover": {
            borderRadius: "6.25rem",
            background: theme.palette.dynamicColor.main,
            color: theme.palette.baselineColor.neutral[0],
          },
        },
      } as { [key: string]: SxProps<Theme> },
    }),
    [theme]
  );
};

```

## Archivo: `packages/ComponentLibrary/src/components/Widgets/types.ts`

```typescript
export interface TabWidgetProps {
  title: string;
  content: React.ReactNode;
  noRecordText: string;
}

```

## Archivo: `packages/ComponentLibrary/src/components/enums/index.ts`

```typescript
enum Container {
  Auto = "auto",
}

enum Position {
  Center = "center",
  Top = "top",
  Bottom = "bottom",
  Left = "left",
  Right = "right",
}

enum Item {
  Role = "Role",
  Client = "Client",
  Organization = "Organization",
  Warehouse = "Warehouse",
  Language = "Language",
}

export { Container, Position, Item };

```

## Archivo: `packages/ComponentLibrary/src/components/index.ts`

```typescript
import ModalCustom from "./BasicModal";
import TextInputMUI from "./Input/TextInput/TextInputAutocomplete";
import SearchInputWithVoiceMUI from "./Input/TextInput/TextInputAutocomplete/SearchInputWithVoice";
import TextInputBaseMUI from "./Input/TextInput/TextInputBase";
import InputPasswordMUI from "./Input/TextInput/TextInputBase/InputPassword";
import ToggleChipMUI from "./Toggle/ToggleChip";
import Nav from "./Nav/Nav";
import ProfileModal from "@workspaceui/mainui/components/ProfileModal/ProfileModal";
import WaterfallModal from "./Waterfall/WaterfallModal";
import ConfigurationModalCustom from "./ConfigurationModal";
import NotificationBase from "./NotificationsButton";
import NotificationModalCustom from "./NotificationsModal";
import TagMUI from "./Tag";
import SecondaryTabsMUI from "./SecondaryTabs";
import NotificationItemStates from "./NotificationItemAllStates";
import DrawerMUI from "./Drawer";
import IconButtonCustom from "./IconButton";
import CopilotButtonCustom from "./Copilot/CopilotButton";
import CopilotPopupCustom from "./Copilot/CopilotPopup";
import RadioGridCustom from "./RadioGrid";

const Modal = ModalCustom;
const TextInput = TextInputMUI;
const TextInputBase = TextInputBaseMUI;
const InputPassword = InputPasswordMUI;
const SearchInputWithVoice = SearchInputWithVoiceMUI;
const ToggleChip = ToggleChipMUI;
const Navbar = Nav;
const Profile = ProfileModal;
const Waterfall = WaterfallModal;
const ConfigurationModal = ConfigurationModalCustom;
const NotificationButton = NotificationBase;
const NotificationModal = NotificationModalCustom;
const Tag = TagMUI;
const SecondaryTabs = SecondaryTabsMUI;
const NotificationStates = NotificationItemStates;
const Drawer = DrawerMUI;
const IconButton = IconButtonCustom;
const CopilotButton = CopilotButtonCustom;
const CopilotPopup = CopilotPopupCustom;
const RadioGrid = RadioGridCustom;

export {
  Modal,
  TextInput,
  TextInputBase,
  InputPassword,
  SearchInputWithVoice,
  ToggleChip,
  Navbar,
  Profile,
  Waterfall,
  ConfigurationModal,
  NotificationButton,
  NotificationModal,
  Tag,
  SecondaryTabs,
  NotificationStates,
  Drawer,
  IconButton,
  CopilotButton,
  CopilotPopup,
  RadioGrid,
};

// Export Copilot constants from api-client
export { MESSAGE_ROLES, CONTEXT_CONSTANTS } from "@workspaceui/api-client/src/api/copilot";
export type { MessageRole } from "@workspaceui/api-client/src/api/copilot";

```

## Archivo: `packages/ComponentLibrary/src/helpers/caltulatePositions.ts`

```typescript
import { Position } from "../components/enums";

export const calculateTop = (posY: string | number): number | string => {
  if (posY === Position.Center) return "50%";
  if (posY === Position.Bottom) return "65%";
  if (posY === Position.Top) return "5%";
  return posY;
};

export const calculateLeft = (posX: string | number): number | string => {
  if (posX === Position.Center) return "50%";
  if (posX === Position.Left) return "5%";
  if (posX === Position.Right) return "75%";
  return posX;
};

```

## Archivo: `packages/ComponentLibrary/src/helpers/className.ts`

```typescript
type ClassName = string | null | undefined;
type ClassNames = ClassName[];

export default function className(...args: ClassNames) {
  return args
    .reduce((acum: string, current) => {
      if (typeof current === "string") {
        acum = `${acum} ${current}`;
      }

      return acum;
    }, "")
    .trim();
}

```

## Archivo: `packages/ComponentLibrary/src/helpers/ensureString.ts`

```typescript
// biome-ignore lint/suspicious/noExplicitAny: <explanation>
export function ensureString(value: any): string {
  if (typeof value === "string") {
    return value;
  }
  if (typeof value === "number" || typeof value === "boolean") {
    return value.toString();
  }
  return "";
}

```

## Archivo: `packages/ComponentLibrary/src/helpers/updateModal.ts`

```typescript
import { Container } from "../components/enums";
import { calculateTransform } from "../utils/transformUtil";
import { calculateTop, calculateLeft } from "./caltulatePositions";

interface ModalStyleProps {
  height: string | number;
  width: string | number;
  posX: string | number;
  posY: string | number;
}

export const calculateModalStyles = ({ height, width, posX, posY }: ModalStyleProps) => {
  return {
    height: height === Container.Auto ? "auto" : `${height}px`,
    width: width === Container.Auto ? "auto" : `${width}px`,
    top: calculateTop(posY),
    left: calculateLeft(posX),
    transform: calculateTransform(posX, posY),
  };
};

```

## Archivo: `packages/ComponentLibrary/src/hooks/types.ts`

```typescript
import type { Menu } from "@workspaceui/api-client/src/api/types";
import type { RecentItem } from "../components/Drawer/types";

export interface UseRecentItemsReturn {
  localRecentItems: RecentItem[];
  isExpanded: boolean;
  setIsExpanded: (value: boolean) => void;
  handleItemClick: (path: string) => void;
  handleToggleExpand: () => void;
  hasItems: boolean;
  resetManualToggle: () => void;
}

export interface UseItemActionsProps {
  onWindowClick?: (item: Menu) => void;
  onReportClick?: (item: Menu) => void;
  onProcessClick?: (item: Menu) => void;
}

```

## Archivo: `packages/ComponentLibrary/src/hooks/useAssistants.ts`

```typescript

```

## Archivo: `packages/ComponentLibrary/src/hooks/useCopilot.ts`

```typescript

```

## Archivo: `packages/ComponentLibrary/src/hooks/useEventListeners.ts`

```typescript
import { useEffect } from "react";

/**
 * Hook to detect clicks outside of a specified element.
 * Calls the provided handler when a click happens outside the referenced element.
 *
 * @param {React.RefObject<HTMLElement>} ref - React ref object pointing to the element.
 * @param {(event: MouseEvent) => void} handler - Callback function to run on outside click.
 */
export function useClickOutside(ref: React.RefObject<HTMLElement>, handler: (event: MouseEvent) => void) {
  useEffect(() => {
    const listener = (event: MouseEvent) => {
      const target = event.target as Node;
      // Ignore if click is inside the ref element or if ref contains the focused element
      if (!ref.current || ref.current.contains(target)) return;
      if (ref.current.contains(document.activeElement)) return;
      handler(event);
    };
    document.addEventListener("mousedown", listener);
    return () => document.removeEventListener("mousedown", listener);
  }, [ref, handler]);
}

/**
 * Hook to detect when the Escape key is pressed.
 * Calls the provided handler when the Escape key is detected.
 *
 * @param {(event: KeyboardEvent) => void} handler - Callback function to run on Escape key press.
 */
export function useEscapeKey(handler: (event: KeyboardEvent) => void) {
  useEffect(() => {
    const listener = (event: KeyboardEvent) => {
      if (event.key === "Escape" || event.key === "Esc") {
        handler(event);
      }
    };
    window.addEventListener("keydown", listener);
    return () => window.removeEventListener("keydown", listener);
  }, [handler]);
}

/**
 * Hook to execute a handler function whenever the window is resized.
 *
 * @param {() => void} handler - Callback function to run on window resize.
 */
export function useWindowResize(handler: () => void) {
  useEffect(() => {
    window.addEventListener("resize", handler);
    return () => window.removeEventListener("resize", handler);
  }, [handler]);
}

```

## Archivo: `packages/ComponentLibrary/src/hooks/useItemType.ts`

```typescript
import { useCallback } from "react";
import type { Menu } from "@workspaceui/api-client/src/api/types";
import type { UseItemActionsProps } from "./types";

export const useItemActions = ({ onWindowClick, onReportClick, onProcessClick }: UseItemActionsProps) => {
  const handleItemClick = useCallback(
    (item: Menu) => {
      const validType = ["Window", "Report", "ProcessDefinition"].includes(item.type || "");
      if (!validType) {
        console.warn(`Invalid item type: ${item.type}, defaulting to Window`);
        if (item.windowId && onWindowClick) {
          onWindowClick(item);
        }
        return;
      }

      switch (item.type) {
        case "Window":
          if (item.windowId && onWindowClick) {
            onWindowClick(item);
          }
          break;
        case "Report":
          if (item.id && onReportClick) {
            onReportClick(item);
          }
          break;
        case "ProcessDefinition":
          if (item.id && onProcessClick) {
            onProcessClick(item);
          }
          break;
        default:
          console.warn(`Unhandled item type: ${item.type}`);
      }
    },
    [onWindowClick, onReportClick, onProcessClick]
  );

  return handleItemClick;
};

```

## Archivo: `packages/ComponentLibrary/src/hooks/useLocalStorage.ts`

```typescript
import { useCallback, useEffect, useState } from "react";

const isBrowser = typeof window !== "undefined";

const getStoredValue = <T>(key: string, initialValue: T | (() => T)): T => {
  if (!isBrowser) {
    return typeof initialValue === "function" ? (initialValue as () => T)() : initialValue;
  }

  try {
    const storedValue = window.localStorage.getItem(key);
    if (storedValue !== null) {
      return JSON.parse(storedValue) as T;
    }
  } catch (error) {
    console.warn(`Error reading localStorage key "${key}":`, error);
  }

  return typeof initialValue === "function" ? (initialValue as () => T)() : initialValue;
};

const useLocalStorage = <T>(key: string, initialValue: T | (() => T)) => {
  const [state, setState] = useState<T>(() => getStoredValue(key, initialValue));

  const setValue = useCallback(
    (value: T | ((prevState: T) => T)) => {
      setState((prevState) => {
        const newValue = typeof value === "function" ? (value as (prev: T) => T)(prevState) : value;

        if (isBrowser) {
          try {
            if (newValue === undefined) {
              window.localStorage.removeItem(key);
            } else {
              window.localStorage.setItem(key, JSON.stringify(newValue));
            }
          } catch (error) {
            console.warn(`Error setting localStorage key "${key}":`, error);
          }
        }

        return newValue;
      });
    },
    [key]
  );

  useEffect(() => {
    if (!isBrowser) return;

    try {
      const storedValue = window.localStorage.getItem(key);
      if (storedValue !== null) {
        setState(JSON.parse(storedValue));
      }
    } catch (error) {
      console.warn(`Error syncing localStorage key "${key}":`, error);
    }
  }, [key]);

  return [state, setValue] as const;
};

export default useLocalStorage;

export { useLocalStorage };

```

## Archivo: `packages/ComponentLibrary/src/hooks/useSSEConnection.ts`

```typescript

```

## Archivo: `packages/ComponentLibrary/src/hooks/useThrottle.ts`

```typescript
import { useCallback, useRef } from "react";

export function useThrottle<T extends (...args: never[]) => unknown>(
  func: T,
  delay: number
): (...args: Parameters<T>) => void {
  const lastCall = useRef(0);

  return useCallback(
    (...args: Parameters<T>) => {
      const now = Date.now();
      if (now - lastCall.current >= delay) {
        lastCall.current = now;
        func(...args);
      }
    },
    [delay, func]
  );
}

```

## Archivo: `packages/ComponentLibrary/src/index.ts`

```typescript
export * from "./theme";
export * from "./components";

```

## Archivo: `packages/ComponentLibrary/src/interfaces/index.ts`

```typescript
import type { ReactNode } from "react";

export interface TabContent {
  children?: ReactNode;
  title: string;
}

```

## Archivo: `packages/ComponentLibrary/src/locales/en.ts`

```typescript
const en = {
  plural_suffix: "s",
  common: {
    etendo: "Etendo",
    cancel: "Cancel",
    confirm: "Confirm",
    close: "Close",
    closing: "Closing...",
    execute: "Execute",
    register: "Register",
    save: "Save",
    edit: "Edit",
    loading: "Loading...",
    loadingFormData: "Loading form data...",
    loadingWindowContent: "Loading window content...",
    retry: "Retry",
    processes: "Available Process",
    clear: "Clear Selection",
    processTitle: "Title of the process",
    notImplemented: "This feature is not implemented yet",
    loadMore: "Load More",
    trueText: "Yes",
    falseText: "No",
    noDataAvailable: "No data available",
    record: "record",
    records: "records",
  },
  forms: {
    sections: {
      main: "Main Section",
      audit: "Audit",
    },
    statusBar: {
      closeRecord: "Close Record",
    },
  },
  audit: {
    createdDate: "Creation Date",
    createdBy: "Created By",
    updated: "Updated",
    updatedBy: "Updated By",
  },
  status: {
    deleteSuccess: "has been deleted successfully",
    deleteError: "Error deleting record",
    deleteConfirmation: "Are you sure you want to delete",
    multipleDeleteConfirmation: "Are you sure you want to delete the selected",
    selectRecordError: "Please select a record first",
    saveSuccess: "{{entityType}} has been saved successfully",
    saveError: "Error saving record",
    noIdError: "Cannot delete a record without ID",
    noEntityError: "No entity has been specified",
    httpError: "HTTP Error: ",
    noRecordsError: "There is no records selected",
    noRecords: "Please create a new record",
  },
  errors: {
    tableError: {
      title: "Error",
      description: "Something went wrong",
    },
    networkError: {
      title: "Could not connect to Etendo",
      description: "Looks like there is a network issue or server is down",
    },
    notFound: {
      title: "Not found",
      description: "We couldn't find the page you're looking for",
    },
    internalServerError: {
      title: "Something went wrong",
      retry: "Retry",
    },
    missingRecord: {
      title: "Record Not Found",
      description: "The requested record could not be found",
    },
    missingData: {
      title: "Data Not Found",
      description: "The requested data could not be found",
    },
    missingMetadata: {
      title: "Missing Metadata",
      description: "Required window metadata is not available",
    },
    formData: {
      title: "Error Loading Form",
      description: "There was an error loading the form data",
    },
    adaptingData: {
      title: "Error Processing Data",
      description: "There was an error processing the form data",
    },
    selectionError: {
      title: "No parent record selected",
      description: "Select a record in the parent tab to view related data",
    },
    windowNotFound: {
      title: "Window Not Found",
      description: "The requested window could not be found",
    },
  },
  modal: {
    secondaryButtonLabel: "Back",
  },
  registerModal: {
    descriptionText: "Confirm your shipment and save it in the system. 📝📦",
  },
  table: {
    tooltips: {
      search: "Search",
      views: "Views",
      filter: "Filter",
      columns: "Columns",
      openSidebar: "Open Sidebar",
      closeSidebar: "Close Sidebar",
      details: "Details",
      refresh: "Refresh",
      implicitFilterOn: "Filters applied. Click to remove filters",
      implicitFilterOff: "Filters deactivated. Click to apply filters",
    },
    selection: {
      single: "Element selected",
      multiple: "Elements selected",
    },
    placeholders: {
      search: "Search...",
    },
    labels: {
      noIdentifier: "No item selected",
      noTitle: "No title",
      noType: "No type",
      noRecord: "No Row Selected",
      emptyRecords: "No records to show",
    },
    content: {
      currentTitle: "Its revenue is expected to increase later this year. Congratulations",
    },
  },
  navigation: {
    common: {
      home: "Home",
      back: "Back",
    },
    waterfall: {
      activateAll: "Activate all",
      deactivateAll: "Deactivate all",
      tooltipButton: "Waterfall Tooltip",
      buttons: "Buttons",
      customize: "Customize",
    },
    configurationModal: {
      tooltipButtonProfile: "Settings",
    },
    activityButton: {
      tooltip: "Activity",
    },
    notificationModal: {
      title: "Notifications",
      markAllAsRead: "Mark all .ault profile",
    },
    profile: {
      tooltipButtonProfile: "Account Settings",
      passwordLabel: "Password",
      newPasswordLabel: "New Password",
      confirmPasswordLabel: "Confirm password",
      signOffTooltip: "Log out",
      saveAsDefault: "Save as default",
    },
  },
  breadcrumb: {
    home: "Home",
    newRecord: "Creating a new Record",
  },
  process: {
    confirmationMessage: "Want to execute this process?",
    messageTitle: "Process",
    completedSuccessfully: "Process completed successfuly",
    processError: "Error while loading process data",
  },
  drawer: {
    recentlyViewed: "Recently Viewed",
  },
  login: {
    subtitle: "Enter your credentials to access your account.",
    fields: {
      username: {
        label: "Username",
        placeholder: "Username",
      },
      password: {
        label: "Password",
        placeholder: "Password",
      },
    },
    buttons: {
      submit: "Log In",
    },
  },
  grid: {
    items: {
      erp: {
        text: "ERP software",
      },
      tailored: {
        text: "Tailored to suit your needs",
      },
      adaptable: {
        text: "Highly scalable",
      },
    },
    alt: {
      logo: "Etendo Logo",
    },
  },
  form: {
    select: {
      placeholder: "Select an option",
    },
  },
  copilot: {
    copilotProfile: "Copilot Profile",
    backToSelection: "Back to assistant selection",
    minimize: "Minimize",
    maximize: "Maximize",
    close: "Close",
    contextText: "Context",
    assistantSelector: {
      errorInvalidData: "Error: Invalid assistant data",
      errorNoAssistantsAvailable: "No assistants available",
      defaultDescription: "Etendo Copilot Assistant",
      welcomeMessage: "Hello! ✨🚀 Select the profile that best fits your task and let's begin. 💪",
      profilesTitle: "Profiles",
      learnMoreText: "Learn more about Copilot →",
      filterPlaceholder: "Filter profiles...",
    },
    messageInput: {
      placeholder: "Chat with Copilot...",
    },
    messageList: {
      contextRecords: "Selected Context",
      welcomeMessage: "Hello! How can I help you today?",
      typing: "Typing...",
    },
    contextPreview: {
      selectedRegisters: " Attached register",
    },
  },
  location: {
    selector: {
      placeholder: "Select location...",
      modalTitle: "New Location",
      modalDescription: "Enter location details",
      buttons: {
        cancel: "Cancel",
        save: "Save",
        creating: "Creating...",
      },
    },
    fields: {
      address1: {
        label: "Address Line 1",
        placeholder: "Enter address line 1",
      },
      address2: {
        label: "Address Line 2",
        placeholder: "Enter address line 2",
      },
      postal: {
        label: "Postal Code",
        placeholder: "Enter postal code",
      },
      city: {
        label: "City",
        placeholder: "Enter city",
      },
      country: {
        label: "Country",
        placeholder: "Select a country",
      },
      region: {
        label: "Region",
        placeholder: "Select a region",
        selectCountryFirst: "Select a country first",
      },
    },
    errors: {
      loadingCountries: "Error loading countries",
      loadingRegions: "Error loading regions",
      creating: "Error creating location",
      requiredFields: "Please fill in all required fields correctly.",
    },
  },
  primaryTabs: {
    dashboard: "Dashboard",
    closeWindow: "Close Window",
    showTabs: "Show Tabs",
  },
};

export default en;

```

## Archivo: `packages/ComponentLibrary/src/locales/es.ts`

```typescript
const es = {
  common: {
    etendo: "Etendo",
    cancel: "Cancelar",
    confirm: "Confirmar",
    close: "Cerrar",
    closing: "Cerrando...",
    execute: "Ejecutar",
    register: "Registrar",
    save: "Guardar",
    edit: "Editar",
    loading: "Cargando...",
    loadingFormData: "Cargando información del formulario...",
    loadingWindowContent: "Cargando contenido de la ventana...",
    retry: "Reintentar",
    processes: "Procesos disponibles",
    clear: "Limpiar Seleccion",
    processTitle: "Titulo del proceso",
    notImplemented: "Esta funcionalidad no está disponible aun",
    loadMore: "Cargar más",
    trueText: "Si",
    falseText: "No",
    noDataAvailable: "No hay información disponible",
    record: "registro",
    records: "registros",
  },
  forms: {
    sections: {
      main: "Sección Principal",
      audit: "Auditoría",
    },
    statusBar: {
      closeRecord: "Cerrar registro",
    },
  },
  audit: {
    createdDate: "Fecha de creación",
    createdBy: "Creado por",
    updated: "Actualizado",
    updatedBy: "Actualizado por",
  },
  status: {
    deleteSuccess: "ha sido eliminado correctamente",
    deleteError: "Error al eliminar el registro",
    deleteConfirmation: "¿Estás seguro de que quieres eliminar",
    multipleDeleteConfirmation: "¿Estás seguro de que quieres eliminar los registros seleccionados?",
    selectRecordError: "Por favor, selecciona un registro primero",
    saveSuccess: "{{entityType}} ha sido guardado correctamente",
    saveError: "Error al guardar el registro",
    noIdError: "No se puede borrar un registro sin identificador",
    noEntityError: "No hay una entidad especificada",
    httpError: "Error HTTP: ",
    noRecordsError: "No hay registros seleccionados",
    noRecords: "Por favor, crea un nuevo registro",
  },
  errors: {
    tableError: {
      title: "Error",
      description: "Algo salió mal",
    },
    networkError: {
      title: "No se pudo conectar con Etendo",
      description: "Parece que hay algún problema en la red o el servidor está caído",
    },
    notFound: {
      title: "Algo salió mal",
      description: "No pudimos encontrar la página que buscas",
    },
    internalServerError: {
      title: "Algo salió mal",
      retry: "Reintentar",
    },
    missingRecord: {
      title: "Registro no encontrado",
      description: "El registro solicitado no fue encontrado",
    },
    missingData: {
      title: "Datos no encontrados",
      description: "Los datos solicitados no fueron encontrados",
    },
    missingMetadata: {
      title: "Falta Metadata",
      description: "La Metadata requerida por la ventana no esta disponible",
    },
    formData: {
      title: "Error cargando el formulario",
      description: "Hubo un error cargando la información del formulario",
    },
    adaptingData: {
      title: "Error procesando la información",
      description: "Hubo un error procesando la información del formulario",
    },
    selectionError: {
      title: "No hay registro superior seleccionado.",
      description: "Selecciona un registro en la pestaña principal para ver la información relacionada.",
    },
    windowNotFound: {
      title: "Ventana no encontrada",
      description: "La ventana solicitada no fue encontrada",
    },
  },
  modal: {
    secondaryButtonLabel: "Atrás",
  },
  registerModal: {
    descriptionText: "Confirma tu envío y guárdalo en el sistema. 📝📦",
  },
  table: {
    tooltips: {
      search: "Buscar",
      views: "Vistas",
      filter: "Filtrar",
      columns: "Columnas",
      openSidebar: "Abrir barra lateral",
      closeSidebar: "Cerrar barra lateral",
      details: "Detalles",
      refresh: "Actualizar",
      implicitFilterOn: "Filtros aplicados. Click para quitar filtros",
      implicitFilterOff: "Filtros desactivados. Click para aplicar filtros",
    },
    selection: {
      single: "Elemento selecccionado",
      multiple: "Elementos seleccionados",
    },
    placeholders: {
      search: "Buscar...",
    },
    labels: {
      noIdentifier: "Ningún elemento seleccionado",
      noTitle: "Sin título",
      noType: "Sin tipo",
      noRecord: "Ninguna fila seleccionada",
      emptyRecords: "No hay registros para mostrar",
    },
    content: {
      currentTitle: "Se espera que sus ingresos aumenten a finales de este año. Felicitaciones",
    },
  },
  navigation: {
    common: {
      home: "Ir al inicio",
      back: "Atrás",
    },
    waterfall: {
      activateAll: "Activar todo",
      deactivateAll: "Desactivar todo",
      tooltipButton: "Tooltip de Cascada",
      buttons: "Botones",
      customize: "Personalizar",
    },
    configurationModal: {
      tooltipButtonProfile: "Configuración",
    },
    activityButton: {
      tooltip: "Actividad",
    },
    notificationModal: {
      title: "Notificaciones",
      markAllAsRead: "Marcar todo como leído",
      emptyStateImageAlt: "Sin Notificaciones",
      emptyStateMessage: "No tienes notificaciones",
      emptyStateDescription: "¡Genial! Estás al día con todo. Te notificaremos aquí si hay algo nuevo.",
      actionButtonLabel: "Configurar notificaciones",
    },
    profile: {
      tooltipButtonProfile: "Configuración de la cuenta",
      passwordLabel: "Contraseña",
      newPasswordLabel: "Nueva Contraseña",
      confirmPasswordLabel: "Confirmar Nueva Contraseña",
      signOffTooltip: "Cerrar sesión",
      saveAsDefault: "Guardar perfil por defecto",
    },
  },
  breadcrumb: {
    home: "Inicio",
    newRecord: "Crando un nuevo registro",
  },
  process: {
    confirmationMessage: "¿Deseas ejecutar este proceso?",
    messageTitle: "Proceso",
    completedSuccessfully: "Proceso completado exítosamente",
    processError: "Error mientras se cargaba la informacion del proceso",
  },
  drawer: {
    recentlyViewed: "Visto recientemente",
  },
  login: {
    subtitle: "Ingrese sus credenciales para acceder a su cuenta",
    fields: {
      username: {
        label: "Usuario",
        placeholder: "Usuario",
      },
      password: {
        label: "Contraseña",
        placeholder: "Contraseña",
      },
    },
    buttons: {
      submit: "Acceso",
    },
  },
  grid: {
    items: {
      erp: {
        text: "ERP software",
      },
      tailored: {
        text: "Adaptado a sus necesidades",
      },
      adaptable: {
        text: "Altamente escalable",
      },
    },
    alt: {
      logo: "Etendo Logo",
    },
  },
  form: {
    select: {
      placeholder: "Seleccione una opción",
    },
  },
  copilot: {
    copilotProfile: "Perfil Copilot",
    backToSelection: "Volver a selección de asistentes",
    minimize: "Minimizar",
    maximize: "Maximizar",
    close: "Cerrar",
    contextText: "Contexto",
    assistantSelector: {
      errorInvalidData: "Error: Datos de asistentes inválidos",
      errorNoAssistantsAvailable: "No hay asistentes disponibles",
      defaultDescription: "Asistente de Etendo Copilot",
      welcomeMessage: "¡Hola! ✨🚀 Selecciona el perfil que más se ajuste a tu tarea y comencemos. 💪",
      profilesTitle: "Perfiles",
      learnMoreText: "Conoce más sobre Copilot →",
      filterPlaceholder: "Filtrar perfiles...",
    },
    messageInput: {
      placeholder: "Conversa con Copilot...",
    },
    messageList: {
      contextRecords: "Contexto seleccionado",
      welcomeMessage: "¡Hola! ¿En qué puedo ayudarte hoy?",
      typing: "Escribiendo...",
    },
    contextPreview: {
      selectedRegisters: " Registros adjuntados",
    },
  },
  location: {
    selector: {
      placeholder: "Seleccionar ubicación...",
      modalTitle: "Nueva Ubicación",
      modalDescription: "Ingrese los detalles de la ubicación",
      buttons: {
        cancel: "Cancelar",
        save: "Guardar",
        creating: "Creando...",
      },
    },
    fields: {
      address1: {
        label: "Dirección Línea 1",
        placeholder: "Ingrese la dirección línea 1",
      },
      address2: {
        label: "Dirección Línea 2",
        placeholder: "Ingrese la dirección línea 2",
      },
      postal: {
        label: "Código Postal",
        placeholder: "Ingrese el código postal",
      },
      city: {
        label: "Ciudad",
        placeholder: "Ingrese la ciudad",
      },
      country: {
        label: "País",
        placeholder: "Seleccione un país",
      },
      region: {
        label: "Región",
        placeholder: "Seleccione una región",
        selectCountryFirst: "Seleccione un país primero",
      },
    },
    errors: {
      loadingCountries: "Error cargando países",
      loadingRegions: "Error cargando regiones",
      creating: "Error creando ubicación",
      requiredFields: "Por favor complete todos los campos requeridos correctamente.",
    },
  },
  primaryTabs: {
    dashboard: "Panel",
    closeWindow: "Cerrar ventana",
    showTabs: "Mostrar pestañas",
  },
};

export default es;

```

## Archivo: `packages/ComponentLibrary/src/locales/index.ts`

```typescript
import type { Translations, Language } from "./types";
import es_ES from "./es";
import en_US from "./en";

const DEFAULT_LANGUAGE: Language = "en_US";
const translations: Translations = {
  es_ES,
  en_US,
};

export default translations;
export { DEFAULT_LANGUAGE, translations };
export type { Language, Translations };

```

## Archivo: `packages/ComponentLibrary/src/locales/types.ts`

```typescript
import type en from "./en";
import type es from "./es";

type Primitive = string;

export type NestedKeyOf<T> = T extends Primitive
  ? T
  : {
      [K in keyof T & (string | number)]: T[K] extends Primitive ? K : K | `${K}.${NestedKeyOf<T[K]>}`;
    }[keyof T & (string | number)];

export type TranslationKeys = NestedKeyOf<typeof en | typeof es>;

export type Language = "en_US" | "es_ES";

export type Translations = {
  [key in Language]: typeof en | typeof es;
};

```

## Archivo: `packages/ComponentLibrary/src/theme/index.ts`

```typescript
"use client";

import { type ThemeOptions, createTheme } from "@mui/material";

// Colors for MUI attributes
export const PRIMARY_100 = "#D8DBF6";
export const PRIMARY_500 = "#202452";
export const SECONDARY_100 = "#FEFACF";
export const SECONDARY_300 = "#FDEC71";
export const SECONDARY_500 = "#FAD614";
export const TERTIARY_50 = "#EDF1FF";
export const TERTIARY_100 = "#E2E7FF";
export const TERTIARY_900 = "#151C7A";
export const NEUTRAL_50 = "#FAFAFA";
export const NEUTRAL_300 = "#E0E0E0";
export const NEUTRAL_1000 = "#121212";
export const BACKGROUND = "#C6D3FF";

export const themeOptions: ThemeOptions = {
  palette: {
    dynamicColor: {
      main: "#004ACA",
      dark: "#00296F",
      light: "#D5E3FC",
      contrastText: "#E5EFFF",
    },
    baselineColor: {
      neutral: {
        0: "#FCFCFD",
        10: "#F5F6FA",
        20: "#D3D7E9",
        30: "#B1B8D8",
        40: "#8F99C7",
        50: "#6D7AB6",
        60: "#505EA0",
        70: "#3F4A7E",
        80: "#2E365C",
        90: "#1D223A",
        100: "#00030D",
      },
      transparentNeutral: {
        0: "transparent",
        5: "rgba(0, 3, 13, 0.05)",
        10: "rgba(0, 3, 13, 0.1)",
        20: "rgba(0, 3, 13, 1)",
        30: "rgba(0, 3, 13, 0.3)",
        40: "rgba(0, 3, 13, 0.4)",
        50: "rgba(0, 3, 13, 0.5)",
        60: "rgba(0, 3, 13, 0.6)",
        70: "rgba(0, 3, 13, 0.7)",
        80: "rgba(0, 3, 13, 0.8)",
      },
      etendoPrimary: {
        main: "#004ACA",
        dark: "#00296F",
        contrastText: "#E5EFFF",
        light: " rgba(0, 74, 202, 0.05)",
      },
    },
    specificColor: {
      success: {
        main: "#008000",
        light: "#BFFF8F",
        contrastText: "rgba(0, 128, 0, 0.05)",
      },
      warning: {
        main: "#FFCC00",
        light: "#FFEB99",
        contrastText: "rgba(255, 204, 0, 0.05)",
      },
      error: {
        main: "#DC143C",
        light: "#FFCCD6",
        contrastText: "rgba(220, 20, 60, 0.05)",
      },
      draft: {
        main: "#3F4A7E",
        contrastText: "#E5E5E6",
      },
    },
    primary: {
      light: PRIMARY_100,
      main: PRIMARY_500,
      dark: TERTIARY_900,
      contrastText: NEUTRAL_50,
    },
    secondary: {
      light: SECONDARY_100,
      main: SECONDARY_500,
      dark: SECONDARY_300,
      contrastText: PRIMARY_500,
    },
    tertiary: {
      light: TERTIARY_50,
      main: TERTIARY_50,
      dark: TERTIARY_100,
      contrastText: PRIMARY_500,
    },
  },
  typography: {
    fontFamily: ["var(--font-inter)", "-apple-system", "BlinkMacSystemFont", '"Segoe UI"'].join(","),
  },
  components: {
    MuiCssBaseline: {
      styleOverrides: `
        * {
          scrollbar-width: thin; /* Firefox */
          scrollbar-color: #b0bec5 transparent; /* Firefox */
        }
        *::-webkit-scrollbar {
          width: 12px;
        }
        *::-webkit-scrollbar-track {
          background: transparent;
        }
        *::-webkit-scrollbar-thumb {
          background-color: #b0bec5;
          border-radius: 10px;
          border: 3px solid transparent;
        }
        *::-webkit-scrollbar-thumb:hover {
          background-color: #90a4ae;
        }
      `,
    },
    MuiTooltip: {
      styleOverrides: {
        tooltip: {
          fontSize: "0.875rem",
          backgroundColor: NEUTRAL_1000,
          color: NEUTRAL_50,
          borderRadius: "0.25rem",
          padding: "0.25rem, 0.35rem, 0.25rem, 0.35rem",
          maxWidth: 500,
        },
        arrow: {
          color: NEUTRAL_1000,
        },
      },
    },
    MuiButton: {
      defaultProps: {
        disableElevation: true,
      },
      styleOverrides: {
        root: {
          borderRadius: 8,
          textTransform: "none",
        },
        contained: {
          boxShadow: "none",
          "&:hover": {
            boxShadow: "none",
          },
        },
        containedPrimary: {
          ":disabled": {
            backgroundColor: NEUTRAL_300,
          },
        },
        containedSecondary: {
          ":disabled": {
            backgroundColor: SECONDARY_100,
          },
        },
        // Styles applied to the root element if `variant="outlined"`.
        outlined: {
          borderWidth: 1.5,
          borderColor: PRIMARY_500,
          color: PRIMARY_500,
          "&:hover": {
            borderColor: PRIMARY_500,
            color: NEUTRAL_50,
            backgroundColor: PRIMARY_500,
          },
          ":disabled": {
            borderWidth: 1.5,
            borderColor: NEUTRAL_300,
          },
        },
        // Styles applied to the root element if `variant="text"`.
        text: {
          color: PRIMARY_500,
          "&:hover": {
            borderRadius: 0,
            borderBottom: `1.5px solid ${PRIMARY_500}`,
            backgroundColor: "transparent",
          },
          ":disabled": {
            color: NEUTRAL_300,
          },
        },
      },
    },
    MuiTab: {
      defaultProps: {
        disableRipple: true,
      },
      styleOverrides: {
        root: {
          textTransform: "none",
          fontSize: "1rem",
          borderTopRightRadius: ".5rem",
          borderTopLeftRadius: ".5rem",
          backgroundColor: TERTIARY_50,

          ":hover": {
            backgroundColor: NEUTRAL_50,
          },
          ":focus": {
            backgroundColor: NEUTRAL_50,
          },
          ":selected": {
            backgroundColor: NEUTRAL_50,
          },
        },
      },
    },
  },
};

// Theme for MUI components
export const theme = createTheme(themeOptions);

```

## Archivo: `packages/ComponentLibrary/src/types/svgr.d.ts`

```typescript
declare module "*.svg" {
  import type { FC, SVGProps } from "react";
  const content: FC<SVGProps<SVGSVGElement>>;
  export default content;
}

declare module "*.svg?url" {
  const content: string;
  export default content;
}

```

## Archivo: `packages/ComponentLibrary/src/types/theme.d.ts`

```typescript
declare module "@mui/material/styles" {
  interface BaselineColor {
    neutral: { [key: number]: string };
    transparentNeutral: { [key: number]: string };
    etendoPrimary: PaletteColor;
  }

  interface SpecificColor {
    success: PaletteColor;
    warning: PaletteColor;
    error: PaletteColor;
    draft: PaletteColor;
  }

  interface Palette {
    dynamicColor: PaletteColor;
    baselineColor: BaselineColor;
    specificColor: SpecificColor;
  }

  interface PaletteOptions {
    dynamicColor?: PaletteColorOptions;
    baselineColor?: {
      neutral?: { [key: number]: string };
      transparentNeutral?: { [key: number]: string };
      etendoPrimary?: PaletteColorOptions;
    };
    specificColor?: {
      success?: PaletteColorOptions;
      warning?: PaletteColorOptions;
      error?: PaletteColorOptions;
      draft?: PaletteColorOptions;
    };
    tertiary?: PaletteColorOptions;
  }

  interface ThemeOptions {
    palette?: PaletteOptions;
  }
}

export {};

```

## Archivo: `packages/ComponentLibrary/src/utils/classUtil.ts`

```typescript
/**
 * Merges user-defined classes with default classes, removing default classes that
 * conflict with user classes based on specific Tailwind CSS utility prefixes.
 *
 * This approach avoids regular expressions, significantly reducing per-class processing cost,
 * especially in frequent renders or large lists of components where performance matters.
 *
 * @param defaultClasses - A string of default CSS classes (e.g. Tailwind utilities).
 * @param className - A string of user-provided CSS classes that override defaults.
 * @returns A combined string of classes with user classes taking precedence over defaults.
 */
export const cleanDefaultClasses = (defaultClasses: string, className = ""): string => {
  if (!className.trim()) {
    return defaultClasses;
  }

  const toArray = (s: string) => s.trim().split(/\s+/);

  const getKey = (cls: string): string | null => {
    const [, variant = "", base] = cls.match(/^([a-z]+:)?(text|bg|w|h|rounded)/) || [];
    return base && !(base === "text" && cls.includes("[")) ? variant + base : null;
  };

  const userClasses = toArray(className);
  const userKeys = new Set(userClasses.map(getKey).filter(Boolean));

  const cleanedDefaults = toArray(defaultClasses).filter((c) => !userKeys.has(getKey(c)));

  return [...cleanedDefaults, ...userClasses].join(" ");
};

```

## Archivo: `packages/ComponentLibrary/src/utils/clickAway.tsx`

```typescript
import type React from "react";
import { useEffect, useRef } from "react";

export const CustomClickAwayListener: React.FC<{
  onClickAway: () => void;
  children: React.ReactNode;
}> = ({ onClickAway, children }) => {
  const ref = useRef<HTMLDivElement>(null);

  useEffect(() => {
    const handleClickOutside = (event: MouseEvent) => {
      if (ref.current && !ref.current.contains(event.target as Node)) {
        onClickAway();
      }
    };

    document.addEventListener("mousedown", handleClickOutside);
    return () => {
      document.removeEventListener("mousedown", handleClickOutside);
    };
  }, [onClickAway]);

  return <div ref={ref}>{children}</div>;
};

export default CustomClickAwayListener;

```

## Archivo: `packages/ComponentLibrary/src/utils/colorUtil.ts`

```typescript
export function rgbaToHex(rgba: string): string {
  if (rgba.startsWith("#")) {
    return rgba.toUpperCase();
  }

  const parts = rgba.substring(rgba.indexOf("(")).split(",");
  const r = Number.parseInt(parts[0].substring(1).trim(), 10);
  const g = Number.parseInt(parts[1].trim(), 10);
  const b = Number.parseInt(parts[2].trim(), 10);
  const a = Number.parseFloat(parts[3] || "1");

  const hex = `#${((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1).toUpperCase()}`;

  if (a === 1) {
    return hex;
  }

  const alpha = Math.round(a * 255)
    .toString(16)
    .toUpperCase();
  return hex + (alpha.length === 1 ? `0${alpha}` : alpha);
}

```

## Archivo: `packages/ComponentLibrary/src/utils/drawerUtils.tsx`

```typescript
import type { Menu } from "@workspaceui/api-client/src/api/types";

export const findActive = (windowId: string | undefined, items: Menu[] | undefined = []): boolean => {
  if (!items || !windowId) return false;
  const stack: Menu[] = [...items];
  while (stack.length > 0) {
    const item = stack.pop();
    if (item) {
      if (item.windowId === windowId) return true;
      if (item.children) stack.push(...item.children);
    }
  }
  return false;
};

```

## Archivo: `packages/ComponentLibrary/src/utils/menuUtils.ts`

```typescript
import type { Menu } from "@workspaceui/api-client/src/api/types";
import type { TranslateFunction } from "@workspaceui/mainui/hooks/types";
import type { RecentItem } from "../components/Drawer/types";

const RECENTLY_VIEWED_ICON = "⌛";

const getActionByType = (type: string): string => {
  switch (type) {
    case "Process":
      return "P";
    case "Report":
      return "R";
    default:
      return "W";
  }
};

const isItemMatch = (item: Menu, identifier: string): boolean => {
  if (item.type === "Window") {
    return item.windowId === identifier;
  }
  if (item.type === "Report" || item.type === "Process") {
    return item.id === identifier;
  }
  return item.windowId === identifier || item.id === identifier;
};

export const findItemByIdentifier = (items?: Menu[], identifier?: string): Menu | null => {
  if (!items?.length || !identifier) return null;

  for (const item of items) {
    if (isItemMatch(item, identifier)) {
      return item;
    }

    if (item.children?.length) {
      const found = findItemByIdentifier(item.children, identifier);
      if (found) return found;
    }
  }

  return null;
};

export const createMenuItem = (id: string, name: string, entityName: string): Menu => ({
  _identifier: id,
  _entityName: entityName,
  $ref: id,
  recordTime: Date.now(),
  id,
  name,
});

export const createRecentMenuItem = (item: RecentItem): Menu => ({
  ...createMenuItem(item.id, item.name, item.type),
  windowId: item.type === "Window" ? item.windowId : item.id,
  action: getActionByType(item.type),
  type: item.type,
});

export const createParentMenuItem = (items: RecentItem[], t: TranslateFunction): Menu => {
  const baseMenuItem = {
    ...createMenuItem("recently-viewed", t("drawer.recentlyViewed"), "RecentlyViewed"),
    icon: RECENTLY_VIEWED_ICON,
    type: "Window",
    action: "W",
  };

  if (!items?.length || typeof items.map !== "function") {
    return baseMenuItem;
  }

  let children: Menu[] = [];

  try {
    children = items.map(createRecentMenuItem);
  } catch (e) {
    console.warn("Error in createParentMenuItem", e);
  }

  return {
    ...baseMenuItem,
    type: items[0].type || "Window",
    children,
  };
};

```

## Archivo: `packages/ComponentLibrary/src/utils/quantitySelectorUtil.ts`

```typescript
export const isValidNumber = (value: string): boolean => {
  const regex = /^-?\d+(\.\d+)?$/;
  return regex.test(value) && !value.endsWith(".");
};

export const validateNumber = (
  value: string,
  minValue: number | undefined,
  maxValue: number | undefined
): { isValid: boolean; errorMessage: string } => {
  if (!isValidNumber(value)) {
    return { isValid: false, errorMessage: "Please enter a valid number" };
  }

  const num = Number.parseFloat(value);

  if (num < 0) {
    return { isValid: false, errorMessage: "Value must be non-negative" };
  }

  if (minValue !== undefined && num < minValue) {
    return { isValid: false, errorMessage: `Value must be at least ${minValue}` };
  }

  if (maxValue !== undefined && num > maxValue) {
    return { isValid: false, errorMessage: `Value must be at most ${maxValue}` };
  }

  if (Number.isNaN(num)) {
    return { isValid: false, errorMessage: "Please enter a valid number" };
  }

  return { isValid: true, errorMessage: "" };
};

```

## Archivo: `packages/ComponentLibrary/src/utils/searchUtils.tsx`

```typescript
import type { Menu } from "@workspaceui/api-client/src/api/types";
import type { IndexedMenu, SearchIndex } from "../components/Drawer/types";

const index: SearchIndex = {
  byId: new Map(),
  byPhrase: new Map(),
};

const addToPhraseIndex = (phrase: string, id: string) => {
  if (!index.byPhrase.has(phrase)) {
    index.byPhrase.set(phrase, new Set());
  }
  index.byPhrase.get(phrase)?.add(id);
};

const traverse = (items: Menu[], path: string[] = [], fullPath = "") => {
  for (const item of items) {
    const newFullPath = fullPath ? `${fullPath} > ${item.name}` : item.name;
    const indexedItem: IndexedMenu = { ...item, path, fullPath: newFullPath };
    index.byId.set(item.id, indexedItem);

    const lowerName = item.name.toLowerCase();
    addToPhraseIndex(lowerName, item.id);

    const words = lowerName.split(/\s+/);
    for (const word of words) {
      addToPhraseIndex(word, item.id);
    }

    addToPhraseIndex(newFullPath.toLowerCase(), item.id);

    if (Array.isArray(item.children)) {
      traverse(item.children, [...path, item.id], newFullPath);
    }
  }
};

export const createSearchIndex = (items: Menu[]): SearchIndex => {
  try {
    traverse(items);
  } catch (e) {
    console.warn("Error in createSearchIndex", e);
  }

  return index;
};

const findMatchingIds = (searchValue: string, searchIndex: SearchIndex): Set<string> => {
  const lowerSearchValue = searchValue.toLowerCase();
  const matchingIds = new Set<string>();

  for (const [phrase, ids] of searchIndex.byPhrase) {
    if (phrase.includes(lowerSearchValue)) {
      for (const id of ids) {
        const item = searchIndex.byId.get(id);
        if (item?.name.toLowerCase().includes(lowerSearchValue)) {
          matchingIds.add(id);
        }
      }
    }
  }

  return matchingIds;
};

const findMatchingIdsForWords = (searchWords: string[], searchIndex: SearchIndex): Set<string> => {
  const allMatchingIds = new Set<string>();

  for (const word of searchWords) {
    for (const [phrase, ids] of searchIndex.byPhrase) {
      if (phrase.includes(word)) {
        for (const id of ids) {
          allMatchingIds.add(id);
        }
      }
    }
  }

  return new Set(
    Array.from(allMatchingIds).filter((id) => {
      const item = searchIndex.byId.get(id);
      return searchWords.every((word) => item?.name.toLowerCase().includes(word));
    })
  );
};

const getExpandedIds = (matchingIds: Set<string>, searchIndex: SearchIndex): Set<string> => {
  const expandedIds = new Set<string>();
  for (const id of matchingIds) {
    const item = searchIndex.byId.get(id);
    if (item?.path) {
      for (const pathId of item.path) {
        expandedIds.add(pathId);
      }
    }
  }
  return expandedIds;
};

export const getAllItemTitles = (searchIndex: SearchIndex): string[] => {
  return Array.from(searchIndex.byPhrase.keys()).sort((a, b) => a.length - b.length);
};

export const rebuildTree = (items: Menu[], matchingIds: Set<string>): Menu[] => {
  return items.reduce<Menu[]>((acc, item) => {
    const childrenMatching = item.children ? rebuildTree(item.children, matchingIds).length > 0 : false;
    const shouldInclude = matchingIds.has(item.id) || childrenMatching;

    if (shouldInclude) {
      const filteredChildren = item.children ? rebuildTree(item.children, matchingIds) : [];
      acc.push({
        ...item,
        isSearchResult: true,
        children: filteredChildren.length > 0 ? filteredChildren : undefined,
      });
    }

    return acc;
  }, []);
};

export const filterItems = (
  items: Menu[],
  searchValue: string,
  searchIndex: SearchIndex
): { filteredItems: Menu[]; searchExpandedItems: Set<string> } => {
  if (!searchValue || !Array.isArray(items)) return { filteredItems: items, searchExpandedItems: new Set() };

  let matchingIds = findMatchingIds(searchValue, searchIndex);
  if (matchingIds.size === 0) {
    const searchWords = searchValue.toLowerCase().split(/\s+/);
    matchingIds = findMatchingIdsForWords(searchWords, searchIndex);
  }

  const expandedIds = getExpandedIds(matchingIds, searchIndex);
  const filteredItems = rebuildTree(items, matchingIds);

  return { filteredItems, searchExpandedItems: expandedIds };
};

```

## Archivo: `packages/ComponentLibrary/src/utils/transformUtil.ts`

```typescript
export const calculateTransform = (posX: string | number, posY: string | number): string => {
  return posX === "center" && posY === "center" ? "translate(-50%, -50%)" : "none";
};

```

## Archivo: `packages/MainUI/.next/types/app/(main)/window/page.ts`

```typescript
// File: /Users/sebastianbarrozo/Documents/work/epic/ETP-1925/com.etendorx.workspace-ui/packages/MainUI/app/(main)/window/page.tsx
import * as entry from '../../../../../app/(main)/window/page.js'
import type { ResolvingMetadata, ResolvingViewport } from 'next/dist/lib/metadata/types/metadata-interface.js'

type TEntry = typeof import('../../../../../app/(main)/window/page.js')

type SegmentParams<T extends Object = any> = T extends Record<string, any>
  ? { [K in keyof T]: T[K] extends string ? string | string[] | undefined : never }
  : T

// Check that the entry is a valid entry
checkFields<Diff<{
  default: Function
  config?: {}
  generateStaticParams?: Function
  revalidate?: RevalidateRange<TEntry> | false
  dynamic?: 'auto' | 'force-dynamic' | 'error' | 'force-static'
  dynamicParams?: boolean
  fetchCache?: 'auto' | 'force-no-store' | 'only-no-store' | 'default-no-store' | 'default-cache' | 'only-cache' | 'force-cache'
  preferredRegion?: 'auto' | 'global' | 'home' | string | string[]
  runtime?: 'nodejs' | 'experimental-edge' | 'edge'
  maxDuration?: number
  
  metadata?: any
  generateMetadata?: Function
  viewport?: any
  generateViewport?: Function
  experimental_ppr?: boolean
  
}, TEntry, ''>>()


// Check the prop type of the entry function
checkFields<Diff<PageProps, FirstArg<TEntry['default']>, 'default'>>()

// Check the arguments and return type of the generateMetadata function
if ('generateMetadata' in entry) {
  checkFields<Diff<PageProps, FirstArg<MaybeField<TEntry, 'generateMetadata'>>, 'generateMetadata'>>()
  checkFields<Diff<ResolvingMetadata, SecondArg<MaybeField<TEntry, 'generateMetadata'>>, 'generateMetadata'>>()
}

// Check the arguments and return type of the generateViewport function
if ('generateViewport' in entry) {
  checkFields<Diff<PageProps, FirstArg<MaybeField<TEntry, 'generateViewport'>>, 'generateViewport'>>()
  checkFields<Diff<ResolvingViewport, SecondArg<MaybeField<TEntry, 'generateViewport'>>, 'generateViewport'>>()
}

// Check the arguments and return type of the generateStaticParams function
if ('generateStaticParams' in entry) {
  checkFields<Diff<{ params: SegmentParams }, FirstArg<MaybeField<TEntry, 'generateStaticParams'>>, 'generateStaticParams'>>()
  checkFields<Diff<{ __tag__: 'generateStaticParams', __return_type__: any[] | Promise<any[]> }, { __tag__: 'generateStaticParams', __return_type__: ReturnType<MaybeField<TEntry, 'generateStaticParams'>> }>>()
}

export interface PageProps {
  params?: Promise<SegmentParams>
  searchParams?: Promise<any>
}
export interface LayoutProps {
  children?: React.ReactNode

  params?: Promise<SegmentParams>
}

// =============
// Utility types
type RevalidateRange<T> = T extends { revalidate: any } ? NonNegative<T['revalidate']> : never

// If T is unknown or any, it will be an empty {} type. Otherwise, it will be the same as Omit<T, keyof Base>.
type OmitWithTag<T, K extends keyof any, _M> = Omit<T, K>
type Diff<Base, T extends Base, Message extends string = ''> = 0 extends (1 & T) ? {} : OmitWithTag<T, keyof Base, Message>

type FirstArg<T extends Function> = T extends (...args: [infer T, any]) => any ? unknown extends T ? any : T : never
type SecondArg<T extends Function> = T extends (...args: [any, infer T]) => any ? unknown extends T ? any : T : never
type MaybeField<T, K extends string> = T extends { [k in K]: infer G } ? G extends Function ? G : never : never



function checkFields<_ extends { [k in keyof any]: never }>() {}

// https://github.com/sindresorhus/type-fest
type Numeric = number | bigint
type Zero = 0 | 0n
type Negative<T extends Numeric> = T extends Zero ? never : `${T}` extends `-${string}` ? T : never
type NonNegative<T extends Numeric> = T extends Zero ? T : Negative<T> extends never ? T : '__invalid_negative_number__'

```

## Archivo: `packages/MainUI/.next/types/app/layout.ts`

```typescript
// File: /Users/sebastianbarrozo/Documents/work/epic/ETP-1925/com.etendorx.workspace-ui/packages/MainUI/app/layout.tsx
import * as entry from '../../../app/layout.js'
import type { ResolvingMetadata, ResolvingViewport } from 'next/dist/lib/metadata/types/metadata-interface.js'

type TEntry = typeof import('../../../app/layout.js')

type SegmentParams<T extends Object = any> = T extends Record<string, any>
  ? { [K in keyof T]: T[K] extends string ? string | string[] | undefined : never }
  : T

// Check that the entry is a valid entry
checkFields<Diff<{
  default: Function
  config?: {}
  generateStaticParams?: Function
  revalidate?: RevalidateRange<TEntry> | false
  dynamic?: 'auto' | 'force-dynamic' | 'error' | 'force-static'
  dynamicParams?: boolean
  fetchCache?: 'auto' | 'force-no-store' | 'only-no-store' | 'default-no-store' | 'default-cache' | 'only-cache' | 'force-cache'
  preferredRegion?: 'auto' | 'global' | 'home' | string | string[]
  runtime?: 'nodejs' | 'experimental-edge' | 'edge'
  maxDuration?: number
  
  metadata?: any
  generateMetadata?: Function
  viewport?: any
  generateViewport?: Function
  experimental_ppr?: boolean
  
}, TEntry, ''>>()


// Check the prop type of the entry function
checkFields<Diff<LayoutProps, FirstArg<TEntry['default']>, 'default'>>()

// Check the arguments and return type of the generateMetadata function
if ('generateMetadata' in entry) {
  checkFields<Diff<LayoutProps, FirstArg<MaybeField<TEntry, 'generateMetadata'>>, 'generateMetadata'>>()
  checkFields<Diff<ResolvingMetadata, SecondArg<MaybeField<TEntry, 'generateMetadata'>>, 'generateMetadata'>>()
}

// Check the arguments and return type of the generateViewport function
if ('generateViewport' in entry) {
  checkFields<Diff<LayoutProps, FirstArg<MaybeField<TEntry, 'generateViewport'>>, 'generateViewport'>>()
  checkFields<Diff<ResolvingViewport, SecondArg<MaybeField<TEntry, 'generateViewport'>>, 'generateViewport'>>()
}

// Check the arguments and return type of the generateStaticParams function
if ('generateStaticParams' in entry) {
  checkFields<Diff<{ params: SegmentParams }, FirstArg<MaybeField<TEntry, 'generateStaticParams'>>, 'generateStaticParams'>>()
  checkFields<Diff<{ __tag__: 'generateStaticParams', __return_type__: any[] | Promise<any[]> }, { __tag__: 'generateStaticParams', __return_type__: ReturnType<MaybeField<TEntry, 'generateStaticParams'>> }>>()
}

export interface PageProps {
  params?: Promise<SegmentParams>
  searchParams?: Promise<any>
}
export interface LayoutProps {
  children?: React.ReactNode

  params?: Promise<SegmentParams>
}

// =============
// Utility types
type RevalidateRange<T> = T extends { revalidate: any } ? NonNegative<T['revalidate']> : never

// If T is unknown or any, it will be an empty {} type. Otherwise, it will be the same as Omit<T, keyof Base>.
type OmitWithTag<T, K extends keyof any, _M> = Omit<T, K>
type Diff<Base, T extends Base, Message extends string = ''> = 0 extends (1 & T) ? {} : OmitWithTag<T, keyof Base, Message>

type FirstArg<T extends Function> = T extends (...args: [infer T, any]) => any ? unknown extends T ? any : T : never
type SecondArg<T extends Function> = T extends (...args: [any, infer T]) => any ? unknown extends T ? any : T : never
type MaybeField<T, K extends string> = T extends { [k in K]: infer G } ? G extends Function ? G : never : never



function checkFields<_ extends { [k in keyof any]: never }>() {}

// https://github.com/sindresorhus/type-fest
type Numeric = number | bigint
type Zero = 0 | 0n
type Negative<T extends Numeric> = T extends Zero ? never : `${T}` extends `-${string}` ? T : never
type NonNegative<T extends Numeric> = T extends Zero ? T : Negative<T> extends never ? T : '__invalid_negative_number__'

```

## Archivo: `packages/MainUI/.next/types/cache-life.d.ts`

```typescript
// Type definitions for Next.js cacheLife configs

declare module 'next/cache' {
  export { unstable_cache } from 'next/dist/server/web/spec-extension/unstable-cache'
  export {
    revalidateTag,
    revalidatePath,
    unstable_expireTag,
    unstable_expirePath,
  } from 'next/dist/server/web/spec-extension/revalidate'
  export { unstable_noStore } from 'next/dist/server/web/spec-extension/unstable-no-store'

  
    /**
     * Cache this `"use cache"` for a timespan defined by the `"default"` profile.
     * ```
     *   stale:      300 seconds (5 minutes)
     *   revalidate: 900 seconds (15 minutes)
     *   expire:     never
     * ```
     * 
     * This cache may be stale on clients for 5 minutes before checking with the server.
     * If the server receives a new request after 15 minutes, start revalidating new values in the background.
     * It lives for the maximum age of the server cache. If this entry has no traffic for a while, it may serve an old value the next request.
     */
    export function unstable_cacheLife(profile: "default"): void
    
    /**
     * Cache this `"use cache"` for a timespan defined by the `"seconds"` profile.
     * ```
     *   stale:      0 seconds
     *   revalidate: 1 seconds
     *   expire:     60 seconds (1 minute)
     * ```
     * 
     * This cache may be stale on clients for 0 seconds before checking with the server.
     * If the server receives a new request after 1 seconds, start revalidating new values in the background.
     * If this entry has no traffic for 1 minute it will expire. The next request will recompute it.
     */
    export function unstable_cacheLife(profile: "seconds"): void
    
    /**
     * Cache this `"use cache"` for a timespan defined by the `"minutes"` profile.
     * ```
     *   stale:      300 seconds (5 minutes)
     *   revalidate: 60 seconds (1 minute)
     *   expire:     3600 seconds (1 hour)
     * ```
     * 
     * This cache may be stale on clients for 5 minutes before checking with the server.
     * If the server receives a new request after 1 minute, start revalidating new values in the background.
     * If this entry has no traffic for 1 hour it will expire. The next request will recompute it.
     */
    export function unstable_cacheLife(profile: "minutes"): void
    
    /**
     * Cache this `"use cache"` for a timespan defined by the `"hours"` profile.
     * ```
     *   stale:      300 seconds (5 minutes)
     *   revalidate: 3600 seconds (1 hour)
     *   expire:     86400 seconds (1 day)
     * ```
     * 
     * This cache may be stale on clients for 5 minutes before checking with the server.
     * If the server receives a new request after 1 hour, start revalidating new values in the background.
     * If this entry has no traffic for 1 day it will expire. The next request will recompute it.
     */
    export function unstable_cacheLife(profile: "hours"): void
    
    /**
     * Cache this `"use cache"` for a timespan defined by the `"days"` profile.
     * ```
     *   stale:      300 seconds (5 minutes)
     *   revalidate: 86400 seconds (1 day)
     *   expire:     604800 seconds (1 week)
     * ```
     * 
     * This cache may be stale on clients for 5 minutes before checking with the server.
     * If the server receives a new request after 1 day, start revalidating new values in the background.
     * If this entry has no traffic for 1 week it will expire. The next request will recompute it.
     */
    export function unstable_cacheLife(profile: "days"): void
    
    /**
     * Cache this `"use cache"` for a timespan defined by the `"weeks"` profile.
     * ```
     *   stale:      300 seconds (5 minutes)
     *   revalidate: 604800 seconds (1 week)
     *   expire:     2592000 seconds (30 days)
     * ```
     * 
     * This cache may be stale on clients for 5 minutes before checking with the server.
     * If the server receives a new request after 1 week, start revalidating new values in the background.
     * If this entry has no traffic for 30 days it will expire. The next request will recompute it.
     */
    export function unstable_cacheLife(profile: "weeks"): void
    
    /**
     * Cache this `"use cache"` for a timespan defined by the `"max"` profile.
     * ```
     *   stale:      300 seconds (5 minutes)
     *   revalidate: 2592000 seconds (30 days)
     *   expire:     never
     * ```
     * 
     * This cache may be stale on clients for 5 minutes before checking with the server.
     * If the server receives a new request after 30 days, start revalidating new values in the background.
     * It lives for the maximum age of the server cache. If this entry has no traffic for a while, it may serve an old value the next request.
     */
    export function unstable_cacheLife(profile: "max"): void
    
    /**
     * Cache this `"use cache"` using a custom timespan.
     * ```
     *   stale: ... // seconds
     *   revalidate: ... // seconds
     *   expire: ... // seconds
     * ```
     *
     * This is similar to Cache-Control: max-age=`stale`,s-max-age=`revalidate`,stale-while-revalidate=`expire-revalidate`
     *
     * If a value is left out, the lowest of other cacheLife() calls or the default, is used instead.
     */
    export function unstable_cacheLife(profile: {
      /**
       * This cache may be stale on clients for ... seconds before checking with the server.
       */
      stale?: number,
      /**
       * If the server receives a new request after ... seconds, start revalidating new values in the background.
       */
      revalidate?: number,
      /**
       * If this entry has no traffic for ... seconds it will expire. The next request will recompute it.
       */
      expire?: number
    }): void
  

  export { cacheTag as unstable_cacheTag } from 'next/dist/server/use-cache/cache-tag'
}

```

## Archivo: `packages/MainUI/__mocks__/ReactMarkdownMock.tsx`

```typescript
import { ReactNode } from "react";

interface ChildrenProps {
  children: ReactNode;
}

function ReactMarkdownMock({ children }: ChildrenProps) {
  return <p>{children}</p>;
}

export default ReactMarkdownMock;
```

## Archivo: `packages/MainUI/__tests__/Collapsible.test.tsx`

```typescript
import { render, screen, fireEvent, waitFor } from "@testing-library/react";
import "@testing-library/jest-dom";
import { Collapsible } from "../components/Form/Collapsible";

const mockProps = {
  title: "Test Section",
  children: <div>Test content</div>,
  isExpanded: false,
  sectionId: "test-section",
};

describe("Collapsible", () => {
  it("renders with title and children", () => {
    render(<Collapsible {...mockProps} />);

    expect(screen.getByText("Test Section")).toBeInTheDocument();
    expect(screen.getByText("Test content")).toBeInTheDocument();
  });

  it("shows correct aria attributes when collapsed", () => {
    render(<Collapsible {...mockProps} />);

    const button = screen.getByRole("button");
    const content = screen.getByText("Test content").closest('[id="section-content-test-section"]');

    expect(button).toHaveAttribute("aria-expanded", "false");
    expect(content).toHaveAttribute("aria-hidden", "true");
  });

  it("shows correct aria attributes when expanded", () => {
    render(<Collapsible {...mockProps} isExpanded />);

    const button = screen.getByRole("button");
    const content = screen.getByText("Test content").closest('[id="section-content-test-section"]');

    expect(button).toHaveAttribute("aria-expanded", "true");
    expect(content).toHaveAttribute("aria-hidden", "false");
  });

  it("calls onToggle when clicked", () => {
    const onToggle = jest.fn();
    render(<Collapsible {...mockProps} onToggle={onToggle} />);

    const button = screen.getByRole("button");
    fireEvent.click(button);

    expect(onToggle).toHaveBeenCalledWith(true);
  });

  it("calls onToggle when Enter key is pressed", () => {
    const onToggle = jest.fn();
    render(<Collapsible {...mockProps} onToggle={onToggle} />);

    const button = screen.getByRole("button");
    fireEvent.keyDown(button, { key: "Enter" });

    expect(onToggle).toHaveBeenCalledWith(true);
  });

  it("calls onToggle when Space key is pressed", () => {
    const onToggle = jest.fn();
    render(<Collapsible {...mockProps} onToggle={onToggle} />);

    const button = screen.getByRole("button");
    fireEvent.keyDown(button, { key: " " });

    expect(onToggle).toHaveBeenCalledWith(true);
  });

  it("does not call onToggle for other keys", () => {
    const onToggle = jest.fn();
    render(<Collapsible {...mockProps} onToggle={onToggle} />);

    const button = screen.getByRole("button");
    fireEvent.keyDown(button, { key: "Tab" });

    expect(onToggle).not.toHaveBeenCalled();
  });

  it("renders with custom icon", () => {
    const customIcon = <span data-testid="custom-icon">Custom Icon</span>;
    render(<Collapsible {...mockProps} icon={customIcon} />);

    expect(screen.getByTestId("custom-icon")).toBeInTheDocument();
  });

  it("renders with default icon when no icon provided", () => {
    render(<Collapsible {...mockProps} icon={undefined} />);

    const iconButtons = screen.getAllByTestId("icon-button");
    expect(iconButtons[0]).toBeInTheDocument();
    expect(iconButtons[0]).toContainElement(screen.getAllByTestId("mock-svg")[0]);
  });

  it("shows chevron down when collapsed", () => {
    render(<Collapsible {...mockProps} isExpanded={false} />);

    const iconButtons = screen.getAllByTestId("icon-button");
    expect(iconButtons[1]).toContainElement(screen.getAllByTestId("mock-svg")[1]);
  });

  it("shows chevron up when expanded", () => {
    render(<Collapsible {...mockProps} isExpanded />);

    const iconButtons = screen.getAllByTestId("icon-button");
    expect(iconButtons[1]).toContainElement(screen.getAllByTestId("mock-svg")[1]);
  });

  it("applies correct CSS classes when collapsed", () => {
    const { container } = render(<Collapsible {...mockProps} isExpanded={false} />);

    const sectionContainer = container.querySelector('[id="section-test-section"]');
    expect(sectionContainer).toHaveClass("overflow-hidden");
  });

  it("applies correct CSS classes when expanded", () => {
    const { container } = render(<Collapsible {...mockProps} isExpanded />);

    const sectionContainer = container.querySelector('[id="section-test-section"]');
    expect(sectionContainer).toHaveClass("overflow-visible");
  });

  it("sets correct id attributes", () => {
    const { container } = render(<Collapsible {...mockProps} />);

    const section = container.querySelector('[id="section-test-section"]');
    const content = container.querySelector('[id="section-content-test-section"]');

    expect(section).toBeInTheDocument();
    expect(content).toBeInTheDocument();
  });

  it("handles missing sectionId gracefully", () => {
    const propsWithoutSectionId = { ...mockProps, sectionId: undefined };
    render(<Collapsible {...propsWithoutSectionId} />);

    const section = screen.getByRole("button").closest('[id="section-"]');
    const content = screen.getByText("Test content").closest('[id="section-content-"]');

    expect(section).toBeInTheDocument();
    expect(content).toBeInTheDocument();
  });

  it("works without onToggle callback", () => {
    render(<Collapsible {...mockProps} onToggle={undefined} />);

    const button = screen.getByRole("button");
    expect(() => fireEvent.click(button)).not.toThrow();
  });

  it("manages tabindex correctly for focusable elements when collapsed", async () => {
    const childrenWithFocusableElements = (
      <div>
        <button type="button">Focusable Button</button>
        <input type="text" data-testid="test-input" />
        <a href="#test">Link</a>
      </div>
    );

    render(
      <Collapsible {...mockProps} isExpanded={false}>
        {childrenWithFocusableElements}
      </Collapsible>
    );

    await waitFor(() => {
      const button = screen.getByText("Focusable Button");
      const input = screen.getByTestId("test-input");
      const link = screen.getByText("Link");

      expect(button).toHaveAttribute("tabindex", "-1");
      expect(input).toHaveAttribute("tabindex", "-1");
      expect(link).toHaveAttribute("tabindex", "-1");
    });
  });

  it("manages tabindex correctly for focusable elements when expanded", async () => {
    const childrenWithFocusableElements = (
      <div>
        <button type="button">Focusable Button</button>
        <input type="text" data-testid="test-input-expanded" />
        <a href="#test">Link</a>
      </div>
    );

    render(
      <Collapsible {...mockProps} isExpanded>
        {childrenWithFocusableElements}
      </Collapsible>
    );

    await waitFor(() => {
      const button = screen.getByText("Focusable Button");
      const input = screen.getByTestId("test-input-expanded");
      const link = screen.getByText("Link");

      expect(button).not.toHaveAttribute("tabindex", "-1");
      expect(input).not.toHaveAttribute("tabindex", "-1");
      expect(link).not.toHaveAttribute("tabindex", "-1");
    });
  });

  it("wraps non-div children in div", () => {
    const textContent = "Just text content";
    const { container } = render(<Collapsible {...mockProps}>{textContent}</Collapsible>);

    const contentWrapper = container.querySelector(".px-3.pb-12 > div");
    expect(contentWrapper).toBeInTheDocument();
    expect(contentWrapper).toHaveTextContent(textContent);
  });

  it("does not double-wrap div children", () => {
    const divContent = <div>Div content</div>;
    const { container } = render(<Collapsible {...mockProps}>{divContent}</Collapsible>);

    const contentWrapper = container.querySelector(".px-3.pb-12");
    expect(contentWrapper?.children).toHaveLength(1);
    expect(contentWrapper?.firstChild).toHaveTextContent("Div content");
  });

  it("handles overflow visibility transition", async () => {
    const { rerender } = render(<Collapsible {...mockProps} isExpanded={false} />);

    rerender(<Collapsible {...mockProps} isExpanded />);

    const contentDiv = screen.getByText("Test content").closest('[id="section-content-test-section"]');
    expect(contentDiv).toHaveClass("overflow-hidden");

    await waitFor(
      () => {
        expect(contentDiv).toHaveClass("overflow-visible");
      },
      { timeout: 400 }
    );
  });
});

```

## Archivo: `packages/MainUI/__tests__/components/ProcessModal/iframe.test.tsx`

```typescript
import { act, render, screen, waitFor, fireEvent } from "@testing-library/react";
import ProcessIframeModal from "@/components/ProcessModal/Iframe";
import type { ProcessIframeModalOpenProps } from "@/components/ProcessModal/types";
import "@testing-library/jest-dom";

// Mocks
jest.mock("@/hooks/useTranslation", () => ({
  useTranslation: () => ({
    t: (key: string) => key,
  }),
}));

const mockFetchProcessMessage = jest.fn();

jest.mock("@/hooks/useProcessMessage", () => ({
  useProcessMessage: () => ({
    fetchProcessMessage: mockFetchProcessMessage,
  }),
}));

describe("ProcessIframeModal", () => {
  const baseProps: ProcessIframeModalOpenProps = {
    isOpen: true,
    url: "https://example.com",
    onClose: jest.fn(),
    onProcessSuccess: jest.fn(),
    title: "Test Modal",
    tabId: "123",
  };

  beforeEach(() => {
    jest.clearAllMocks();
    mockFetchProcessMessage.mockImplementation(() =>
      Promise.resolve({
        type: "success",
        title: "Success",
        message: "Operation completed",
      })
    );
  });

  it("should not render if isOpen is false", () => {
    const { container } = render(<ProcessIframeModal isOpen={false} />);
    expect(container.firstChild).toBeNull();
  });

  it("renders modal correctly with iframe", async () => {
    render(<ProcessIframeModal {...baseProps} />);
    const iframe = screen.getByTitle("common.processes");

    fireEvent.load(iframe);

    await waitFor(() => expect(screen.queryByText("common.loading")).not.toBeInTheDocument());

    expect(screen.getByRole("heading", { name: /test modal/i })).toBeInTheDocument();
  });

  it("calls onClose when close button is clicked", () => {
    render(<ProcessIframeModal {...baseProps} />);
    const closeButton = screen.getByTestId("close-button");
    fireEvent.click(closeButton);
    expect(baseProps.onClose).toHaveBeenCalled();
  });

  it("sets iframeLoading to false on iframe load", async () => {
    render(<ProcessIframeModal {...baseProps} />);
    const iframe = screen.getByTitle("common.processes");

    fireEvent.load(iframe);

    await waitFor(() => expect(screen.queryByText("common.loading")).not.toBeInTheDocument());
  });

  it("renders processMessage with success style", () => {
    // Forcing state via mocking would be required for full coverage here.
    // Alternatively, expose internal state or extract logic.
    const { rerender } = render(<ProcessIframeModal {...baseProps} />);
    rerender(<ProcessIframeModal {...baseProps} />);
    expect(true).toBe(true);
  });

  it("handles postMessage: closeModal", async () => {
    render(<ProcessIframeModal {...baseProps} />);

    act(() => {
      window.postMessage({ type: "fromIframe", action: "closeModal" }, "*");
    });

    await waitFor(() => {
      expect(baseProps.onClose).toHaveBeenCalled();
    });
  });

  it("handles postMessage: processOrder and calls fetchProcessMessage", async () => {
    mockFetchProcessMessage.mockResolvedValueOnce({
      type: "success",
      title: "Processed",
    });

    render(<ProcessIframeModal {...baseProps} />);

    act(() => {
      window.postMessage({ type: "fromIframe", action: "processOrder" }, "*");
    });

    await waitFor(() => {
      expect(mockFetchProcessMessage).toHaveBeenCalled();
    });
  });

  it("renders fallback message if url is empty", async () => {
    render(<ProcessIframeModal {...baseProps} url="" />);

    await waitFor(() => {
      expect(screen.queryByText("common.loading")).not.toBeInTheDocument();
    });

    expect(screen.getByText("common.noDataAvailable")).toBeInTheDocument();
  });

  it("returns null if isOpen is false (again for coverage)", () => {
    const { container } = render(<ProcessIframeModal isOpen={false} />);
    expect(container.firstChild).toBeNull();
  });
});

```

## Archivo: `packages/MainUI/__tests__/coverage.test.ts`

```typescript
// Dummy test to enable coverage collection for MainUI
// This test exists solely to allow Jest to process files for coverage
describe("Coverage enabler", () => {
  it("enables coverage collection", () => {
    expect(true).toBe(true);
  });
});

```

## Archivo: `packages/MainUI/__tests__/hooks/useProcessDatasourceConfig.test.ts`

```typescript
import { renderHook, act } from "@testing-library/react";
import { useProcessConfig } from "@/hooks/datasource/useProcessDatasourceConfig";
import { Metadata } from "@workspaceui/api-client/src/api/metadata";

// Mock the metadata client
jest.mock("@workspaceui/api-client/src/api/metadata", () => ({
  Metadata: {
    kernelClient: {
      post: jest.fn(),
    },
  },
}));

// Mock the logger
jest.mock("@/utils/logger", () => ({
  logger: {
    error: jest.fn(),
  },
}));

const mockPost = Metadata.kernelClient.post as jest.MockedFunction<typeof Metadata.kernelClient.post>;

describe("useProcessConfig", () => {
  const defaultProps = {
    processId: "test-process-id",
    windowId: "test-window-id",
    tabId: "test-tab-id",
  };

  beforeEach(() => {
    jest.clearAllMocks();
  });

  it("should initialize with default values", () => {
    const { result } = renderHook(() => useProcessConfig(defaultProps));

    expect(result.current.loading).toBe(false);
    expect(result.current.error).toBe(null);
    expect(result.current.config).toBe(null);
    expect(typeof result.current.fetchConfig).toBe("function");
  });

  it("should fetch config successfully", async () => {
    const mockResponse = {
      data: {
        defaults: { field1: { value: "value1", identifier: "id1" } },
        filterExpressions: { filter1: { expr: "expression1" } },
        refreshParent: true,
      },
    };

    mockPost.mockResolvedValueOnce(mockResponse);

    const { result } = renderHook(() => useProcessConfig(defaultProps));

    await act(async () => {
      const config = await result.current.fetchConfig({ testPayload: "test" });
      
      expect(config).toEqual({
        processId: "test-process-id",
        defaults: { field1: { value: "value1", identifier: "id1" } },
        filterExpressions: { filter1: { expr: "expression1" } },
        refreshParent: true,
      });
    });

    expect(result.current.loading).toBe(false);
    expect(result.current.error).toBe(null);
    expect(result.current.config).toEqual({
      processId: "test-process-id",
      defaults: { field1: { value: "value1", identifier: "id1" } },
      filterExpressions: { filter1: { expr: "expression1" } },
      refreshParent: true,
    });
  });

  it("should handle missing required parameters", async () => {
    const { result } = renderHook(() => useProcessConfig({
      processId: "",
      windowId: "test-window-id",
      tabId: "test-tab-id",
    }));

    await act(async () => {
      const config = await result.current.fetchConfig();
      expect(config).toBe(null);
    });

    expect(mockPost).not.toHaveBeenCalled();
  });

  it("should handle API errors", async () => {
    const mockError = new Error("API Error");
    mockPost.mockRejectedValueOnce(mockError);

    const { result } = renderHook(() => useProcessConfig(defaultProps));

    await act(async () => {
      const config = await result.current.fetchConfig();
      expect(config).toBe(null);
    });

    expect(result.current.loading).toBe(false);
    expect(result.current.error).toEqual(new Error("API Error"));
    expect(result.current.config).toBe(null);
  });
});
```

## Archivo: `packages/MainUI/__tests__/tabUtils.test.ts`

```typescript
import { shouldShowTab, type TabWithParentInfo } from "../utils/tabUtils";
import type { Tab } from "@workspaceui/api-client/src/api/types";

const createMockTab = (overrides: Partial<Tab> = {}): Tab => ({
  id: "default-id",
  tabLevel: 0,
  name: "Default Tab",
  _identifier: "default-identifier",
  entityName: "DefaultEntity",
  table$_identifier: "default_table",
  uIPattern: "",
  window: "",
  title: "Default Title",
  parentColumns: [],
  table: "",
  readOnlyLogic: "",
  displayLogic: "",
  orderByClause: "",
  whereClause: "",
  ...overrides
});

const createMockTabWithParentInfo = (overrides: Partial<TabWithParentInfo> = {}): TabWithParentInfo => ({
  ...createMockTab(),
  ...overrides
});

describe("tabUtils", () => {
  describe("shouldShowTab", () => {
    it("should return true for tabs with level 0", () => {
      const tab = createMockTabWithParentInfo({
        id: "tab1",
        tabLevel: 0,
        name: "Root Tab",
        _identifier: "tab1",
        entityName: "Entity",
        table$_identifier: "table1"
      });

      const result = shouldShowTab(tab, null);

      expect(result).toBe(true);
    });

    it("should return false when no active parent tab and level > 0", () => {
      const tab = createMockTabWithParentInfo({
        id: "tab2",
        tabLevel: 1,
        name: "Child Tab",
        _identifier: "tab2",
        entityName: "Entity",
        table$_identifier: "table2"
      });

      const result = shouldShowTab(tab, null);

      expect(result).toBe(false);
    });

    it("should return false when tab is inactive", () => {
      const tab = createMockTabWithParentInfo({
        id: "tab3",
        tabLevel: 1,
        name: "Inactive Tab",
        _identifier: "tab3",
        entityName: "Entity",
        table$_identifier: "table3",
        active: false
      });

      const activeParentTab = createMockTab({
        id: "parent1",
        tabLevel: 0,
        name: "Parent Tab",
        _identifier: "parent1",
        entityName: "ParentEntity",
        table$_identifier: "parent_table"
      });

      const result = shouldShowTab(tab, activeParentTab);

      expect(result).toBe(false);
    });

    it("should return true when parentTabId matches active parent tab id", () => {
      const tab = createMockTabWithParentInfo({
        id: "tab4",
        tabLevel: 1,
        name: "Child Tab",
        _identifier: "tab4",
        entityName: "Entity",
        table$_identifier: "table4",
        parentTabId: "parent1"
      });

      const activeParentTab = createMockTab({
        id: "parent1",
        tabLevel: 0,
        name: "Parent Tab",
        _identifier: "parent1",
        entityName: "ParentEntity",
        table$_identifier: "parent_table"
      });

      const result = shouldShowTab(tab, activeParentTab);

      expect(result).toBe(true);
    });

    it("should return false when parentTabId does not match active parent tab id", () => {
      const tab = createMockTabWithParentInfo({
        id: "tab5",
        tabLevel: 1,
        name: "Child Tab",
        _identifier: "tab5",
        entityName: "Entity",
        table$_identifier: "table5",
        parentTabId: "different_parent"
      });

      const activeParentTab = createMockTab({
        id: "parent1",
        tabLevel: 0,
        name: "Parent Tab",
        _identifier: "parent1",
        entityName: "ParentEntity",
        table$_identifier: "parent_table"
      });

      const result = shouldShowTab(tab, activeParentTab);

      expect(result).toBe(false);
    });

    it("should return true when parentColumns match with entity name", () => {
      const tab = createMockTabWithParentInfo({
        id: "tab6",
        tabLevel: 1,
        name: "Child Tab",
        _identifier: "tab6",
        entityName: "Entity",
        table$_identifier: "table6",
        parentColumns: ["business_partner_id"]
      });

      const activeParentTab = createMockTab({
        id: "parent1",
        tabLevel: 0,
        name: "Parent Tab",
        _identifier: "parent1",
        entityName: "BusinessPartner",
        table$_identifier: "c_bpartner"
      });

      const result = shouldShowTab(tab, activeParentTab);

      expect(result).toBe(true);
    });

    it("should return true when parentColumns match with table identifier", () => {
      const tab = createMockTabWithParentInfo({
        id: "tab7",
        tabLevel: 1,
        name: "Child Tab",
        _identifier: "tab7",
        entityName: "Entity",
        table$_identifier: "table7",
        parentColumns: ["product_id"]
      });

      const activeParentTab = createMockTab({
        id: "parent1",
        tabLevel: 0,
        name: "Parent Tab",
        _identifier: "parent1",
        entityName: "SomeEntity",
        table$_identifier: "m_product"
      });

      const result = shouldShowTab(tab, activeParentTab);

      expect(result).toBe(true);
    });

    it("should return false when parentColumns do not match", () => {
      const tab = createMockTabWithParentInfo({
        id: "tab8",
        tabLevel: 1,
        name: "Child Tab",
        _identifier: "tab8",
        entityName: "Entity",
        table$_identifier: "table8",
        parentColumns: ["unrelated_column_id"]
      });

      const activeParentTab = createMockTab({
        id: "parent1",
        tabLevel: 0,
        name: "Parent Tab",
        _identifier: "parent1",
        entityName: "BusinessPartner",
        table$_identifier: "c_bpartner"
      });

      const result = shouldShowTab(tab, activeParentTab);

      expect(result).toBe(false);
    });

    it("should handle financial prefixes normalization", () => {
      const tab = createMockTabWithParentInfo({
        id: "tab9",
        tabLevel: 1,
        name: "Child Tab",
        _identifier: "tab9",
        entityName: "Entity",
        table$_identifier: "table9",
        parentColumns: ["invoice_id"]
      });

      const activeParentTab = createMockTab({
        id: "parent1",
        tabLevel: 0,
        name: "Parent Tab",
        _identifier: "parent1",
        entityName: "FinInvoice",
        table$_identifier: "c_invoice"
      });

      const result = shouldShowTab(tab, activeParentTab);

      expect(result).toBe(true);
    });

    it("should return false when no parentColumns and no parentTabId", () => {
      const tab = createMockTabWithParentInfo({
        id: "tab10",
        tabLevel: 1,
        name: "Child Tab",
        _identifier: "tab10",
        entityName: "Entity",
        table$_identifier: "table10"
      });

      const activeParentTab = createMockTab({
        id: "parent1",
        tabLevel: 0,
        name: "Parent Tab",
        _identifier: "parent1",
        entityName: "ParentEntity",
        table$_identifier: "parent_table"
      });

      const result = shouldShowTab(tab, activeParentTab);

      expect(result).toBe(false);
    });
  });
});
```

## Archivo: `packages/MainUI/app/(main)/page.tsx`

```typescript
import Page from "./window/page";

export default function HomePage() {
  return <Page />;
}

```

## Archivo: `packages/MainUI/app/(main)/report/[reportId]/page.tsx`

```typescript
"use client";

import { useCallback } from "react";
import { Box, CircularProgress } from "@mui/material";
import { useParams } from "next/navigation";
import DynamicReport from "../../../../components/ad_reports/DynamicReport";
import type { FieldValues } from "react-hook-form";
import { useApiContext } from "@/hooks/useApiContext";
import { useReportMetadata } from "@/hooks/useReportMetadata";
import { useReport } from "@/hooks/useReport";

export default function ReportPage() {
  const params = useParams();
  const reportId = params.reportId as string;
  const { metadata, loading, error } = useReportMetadata(reportId);
  const apiUrl = useApiContext();
  const { generateReport } = useReport(apiUrl);

  const handleSubmit = useCallback(
    async (format: string, data: FieldValues) => {
      if (!metadata) return;

      const reportData = {
        ...data,
        format,
        reportId,
        metadata,
      };
      await generateReport(format, reportData);
    },
    [generateReport, metadata, reportId]
  );

  if (loading) {
    return (
      <Box display="flex" justifyContent="center" m={4}>
        <CircularProgress />
      </Box>
    );
  }

  if (error || !metadata) {
    return <Box m={2}>Report not found</Box>;
  }

  return (
    <Box m={2}>
      <DynamicReport metadata={metadata} onSubmit={handleSubmit} />
    </Box>
  );
}

```

## Archivo: `packages/MainUI/app/(main)/window/page.tsx`

```typescript
"use client";
import { useEffect } from "react";
import { ErrorDisplay } from "@/components/ErrorDisplay";
import Loading from "@/components/loading";
import WindowTabs from "@/components/NavigationTabs/WindowTabs";
import { useMetadataContext } from "@/hooks/useMetadataContext";
import { useMultiWindowURL } from "@/hooks/navigation/useMultiWindowURL";
import { useQueryParams } from "@/hooks/useQueryParams";
import Home from "@/screens/Home";
import { useTranslation } from "@/hooks/useTranslation";
import Window from "@/components/window/Window";
import TabsProvider from "@/contexts/tabs";

export default function Page() {
  const { loading, error } = useMetadataContext();
  const { windows, activeWindow, isHomeRoute, openWindow } = useMultiWindowURL();
  const { windowId } = useQueryParams<{ windowId?: string }>();
  const { t } = useTranslation();

  useEffect(() => {
    if (windowId && windows.length === 0) {
      openWindow(windowId);
    }
  }, [windowId, windows.length, openWindow]);

  if (loading) {
    return <Loading />;
  }

  if (error) {
    return <ErrorDisplay title={error?.message ?? t("errors.internalServerError.title")} />;
  }

  const shouldShowTabs = windows.length > 0;

  return (
    <div className="flex flex-col gap-2 w-full h-full max-h-full p-1 pb-0">
      {shouldShowTabs && (
        <TabsProvider>
          <WindowTabs />
        </TabsProvider>
      )}

      {isHomeRoute || !activeWindow ? <Home /> : <Window windowId={activeWindow.windowId} />}
    </div>
  );
}

```

## Archivo: `packages/MainUI/app/layout.tsx`

```typescript
import type { Metadata } from "next/types";
import { Inter } from "next/font/google";
import ApiProviderWrapper from "@/contexts/api/wrapper";
import "./styles/global.css";
import ThemeProvider from "@workspaceui/componentlibrary/src/components/ThemeProvider";
import LanguageProvider from "@/contexts/language";
import LoadingProvider from "@/contexts/loading";
import UserProvider from "@/contexts/user";
import { DatasourceProvider } from "@/contexts/datasourceContext";
import MetadataProvider from "@/contexts/metadata";
import Layout from "@/components/layout";
import { DENSITY_KEY } from "@/utils/accessibility/constants";

const inter = Inter({
  subsets: ["latin"],
  display: "swap",
  variable: "--font-inter",
});

export const metadata: Metadata = {
  title: "Etendo",
  applicationName: "Etendo",
};

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  const setInitialDensityScript = `
    (function() {
      try {
        const className = localStorage.getItem("${DENSITY_KEY}");
        if (className) document.documentElement.classList.add(JSON.parse(className));
      } catch(e) {}
    })();
  `;

  return (
    <html lang="en" className={inter.variable}>
      <head>
        <meta charSet="utf-8" />
        <link rel="icon" href="/favicon.ico" sizes="any" />
        {/* biome-ignore lint/security/noDangerouslySetInnerHtml: 
        Apply the density class as early as possible to avoid layout shift. 
        This script is 100% safe because it doesn't evaluate user input. */}
        <script dangerouslySetInnerHTML={{ __html: setInitialDensityScript }} />
      </head>
      <body>
        <ApiProviderWrapper>
          <ThemeProvider>
            <LanguageProvider>
              <UserProvider>
                <DatasourceProvider>
                  <MetadataProvider>
                    <LoadingProvider>
                      <Layout>{children}</Layout>
                    </LoadingProvider>
                  </MetadataProvider>
                </DatasourceProvider>
              </UserProvider>
            </LanguageProvider>
          </ThemeProvider>
        </ApiProviderWrapper>
      </body>
    </html>
  );
}

```

## Archivo: `packages/MainUI/app/loading.tsx`

```typescript
import Loading from "@/components/loading";

export default function LoadingScreen() {
  return <Loading />;
}

```

## Archivo: `packages/MainUI/app/not-found.tsx`

```typescript
import Link from "next/link";
import { Button } from "@mui/material";
import { getLanguage, t } from "@/utils/language";
import { ErrorDisplay } from "@/components/ErrorDisplay";

export default function NotFound() {
  const language = getLanguage();

  return (
    <div className="w-full min-h-full flex items-center justify-center">
      <ErrorDisplay
        title={t(language, "errors.notFound.title")}
        description={t(language, "errors.notFound.description")}>
        <Link href="/">
          <Button variant="contained">{t(language, "navigation.common.home")}</Button>
        </Link>
      </ErrorDisplay>
    </div>
  );
}

```

## Archivo: `packages/MainUI/app/types.ts`

```typescript
export type WindowParams = {
  [K in "windowId" | "tabId" | "recordId"]: string;
};

```

## Archivo: `packages/MainUI/components/Breadcrums.tsx`

```typescript
"use client";

import { useCallback, useMemo } from "react";
import { useQueryParams } from "@/hooks/useQueryParams";
import Breadcrumb from "@workspaceui/componentlibrary/src/components/Breadcrums";
import type { BreadcrumbItem } from "@workspaceui/componentlibrary/src/components/Breadcrums/types";
import { usePathname } from "next/navigation";
import type React from "react";
import { ROUTE_IDS } from "../constants/breadcrumb";
import { useMetadataContext } from "../hooks/useMetadataContext";
import { useTranslation } from "../hooks/useTranslation";
import { useMultiWindowURL } from "@/hooks/navigation/useMultiWindowURL";
import type { Tab } from "@workspaceui/api-client/src/api/types";
import { useSelected } from "@/hooks/useSelected";
import { NEW_RECORD_ID } from "@/utils/url/constants";

interface BreadcrumbProps {
  allTabs: Tab[][];
}

const AppBreadcrumb: React.FC<BreadcrumbProps> = ({ allTabs }) => {
  const { t } = useTranslation();
  const pathname = usePathname();
  const { window } = useMetadataContext();
  const { windowId } = useQueryParams<{ windowId: string }>();
  const { navigateToHome, clearTabFormState, getTabFormState } = useMultiWindowURL();
  const { graph } = useSelected();

  const allTabsFormatted = useMemo(() => allTabs.flat(), [allTabs]);
  const currentTab = useMemo(
    () => allTabsFormatted.find((tab) => tab.window === windowId),
    [allTabsFormatted, windowId]
  );

  const isNewRecord = useCallback(() => pathname.includes("/NewRecord"), [pathname]);

  const handleWindowClick = useCallback(
    (windowId: string) => {
      const allTabsFormatted = allTabs.flat();
      const currentTab = allTabsFormatted.find((tab) => tab.window === windowId);
      if (windowId && currentTab && currentTab.id) {
        clearTabFormState(windowId, currentTab.id);
      }
      if (currentTab && graph) {
        graph.clear(currentTab);
        graph.clearSelected(currentTab);
      }
    },
    [clearTabFormState, allTabs, graph]
  );

  const breadcrumbItems = useMemo(() => {
    const items: BreadcrumbItem[] = [];

    if (windowId && window) {
      items.push({
        id: windowId,
        label: String(window.window$_identifier || window.name || t("common.loading")),
        onClick: () => handleWindowClick(windowId),
      });
    }

    if (isNewRecord()) {
      items.push({
        id: ROUTE_IDS.NEW_RECORD,
        label: t("breadcrumb.newRecord"),
      });
    }

    if (currentTab) {
      const tabFormState = windowId ? getTabFormState(windowId, currentTab.id) : undefined;
      const currentRecordId = tabFormState?.recordId || "";

      if (currentRecordId && currentRecordId !== NEW_RECORD_ID) {
        items.push({
          id: currentRecordId.toString(),
          label: currentRecordId.toString(),
        });
      }
    }

    return items;
  }, [windowId, window, currentTab, isNewRecord, t, handleWindowClick, getTabFormState]);

  const handleHomeClick = useCallback(() => {
    navigateToHome();
  }, [navigateToHome]);

  return (
    <div className="w-full h-8">
      <Breadcrumb onHomeClick={handleHomeClick} items={breadcrumbItems || []} />
    </div>
  );
};

export default AppBreadcrumb;

```

## Archivo: `packages/MainUI/components/Drawer/RecentlyViewed/index.tsx`

```typescript
import type { RecentlyViewedProps } from "@workspaceui/componentlibrary/src/components/Drawer/types";
import type { Menu } from "@workspaceui/api-client/src/api/types";
import { forwardRef, useCallback, useEffect, useImperativeHandle, useState } from "react";
import { useRecentItems } from "../../../hooks/useRecentItems";
import { useTranslation } from "../../../hooks/useTranslation";
import { useUserContext } from "../../../hooks/useUserContext";
import clsx from "clsx";
import ChevronDown from "../../../../ComponentLibrary/src/assets/icons/chevron-down.svg";
import DrawerSection from "@workspaceui/componentlibrary/src/components/Drawer/DrawerSection";
import { CLOCK_B64 } from "@workspaceui/componentlibrary/src/components/Drawer/MenuTitle/constants";
import MenuLibrary from "../../../../ComponentLibrary/src/components/Menu";

export const RecentlyViewed = forwardRef<{ handleWindowAccess: (item: Menu) => void }, RecentlyViewedProps>(
  ({ onClick, items, getTranslatedName, open, windowId }, ref) => {
    const [expanded, setExpanded] = useState<boolean>(false);
    const [anchorEl, setAnchorEl] = useState<HTMLElement | null>(null);

    const { t } = useTranslation();
    const { currentRole } = useUserContext();

    const handleCloseMenu = useCallback(() => {
      setAnchorEl(null);
    }, []);

    const handleClickAndClose = useCallback(
      (item: Menu) => {
        onClick(item);
        handleCloseMenu();
      },
      [handleCloseMenu, onClick]
    );

    const handleClick = useCallback(
      (event: React.MouseEvent<HTMLElement>) => {
        if (!open) {
          return setAnchorEl(event.currentTarget);
        }
        setExpanded((prev) => !prev);
      },
      [open]
    );

    const { localRecentItems, handleRecentItemClick, addRecentItem, updateTranslations } = useRecentItems(
      items,
      onClick,
      currentRole?.id ?? "",
      getTranslatedName
    );

    useEffect(() => {
      if (currentRole?.id && items.length > 0) {
        updateTranslations(items);
      }
    }, [items, currentRole?.id, updateTranslations]);

    const handleWindowAccess = useCallback(
      (item: Menu) => {
        if (item.id && item.type) {
          addRecentItem(item);
        }
      },
      [addRecentItem]
    );

    useImperativeHandle(
      ref,
      () => ({
        handleWindowAccess,
      }),
      [handleWindowAccess]
    );

    if (!currentRole?.id || localRecentItems.length === 0) return null;

    const item = {
      id: "recently-viewed",
      name: t("drawer.recentlyViewed"),
      type: "Folder",
      children: [],
    };

    return (
      <div className="p-2">
        <button
          type="button"
          onClick={handleClick}
          className={`flex transition-colors duration-300 cursor-pointer w-full items-center
            ${open ? "rounded-lg" : "p-2.5 rounded-full justify-center"}
             text-xl justify-between p-1 gap-1 hover:[&_img]:filter-[brightness(0)_saturate(100%)_invert(18%)_sepia(40%)_saturate(7101%)_hue-rotate(215deg)_brightness(91%)_contrast(102%)] ${"text-neutral-90 hover:bg-dynamic-contrast-text hover:text-dynamic-main hover:text-neutral-0"}`}>
          <div className={`flex items-center ${open ? "overflow-hidden" : ""}`}>
            <div className={`${open ? "w-8" : "w-full h-full"} flex justify-center items-center`}>
              <img
                alt="img"
                src={`data:image/svg+xml;base64,${CLOCK_B64}`}
                className="filter-[brightness(0)_saturate(100%)_invert(9%)_sepia(100%)_saturate(3080%)_hue-rotate(212deg)_brightness(97%)_contrast(101%)] w-5 h-5"
              />
            </div>
            {open && (
              <div className="relative group flex items-center py-1.5">
                <span className="ml-2 font-medium text-sm whitespace-nowrap overflow-hidden text-ellipsis max-w-40">
                  {item.name}
                </span>
              </div>
            )}
          </div>

          {open && item.children && (
            <div className={`transition-transform duration-300 flex justify-center ${expanded ? "rotate-180" : ""}`}>
              <ChevronDown />
            </div>
          )}
        </button>

        {expanded && open && (
          <div className="pt-2 pl-4 flex flex-wrap gap-2 w-full">
            {localRecentItems.map((recentItem) => (
              <button
                key={recentItem.id}
                type="button"
                onClick={() => handleRecentItemClick(recentItem)}
                className={clsx(
                  "rounded-full px-4 py-1 text-sm font-medium border",
                  "bg-[#00030D0D] text-gray-800 border-gray-300 hover:bg-gray-200 transition"
                )}>
                {recentItem.name}
              </button>
            ))}
          </div>
        )}
        {!open && (
          <MenuLibrary
            className="max-h-80 w-full max-w-60  overflow-y-scroll overflow-hidden hide-scrollbar"
            anchorEl={anchorEl}
            offsetX={52}
            offsetY={-40}
            onClose={handleCloseMenu}>
            <div
              className="border-b border-transparent-neutral-5 h-13 flex items-center px-6 bg-neutral-50 
                font-inter font-semibold text-[14px] leading-[20px] tracking-[0.15px] text-baseline-80">
              {item.name}
            </div>
            {localRecentItems?.map((subitem) => (
              <DrawerSection
                key={subitem.id}
                item={subitem}
                onClick={handleClickAndClose}
                open={true}
                isSearchActive={false}
                onToggleExpand={() => {}}
                hasChildren={false}
                isExpandable={false}
                isExpanded={false}
                parentId={subitem.id}
                windowId={windowId}
              />
            ))}
          </MenuLibrary>
        )}
      </div>
    );
  }
);

RecentlyViewed.displayName = "RecentlyViewed";
export default RecentlyViewed;

```

## Archivo: `packages/MainUI/components/ErrorDisplay.tsx`

```typescript
"use client";

import Image from "next/image";
import { Button } from "@mui/material";
import { useTranslation } from "../hooks/useTranslation";
import errorImage from "../../ComponentLibrary/src/assets/images/NotificationModal/empty-state-notifications.svg?url";
import Link from "next/link";
import type { ErrorDisplayProps } from "./types";

export function ErrorDisplay({
  title,
  description,
  showRetry = false,
  onRetry,
  showHomeButton = false,
  children,
}: ErrorDisplayProps & { children?: React.ReactNode }) {
  const { t } = useTranslation();

  return (
    <div className="w-full max-w-md p-8 mx-auto bg-white rounded-lg shadow-md flex flex-col items-center">
      <div className="mb-6 max-w-xs">
        <Image src={errorImage} width={240} height={240} alt="Error" className="mx-auto" priority />
      </div>
      <h2 className="text-2xl font-semibold text-gray-800 mb-3 text-center">{title}</h2>
      {description && <p className="text-gray-600 mb-6 text-center">{description}</p>}
      {children}
      <div className="flex flex-col sm:flex-row gap-3 mt-2 w-full justify-center">
        {showRetry && onRetry && (
          <Button
            variant="contained"
            onClick={onRetry}
            className="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-md">
            {t("errors.internalServerError.retry")}
          </Button>
        )}
        {showHomeButton && (
          <Link href="/">
            <Button variant="contained" className="bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded-md">
              {t("navigation.common.home")}
            </Button>
          </Link>
        )}
      </div>
    </div>
  );
}

```

## Archivo: `packages/MainUI/components/Form/Collapsible.tsx`

```typescript
"use client";

import ChevronDown from "@workspaceui/componentlibrary/src/assets/icons/chevron-down.svg";
import ChevronUp from "@workspaceui/componentlibrary/src/assets/icons/chevron-up.svg";
import InfoIcon from "@workspaceui/componentlibrary/src/assets/icons/file-text.svg";
import IconButton from "@workspaceui/componentlibrary/src/components/IconButton";
import React, { type CSSProperties, memo, useCallback, useEffect, useMemo, useRef, useState } from "react";
import type { CollapsibleProps } from "./FormView/types";

function CollapsibleCmp({ title, icon, children, isExpanded, sectionId = "", onToggle }: CollapsibleProps) {
  const contentRef = useRef<React.ElementRef<"div">>(null);
  const [maxHeight, setMaxHeight] = useState<CSSProperties["maxHeight"]>("100%");
  const [overflowVisible, setOverflowVisible] = useState(false);
  const style = useMemo(() => ({ maxHeight: isExpanded ? maxHeight : 0 }), [isExpanded, maxHeight]);

  const handleToggle = useCallback(() => {
    if (onToggle) {
      onToggle(!isExpanded);
    }
  }, [isExpanded, onToggle]);

  useEffect(() => {
    if (contentRef.current) {
      setMaxHeight(contentRef.current.scrollHeight);
    }
  }, [isExpanded, children]);

  useEffect(() => {
    if (isExpanded) {
      const timeoutId = setTimeout(() => {
        setOverflowVisible(true);
      }, 300);
      return () => clearTimeout(timeoutId);
    }
    setOverflowVisible(false);
  }, [isExpanded]);

  useEffect(() => {
    if (!contentRef.current) return;

    const focusableElements = contentRef.current.querySelectorAll(
      'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
    );

    for (const el of focusableElements) {
      if (isExpanded) {
        if ((el as HTMLElement).dataset.originalTabIndex) {
          (el as HTMLElement).setAttribute("tabindex", (el as HTMLElement).dataset.originalTabIndex || "0");
          delete (el as HTMLElement).dataset.originalTabIndex;
        }
      } else {
        if (!(el as HTMLElement).dataset.originalTabIndex) {
          (el as HTMLElement).dataset.originalTabIndex = (el as HTMLElement).getAttribute("tabindex") || "0";
        }
        (el as HTMLElement).setAttribute("tabindex", "-1");
      }
    }
  }, [isExpanded]);

  const handleKeyDown = useCallback(
    (e: React.KeyboardEvent) => {
      if (e.key === "Enter" || e.key === " ") {
        handleToggle();
        e.preventDefault();
      }
    },
    [handleToggle]
  );

  return (
    <div
      id={`section-${sectionId}`}
      className={`flex flex-col gap-3 bg-white rounded-xl border border-gray-200 ${isExpanded ? "overflow-visible" : "overflow-hidden"}`}>
      <div
        // biome-ignore lint/a11y/useSemanticElements: <explanation>
        role="button"
        tabIndex={0}
        aria-expanded={isExpanded}
        aria-controls={`section-content-${sectionId}`}
        className={`w-full h-12 flex justify-between text-(--color-baseline-90) hover:text-(--color-dynamic-main)
          items-center p-4 cursor-pointer transition-colors hover:bg-(--color-dynamic-contrast-text) bg-gray-50 ${isExpanded ? "rounded-xl" : ""}`}
        onClick={handleToggle}
        onKeyDown={handleKeyDown}>
        <div className="flex items-center gap-3">
          <IconButton className="[&>svg]:text-[1rem]">{icon || <InfoIcon />}</IconButton>
          <span className="font-semibold text-gray-800">{title}</span>
        </div>
        <div>
          <IconButton>{isExpanded ? <ChevronUp /> : <ChevronDown />}</IconButton>
        </div>
      </div>
      <div
        id={`section-content-${sectionId}`}
        ref={contentRef}
        className={`transition-all duration-300 ease-in-out ${
          overflowVisible ? "overflow-visible" : "overflow-hidden"
        }`}
        style={style}
        aria-hidden={!isExpanded}>
        <div className="px-3 pb-12">
          {React.isValidElement(children) && children.type === "div" ? children : <div>{children}</div>}
        </div>
      </div>
    </div>
  );
}

export const Collapsible = memo(CollapsibleCmp);
export default Collapsible;

```

## Archivo: `packages/MainUI/components/Form/FormView/Label.tsx`

```typescript
import { memo, useMemo } from "react";
import { useFormContext } from "react-hook-form";
import { isEntityReference } from "@workspaceui/api-client/src/utils/metadata";
import type { Field } from "@workspaceui/api-client/src/api/types";
import { getFieldReference } from "@/utils";
import BaseLabel from "@/components/Label";
import { useRedirect } from "@/hooks/navigation/useRedirect";
import { CUSTOM_SELECTORS_IDENTIFIERS } from "@/utils/form/constants";

function LabelCmp({ field }: { field: Field }) {
  const { watch } = useFormContext();
  const value = watch(field.hqlName);
  const isReference = useMemo(() => isEntityReference(getFieldReference(field.column?.reference)), [field]);
  const { handleClickRedirect, handleKeyDownRedirect } = useRedirect();

  if (
    field.fieldGroup !== "audit" &&
    value &&
    isReference &&
    field.column.referenceSearchKey$_identifier !== CUSTOM_SELECTORS_IDENTIFIERS.LOCATION
  ) {
    return (
      <BaseLabel
        name={`${field.name} ⤴️`}
        htmlFor={field.hqlName}
        onClick={(e) => handleClickRedirect(e, field.referencedWindowId, field.name)}
        onKeyDown={(e) => handleKeyDownRedirect(e, field.referencedWindowId, field.name)}
        link
      />
    );
  }

  return <BaseLabel name={field.name} htmlFor={field.hqlName} />;
}

const Label = memo(LabelCmp, () => true);
export { Label };
export default Label;

```

## Archivo: `packages/MainUI/components/Form/FormView/Sections/DottedLine.tsx`

```typescript
import { useMemo } from "react";
import { Box, useTheme } from "@mui/material";

const useStyle = () => {
  const theme = useTheme();

  return useMemo(
    () => ({
      dottedLine: {
        backgroundImage: `radial-gradient(circle, ${theme.palette.divider} 1px, transparent 1px)`,
        backgroundSize: "8px 8px",
        backgroundPosition: "right",
        backgroundRepeat: "repeat-y",
        width: "8px",
        height: "100%",
        margin: "0 1rem",
      },
    }),
    [theme.palette.divider]
  );
};

const DottedLine = ({
  fields,
  dottedLineInterval,
  index,
}: {
  fields: unknown[];
  dottedLineInterval: number;
  index: number;
}) => {
  const { dottedLine } = useStyle();
  const shouldRenderDottedLine = index < fields.length && (index + 1) % dottedLineInterval !== 0;

  if (shouldRenderDottedLine) {
    return <Box sx={dottedLine} />;
  }

  return null;
};

export default DottedLine;

```

## Archivo: `packages/MainUI/components/Form/FormView/Sections/FieldLabel.tsx`

```typescript
import { Box, Link } from "@mui/material";
import { useStyle } from "../styles";
import type { FieldLabelProps } from "../types";

export const FieldLabel = ({ isEntityReference, label, required, onLinkClick }: FieldLabelProps) => {
  const { styles, sx } = useStyle();

  return (
    <Box sx={styles.labelWrapper}>
      {isEntityReference ? (
        <Link onClick={onLinkClick} sx={sx.linkStyles}>
          {label}
        </Link>
      ) : (
        <span style={styles.labelText}>{label}</span>
      )}
      {required && <span style={styles.requiredAsterisk}>*</span>}
      <span style={styles.dottedSpacing} />
    </Box>
  );
};

```

## Archivo: `packages/MainUI/components/Form/FormView/Sections/noteSection.tsx`

```typescript
import { useState, useEffect } from "react";
import { Box, Grid, Card, CardContent, Typography, Button, TextField, useTheme } from "@mui/material";
import Modal from "@workspaceui/componentlibrary/src/components/BasicModal";
import CloseIcon from "@workspaceui/componentlibrary/src/assets/icons/x.svg";
import NoteIcon from "@workspaceui/componentlibrary/src/assets/icons/note.svg";
import PlusIcon from "@workspaceui/componentlibrary/src/assets/icons/plus-circle.svg";
import type { Note, NoteSectionProps } from "../types";
import { noteColors, useStyle } from "../styles";
import IconButton from "@workspaceui/componentlibrary/src/components/IconButton";

const NoteSection = ({
  sectionId,
  addNoteButtonText,
  modalTitleText,
  modalDescriptionText,
  noteInputPlaceholder,
  addNoteSubmitText,
}: NoteSectionProps) => {
  const { sx } = useStyle();
  const theme = useTheme();
  const [notes, setNotes] = useState<Note[]>([]);
  const [newNote, setNewNote] = useState("");

  useEffect(() => {
    const storedNotes = sessionStorage.getItem(`notes-${sectionId}`);
    if (storedNotes) {
      setNotes(JSON.parse(storedNotes));
    }
  }, [sectionId]);

  const getRandomColor = () => {
    const colors = noteColors;
    return colors[Math.floor(Math.random() * colors.length)];
  };

  const addNote = () => {
    if (newNote.trim()) {
      const newNoteObj: Note = {
        id: Date.now().toString(),
        content: newNote,
        createdAt: new Date().toISOString(),
        color: getRandomColor(),
      };
      const updatedNotes = [...notes, newNoteObj];
      setNotes(updatedNotes);
      sessionStorage.setItem(`notes-${sectionId}`, JSON.stringify(updatedNotes));
      setNewNote("");
    }
  };

  const deleteNote = (id: string) => {
    const updatedNotes = notes.filter((note) => note.id !== id);
    setNotes(updatedNotes);
    sessionStorage.setItem(`notes-${sectionId}`, JSON.stringify(updatedNotes));
  };

  return (
    <Box>
      <Grid container spacing={2}>
        <Grid item xs={6}>
          <Modal
            HeaderIcon={NoteIcon}
            tittleHeader={modalTitleText}
            descriptionText={modalDescriptionText}
            customTrigger={
              <Button sx={sx.addNoteButton}>
                <IconButton>
                  <PlusIcon fill={theme.palette.baselineColor.neutral[80]} />
                </IconButton>
                <Typography variant="body1" sx={sx.addNoteText}>
                  {addNoteButtonText}
                </Typography>
              </Button>
            }>
            <TextField
              fullWidth
              multiline
              rows={4}
              value={newNote}
              onChange={(e) => setNewNote(e.target.value)}
              placeholder={noteInputPlaceholder}
            />
            <Button onClick={addNote} variant="contained" sx={{ mt: 2 }}>
              {addNoteSubmitText}
            </Button>
          </Modal>
        </Grid>
        {notes.map((note) => (
          <Grid item xs={6} key={note.id}>
            <Card sx={{ ...sx.noteCard, backgroundColor: note.color }}>
              <CardContent sx={sx.noteCardContent}>
                <Box sx={sx.noteContentBox}>
                  <Typography variant="body1" sx={sx.noteContentText}>
                    {note.content}
                  </Typography>
                </Box>
                <Typography variant="body2" component="div" sx={sx.noteDate}>
                  {new Date(note.createdAt).toDateString()}
                </Typography>
                <Box sx={sx.deleteButtonBox}>
                  <IconButton onClick={() => deleteNote(note.id)}>
                    <CloseIcon fontSize="small" />
                  </IconButton>
                </Box>
              </CardContent>
            </Card>
          </Grid>
        ))}
      </Grid>
    </Box>
  );
};

export default NoteSection;

```

## Archivo: `packages/MainUI/components/Form/FormView/StatusBar.tsx`

```typescript
import type { Field } from "@workspaceui/api-client/src/api/types";
import StatusBarField from "./StatusBarField";
import { IconButton } from "@workspaceui/componentlibrary/src/components";
import CloseIcon from "@workspaceui/componentlibrary/src/assets/icons/x.svg";
import { useTranslation } from "@/hooks/useTranslation";
import { useToolbarContext } from "@/contexts/ToolbarContext";
import { useEffect, useState } from "react";

export default function StatusBar({ fields }: { fields: Record<string, Field> }) {
  const [isSaved, setIsSaved] = useState(false);
  const { t } = useTranslation();
  const { onBack, onSave } = useToolbarContext();

  const handleCloseRecord = async () => {
    try {
      await onSave();
      setIsSaved(true);
    } catch (error) {
      console.error("Error saving record", error);
    }
  };

  useEffect(() => {
    if (isSaved) {
      onBack();
    }

    return () => {
      setIsSaved(false);
    };
  }, [isSaved, onBack]);

  return (
    <div className="h-10 flex items-center justify-between bg-gray-100/50 shadow px-3 py-2 rounded-xl">
      <div className="flex gap-4 text-sm">
        {Object.entries(fields).map(([key, field]) => (
          <StatusBarField key={key} field={field} />
        ))}
      </div>
      <IconButton
        onClick={handleCloseRecord}
        className="w-8 h-8"
        tooltip={t("forms.statusBar.closeRecord")}
        disabled={false}>
        <CloseIcon />
      </IconButton>
    </div>
  );
}

```

## Archivo: `packages/MainUI/components/Form/FormView/StatusBarField.tsx`

```typescript
import type { Field } from "@workspaceui/api-client/src/api/types";
import { useFormContext } from "react-hook-form";
import { useFieldValue } from "@/hooks/useFieldValue";

export default function StatusBarField({ field }: { field: Field }) {
  const { register } = useFormContext();
  const { displayValue } = useFieldValue(field);

  return (
    <div className="inline-flex gap-1">
      <label htmlFor={field.hqlName} className="font-semibold">
        {field.name}:
      </label>
      <span className="" {...register(field.hqlName)}>
        {displayValue}
      </span>
    </div>
  );
}

```

## Archivo: `packages/MainUI/components/Form/FormView/index.tsx`

```typescript
import { useToolbarContext } from "@/contexts/ToolbarContext";
import { useStatusModal } from "@/hooks/Toolbar/useStatusModal";
import { useFormAction } from "@/hooks/useFormAction";
import useFormFields from "@/hooks/useFormFields";
import { useFormInitialState } from "@/hooks/useFormInitialState";
import { useFormInitialization } from "@/hooks/useFormInitialization";
import { useSelected } from "@/hooks/useSelected";
import { useTheme } from "@mui/material";
import InfoIcon from "@workspaceui/componentlibrary/src/assets/icons/file-text.svg";
import FileIcon from "@workspaceui/componentlibrary/src/assets/icons/file.svg";
import FolderIcon from "@workspaceui/componentlibrary/src/assets/icons/folder.svg";
import Info from "@workspaceui/componentlibrary/src/assets/icons/info.svg";
import PrimaryTabs from "@workspaceui/componentlibrary/src/components/PrimaryTab";
import type { TabItem } from "@workspaceui/componentlibrary/src/components/PrimaryTab/types";
import Spinner from "@workspaceui/componentlibrary/src/components/Spinner";
import StatusModal from "@workspaceui/componentlibrary/src/components/StatusModal";
import { type EntityData, type EntityValue, FormMode } from "@workspaceui/api-client/src/api/types";
import { useCallback, useEffect, useMemo, useRef, useState } from "react";
import { FormProvider, type SetValueConfig, useForm } from "react-hook-form";
import Collapsible from "../Collapsible";
import StatusBar from "./StatusBar";
import { BaseSelector, compileExpression } from "./selectors/BaseSelector";
import type { FormViewProps } from "./types";
import { useUserContext } from "@/hooks/useUserContext";
import { useMultiWindowURL } from "@/hooks/navigation/useMultiWindowURL";
import { NEW_RECORD_ID } from "@/utils/url/constants";
import { useTabContext } from "@/contexts/tab";
import { FormInitializationProvider } from "@/contexts/FormInitializationContext";

const iconMap: Record<string, React.ReactElement> = {
  "Main Section": <FileIcon />,
  "More Information": <InfoIcon />,
  Dimensions: <FolderIcon />,
};

const processFormData = (data: Record<string, EntityValue>): Record<string, EntityValue> => {
  const processedData = { ...data };

  for (const key of Object.keys(processedData)) {
    const value = processedData[key];
    if (typeof value === "undefined") {
      processedData[key] = "";
    }
  }

  return processedData;
};

export function FormView({ window: windowMetadata, tab, mode, recordId, setRecordId }: FormViewProps) {
  const theme = useTheme();

  const [expandedSections, setExpandedSections] = useState<string[]>(["null"]);
  const [selectedTab, setSelectedTab] = useState<string>("");
  const [isSucessfullEdit, setIsSucessfullEdit] = useState(false);
  const [isFormInitializing, setIsFormInitializing] = useState(false);

  const sectionRefs = useRef<{ [key: string]: HTMLElement | null }>({});
  const containerRef = useRef<HTMLDivElement>(null);

  const { graph } = useSelected();
  const { session } = useUserContext();
  const { activeWindow, getSelectedRecord, clearTabFormState, setSelectedRecord } = useMultiWindowURL();
  const { statusModal, showSuccessModal, showErrorModal, hideStatusModal } = useStatusModal();
  const { registerActions } = useToolbarContext();
  const { markFormAsChanged, resetFormChanges } = useTabContext();
  const {
    formInitialization,
    refetch,
    loading: loadingFormInitialization,
  } = useFormInitialization({
    tab,
    mode: mode,
    recordId,
  });
  const initialState = useFormInitialState(formInitialization) || undefined;

  const defaultIcon = useMemo(
    () => <Info fill={theme.palette.baselineColor.neutral[80]} />,
    [theme.palette.baselineColor.neutral]
  );

  const getIconForGroup = useCallback(
    (identifier: string) => {
      return iconMap[identifier] || defaultIcon;
    },
    [defaultIcon]
  );

  const record = useMemo(() => {
    const windowId = activeWindow?.windowId;
    if (!windowId) return null;

    if (recordId === NEW_RECORD_ID) return null;

    const selectedRecordId = getSelectedRecord(windowId, tab.id);
    if (selectedRecordId && selectedRecordId === recordId) {
      const graphRecord = graph.getSelected(tab);
      if (graphRecord && String(graphRecord.id) === recordId) {
        return graphRecord;
      }

      return { id: selectedRecordId } as EntityData;
    }

    if (recordId && recordId !== NEW_RECORD_ID) {
      return { id: recordId } as EntityData;
    }

    return null;
  }, [activeWindow?.windowId, getSelectedRecord, tab, recordId, graph]);

  const availableFormData = useMemo(() => {
    return { ...record, ...initialState };
  }, [record, initialState]);

  const { fields, groups } = useFormFields(tab, mode, false, availableFormData);

  const formMethods = useForm({ values: availableFormData as EntityData });
  const { reset, setValue, formState, ...form } = formMethods;

  const resetRef = useRef(reset);
  resetRef.current = reset;

  const stableReset = useCallback((data: EntityData) => {
    resetRef.current(data);
  }, []);

  const tabs: TabItem[] = useMemo(() => {
    return groups.map(([id, group]) => ({
      id: String(id || "_main"),
      icon: getIconForGroup(group.identifier),
      label: group.identifier,
      fill: theme.palette.baselineColor.neutral[80],
      hoverFill: theme.palette.baselineColor.neutral[0],
      showInTab: true,
    }));
  }, [groups, getIconForGroup, theme.palette.baselineColor.neutral]);

  useEffect(() => {
    if (formState.isDirty) {
      markFormAsChanged();
    }

    return () => {
      resetFormChanges();
    };
  }, [formState.isDirty, markFormAsChanged, resetFormChanges]);

  useEffect(() => {
    if (selectedTab && containerRef.current) {
      const sectionElement = sectionRefs.current[selectedTab];
      if (sectionElement) {
        const containerRect = containerRef.current.getBoundingClientRect();
        const sectionRect = sectionElement.getBoundingClientRect();

        const sectionTop = sectionRect.top - containerRect.top + containerRef.current.scrollTop;

        containerRef.current.scrollTo({
          top: Math.max(0, sectionTop - 20),
          behavior: "smooth",
        });
      }
    }
  }, [selectedTab, expandedSections]);

  useEffect(() => {
    if (recordId || isSucessfullEdit) {
      refetch();
      setIsSucessfullEdit(false);
    }

    return () => {
      setIsSucessfullEdit(false);
    };
  }, [recordId, isSucessfullEdit, refetch, mode]);

  useEffect(() => {
    if (!availableFormData) return;

    setIsFormInitializing(true);
    const processedData = processFormData(availableFormData);
    stableReset(processedData);

    setTimeout(() => {
      setIsFormInitializing(false);
    }, 50);
  }, [availableFormData, tab.id, stableReset]);

  const handleSetValue = useCallback(
    (name: string, value: EntityValue, options?: SetValueConfig) => {
      const { shouldDirty = true, ...rest } = options || {};
      setValue(name, value, { shouldDirty, ...rest });
    },
    [setValue]
  );

  const handleTabChange = useCallback((newTabId: string) => {
    setSelectedTab(newTabId);
    setExpandedSections((prev) => {
      if (!prev.includes(newTabId)) {
        return [...prev, newTabId];
      }
      return prev;
    });
  }, []);

  const handleSectionRef = useCallback(
    (sectionId: string | null) => (el: HTMLElement | null) => {
      const id = String(sectionId || "_main");
      sectionRefs.current[id] = el;
    },
    []
  );

  const handleAccordionChange = useCallback((sectionId: string | null, isExpanded: boolean) => {
    const id = String(sectionId || "_main");

    setExpandedSections((prev) => {
      if (isExpanded) {
        return [...prev, id];
      }
      return prev.filter((existingId) => existingId !== id);
    });

    if (isExpanded) {
      setSelectedTab(id);
    }
  }, []);

  const onSuccess = useCallback(
    async (data: EntityData) => {
      if (mode === FormMode.EDIT) {
        reset({ ...initialState, ...data });
      } else {
        setRecordId(String(data.id));
      }

      graph.setSelected(tab, data);
      graph.setSelectedMultiple(tab, [data]);

      const windowId = activeWindow?.windowId;
      if (windowId) {
        setSelectedRecord(windowId, tab.id, String(data.id));
      }

      showSuccessModal("Saved");
      setIsSucessfullEdit(true);
    },
    [mode, graph, tab, activeWindow?.windowId, showSuccessModal, reset, initialState, setRecordId, setSelectedRecord]
  );

  const onError = useCallback(
    (data: string) => {
      showErrorModal(data);
    },
    [showErrorModal]
  );

  const { save, loading } = useFormAction({
    windowMetadata,
    tab,
    mode,
    onSuccess,
    onError,
    initialState,
    submit: form.handleSubmit,
  });

  const isSectionExpanded = useCallback(
    (sectionId: string | null) => {
      const id = String(sectionId);
      return expandedSections.includes(id);
    },
    [expandedSections]
  );

  // NOTE: toolbar actions
  const handleSave = useCallback(async () => {
    await save();
    resetFormChanges();
  }, [save, resetFormChanges]);

  const onReset = useCallback(async () => {
    await refetch();
    resetFormChanges();
  }, [refetch, resetFormChanges]);

  const handleBack = useCallback(() => {
    const windowId = activeWindow?.windowId;
    if (windowId) {
      clearTabFormState(windowId, tab.id);
    }
    graph.clear(tab);
    graph.clearSelected(tab);
    resetFormChanges();
  }, [activeWindow?.windowId, clearTabFormState, graph, tab, resetFormChanges]);

  const handleNew = useCallback(() => {
    setRecordId(NEW_RECORD_ID);
    resetFormChanges();
  }, [setRecordId, resetFormChanges]);

  useEffect(() => {
    const actions = {
      save: handleSave,
      refresh: onReset,
      back: handleBack,
      new: handleNew,
    };

    registerActions(actions);
  }, [registerActions, handleSave, onReset, handleBack, handleNew, tab.id]);

  const isLoading = loading || loadingFormInitialization;

  return (
    <FormInitializationProvider value={{ isFormInitializing }}>
      <FormProvider setValue={handleSetValue} reset={reset} formState={formState} {...form}>
        <form
          className={`flex h-full max-h-full w-full flex-col gap-2 overflow-hidden transition duration-300 ${
            loading ? "cursor-progress cursor-to-children select-none opacity-50" : ""
          }`}
          onSubmit={handleSave}>
          {statusModal.open && (
            <StatusModal
              statusType={statusModal.statusType}
              statusText={statusModal.statusText}
              errorMessage={statusModal.errorMessage}
              saveLabel={statusModal.saveLabel}
              secondaryButtonLabel={statusModal.secondaryButtonLabel}
              onClose={hideStatusModal}
              isDeleteSuccess={statusModal.isDeleteSuccess}
            />
          )}
          <StatusBar fields={fields.statusBarFields} />
          <PrimaryTabs tabs={tabs} onChange={handleTabChange} selectedTab={selectedTab} icon={defaultIcon} />
          {isLoading ? (
            <Spinner />
          ) : (
            <div className="flex flex-col gap-2 flex-grow overflow-auto" ref={containerRef}>
              {groups.map(([id, group]) => {
                const sectionId = String(id || "_main");

                const hasVisibleFields = Object.values(group.fields).some((field) => {
                  if (!field.displayed) return false;
                  if (!field.displayLogicExpression) return true;

                  const compiledExpr = compileExpression(field.displayLogicExpression);
                  try {
                    return compiledExpr(session, form.watch());
                  } catch (error) {
                    console.warn("Error executing expression:", field.displayLogicExpression, error);
                    return true;
                  }
                });

                if (!hasVisibleFields) {
                  return null;
                }

                return (
                  <div key={sectionId} ref={handleSectionRef(id)}>
                    <Collapsible
                      title={group.identifier}
                      isExpanded={isSectionExpanded(id)}
                      sectionId={sectionId}
                      icon={getIconForGroup(group.identifier)}
                      onToggle={(isOpen: boolean) => handleAccordionChange(id, isOpen)}>
                      <div className="grid auto-rows-auto grid-cols-3 gap-x-5 gap-y-2">
                        {Object.entries(group.fields).map(([hqlName, field]) => (
                          <BaseSelector field={field} key={hqlName} formMode={mode} />
                        ))}
                      </div>
                    </Collapsible>
                  </div>
                );
              })}
            </div>
          )}
        </form>
      </FormProvider>
    </FormInitializationProvider>
  );
}

export default FormView;

```

## Archivo: `packages/MainUI/components/Form/FormView/selectors/BaseSelector.tsx`

```typescript
import { useTabContext } from "@/contexts/tab";
import { useCallout } from "@/hooks/useCallout";
import { useDebounce } from "@/hooks/useDebounce";
import { useUserContext } from "@/hooks/useUserContext";
import { globalCalloutManager } from "@/services/callouts";
import { buildPayloadByInputName, parseDynamicExpression } from "@/utils";
import { logger } from "@/utils/logger";
import { type Field, type FormInitializationResponse, FormMode } from "@workspaceui/api-client/src/api/types";
import { getFieldsByColumnName } from "@workspaceui/api-client/src/utils/metadata";
import { useParams } from "next/navigation";
import { memo, useCallback, useEffect, useMemo, useRef } from "react";
import { useFormContext } from "react-hook-form";
import Label from "../Label";
import { GenericSelector } from "./GenericSelector";
import useDisplayLogic from "@/hooks/useDisplayLogic";
import { useFormInitializationContext } from "@/contexts/FormInitializationContext";
import useFormParent from "@/hooks/useFormParent";

export const compileExpression = (expression: string) => {
  try {
    return new Function("context", "currentValues", `return ${parseDynamicExpression(expression)};`);
  } catch (error) {
    logger.error("Error compiling expression:", expression, error);
    return () => true;
  }
};

const BaseSelectorComp = ({ field, formMode = FormMode.EDIT }: { field: Field; formMode?: FormMode }) => {
  const { watch, getValues, setValue, register } = useFormContext();
  const { isFormInitializing } = useFormInitializationContext();
  const { tab } = useTabContext();
  const fieldsByColumnName = useMemo(() => getFieldsByColumnName(tab), [tab]);
  const { recordId } = useParams<{ recordId: string }>();
  const { session } = useUserContext();
  const parentData = useFormParent();

  const getParentId = useCallback(() => {
    const parentIds = Object.values(parentData)
      .filter((value) => value && value !== "null" && value !== null)
      .map((value) => String(value));
    return parentIds.length > 0 ? parentIds[0] : "null";
  }, [parentData]);

  const executeCalloutBase = useCallout({
    field,
    rowId: recordId,
    parentId: getParentId(),
  });
  const debouncedCallout = useDebounce(executeCalloutBase, 300);
  const value = watch(field.hqlName);
  const values = watch();
  const previousValue = useRef(value);
  const ready = useRef(false);
  const fieldsByHqlName = useMemo(() => tab?.fields || {}, [tab?.fields]);
  const optionData = watch(`${field.hqlName}_data`);

  const isSettingFromCallout = useRef(false);

  const isDisplayed = useDisplayLogic({ field });

  const isReadOnly = useMemo(() => {
    if (field.isReadOnly) return true;
    if (!field.isUpdatable) return FormMode.NEW !== formMode;
    if (!field.readOnlyLogicExpression) return false;
    const compiledExpr = compileExpression(field.readOnlyLogicExpression);

    try {
      return compiledExpr(session, values);
    } catch (error) {
      logger.warn("Error executing expression:", compiledExpr, error);
      return true;
    }
  }, [field, formMode, session, values]);

  const applyColumnValues = useCallback(
    (columnValues: FormInitializationResponse["columnValues"]) => {
      for (const [column, { value, identifier }] of Object.entries(columnValues ?? {})) {
        const targetField = fieldsByColumnName[column];
        const hqlName = targetField?.hqlName ?? column;

        setValue(hqlName, value, { shouldDirty: false });

        if (targetField && identifier) {
          setValue(`${hqlName}$_identifier`, identifier, { shouldDirty: false });

          if (value && String(value) !== identifier) {
            logger.debug(`Field ${hqlName}: value=${value}, identifier=${identifier}`);
          }
        } else if (targetField && !identifier && value) {
          setValue(`${hqlName}$_identifier`, "", { shouldDirty: false });
        }
      }
    },
    [fieldsByColumnName, setValue]
  );

  const applyAuxiliaryInputValues = useCallback(
    (auxiliaryInputValues: FormInitializationResponse["auxiliaryInputValues"]) => {
      for (const [column, { value }] of Object.entries(auxiliaryInputValues ?? {})) {
        const targetField = fieldsByColumnName[column];
        setValue(targetField?.hqlName || column, value, { shouldDirty: false });
      }
    },
    [fieldsByColumnName, setValue]
  );

  const executeCallout = useCallback(async () => {
    if (!tab || !field.column.callout) return;

    try {
      const entityKeyColumn = tab.fields.id.columnName;
      const payload = buildPayloadByInputName(getValues(), fieldsByHqlName);

      const calloutData = {
        ...session,
        ...payload,
        inpKeyName: fieldsByColumnName[entityKeyColumn].inputName,
        inpTabId: tab.id,
        inpTableId: tab.table,
        inpkeyColumnId: entityKeyColumn,
        keyColumnName: entityKeyColumn,
        _entityName: tab.entityName,
        inpwindowId: tab.window,
      } as Record<string, string>;

      //TODO: This will imply the evaluation of out fiels inside the fieldBuilder an it's implementation in metadata module
      if (field.inputName === "inpmProductId" && optionData) {
        calloutData.inpmProductId_CURR = optionData.currency || session.$C_Currency_ID;
        calloutData.inpmProductId_UOM = optionData.uOM || session["#C_UOM_ID"];
        calloutData.inpmProductId_PSTD = String(optionData.standardPrice || optionData.netListPrice || 0);
        calloutData.inpmProductId_PLIST = String(optionData.netListPrice || 0);
        calloutData.inpmProductId_PLIM = String(optionData.priceLimit || 0);
      }

      const data = await debouncedCallout(calloutData);

      if (data) {
        applyColumnValues(data.columnValues);
        applyAuxiliaryInputValues(data.auxiliaryInputValues);
      }
    } catch (err) {
      logger.error("Callout execution failed:", err);
      throw err;
    }
  }, [
    field.column.callout,
    field.inputName,
    tab,
    getValues,
    fieldsByHqlName,
    session,
    fieldsByColumnName,
    optionData,
    debouncedCallout,
    applyColumnValues,
    applyAuxiliaryInputValues,
  ]);

  const runCallout = useCallback(async () => {
    if (isSettingFromCallout.current) {
      return;
    }

    if (isFormInitializing) {
      return;
    }

    if (globalCalloutManager.isCalloutRunning()) {
      return;
    }

    previousValue.current = value;

    await globalCalloutManager.executeCallout(field.hqlName, executeCallout);
  }, [field.hqlName, value, executeCallout, isFormInitializing]);

  useEffect(() => {
    if (ready.current) {
      runCallout();
    } else {
      ready.current = true;
    }
  }, [runCallout, value]);

  useEffect(() => {
    return () => {
      globalCalloutManager.clearPendingCallouts();
    };
  }, []);

  if (isDisplayed) {
    return (
      <div
        className="h-12 grid grid-cols-3 auto-rows-auto gap-4 items-center"
        title={field.helpComment || ""}
        aria-describedby={field.helpComment ? `${field.name}-help` : ""}>
        <div className="relative">
          {field.isMandatory && (
            <span className="absolute -top-4 right-0 text-[#DC143C] text-xs font-bold" aria-required>
              *
            </span>
          )}
          <Label field={field} />
        </div>
        <div className="col-span-2">
          <GenericSelector field={field} isReadOnly={isReadOnly} />
        </div>
      </div>
    );
  }
  return <input type="hidden" {...register(field.hqlName)} />;
};

const BaseSelector = memo(BaseSelectorComp);
export { BaseSelector };
export default BaseSelector;

```

## Archivo: `packages/MainUI/components/Form/FormView/selectors/BooleanSelector.tsx`

```typescript
import type { Field } from "@workspaceui/api-client/src/api/types";
import { useController, useFormContext } from "react-hook-form";
import { Switch } from "./components/Switch";

export const BooleanSelector = ({ field, isReadOnly }: { field: Field; isReadOnly: boolean }) => {
  const { control } = useFormContext();

  const {
    field: { value = false, onChange },
  } = useController({
    name: field.hqlName,
    control,
    defaultValue: false,
  });

  return <Switch checked={!!value} onCheckedChange={onChange} field={field} disabled={isReadOnly} />;
};

```

## Archivo: `packages/MainUI/components/Form/FormView/selectors/DateSelector.tsx`

```typescript
import type { Field } from "@workspaceui/api-client/src/api/types";
import { useFormContext } from "react-hook-form";
import { DateInput } from "./components/DateInput";

export const DateSelector = ({ field, isReadOnly }: { field: Field; isReadOnly?: boolean }) => {
  const { register } = useFormContext();

  return <DateInput field={field} isReadOnly={isReadOnly} {...register(field.hqlName)} />;
};

export default DateSelector;

```

## Archivo: `packages/MainUI/components/Form/FormView/selectors/DatetimeSelector.tsx`

```typescript
import type { Field } from "@workspaceui/api-client/src/api/types";
import { useFormContext } from "react-hook-form";

function formatDateForInput(value: string) {
  const date = new Date(value);
  const pad = (n: number) => n.toString().padStart(2, "0");

  const year = date.getFullYear();
  const month = pad(date.getMonth() + 1);
  const day = pad(date.getDate());
  const hours = pad(date.getHours());
  const minutes = pad(date.getMinutes());

  return `${year}-${month}-${day}T${hours}:${minutes}`;
}

export const DatetimeSelector = ({ field, isReadOnly }: { field: Field; isReadOnly?: boolean }) => {
  const { register, getValues } = useFormContext();
  const value = getValues(field.hqlName);

  return (
    <input type="datetime-local" {...register(field.hqlName)} readOnly={isReadOnly} value={formatDateForInput(value)} />
  );
};

export default DatetimeSelector;

```

## Archivo: `packages/MainUI/components/Form/FormView/selectors/GenericSelector.tsx`

```typescript
import type { Field } from "@workspaceui/api-client/src/api/types";
import { memo } from "react";
import { CUSTOM_SELECTORS_IDENTIFIERS, FIELD_REFERENCE_CODES } from "@/utils/form/constants";
import { useFormContext } from "react-hook-form";
import { BooleanSelector } from "./BooleanSelector";
import { DateSelector } from "./DateSelector";
import { ListSelector } from "./ListSelector";
import { NumericSelector } from "./NumericSelector";
import QuantitySelector from "./QuantitySelector";
import { SelectSelector } from "./SelectSelector";
import { StringSelector } from "./StringSelector";
import { PasswordSelector } from "./PasswordSelector";
import { TableDirSelector } from "./TableDirSelector";
import DatetimeSelector from "./DatetimeSelector";
import LocationSelector from "./LocationSelector";

export type GenericSelectorProps = {
  field: Field;
  isReadOnly: boolean;
};

const GenericSelectorCmp = ({ field, isReadOnly }: GenericSelectorProps) => {
  const { watch } = useFormContext();
  const value = watch(field.hqlName);
  const { reference } = field.column;

  switch (reference) {
    case FIELD_REFERENCE_CODES.PASSWORD:
      return <PasswordSelector field={field} readOnly={isReadOnly} />;
    case FIELD_REFERENCE_CODES.PRODUCT: // Product reference to datasource
    case FIELD_REFERENCE_CODES.TABLE_DIR_19:
    case FIELD_REFERENCE_CODES.TABLE_DIR_18:
      return <TableDirSelector field={field} isReadOnly={isReadOnly} />;
    case FIELD_REFERENCE_CODES.DATE:
      return <DateSelector field={field} isReadOnly={isReadOnly} />;
    case FIELD_REFERENCE_CODES.DATETIME:
      return <DatetimeSelector field={field} isReadOnly={isReadOnly} />;
    case FIELD_REFERENCE_CODES.BOOLEAN:
      return <BooleanSelector field={field} isReadOnly={isReadOnly} />;
    case FIELD_REFERENCE_CODES.QUANTITY_29:
    case FIELD_REFERENCE_CODES.QUANTITY_22:
      return (
        <QuantitySelector
          field={field}
          name={field.hqlName}
          value={value}
          min={field.column.minValue}
          max={field.column.maxValue}
          readOnly={isReadOnly}
          maxLength={field.column.length}
        />
      );
    case FIELD_REFERENCE_CODES.LIST_17:
    case FIELD_REFERENCE_CODES.LIST_13:
      return <ListSelector field={field} isReadOnly={isReadOnly} />;
    case FIELD_REFERENCE_CODES.SELECT_30:
      if (
        field.column.referenceSearchKey === FIELD_REFERENCE_CODES.LOCATION_21 ||
        field.column.referenceSearchKey$_identifier === CUSTOM_SELECTORS_IDENTIFIERS.LOCATION
      ) {
        return <LocationSelector field={field} isReadOnly={isReadOnly} />;
      }
      return <SelectSelector field={field} isReadOnly={isReadOnly} />;
    case FIELD_REFERENCE_CODES.DECIMAL:
      return <NumericSelector field={field} type="decimal" readOnly={isReadOnly} />;
    case FIELD_REFERENCE_CODES.INTEGER:
      return <NumericSelector field={field} type="integer" readOnly={isReadOnly} />;
    default:
      return <StringSelector field={field} readOnly={isReadOnly} />;
  }
};

const GenericSelector = memo(GenericSelectorCmp);
export { GenericSelector };
export default GenericSelector;

```

## Archivo: `packages/MainUI/components/Form/FormView/selectors/ListSelector.tsx`

```typescript
import { useMemo } from "react";
import type { Field } from "@workspaceui/api-client/src/api/types";
import Select from "./components/Select";
import type { SelectProps } from "./components/types";

export const ListSelector = ({ field, isReadOnly }: { field: Field; isReadOnly: boolean }) => {
  const options = useMemo<SelectProps["options"]>(() => {
    if (field.refList) {
      return Array.from(field.refList).map((item) => ({
        id: item.value,
        label: item.label,
      }));
    }

    return [];
  }, [field.refList]);

  return <Select name={field.hqlName} options={options} isReadOnly={isReadOnly} field={field} />;
};

```

## Archivo: `packages/MainUI/components/Form/FormView/selectors/LocationSelector.tsx`

```typescript
import type React from "react";
import { useState, useCallback, useEffect, useMemo } from "react";
import { useFormContext } from "react-hook-form";
import Modal from "@workspaceui/componentlibrary/src/components/BasicModal";
import Select from "@workspaceui/componentlibrary/src/components/Input/Select";
import SearchOutlined from "@workspaceui/componentlibrary/src/assets/icons/search.svg";
import LocationIcon from "@workspaceui/componentlibrary/src/assets/icons/map-pin.svg";
import Spinner from "@workspaceui/componentlibrary/src/components/Spinner";
import Button from "@mui/material/Button";
import type { LocationSelectorProps } from "../types";
import { TextInput } from "./components/TextInput";
import { useDatasource } from "@/hooks/useDatasource";
import { useLocation } from "@/hooks/useLocation";
import { useTranslation } from "@/hooks/useTranslation";
import type { EntityData } from "@workspaceui/api-client/src/api/types";
import type { LocationData, CountryOption, RegionOption } from "./LocationSelector/types";

const LocationSelector: React.FC<LocationSelectorProps> = ({ field, isReadOnly }) => {
  const { watch, setValue } = useFormContext();
  const { t } = useTranslation();
  const value = watch(field.hqlName);

  const [isModalOpen, setIsModalOpen] = useState(false);

  const { createLocation, loading: locationLoading, error: locationError } = useLocation();

  const [locationData, setLocationData] = useState<LocationData>({
    id: "",
    address1: "",
    address2: "",
    postal: "",
    city: "",
    countryId: "",
    regionId: "",
    _identifier: "",
  });

  const [displayValue, setDisplayValue] = useState<string>("");

  useEffect(() => {
    const existingIdentifier = watch(`${field.hqlName}$_identifier`);

    if (existingIdentifier && !displayValue) {
      setDisplayValue(existingIdentifier);
    }

    if (value?.id && !locationData.id) {
      setLocationData({
        id: value.id || "",
        address1: value.address1 || "",
        address2: value.address2 || "",
        postal: value.postal || "",
        city: value.city || "",
        countryId: value.country || "",
        regionId: value.region || "",
        _identifier: value._identifier || "",
      });
    }
  }, [field.hqlName, watch, displayValue, locationData.id, value]);

  const {
    records: countryRecords,
    loading: loadingCountries,
    error: countryError,
  } = useDatasource({
    entity: "Country",
    skip: false,
  });

  const [shouldLoadRegions, setShouldLoadRegions] = useState(false);
  const [regionEntity, setRegionEntity] = useState<string>("");

  useEffect(() => {
    if (locationData.countryId && !shouldLoadRegions) {
      setShouldLoadRegions(true);
      setRegionEntity("Region");
    } else if (!locationData.countryId && shouldLoadRegions) {
      setShouldLoadRegions(false);
      setRegionEntity("");
    }
  }, [locationData.countryId, shouldLoadRegions]);

  const {
    records: regionRecords,
    loading: loadingRegions,
    error: regionError,
  } = useDatasource({
    entity: regionEntity,
    skip: !shouldLoadRegions,
  });

  const countries = useMemo((): CountryOption[] => {
    if (!countryRecords) return [];
    return countryRecords.map((country: EntityData) => ({
      id: String(country.id || ""),
      title: String(country._identifier || country.name || country.id || ""),
      value: String(country.id || ""),
    }));
  }, [countryRecords]);

  const regions = useMemo((): RegionOption[] => {
    if (!regionRecords || !locationData.countryId) return [];
    return regionRecords
      .filter((region: EntityData) => region.country === locationData.countryId)
      .map((region: EntityData) => ({
        id: String(region.id || ""),
        title: String(region._identifier || region.name || region.id || ""),
        value: String(region.id || ""),
      }));
  }, [regionRecords, locationData.countryId]);

  useEffect(() => {
    if (!value && displayValue) {
      setDisplayValue("");
    }
  }, [value, displayValue]);

  const handleOpenModal = useCallback(() => {
    if (isReadOnly) return;
    setIsModalOpen(true);
  }, [isReadOnly]);

  const handleCloseModal = useCallback(() => {
    setIsModalOpen(false);
    const existingData = watch(`${field.hqlName}`);
    if (existingData?.id) {
      setLocationData({
        id: existingData.id || "",
        address1: existingData.address1 || "",
        address2: existingData.address2 || "",
        postal: existingData.postal || "",
        city: existingData.city || "",
        countryId: existingData.country || "",
        regionId: existingData.region || "",
        _identifier: existingData._identifier || "",
      });
    } else {
      setLocationData({
        id: "",
        address1: "",
        address2: "",
        postal: "",
        city: "",
        countryId: "",
        regionId: "",
        _identifier: "",
      });
    }
  }, [field.hqlName, watch]);

  const handleCountryChange = useCallback((_event: React.SyntheticEvent, newValue: CountryOption | null) => {
    setLocationData((prev) => ({
      ...prev,
      countryId: newValue?.value || "",
      regionId: "",
    }));
  }, []);

  const handleRegionChange = useCallback((_event: React.SyntheticEvent, newValue: RegionOption | null) => {
    setLocationData((prev) => ({
      ...prev,
      regionId: newValue?.value || "",
    }));
  }, []);

  const handleInputChange = useCallback((fieldName: keyof LocationData, value: string) => {
    setLocationData((prev) => ({
      ...prev,
      [fieldName]: value,
    }));
  }, []);

  const selectedCountry = useMemo(() => {
    return countries.find((country) => country.value === locationData.countryId) || null;
  }, [countries, locationData.countryId]);

  const selectedRegion = useMemo(() => {
    return regions.find((region) => region.value === locationData.regionId) || null;
  }, [regions, locationData.regionId]);

  const isFormValid = useMemo(() => {
    return locationData.address1.trim() !== "" && locationData.city.trim() !== "" && locationData.countryId !== "";
  }, [locationData]);

  const handleSaveLocation = useCallback(async () => {
    if (!isFormValid || locationLoading) return;

    try {
      const createdLocation = await createLocation({
        address1: locationData.address1,
        address2: locationData.address2,
        postal: locationData.postal,
        city: locationData.city,
        countryId: locationData.countryId,
        regionId: locationData.regionId || undefined,
      });

      const locationId = createdLocation.id;
      const locationIdentifier = createdLocation._identifier;

      if (locationId) {
        setValue(field.hqlName, locationId);
        setValue(`${field.hqlName}$_identifier`, locationIdentifier);
        setValue(`${field.hqlName}_data`, {
          id: locationId,
          _identifier: locationIdentifier,
          _entityName: "Location",
          address1: createdLocation.address1,
          address2: createdLocation.address2,
          postal: createdLocation.postal,
          city: createdLocation.city,
          country: createdLocation.countryId,
          region: createdLocation.regionId || null,
        });

        setDisplayValue(locationIdentifier);
        setIsModalOpen(false);
      }
    } catch (error) {
      console.error(t("location.errors.creating"), error);
    }
  }, [isFormValid, locationLoading, locationData, createLocation, setValue, field.hqlName, t]);

  const combinedError = locationError || countryError || regionError;

  return (
    <>
      <div className="w-full">
        <div
          className={`flex items-center justify-between w-full h-10 px-3 border-b transition-colors ${
            isReadOnly ? "bg-gray-100 cursor-not-allowed" : "hover:border-gray-400 cursor-pointer border-gray-300"
          }`}
          onClick={handleOpenModal}
          tabIndex={isReadOnly ? -1 : 0}
          onKeyDown={(e) => {
            if ((e.key === "Enter" || e.key === " ") && !isReadOnly) {
              e.preventDefault();
              handleOpenModal();
            }
          }}>
          <div className="flex items-center gap-2">
            <SearchOutlined fill="#6B7280" className="w-4 h-4" />
            <span className={`text-sm ${displayValue ? "text-gray-900" : "text-gray-500"}`}>
              {displayValue || t("location.selector.placeholder")}
            </span>
          </div>
          {!isReadOnly && <LocationIcon fill="#9CA3AF" className="w-4 h-4" />}
        </div>
      </div>

      <Modal
        open={isModalOpen}
        onCancel={handleCloseModal}
        tittleHeader={t("location.selector.modalTitle")}
        descriptionText={t("location.selector.modalDescription")}
        HeaderIcon={LocationIcon}
        showHeader
        buttons={
          <div className="flex gap-2">
            <Button variant="outlined" onClick={handleCloseModal} disabled={locationLoading}>
              {t("location.selector.buttons.cancel")}
            </Button>
            <Button variant="contained" onClick={handleSaveLocation} disabled={!isFormValid || locationLoading}>
              {locationLoading ? (
                <div className="flex items-center gap-2">
                  <Spinner />
                  <span>{t("location.selector.buttons.creating")}</span>
                </div>
              ) : (
                t("location.selector.buttons.save")
              )}
            </Button>
          </div>
        }>
        <div className="space-y-4 p-4">
          {combinedError && (
            <div className="bg-red-50 border border-red-200 rounded-md p-3">
              <p className="text-sm text-red-600">{String(combinedError)}</p>
            </div>
          )}

          {!isFormValid && (
            <div className="bg-yellow-50 border border-yellow-200 rounded-md p-3">
              <p className="text-sm text-yellow-600">{t("location.errors.requiredFields")}</p>
            </div>
          )}

          <TextInput
            label={t("location.fields.address1.label")}
            field={{
              ...field,
              isMandatory: true,
              name: "address1",
              hqlName: "address1",
            }}
            value={locationData.address1}
            onChange={(e) => handleInputChange("address1", e.target.value)}
            placeholder={t("location.fields.address1.placeholder")}
            maxLength={60}
            className="w-full"
          />

          <TextInput
            label={t("location.fields.address2.label")}
            field={{
              ...field,
              isMandatory: false,
              name: "address2",
              hqlName: "address2",
            }}
            value={locationData.address2}
            onChange={(e) => handleInputChange("address2", e.target.value)}
            placeholder={t("location.fields.address2.placeholder")}
            maxLength={60}
            className="w-full"
          />

          <div className="grid grid-cols-2 gap-4">
            <TextInput
              label={t("location.fields.postal.label")}
              field={{
                ...field,
                isMandatory: false,
                name: "postal",
                hqlName: "postal",
              }}
              value={locationData.postal}
              onChange={(e) => handleInputChange("postal", e.target.value)}
              placeholder={t("location.fields.postal.placeholder")}
              maxLength={10}
              className="w-full"
            />
            <TextInput
              label={t("location.fields.city.label")}
              field={{
                ...field,
                isMandatory: true,
                name: "city",
                hqlName: "city",
              }}
              value={locationData.city}
              onChange={(e) => handleInputChange("city", e.target.value)}
              placeholder={t("location.fields.city.placeholder")}
              maxLength={60}
              className="w-full"
            />
          </div>

          <div>
            <label htmlFor="country-select" className="block text-sm font-medium text-gray-700 mb-1">
              {t("location.fields.country.label")} *
            </label>
            {loadingCountries ? (
              <div className="flex items-center justify-center p-4">
                <Spinner />
              </div>
            ) : countryError ? (
              <div className="text-red-500 text-sm">{t("location.errors.loadingCountries")}</div>
            ) : (
              <Select
                options={countries}
                value={selectedCountry}
                onChange={handleCountryChange}
                id="country-select"
                disabled={locationLoading}
              />
            )}
          </div>

          <div>
            <label htmlFor="region-select" className="block text-sm font-medium text-gray-700 mb-1">
              {t("location.fields.region.label")}
            </label>
            {!locationData.countryId ? (
              <div className="text-xs text-gray-500 p-2 bg-gray-50 rounded">
                {t("location.fields.region.selectCountryFirst")}
              </div>
            ) : loadingRegions ? (
              <div className="flex items-center justify-center p-4">
                <Spinner />
              </div>
            ) : regionError ? (
              <div className="text-red-500 text-sm">{t("location.errors.loadingRegions")}</div>
            ) : (
              <Select
                options={regions}
                value={selectedRegion}
                onChange={handleRegionChange}
                id="region-select"
                disabled={locationLoading}
              />
            )}
          </div>
        </div>
      </Modal>
    </>
  );
};

export default LocationSelector;

```

## Archivo: `packages/MainUI/components/Form/FormView/selectors/LocationSelector/types.ts`

```typescript
import type { Option } from "@workspaceui/componentlibrary/src/components/Input/Select/types";

export interface LocationData {
  id: string;
  address1: string;
  address2: string;
  postal: string;
  city: string;
  countryId: string;
  regionId: string;
  _identifier: string;
}

export interface CountryOption extends Option {
  id: string;
  title: string;
  value: string;
}

export interface RegionOption extends Option {
  id: string;
  title: string;
  value: string;
}

export interface LocationFormData {
  address1: string;
  address2: string;
  postal: string;
  city: string;
  countryId: string;
  regionId?: string;
}

```

## Archivo: `packages/MainUI/components/Form/FormView/selectors/NumericSelector.tsx`

```typescript
import type { Field } from "@workspaceui/api-client/src/api/types";
import type React from "react";
import { useCallback, useEffect, useState } from "react";
import { useFormContext } from "react-hook-form";
import { TextInput } from "./components/TextInput";

type NumericType = "integer" | "decimal";

interface UnifiedNumericSelectorProps extends React.ComponentProps<typeof TextInput> {
  field: Field;
  type?: NumericType;
}

export const UnifiedNumericSelector = ({ field, type = "decimal", ...props }: UnifiedNumericSelectorProps) => {
  const { register, setValue, watch, formState } = useFormContext();
  const formValue = watch(field.hqlName);
  const [localValue, setLocalValue] = useState(formValue === null || formValue === undefined ? "" : String(formValue));
  const [isFocused, setIsFocused] = useState(false);
  const isDirty = formState.isDirty;

  const isInteger = type === "integer" || field.column.reference === "11";

  useEffect(() => {
    if (!isFocused) {
      setLocalValue(formValue === null || formValue === undefined ? "" : String(formValue));
    }
  }, [formValue, isFocused]);

  const getValidationRegex = useCallback(() => {
    if (isInteger) {
      return /^-?\d*$/;
    }
    return /^-?(?:\d+\.?\d*|\.\d+)$/;
  }, [isInteger]);

  const parseValue = useCallback(
    (value: string): number | null => {
      if (value === "" || value === null || value === undefined) {
        return field.isMandatory || props.required ? 0 : null;
      }

      const stringValue = String(value).trim();

      if (stringValue === "" || stringValue === "-" || stringValue === ".") {
        return field.isMandatory || props.required ? 0 : null;
      }

      const normalizedValue = stringValue.replace(",", ".");

      const numericValue = isInteger ? Number.parseInt(normalizedValue, 10) : Number.parseFloat(normalizedValue);

      if (Number.isNaN(numericValue)) {
        return field.isMandatory || props.required ? 0 : null;
      }

      return numericValue;
    },
    [isInteger, field.isMandatory, props.required]
  );

  const handleChange = useCallback(
    (event: React.ChangeEvent<HTMLInputElement>) => {
      let value = event.target.value;

      if (isInteger) {
        value = value.replace(/[^\d.-]/g, "");
        value = value.replace(/(?!^)-/g, "");
        value = value.replace(/\./g, "");
      }

      const regex = getValidationRegex();

      if (value === "" || regex.test(value)) {
        setLocalValue(value);

        if (props.onChange) {
          props.onChange(event);
        }
        if (!isDirty) {
          const parsedValue = parseValue(value);
          setValue(field.hqlName, parsedValue);
        }
      }
    },
    [isInteger, getValidationRegex, props, isDirty, field.hqlName, parseValue, setValue]
  );

  const handleFocus = useCallback(
    (event: React.FocusEvent<HTMLInputElement>) => {
      setIsFocused(true);

      if (props.onFocus) {
        props.onFocus(event);
      }
    },
    [props]
  );

  const handleBlur = useCallback(
    (event: React.FocusEvent<HTMLInputElement>) => {
      setIsFocused(false);

      const parsedValue = parseValue(localValue);
      setValue(field.hqlName, parsedValue);

      if (parsedValue === null) {
        setLocalValue("");
      } else {
        setLocalValue(String(parsedValue));
      }

      if (props.onBlur) {
        props.onBlur(event);
      }
    },
    [localValue, parseValue, field.hqlName, setValue, props]
  );

  const registerProps = register(field.hqlName);

  return (
    <TextInput
      {...props}
      field={field}
      name={registerProps.name}
      onBlur={handleBlur}
      onChange={handleChange}
      onFocus={handleFocus}
      value={localValue}
      ref={registerProps.ref}
      inputMode={isInteger ? "numeric" : "decimal"}
      pattern={isInteger ? "^-?\\d*$" : "^-?(?:\\d+\\.?\\d*|\\.\\d+)$"}
    />
  );
};

export const NumericSelector = (props: { field: Field } & React.ComponentProps<typeof TextInput>) => (
  <UnifiedNumericSelector {...props} type="decimal" />
);

export const IntegerSelector = (props: { field: Field } & React.ComponentProps<typeof TextInput>) => (
  <UnifiedNumericSelector {...props} type="integer" />
);

```

## Archivo: `packages/MainUI/components/Form/FormView/selectors/PasswordSelector.tsx`

```typescript
import type { Field } from "@workspaceui/api-client/src/api/types";
import { TextInput } from "./components/TextInput";
import { useFormContext } from "react-hook-form";

export const PasswordSelector = (props: { field: Field } & React.ComponentProps<typeof TextInput>) => {
  const { register } = useFormContext();

  return (
    <TextInput
      {...props}
      {...register(props.field.hqlName)}
      type="password"
      maxLength={Number(props.field.column.length)}
      autoComplete="new-password"
    />
  );
};

```

## Archivo: `packages/MainUI/components/Form/FormView/selectors/QuantitySelector.tsx`

```typescript
import { Add as AddIcon, Remove as RemoveIcon } from "@mui/icons-material";
import { validateNumber } from "@workspaceui/componentlibrary/src/utils/quantitySelectorUtil";
import type React from "react";
import { memo, useCallback, useEffect, useState } from "react";
import { useFormContext } from "react-hook-form";
import type { FieldValue, QuantityProps } from "../types";
import { TextInput } from "./components/TextInput";
import { IconButton } from "@workspaceui/componentlibrary/src/components";

const EndAdormentQuantity = () => {
  return (
    <div className="flex flex-row h-full">
      <IconButton
        className="w-6 rounded-0 hover:bg-[rgba(0,0,0,0.04)] hover:text-[rgba(0,0,0,0.4)]"
        onClick={(e) => {
          e.stopPropagation();
          const input = e.currentTarget.parentElement?.parentElement?.querySelector("input");
          if (input) {
            input.stepUp();
            input.dispatchEvent(new Event("input", { bubbles: true }));
          }
        }}>
        <AddIcon fontSize="small" />
      </IconButton>
      <IconButton
        className="w-6 rounded-0 hover:bg-[rgba(0,0,0,0.04)] hover:text-[rgba(0,0,0,0.4)]"
        onClick={(e) => {
          e.stopPropagation();
          const input = e.currentTarget.parentElement?.parentElement?.querySelector("input");
          const inputValue = input?.value;
          if (input && inputValue && Number(inputValue) > 0) {
            input.stepDown();
            input.dispatchEvent(new Event("input", { bubbles: true }));
          }
        }}>
        <RemoveIcon fontSize="small" />
      </IconButton>
    </div>
  );
};

const DEFAULT_STEP = "any";
const DEFAULT_TYPE = "decimal";

const QuantitySelector: React.FC<QuantityProps> = memo(
  ({ value: initialValue, min, max, onChange, readOnly, maxLength = 100, name, field }) => {
    const { watch, setValue: setActualValue } = useFormContext();
    const value = watch(field.hqlName, initialValue || "");

    const [error, setError] = useState(false);
    const [errorMessage, setErrorMessage] = useState("");

    const setValue = useCallback(
      (value: FieldValue) => {
        if (value === null || value === "") {
          setActualValue(field.hqlName, null);
          return;
        }

        const valueAsString = String(value);

        if (valueAsString.endsWith(".")) {
          setActualValue(field.hqlName, valueAsString);
          return;
        }

        const numValue = Number.parseFloat(valueAsString);
        if (!Number.isNaN(numValue)) {
          setActualValue(field.hqlName, numValue);
        }
      },
      [field.hqlName, setActualValue]
    );

    const minValue = min !== null && min !== undefined && min !== "" ? Number(min) : undefined;
    const maxValue = max !== null && max !== undefined && max !== "" ? Number(max) : undefined;

    const handleChange = useCallback(
      (event: React.ChangeEvent<HTMLInputElement>) => {
        const inputValue = event.target.value;
        const sanitizedValue = inputValue.replace(/[^\d.]/g, "").slice(0, Number(maxLength));

        setValue(sanitizedValue);

        if (sanitizedValue === "") {
          setError(false);
          setErrorMessage("");
          onChange?.(null);
          return;
        }
      },
      [maxLength, setValue, minValue, maxValue, onChange]
    );

    const handleKeyDown = useCallback((event: React.KeyboardEvent<HTMLInputElement>) => {
      if (["e", "E", "+", "-"].concat(DEFAULT_TYPE === "decimal" ? [] : ["."]).includes(event.key)) {
        event.preventDefault();
      }
    }, []);

    const handleBlur = useCallback(() => {
      const defaultValue = !value || value === "" ? 0 : value;
      if (!defaultValue && field.isMandatory) {
        setValue(minValue ?? defaultValue);
      }
      const { isValid, errorMessage } = validateNumber(String(defaultValue), minValue, maxValue);
      setError(!isValid);
      setErrorMessage(errorMessage);
    }, [field, value, setValue, minValue, maxValue]);

    useEffect(() => {
      setValue(initialValue);
    }, [initialValue, setValue]);

    return (
      <TextInput
        field={field}
        type={DEFAULT_TYPE}
        step={DEFAULT_TYPE === "decimal" ? DEFAULT_STEP : undefined}
        className="[appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"
        value={value}
        onChange={handleChange}
        onKeyDown={handleKeyDown}
        onBlur={handleBlur}
        disabled={readOnly}
        name={name}
        endAdornment={DEFAULT_TYPE === "decimal" ? undefined : <EndAdormentQuantity />}
        errorText={error ? errorMessage : " "}
        role="spinbutton"
        aria-readonly={readOnly}
        aria-disabled={readOnly}
        {...(typeof minValue !== "undefined" ? { "aria-valuemin": minValue } : {})}
        {...(typeof maxValue !== "undefined" ? { "aria-valuemax": maxValue } : {})}
      />
    );
  }
);

QuantitySelector.displayName = "QuantitySelector";

export default QuantitySelector;

```

## Archivo: `packages/MainUI/components/Form/FormView/selectors/SelectSelector.tsx`

```typescript
import type { Field } from "@workspaceui/api-client/src/api/types";
import Select from "./components/Select";
import { useSelectFieldOptions } from "@/hooks/useSelectFieldOptions";
import { useTableDirDatasource } from "@/hooks/datasource/useTableDirDatasource";

export const SelectSelector = ({
  field,
  isReadOnly,
  pageSize = 20,
  initialPageSize = 20,
}: {
  field: Field;
  isReadOnly: boolean;
  pageSize?: number;
  initialPageSize?: number;
}) => {
  const { records, loading, refetch, loadMore, hasMore } = useTableDirDatasource({ field, pageSize, initialPageSize });
  const options = useSelectFieldOptions(field, records);

  return (
    <Select
      name={field.hqlName}
      options={options}
      isReadOnly={isReadOnly}
      onFocus={refetch}
      onLoadMore={loadMore}
      loading={loading}
      hasMore={hasMore}
      field={field}
    />
  );
};

```

## Archivo: `packages/MainUI/components/Form/FormView/selectors/StringSelector.tsx`

```typescript
import type { Field } from "@workspaceui/api-client/src/api/types";
import { TextInput } from "./components/TextInput";
import { useFormContext } from "react-hook-form";

export const StringSelector = (props: { field: Field } & React.ComponentProps<typeof TextInput>) => {
  const { register } = useFormContext();

  return <TextInput {...props} {...register(props.field.hqlName)} maxLength={Number(props.field.column.length)} />;
};

```

## Archivo: `packages/MainUI/components/Form/FormView/selectors/TableDirSelector.tsx`

```typescript
import type { Field } from "@workspaceui/api-client/src/api/types";
import Select from "@/components/Form/FormView/selectors/components/Select";
import { useTableDirDatasource } from "@/hooks/datasource/useTableDirDatasource";
import { useSelectFieldOptions } from "@/hooks/useSelectFieldOptions";

export const TableDirSelector = ({ field, isReadOnly }: { field: Field; isReadOnly: boolean }) => {
  const { records, loading, refetch, loadMore, hasMore, search } = useTableDirDatasource({ field });
  const options = useSelectFieldOptions(field, records);

  return (
    <Select
      name={field.hqlName}
      options={options}
      onFocus={refetch}
      onSearch={search}
      isReadOnly={isReadOnly}
      field={field}
      onLoadMore={loadMore}
      loading={loading}
      hasMore={hasMore}
    />
  );
};

```

## Archivo: `packages/MainUI/components/Form/FormView/selectors/components/DateInput.tsx`

```typescript
import IconButton from "@workspaceui/componentlibrary/src/components/IconButton";
import type { Field } from "@workspaceui/api-client/src/api/types";
import { forwardRef, useCallback, useRef, useState } from "react";
import CalendarIcon from "../../../../../../ComponentLibrary/src/assets/icons/calendar.svg";

interface DateInputProps extends React.InputHTMLAttributes<HTMLInputElement> {
  label?: string;
  isReadOnly?: boolean;
  error?: boolean;
  helperText?: string;
  field: Field;
}

export const DateInput = forwardRef<HTMLInputElement, DateInputProps>(
  ({ name, label, isReadOnly, error, helperText, field, ...props }, ref) => {
    const inputRef = useRef<HTMLInputElement>();
    const [isFocused, setIsFocused] = useState(false);

    const handleCalendarClick = useCallback(() => {
      if (!isReadOnly && inputRef.current) {
        inputRef.current.showPicker();
      }
    }, [isReadOnly]);

    const handleRef = useCallback(
      (node: HTMLInputElement) => {
        if (node) {
          inputRef.current = node;
        }

        if (typeof ref === "function") {
          ref(node);
        } else if (ref) {
          ref.current = node;
        }
      },
      [ref]
    );

    const handleFocus = useCallback(() => setIsFocused(true), []);

    const handleBlur = useCallback(
      (e: React.FocusEvent<HTMLInputElement>) => {
        setIsFocused(false);
        props.onBlur?.(e);
      },
      [props]
    );

    const getLabelClass = useCallback(
      () => `block mb-1 text-sm ${isReadOnly ? "text-baseline-60" : "text-baseline-80"}`,
      [isReadOnly]
    );

    const getInputClass = useCallback(() => {
      const baseClass = "w-full h-full py-2 pl-2 pr-10 border-b outline-none text-sm";
      const focusClass = isFocused ? "border-baseline-80 bg-baseline-0" : "border-baseline-60";
      const readOnlyClass = isReadOnly
        ? "bg-transparent-neutral-20 rounded-t-lg cursor-not-allowed"
        : "bg-transparent text-baseline-90 hover:border-baseline-80";
      const errorClass = error ? "border-error-main" : "";

      return `${baseClass} ${focusClass} ${readOnlyClass} ${errorClass} transition-colors`;
    }, [error, isFocused, isReadOnly]);

    const renderLabel = useCallback(() => {
      if (!label) return null;

      return (
        <label htmlFor={name} className={getLabelClass()}>
          {label}
          {props.required && <span className="text-error-main ml-1">*</span>}
        </label>
      );
    }, [getLabelClass, label, name, props.required]);

    const renderHelperText = useCallback(() => {
      if (!helperText) return null;

      return <div className={`mt-1 text-xs ${error ? "text-error-main" : "text-baseline-60"}`}>{helperText}</div>;
    }, [error, helperText]);

    return (
      <div className="w-full font-medium">
        {renderLabel()}
        <div className="relative w-full h-10 flex items-center">
          <input
            type="date"
            id={name}
            name={name}
            ref={handleRef}
            onFocus={handleFocus}
            onBlur={handleBlur}
            className={getInputClass()}
            readOnly={isReadOnly}
            aria-label={field.name}
            aria-readonly={isReadOnly}
            aria-required={field.isMandatory}
            aria-disabled={isReadOnly}
            aria-details={field.helpComment}
            {...props}
          />
          <div className="absolute right-1 top-1/2 transform -translate-y-1/2">
            <IconButton onClick={handleCalendarClick} disabled={isReadOnly} className="w-8 h-8">
              <CalendarIcon className="w-5 h-5" />
            </IconButton>
          </div>
        </div>
        {renderHelperText()}
      </div>
    );
  }
);

DateInput.displayName = "DateInput";

export default DateInput;

```

## Archivo: `packages/MainUI/components/Form/FormView/selectors/components/Select.tsx`

```typescript
import useDebounce from "@/hooks/useDebounce";
import Image from "next/image";
import { memo, useCallback, useEffect, useMemo, useRef, useState } from "react";
import { useFormContext } from "react-hook-form";
import checkIconUrl from "../../../../../../ComponentLibrary/src/assets/icons/check-circle-filled.svg?url";
import ChevronDown from "../../../../../../ComponentLibrary/src/assets/icons/chevron-down.svg";
import closeIconUrl from "../../../../../../ComponentLibrary/src/assets/icons/x.svg?url";
import type { SelectProps } from "./types";

const OptionItem = memo(
  ({
    id,
    label,
    index,
    isSelected,
    isHighlighted,
    onOptionClick,
    onMouseEnter,
  }: {
    id: string;
    label: string;
    index: number;
    isSelected: boolean;
    isHighlighted: boolean;
    onOptionClick: (id: string, label: string) => void;
    onMouseEnter: (index: number) => void;
  }) => (
    <li
      aria-selected={isSelected}
      onClick={() => onOptionClick(id, label)}
      onKeyDown={(e) => {
        if (e.key === "Enter" || e.key === " ") {
          e.preventDefault();
          onOptionClick(id, label);
        }
      }}
      onMouseEnter={() => onMouseEnter(index)}
      className={`px-4 py-3 text-sm cursor-pointer flex items-center justify-between focus:outline-none focus:bg-baseline-10
      ${isHighlighted ? "bg-baseline-10" : ""}
      ${isSelected ? "bg-baseline-10 font-medium" : ""}
      hover:bg-baseline-10`}>
      <span className={`truncate mr-2 ${isSelected ? "text-dynamic-dark" : "text-baseline-90"}`}>{label}</span>
      {isSelected && (
        <Image src={checkIconUrl} alt="Selected Item" className="fade-in-left flex-shrink-0" height={16} width={16} />
      )}
    </li>
  )
);

OptionItem.displayName = "OptionItem";

function SelectCmp({
  name,
  options,
  onFocus,
  isReadOnly,
  onSearch,
  onLoadMore,
  loading = false,
  hasMore = true,
  field,
}: SelectProps) {
  const { register, setValue, watch } = useFormContext();
  const selectedValue = watch(name);
  const currentIdentifier = watch(`${name}$_identifier`);
  const [selectedLabel, setSelectedLabel] = useState("");
  const [searchTerm, setSearchTerm] = useState("");
  const [isOpen, setIsOpen] = useState(false);
  const [highlightedIndex, setHighlightedIndex] = useState<number>(-1);
  const [isHovering, setIsHovering] = useState(false);
  const listRef = useRef<HTMLUListElement>(null);
  const searchInputRef = useRef<HTMLInputElement>(null);
  const wrapperRef = useRef<HTMLDivElement>(null);
  const loadingRef = useRef<HTMLLIElement>(null);
  const debouncedSetSearchTerm = useDebounce(onSearch);

  const filteredOptions = useMemo(
    () => options.filter((option) => option.label.toLowerCase().includes(searchTerm.toLowerCase())),
    [options, searchTerm]
  );

  const handleSelect = useCallback(
    (id: string, label: string) => {
      const option = options.find((opt) => opt.id === id);
      setValue(`${name}_data`, option?.data);
      setValue(name, id);
      setSelectedLabel(label);
      setIsOpen(false);
      setHighlightedIndex(-1);
    },
    [name, options, setValue]
  );

  const handleOptionClick = useCallback(
    (id: string, label: string) => {
      handleSelect(id, label);
    },
    [handleSelect]
  );

  const handleOptionMouseEnter = useCallback((index: number) => {
    setHighlightedIndex(index);
  }, []);

  const handleKeyDown = useCallback(
    (e: React.KeyboardEvent<HTMLInputElement>) => {
      if (e.key === "ArrowDown") {
        e.preventDefault();
        setHighlightedIndex((prev) => (prev + 1) % filteredOptions.length);
      }

      if (e.key === "ArrowUp") {
        e.preventDefault();
        setHighlightedIndex((prev) => (prev <= 0 ? filteredOptions.length - 1 : prev - 1));
      }

      if (e.key === "Enter" && highlightedIndex >= 0) {
        e.preventDefault();
        const option = filteredOptions[highlightedIndex];
        if (option) handleSelect(option.id, option.label);
      }

      if (e.key === "Escape") {
        e.preventDefault();
        setIsOpen(false);
        setHighlightedIndex(-1);
      }
    },
    [filteredOptions, highlightedIndex, handleSelect]
  );

  const handleBlur = useCallback((e: React.FocusEvent<HTMLDivElement>) => {
    if (!e.currentTarget.contains(e.relatedTarget as Node)) {
      setIsOpen(false);
      setHighlightedIndex(-1);
    }
  }, []);

  const handleClickOutside = useCallback((event: MouseEvent) => {
    if (wrapperRef.current && !wrapperRef.current.contains(event.target as Node)) {
      setIsOpen(false);
    }
  }, []);

  const handleClick = useCallback(() => {
    if (!isReadOnly) {
      setIsOpen((prev) => !prev);
    }
  }, [isReadOnly]);

  const handleClear = useCallback(
    (e: React.MouseEvent) => {
      e.stopPropagation();
      setValue(name, "");
      setSelectedLabel("");
    },
    [name, setValue]
  );

  const handleMouseEnter = useCallback(() => {
    setIsHovering(true);
  }, []);

  const handleMouseLeave = useCallback(() => {
    setIsHovering(false);
  }, []);

  const handleScroll = useCallback(() => {
    if (!listRef.current || loading || !hasMore) return;

    const list = listRef.current;
    const scrollBottom = list.scrollTop + list.clientHeight;

    if (scrollBottom >= list.scrollHeight * 0.9) {
      onLoadMore?.();
    }
  }, [loading, hasMore, onLoadMore]);

  const handleFocus = useCallback(() => {
    onFocus?.();
  }, [onFocus]);

  const handleSetSearchTerm = useCallback(
    (e: React.ChangeEvent<HTMLInputElement>) => {
      const term = e.target.value;
      setSearchTerm(term);

      if (debouncedSetSearchTerm) {
        debouncedSetSearchTerm(term);
      }
    },
    [debouncedSetSearchTerm]
  );

  useEffect(() => {
    const selectedOption = options.find((option) => option.id === selectedValue);
    if (!selectedOption && selectedValue) {
      setSelectedLabel(currentIdentifier || selectedValue);
    } else {
      setSelectedLabel(selectedOption?.label ?? "");
    }
  }, [selectedValue, options, currentIdentifier]);

  useEffect(() => {
    if (isOpen) {
      setSearchTerm("");
      setHighlightedIndex(0);
      setTimeout(() => searchInputRef.current?.focus(), 1);
    }
  }, [isOpen]);

  useEffect(() => {
    document.addEventListener("mousedown", handleClickOutside);
    return () => {
      document.removeEventListener("mousedown", handleClickOutside);
    };
  }, [handleClickOutside]);

  const renderedOptions = useMemo(() => {
    if (filteredOptions.length > 0) {
      return filteredOptions.map(({ id, label }, index) => (
        <OptionItem
          key={id}
          id={id}
          label={label}
          index={index}
          isSelected={selectedValue === id}
          isHighlighted={highlightedIndex === index}
          onOptionClick={handleOptionClick}
          onMouseEnter={handleOptionMouseEnter}
        />
      ));
    }
    return <li className="px-4 py-3 text-sm text-baseline-60">No options found</li>;
  }, [filteredOptions, highlightedIndex, selectedValue, handleOptionClick, handleOptionMouseEnter]);

  return (
    <div
      ref={wrapperRef}
      className={`relative w-full font-['Inter'] ${isReadOnly ? "pointer-events-none" : ""}`}
      onBlur={isReadOnly ? undefined : handleBlur}
      aria-label={field.name}
      aria-readonly={isReadOnly}
      aria-required={field.isMandatory}
      aria-disabled={isReadOnly}
      aria-details={field.helpComment}
      tabIndex={-1}>
      <input {...register(name)} type="hidden" readOnly={isReadOnly} />
      <div
        onClick={handleClick}
        onKeyDown={(e) => {
          if (e.key === "Enter" || e.key === " ") {
            e.preventDefault();
            handleClick();
          }
        }}
        onMouseEnter={handleMouseEnter}
        onMouseLeave={handleMouseLeave}
        className={`w-full flex items-center justify-between px-3 py-2 h-10 border-b border-baseline-10 hover:border-baseline-100 focus:outline-none focus:ring-2 focus:ring-dynamic-light
          ${isOpen ? "rounded border-b-0 border-dynamic-main ring-2 ring-dynamic-light" : "border-baseline-40"} 
          ${isReadOnly ? "bg-transparent-neutral-20 rounded-t-lg cursor-not-allowed" : "bg-white text-baseline-90 cursor-pointer hover:border-baseline-60"}
          transition-colors outline-none`}>
        <span
          className={`text-sm truncate max-w-[calc(100%-40px)] ${selectedLabel ? "text-baseline-90 font-medium" : "text-baseline-60"}`}>
          {selectedLabel || "Select an option"}
        </span>
        <div className="flex items-center flex-shrink-0 ml-2">
          {selectedLabel && (isHovering || isOpen) && (
            <button
              type="button"
              onClick={handleClear}
              onKeyDown={(e) => {
                if (e.key === "Enter" || e.key === " ") {
                  e.preventDefault();
                  handleClear;
                }
              }}
              className="mr-1 text-baseline-60 hover:text-baseline-80 transition-opacity opacity-100 focus:outline-none focus:ring-2 focus:ring-dynamic-light rounded"
              aria-label="Clear selection">
              <Image src={closeIconUrl} alt="Clear" height={16} width={16} />
            </button>
          )}
          <ChevronDown
            fill="currentColor"
            className={`w-5 h-5 text-baseline-60 transition-transform ${isOpen ? "rotate-180" : ""}`}
          />
        </div>
      </div>

      {!isReadOnly && isOpen && (
        <div className="absolute z-10 mt-1 w-full bg-white rounded shadow-lg overflow-hidden">
          <div className="p-2">
            <input
              ref={searchInputRef}
              value={searchTerm}
              onChange={handleSetSearchTerm}
              onKeyDown={handleKeyDown}
              placeholder="Search..."
              className="w-full p-2 text-sm border border-baseline-30 rounded focus:outline-none focus:border-dynamic-main focus:ring-1 focus:ring-dynamic-light"
              aria-label="Search options"
              onFocus={handleFocus}
            />
          </div>
          <ul ref={listRef} className="max-h-60 overflow-y-auto focus:outline-none" onScroll={handleScroll}>
            {renderedOptions}
            {loading && hasMore && (
              <li ref={loadingRef} className="px-4 py-3 text-sm text-baseline-60 text-center">
                Loading more options...
              </li>
            )}
          </ul>
        </div>
      )}
    </div>
  );
}

const Select = memo(SelectCmp);
export default Select;
export { Select };

```

## Archivo: `packages/MainUI/components/Form/FormView/selectors/components/Switch.tsx`

```typescript
import type { Field } from "@workspaceui/api-client/src/api/types";
import { forwardRef, useCallback } from "react";

interface SwitchProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {
  checked: boolean;
  onCheckedChange: (checked: boolean) => void;
  disabled?: boolean;
  field: Field;
}

export const Switch = forwardRef<HTMLButtonElement, SwitchProps>(
  ({ checked = false, onCheckedChange, disabled = false, className = "", field, ...props }, ref) => {
    const handleToggle = useCallback(() => {
      if (disabled) return;
      onCheckedChange(!checked);
    }, [checked, disabled, onCheckedChange]);

    return (
      <button
        type="button"
        role="switch"
        aria-checked={checked}
        aria-label={field.name}
        aria-readonly={disabled}
        aria-required={field.isMandatory}
        aria-disabled={disabled}
        aria-details={field.helpComment}
        disabled={disabled}
        onClick={handleToggle}
        ref={ref}
        className={`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 ${
          checked ? "bg-blue-600" : "bg-gray-300"
        } ${disabled ? "opacity-50 cursor-not-allowed" : "cursor-pointer"} ${className}`}
        {...props}>
        <span
          className={`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${
            checked ? "translate-x-6" : "translate-x-1"
          }`}
        />
      </button>
    );
  }
);

Switch.displayName = "Switch";

```

## Archivo: `packages/MainUI/components/Form/FormView/selectors/components/TextInput.tsx`

```typescript
import type { ChangeEvent } from "react";
import type { TextInputProps } from "./types";

export const TextInput = ({
  leftIcon,
  rightIcon,
  onLeftIconClick,
  onRightIconClick,
  label,
  setValue,
  readOnly,
  disabled,
  className,
  onChange,
  field,
  endAdornment,
  errorText,
  ...props
}: TextInputProps) => {
  const isDisabled = disabled || readOnly;

  const handleChange = (event: ChangeEvent<HTMLInputElement>) => {
    if (setValue) {
      setValue(event.target.value);
    }
    if (onChange) {
      onChange(event);
    }
  };

  return (
    <div className="w-full font-['Inter'] font-medium">
      {label && (
        <label
          htmlFor={props.id || props.name}
          className={`block mb-1 text-sm ${isDisabled ? "text-baseline-60" : "text-baseline-80"}`}>
          {label}
          {field.isMandatory && <span className="text-error-main ml-1">*</span>}
        </label>
      )}
      <div className={`relative flex items-center w-full h-10 ${isDisabled ? "pointer-events-none" : ""}`}>
        {leftIcon && (
          <div className="absolute left-3 text-baseline-60">
            <button type="button" onClick={onLeftIconClick} className="p-1 focus:outline-none" disabled={isDisabled}>
              {leftIcon}
            </button>
          </div>
        )}
        <input
          className={`w-full h-full py-2 border-b outline-none text-sm transition-colors
            ${leftIcon ? "pl-10" : "pl-3"} 
            ${rightIcon ? "pr-10" : "pr-3"}
            ${isDisabled ? "bg-transparent-neutral-20 rounded-t-lg cursor-not-allowed" : "bg-transparent text-baseline-90 hover:border-baseline-80"}
            ${className || ""}`}
          onChange={handleChange}
          disabled={isDisabled}
          readOnly={readOnly}
          aria-label={field.name}
          aria-required={field.isMandatory}
          {...props}
        />
        {rightIcon && (
          <div className="absolute right-3 text-baseline-60">
            <button type="button" onClick={onRightIconClick} className="p-1 focus:outline-none" disabled={isDisabled}>
              {rightIcon}
            </button>
          </div>
        )}
        {endAdornment}
      </div>
      <div className="h-5">{errorText && <p className="text-xs text-red-500 mt-1">{errorText}</p>}</div>
    </div>
  );
};

```

## Archivo: `packages/MainUI/components/Form/FormView/selectors/components/types.ts`

```typescript
import type { EntityData, Field } from "@workspaceui/api-client/src/api/types";

export interface TextInputProps
  extends React.DetailedHTMLProps<React.InputHTMLAttributes<HTMLInputElement>, HTMLInputElement> {
  leftIcon?: React.ReactNode;
  rightIcon?: React.ReactNode;
  onLeftIconClick?: () => void;
  onRightIconClick?: () => void;
  label?: string;
  setValue?: (value: string) => void;
  field: Field;
  endAdornment?: React.ReactNode;
  errorText?: string;
}

export interface Option {
  id: string;
  label: string;
}

export interface SelectProps {
  name: string;
  options: Array<{ id: string; label: string; data?: EntityData }>;
  onFocus?: () => void;
  onSearch?: (term: string) => void;
  isReadOnly?: boolean;
  loading?: boolean;
  hasMore?: boolean;
  onLoadMore?: () => void;
  field: Field;
}

```

## Archivo: `packages/MainUI/components/Form/FormView/styles.ts`

```typescript
import { type SxProps, type Theme, useTheme } from "@mui/material";
import { type CSSProperties, useMemo } from "react";
import { theme } from "@workspaceui/componentlibrary/src/theme";

export const defaultFill = theme.palette.dynamicColor.main;
export const noteColors = ["#FFA07A", "#98FB98", "#87CEFA", "#DDA0DD", "#F0E68C", "#47a3f3", "#2186eb"];

type StylesType = {
  styles: Record<string, CSSProperties>;
  sx: Record<string, SxProps<Theme>>;
};

export const useStyle = (): StylesType => {
  const theme = useTheme();

  return useMemo(
    () => ({
      styles: {
        dottedSpacing: {
          flex: 1,
          backgroundImage: `radial-gradient(circle, ${theme.palette.text.secondary} 1px, transparent 1px)`,
          backgroundSize: "8px 4px",
          backgroundPosition: "bottom",
          backgroundRepeat: "repeat-x",
          height: "4px",
          marginLeft: theme.spacing(1.5),
          marginRight: theme.spacing(2),
        },
        labelWrapper: {
          display: "flex",
          alignItems: "center",
          justifyContent: "center",
          width: "100%",
        },
        labelText: {
          fontSize: "0.875rem",
          whiteSpace: "nowrap",
          color: theme.palette.baselineColor.neutral[80],
        },
        requiredAsterisk: {
          width: "0.75rem",
          height: "1rem",
          color: theme.palette.specificColor.error.main,
          marginLeft: theme.spacing(1),
        },
        fieldContainer: {
          display: "flex",
          alignItems: "center",
          justifyContent: "center",
          width: "100%",
        },
      },
      sx: {
        linkStyles: {
          fontSize: "0.875rem",
          fontWeight: "600",
          lineHeight: "1rem",
          color: theme.palette.dynamicColor.main,
          textDecoration: "none",
          paddingRight: "0.5rem",
          cursor: "pointer",
          "&:hover": {
            textDecoration: "underline",
          },
        },
        accordion: {
          width: "100%",
          marginTop: "0.5rem",
          border: `1px solid ${theme.palette.divider}`,
          borderRadius: "0.75rem",
          "&:before": {
            display: "none",
          },
          "&:first-of-type": {
            borderRadius: "0.75rem",
          },
          "&:last-of-type": {
            borderRadius: "0.75rem",
          },
          "&.MuiAccordion-root": {
            "&:before": {
              display: "none",
            },
            "&.Mui-expanded": {
              margin: `${theme.spacing(1)} 0 0`,
            },
          },
          "& .MuiAccordionSummary-root": {
            minHeight: "auto",
            "&.Mui-expanded": {
              minHeight: "auto",
            },
          },
          "& .MuiAccordionSummary-content": {
            margin: `${theme.spacing(1)} 0`,
            "&.Mui-expanded": {
              margin: `${theme.spacing(1)} 0`,
            },
          },
          "& .MuiAccordionDetails-root": {
            padding: theme.spacing(2),
          },
        },
        iconLabel: {
          display: "flex",
          alignItems: "center",
          gap: "0.5rem",
        },
        chevronButton: {
          background: "none",
          "&:hover": {
            background: theme.palette.baselineColor.transparentNeutral[5],
          },
        },
        accordionSummary: {
          borderRadius: "0.75rem",
          "&.Mui-expanded": {
            borderBottomLeftRadius: 0,
            borderBottomRightRadius: 0,
          },
          "&:hover .main-icon-button": {
            backgroundColor: theme.palette.dynamicColor.main,
          },
        },
        labelBox: {
          flexBasis: "40%",
          alignContent: "center",
          alignItems: "center",
        },
        inputBox: {
          flexGrow: 1,
        },
        checkboxContainer: {
          "&::after": {
            content: '""',
            position: "absolute",
            bottom: 0,
            left: 0,
            right: 0,
            height: "1px",
            backgroundColor: theme.palette.baselineColor.neutral[100],
            opacity: 0.42,
          },
          "&:hover::after": {
            height: "2px",
            opacity: 0.87,
          },
          "&:focus-within::after": {
            height: "2px",
            backgroundColor: theme.palette.baselineColor.neutral[100],
            opacity: 1,
          },
        },
        gridItem: {
          display: "flex",
          alignItems: "stretch",
        },
        //Notes Styles
        addNoteButton: {
          height: "8rem",
          width: "100%",
          border: `2px solid ${theme.palette.baselineColor.neutral[40]}`,
          alignItems: "center",
          flexDirection: "column",
          display: "flex",
          justifyContent: "center",
          borderRadius: "1.75rem",
          borderStyle: "dashed",
          "&:hover": {
            border: `2px solid ${theme.palette.dynamicColor.main}`,
            borderRadius: "1.75rem",
            background: theme.palette.baselineColor.etendoPrimary.contrastText,
          },
        },
        addNoteText: {
          maxHeight: "4rem",
          overflow: "hidden",
          color: theme.palette.baselineColor.neutral[90],
        },
        noteCard: {
          height: "8rem",
          padding: "1.25rem",
          position: "relative",
          borderRadius: "1.75rem",
          border: `2px solid ${theme.palette.baselineColor.transparentNeutral[0]}`,
          display: "flex",
          flexDirection: "column",
          justifyContent: "space-between",
          "&:hover": {
            border: `2px solid ${theme.palette.dynamicColor.main}`,
          },
        },
        noteCardContent: {
          padding: 0,
          "&:last-child": {
            paddingBottom: 0,
          },
          display: "flex",
          flexDirection: "column",
          height: "100%",
          justifyContent: "space-between",
        },
        noteContentBox: {
          flex: 1,
          overflow: "hidden",
        },
        noteContentText: {
          overflow: "hidden",
          textOverflow: "ellipsis",
          display: "-webkit-box",
          WebkitLineClamp: 3,
          WebkitBoxOrient: "vertical",
          lineHeight: "1rem",
          maxHeight: "3rem",
          wordBreak: "break-word",
          color: theme.palette.baselineColor.transparentNeutral[100],
        },
        noteDate: {
          color: theme.palette.baselineColor.transparentNeutral[50],
        },
        deleteButtonBox: {
          position: "absolute",
          top: "0.5rem",
          right: "0.75rem",
          display: "none",
          ".MuiCard-root:hover &": {
            display: "flex",
          },
        },
      },
    }),
    [theme]
  );
};

```

## Archivo: `packages/MainUI/components/Form/FormView/types.ts`

```typescript
import type { Field, FormMode, WindowMetadata, FieldDefinition, Tab } from "@workspaceui/api-client/src/api/types";
import type { ReportColumn } from "@workspaceui/api-client/src/hooks/types";
import type { MRT_ColumnDef, MRT_Row } from "material-react-table";

export interface GridItemProps {
  xs?: number;
  sm?: number;
  md?: number;
}

export interface CollapsibleProps {
  title: string;
  icon?: React.ReactNode;
  isExpanded?: boolean;
  sectionId?: string;
  onToggle?: (isOpen: boolean) => void;
  children: React.ReactNode;
}

export interface Section {
  name: string;
  label: string;
  type: "section";
  personalizable: boolean;
  icon?: React.ReactNode;
  id: string;
  fill?: string;
  hoverFill?: string;
  showInTab: "icon" | "label" | "both";
}

export type FormData = Record<string, FieldDefinition | Section>;

export interface FormViewProps {
  window?: WindowMetadata;
  tab: Tab;
  mode: FormMode;
  recordId?: string;
  onSave?: (saveFn: () => void) => void;
  setRecordId: React.Dispatch<React.SetStateAction<string>>;
}

export type FieldValue = string | number | boolean | string[] | Date | null | FieldDefinition["value"];

export interface FieldLabelProps {
  label: string;
  required?: boolean;
  readOnly?: boolean;
  fieldType: string;
  onLinkClick?: () => void;
  isEntityReference?: boolean;
}

export interface Note {
  id: string;
  content: string;
  createdAt: string;
  color: string;
}

export interface NoteSectionProps {
  sectionId: string;
  addNoteButtonText: string | undefined;
  modalTitleText: string | undefined;
  modalDescriptionText: string | undefined;
  noteInputPlaceholder: string | undefined;
  addNoteSubmitText: string | undefined;
}

// TableDir Selector
export interface TableDirSelectorProps {
  label: string;
  value: FieldValue;
  entity: string;
  name: string;
  onChange: (value: string) => void;
  disabled?: boolean;
  isReadOnly?: boolean;
}

export interface SearchSelectorProps {
  label: string;
  value: FieldValue;
  entity: string;
  onChange: (value: string) => void;
  field: Field;
  name: string;
  disabled?: boolean;
  readOnly?: boolean;
}

export interface Option {
  id: string;
  title: string;
  value: string;
}

export interface GenericSelectorProps {
  field: Field;
}

export interface BooleanSelectorProps {
  label: string;
  readOnly?: boolean;
  checked?: boolean;
  name: string;
  onChange: (name: string, value: boolean) => void;
  disabled?: boolean;
}

export interface NumberSelectorProps {
  name: string;
  value: number;
  onChange: (name: string, value: number) => void;
  readOnly?: boolean;
}

export interface DateSelectorProps {
  label?: string;
  name: string;
  value?: string;
  onChange: (event: unknown) => void;
  onBlur?: () => void;
  readOnly?: boolean;
  required?: boolean;
  error?: boolean;
  helperText?: string;
}

export interface SelectSelectorProps {
  name: string;
  title: string;
  onChange: (value: string) => void;
  readOnly?: boolean;
  field: Field;
  value: string;
}

export interface DatabaseSelectSelector {
  name: string;
  title: string;
  onChange: (value: string) => void;
  readOnly?: boolean;
  value: string;
  entity: string;
}

export interface QuantityProps {
  value: FieldValue;
  maxLength?: string;
  min?: number | string | null;
  max?: number | string | null;
  onChange?: (value: number | null) => void;
  name: string;
  readOnly?: boolean;
  field: Field;
}

export interface ListSelectorProps {
  field: Field;
  value: string;
  onChange: (value: string) => void;
  name: string;
  readOnly?: boolean;
}

//MultiSelect
export interface MultiSelectProps {
  value?: string | string[];
  onChange: (value: string[]) => void;
  readOnly?: boolean;
  title?: string;
  entity: string;
  columnName: string;
  identifierField: string;
  columns?: ReportColumn[];
}

export type TableData = Record<string, unknown>;

export interface SelectorTableProps {
  data: TableData[];
  onRowClick: (row: MRT_Row<TableData>) => void;
  columns: MRT_ColumnDef<TableData>[];
  title: string;
}

export interface LocationSelectorProps {
  field: Field;
  isReadOnly: boolean;
}

```

## Archivo: `packages/MainUI/components/Forms/GridLayout.tsx`

```typescript
import { Box, Paper, Typography } from "@mui/material";
import { useStyle } from "./styles";
import { GRID_CONSTANTS } from "./constants";
import EtendoImg from "../../../ComponentLibrary/src/assets/images/Etendo.svg?url";
import type { GridItemProps } from "./types";
import { useTranslation } from "../../hooks/useTranslation";

const GridItem = ({ bgColor = "transparent", children }: GridItemProps) => {
  const { styles } = useStyle();

  return (
    <Paper
      elevation={8}
      sx={{
        ...styles.gridItem,
        backgroundColor: bgColor,
        ...(bgColor !== "transparent" && styles.gridItemWithBg),
      }}>
      <Box sx={styles.gridItemContent}>{children}</Box>
    </Paper>
  );
};

const { ITEMS } = GRID_CONSTANTS;

const GridLayout = () => {
  const { styles } = useStyle();
  const { t } = useTranslation();

  return (
    <Box sx={styles.gridContainer}>
      <GridItem />
      <GridItem />
      <GridItem bgColor={ITEMS.ERP_SOFTWARE.color}>
        <Box sx={styles.gridText}>
          <Typography sx={{ fontSize: ITEMS.ERP_SOFTWARE.fontSize }}>{t("grid.items.erp.text")}</Typography>
        </Box>
      </GridItem>
      <GridItem bgColor={ITEMS.LOGO.color}>
        <Box component="img" src={EtendoImg} alt={t("grid.alt.logo")} sx={styles.gridImage} />
      </GridItem>
      <GridItem bgColor={ITEMS.TAILORED.color}>
        <Box sx={styles.gridTextYellow}>
          <Typography sx={{ fontSize: ITEMS.TAILORED.fontSize }}>{t("grid.items.tailored.text")}</Typography>
        </Box>
      </GridItem>
      <GridItem />
      <GridItem bgColor={ITEMS.HIGHLY_ADAPTABLE.color}>
        <Box sx={styles.gridTextYellow}>
          <Typography sx={{ fontSize: ITEMS.HIGHLY_ADAPTABLE.fontSize }}>{t("grid.items.adaptable.text")}</Typography>
        </Box>
      </GridItem>
      <GridItem />
      <GridItem />
    </Box>
  );
};

export default GridLayout;

```

## Archivo: `packages/MainUI/components/Forms/Input.tsx`

```typescript
export default function Input(
  props: React.DetailedHTMLProps<React.InputHTMLAttributes<HTMLInputElement>, HTMLInputElement>
) {
  return (
    <div className="relative w-full">
      <input
        {...props}
        placeholder=" "
        className="peer h-12 w-full border-b border-gray-400 text-gray-900 placeholder-transparent focus:outline-none focus:border-blue-800"
      />
      <label
        htmlFor={props.name}
        className="absolute left-0 -top-3.5 text-gray-600 text-sm transition-all peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-400 peer-placeholder-shown:top-3.5 peer-focus:-top-3.5 peer-focus:text-sm peer-focus:text-blue-800">
        {props.placeholder}
      </label>
    </div>
  );
}

```

## Archivo: `packages/MainUI/components/Forms/Login.tsx`

```typescript
"use client";
import { useCallback, useState } from "react";
import { Box, Button, Paper, Typography } from "@mui/material";
import { useStyle } from "./styles";
import GridLayout from "./GridLayout";
import type { LoginProps } from "./types";
import { useTranslation } from "../../hooks/useTranslation";
import { GRID_CONSTANTS } from "./constants";
import Input from "./Input";

export default function Login({ title, onSubmit, error }: LoginProps) {
  const [username, setUsername] = useState("");
  const [password, setPassword] = useState("");
  const { styles } = useStyle();
  const { t } = useTranslation();

  const handleUsernameChange = useCallback(
    (e: React.ChangeEvent<HTMLInputElement>) => setUsername(e.currentTarget.value),
    []
  );

  const handlePasswordChange = useCallback(
    (e: React.ChangeEvent<HTMLInputElement>) => setPassword(e.currentTarget.value),
    []
  );

  const handleSubmit = useCallback<React.FormEventHandler>(
    async (e) => {
      e.preventDefault();
      e.stopPropagation();
      await onSubmit(username, password);
    },
    [onSubmit, password, username]
  );

  return (
    <Box component="main" sx={styles.container}>
      <Box sx={styles.contentWrapper}>
        <Box sx={styles.leftSection}>
          <GridLayout />
        </Box>
        <div className="flex flex-1 items-center justify-center">
          <form onSubmit={handleSubmit} noValidate>
            <Paper sx={styles.paper} elevation={0}>
              <Typography variant="h1" sx={styles.title}>
                {title}
                {GRID_CONSTANTS.ICONS.TITLE_EMOJI}
              </Typography>
              <Typography variant="body1" sx={styles.subtitle}>
                {t("login.subtitle")}
              </Typography>
              <Input
                type="text"
                name="username"
                id="username"
                placeholder={t("login.fields.username.placeholder")}
                value={username}
                onChange={handleUsernameChange}
                autoComplete="username"
              />
              <Input
                type="password"
                name="password"
                id="password"
                placeholder={t("login.fields.password.placeholder")}
                value={password}
                onChange={handlePasswordChange}
                autoComplete="current-password"
              />
              <Button type="submit" fullWidth variant="contained" sx={styles.button}>
                {t("login.buttons.submit")}
              </Button>
              {error && (
                <Typography component="div" sx={styles.error}>
                  {error}
                </Typography>
              )}
            </Paper>
          </form>
        </div>
      </Box>
    </Box>
  );
}

```

## Archivo: `packages/MainUI/components/Forms/constants.ts`

```typescript
import { SECONDARY_100, SECONDARY_500, PRIMARY_100 } from "@workspaceui/componentlibrary/src/theme";

export const GRID_CONSTANTS = {
  ITEMS: {
    ERP_SOFTWARE: {
      color: SECONDARY_500,
      fontSize: "2rem",
    },
    TAILORED: {
      color: SECONDARY_100,
      fontSize: "1.5rem",
    },
    HIGHLY_ADAPTABLE: {
      color: SECONDARY_100,
      fontSize: "1.5rem",
    },
    LOGO: {
      color: PRIMARY_100,
    },
  },
  ICONS: {
    TITLE_EMOJI: "✨",
  },
} as const;

```

## Archivo: `packages/MainUI/components/Forms/styles.ts`

```typescript
import { useTheme } from "@mui/material";
import { useMemo } from "react";
import EtendoImg from "../../../ComponentLibrary/src/assets/images/Etendo.svg?url";

export const useStyle = () => {
  const theme = useTheme();

  return useMemo(
    () => ({
      styles: {
        container: {
          display: "flex",
          flex: 1,
          flexDirection: "column",
          alignItems: "center",
          justifyContent: "center",
          minHeight: "100vh",
          backgroundColor: theme.palette.dynamicColor.light,
          padding: "2rem",
          position: "relative",
          overflow: "hidden",
          "&::before": {
            content: '""',
            position: "absolute",
            width: "200%",
            height: "200%",
            top: "-50%",
            left: "-57%",
            backgroundImage: `url(${EtendoImg})`,
            backgroundRepeat: "no-repeat",
            backgroundPosition: "center",
            backgroundSize: "contain",
            transform: "rotate(-15deg)",
            opacity: 0.3,
            zIndex: 0,
            pointerEvents: "none",
          },
        },
        contentWrapper: {
          display: "flex",
          alignItems: "stretch",
          justifyContent: "space-between",
          maxWidth: "90rem",
          gap: "15rem",
          position: "relative",
          zIndex: 1,
        },
        leftSection: {
          flex: "2",
          display: "flex",
          alignItems: "center",
        },
        rightSection: {
          flex: "1",
          display: "flex",
          alignItems: "center",
          justifyContent: "center",
        },
        paper: {
          width: "100%",
          maxWidth: "400px",
          padding: "2rem",
          backgroundColor: "transparent",
          display: "flex",
          flexDirection: "column",
          gap: "1.5rem",
          border: "none",
          boxShadow: "none",
        },
        title: {
          color: theme.palette.baselineColor.neutral[80],
          fontSize: "2rem",
          fontWeight: 600,
          marginBottom: "1rem",
          textAlign: "left",
        },
        subtitle: {
          color: theme.palette.baselineColor.neutral[80],
          marginBottom: "1rem",
          textAlign: "left",
        },
        input: {
          transition: "border-color 0.2s",
          "& input": {
            padding: "0.5rem",
            color: theme.palette.baselineColor.neutral[100],
            "&::placeholder": {
              color: theme.palette.baselineColor.neutral[100],
              opacity: 1,
            },
          },
          "&:hover": {
            borderColor: theme.palette.baselineColor.neutral[100],
          },
          "&:focus-within": {
            borderColor: theme.palette.primary.main,
            outline: "none",
          },
        },
        button: {
          marginTop: "1rem",
          backgroundColor: theme.palette.baselineColor.neutral[80],
          color: theme.palette.baselineColor.neutral[0],
          padding: "0.75rem",
          borderRadius: "0.5rem",
          textTransform: "none",
          fontSize: "1rem",
          fontWeight: 500,
          "&:hover": {
            backgroundColor: theme.palette.baselineColor.neutral[60],
          },
        },
        error: {
          color: theme.palette.error.main,
          marginTop: "1rem",
          fontSize: "0.875rem",
        },
        // Grid Layout Styles
        gridContainer: {
          display: "grid",
          gridTemplateColumns: "repeat(3, 1fr)",
          gap: "1.5rem",
          width: "100%",
          aspectRatio: "1/1",
          padding: "2rem",
          background: `linear-gradient(135deg, ${theme.palette.baselineColor.neutral[40]} 0%, ${theme.palette.baselineColor.neutral[90]} 100%)`,
          borderRadius: "1.5rem",
          position: "relative",
          "&::before": {
            content: '""',
            position: "absolute",
            top: -2,
            left: -2,
            right: -2,
            bottom: -2,
            background: `linear-gradient(135deg, ${theme.palette.primary.main} 0%, ${theme.palette.baselineColor.neutral[50]} 100%)`,
            borderRadius: "1.75rem",
            zIndex: -1,
          },
          boxShadow: "0 8px 32px rgba(0,0,0,0.2)",
        },
        gridItem: {
          aspectRatio: "1/1",
          borderRadius: "1rem",
          display: "flex",
          alignItems: "center",
          justifyContent: "center",
          padding: "2rem",
          border: `1px solid ${theme.palette.baselineColor.neutral[70]}`,
          position: "relative",
          overflow: "hidden",
          "&::before": {
            content: '""',
            position: "absolute",
            top: 0,
            left: 0,
            right: 0,
            bottom: 0,
            background: "linear-gradient(145deg, rgba(159, 203, 209, 0.28) 0%, rgba(255,255,255,0) 100%)",
            opacity: 0.5,
            zIndex: 1,
          },
          "&::after": {
            content: '""',
            position: "absolute",
            top: 0,
            left: 0,
            right: 0,
            bottom: 0,
            backdropFilter: "blur(10px)",
            zIndex: -1,
          },
          transition: "transform 0.3s ease, box-shadow 0.3s ease",
          "&:hover": {
            transform: "translateY(-2px)",
          },
        },
        gridItemWithBg: {
          boxShadow: "0 4px 30px rgba(0, 0, 0, 0.1), inset 0 2px 1px rgba(255, 255, 255, 0.1)",
          "&:hover": {
            boxShadow: "0 6px 40px rgba(0, 0, 0, 0.2), inset 0 2px 1px rgba(255, 255, 255, 0.1)",
          },
        },
        gridItemContent: {
          position: "relative",
          zIndex: 2,
        },
        gridText: {
          color: theme.palette.baselineColor.neutral[80],
          textAlign: "left",
          fontSize: "1.1rem",
          fontWeight: 500,
          textShadow: "0 2px 4px rgba(0,0,0,0.2)",
        },
        gridTextYellow: {
          color: theme.palette.baselineColor.neutral[80],
          textAlign: "left",
          fontSize: "1rem",
          fontWeight: 500,
        },
        gridImage: {
          width: "100%",
          height: "100%",
          objectFit: "contain",
        },
      },
    }),
    [theme]
  );
};

```

## Archivo: `packages/MainUI/components/Forms/types.ts`

```typescript
export interface LoginProps {
  title: string;
  onSubmit: (username: string, password: string) => Promise<void>;
  error?: string;
}

export interface GridItemProps {
  bgColor?: string;
  children?: React.ReactNode;
}

```

## Archivo: `packages/MainUI/components/Header/ConfigurationSection.tsx`

```typescript
"use client";
import { useState, useEffect } from "react";
import { ConfigurationModal } from "@workspaceui/componentlibrary/src/components";
import { modalConfig } from "../../../storybook/src/mocks";
import { useTranslation } from "../../hooks/useTranslation";
import type {
  OptionSelectedProps,
  ISection,
} from "@workspaceui/componentlibrary/src/components/ConfigurationModal/types";
import {
  SECTION_DENSITY_ID,
  SMALL_INTERFACE_SCALE_ID,
  DEFAULT_INTERFACE_SCALE_ID,
  LARGE_INTERFACE_SCALE_ID,
} from "@workspaceui/componentlibrary/src/components/ConfigurationModal/constants";
import { useLocalStorage } from "@workspaceui/componentlibrary/src/hooks/useLocalStorage";
import { DENSITY_KEY } from "@/utils/accessibility/constants";

const DENSITY_STYLES_OPTIONS = { small: "small-scale", default: "default-scale", large: "large-scale" };

const ConfigurationSection: React.FC = () => {
  const { t } = useTranslation();
  const [density, setDensity] = useLocalStorage(DENSITY_KEY, "");
  const [sections, setSections] = useState<ISection[]>([]);

  useEffect(() => {
    const initializedSections = modalConfig.sections.map((section) => {
      if (section.id === SECTION_DENSITY_ID) {
        const items = section.items;
        const selectedItemsIndex = items.findIndex((item) => item.id === density);
        return {
          ...section,
          selectedItem: selectedItemsIndex === -1 ? 1 : selectedItemsIndex,
        };
      }
      return section;
    });
    setSections(initializedSections);
  }, [density]);

  const handleSelectOption = (optionSelected: OptionSelectedProps) => {
    const { sectionId, id: optionSelectedId } = optionSelected;
    if (sectionId === SECTION_DENSITY_ID) {
      const rootElement = document.documentElement;
      rootElement.classList.remove(...Object.values(DENSITY_STYLES_OPTIONS));
      let newStyle = "";
      switch (optionSelectedId) {
        case SMALL_INTERFACE_SCALE_ID:
          newStyle = DENSITY_STYLES_OPTIONS.small;
          break;
        case DEFAULT_INTERFACE_SCALE_ID:
          newStyle = DENSITY_STYLES_OPTIONS.default;
          break;
        case LARGE_INTERFACE_SCALE_ID:
          newStyle = DENSITY_STYLES_OPTIONS.large;
          break;
      }
      rootElement.classList.add(newStyle);
      setDensity(newStyle);
    }
  };

  return (
    <ConfigurationModal
      {...modalConfig}
      sections={sections}
      tooltipButtonProfile={t("navigation.configurationModal.tooltipButtonProfile")}
      onChangeSelect={handleSelectOption}
    />
  );
};

export default ConfigurationSection;

```

## Archivo: `packages/MainUI/components/Label/index.tsx`

```typescript
interface LabelProps {
  htmlFor: string;
  name: string;
  onClick?: (e: React.MouseEvent) => void;
  onKeyDown?: (e: React.KeyboardEvent) => void;
  link?: boolean;
}

export default function Label({ htmlFor, name, onClick, onKeyDown, link }: LabelProps) {
  return (
    <label
      htmlFor={htmlFor}
      className={`block text-sm font-medium select-none truncate ${link ? "text-(--color-dynamic-main) cursor-pointer" : "text-gray-700"}`}
      onClick={(e) => onClick?.(e)}
      onKeyDown={(e) => onKeyDown?.(e)}
      {...(link ? { role: "button", tabIndex: 0, "aria-label": "Navigate to referenced window" } : {})}>
      {name}
    </label>
  );
}

```

## Archivo: `packages/MainUI/components/Layout/GlobalLoading.tsx`

```typescript
"use client";

import Loading from "@/components/loading";
import { useLoading } from "@/contexts/loading";

export default function GlobalLoading() {
  const { isLoading } = useLoading();

  if (!isLoading) return null;

  return (
    <Loading
      className="h-screen w-screen absolute z-100 bg-black/25"
      customIconProps={{
        size: 60,
        thickness: 4,
        sx: {
          color: "#1976d2",
        },
      }}
    />
  );
}

```

## Archivo: `packages/MainUI/components/Modal.tsx`

```typescript
import { useEffect, useState } from "react";
import { createPortal } from "react-dom";

export default function Modal({
  children,
  open,
  onClose,
}: {
  children: React.ReactNode;
  open: boolean;
  onClose: () => unknown;
}) {
  const [visible, setVisible] = useState(open);

  useEffect(() => {
    if (open) {
      setVisible(true);

      return () => {
        setTimeout(() => setVisible(false), 300);
      };
    }
  }, [open]);

  useEffect(() => {
    if (open) {
      const handler = (e: KeyboardEvent) => {
        if (e.key === "Escape") {
          onClose?.();
        }
      };

      document.addEventListener("keydown", handler);

      return () => {
        document.removeEventListener("keydown", handler);
      };
    }
  }, [onClose, open]);

  return createPortal(
    <div className="fixed inset-0 z-[1000] pointer-events-none overflow-hidden">
      <div
        className={`w-full h-full transition-all transform-gpu duration-200 ${open ? "opacity-100 pointer-events-auto scale-y-100 scale-x-100 ease-out" : "opacity-0 pointer-events-none scale-x-200 scale-y-150 ease-in"}`}>
        {visible ? children : null}
      </div>
    </div>,
    document.body
  );
}

```

## Archivo: `packages/MainUI/components/Nav/Profile.tsx`

```typescript
import { useContext, useState, useCallback, useMemo } from "react";
import { UserContext } from "../../contexts/user";
import { logger } from "../../utils/logger";
import type { ProfileWrapperProps } from "./types";
import type { Language } from "../../contexts/types";
import { useLanguage } from "@/contexts/language";
import ProfileModal from "../ProfileModal/ProfileModal";

const ProfileWrapper = (props: ProfileWrapperProps) => {
  const {
    setDefaultConfiguration,
    currentRole,
    currentOrganization,
    profile,
    currentWarehouse,
    changeProfile,
    roles,
    languages,
  } = useContext(UserContext);
  const [saveAsDefault, setSaveAsDefault] = useState(false);
  const { language, setLanguage, getFlag } = useLanguage();

  const { clearUserData } = useContext(UserContext);

  const handleSignOff = useCallback(() => {
    clearUserData();
  }, [clearUserData]);

  const handleSaveAsDefaultChange = useCallback((event: React.ChangeEvent<HTMLInputElement>) => {
    setSaveAsDefault(event.target.checked);
  }, []);

  const languagesWithFlags = useMemo(() => {
    return languages.map((lang) => ({
      ...lang,
      flagEmoji: getFlag(lang.language as Language),
      displayName: `${getFlag(lang.language as Language)} ${lang.name}`,
    }));
  }, [languages, getFlag]);

  const flagString = getFlag(language);

  if (!currentRole) {
    return null;
  }

  return (
    <ProfileModal
      {...props}
      currentRole={currentRole}
      currentWarehouse={currentWarehouse}
      currentOrganization={currentOrganization}
      roles={roles}
      saveAsDefault={saveAsDefault}
      onLanguageChange={setLanguage}
      language={language}
      languagesFlags={flagString}
      onSaveAsDefaultChange={handleSaveAsDefaultChange}
      changeProfile={changeProfile}
      onSetDefaultConfiguration={setDefaultConfiguration}
      logger={logger}
      onSignOff={handleSignOff}
      languages={languagesWithFlags}
      userName={profile.name}
      userEmail={profile.email}
      userPhotoUrl={profile.image}
    />
  );
};

export default ProfileWrapper;

```

## Archivo: `packages/MainUI/components/Nav/types.ts`

```typescript
import type { Role } from "@workspaceui/api-client/src/api/types";
import type { Option } from "@workspaceui/componentlibrary/src/components/Input/Select/types";
import type { BaseDefaultConfiguration, BaseProfileModalProps, BaseWarehouse } from "../ProfileModal/types";
import type { Logger } from "@/utils/logger";

export interface WrapperHandledProps {
  currentRole: Role | null;
  currentWarehouse: BaseWarehouse | null;
  roles: Role[];
  onChangeRole: (roleId: string) => Promise<void>;
  onChangeWarehouse: (warehouseId: string) => Promise<void>;
  onSetDefaultConfiguration: (config: BaseDefaultConfiguration) => Promise<void>;
  logger: Logger;
  onRoleChange: (event: React.SyntheticEvent<Element, Event>, value: Option | null) => void;
  onWarehouseChange: (event: React.SyntheticEvent<Element, Event>, value: Option | null) => void;
  selectedRole: Option | null;
  selectedWarehouse: Option | null;
  saveAsDefault: boolean;
  onSaveAsDefaultChange: (event: React.ChangeEvent<HTMLInputElement>) => void;
}

export interface ProfileWrapperProps extends Omit<BaseProfileModalProps, "userPhotoUrl" | "userName" | "userEmail"> {}

```

## Archivo: `packages/MainUI/components/NavigationTabs/MenuTabs/MenuItem.tsx`

```typescript
"use client";
import CheckIcon from "@workspaceui/componentlibrary/src/assets/icons/check.svg";
import { useState } from "react";
import FolderIcon from "@workspaceui/componentlibrary/src/assets/icons/folder.svg";
import Tooltip from "@workspaceui/componentlibrary/src/components/Tooltip";

interface MenuItemProps {
  windowId: string;
  title: string;
  isActive: boolean;
  onSelect: (windowId: string) => void;
}

export default function MenuItem({ windowId, title, isActive, onSelect }: MenuItemProps) {
  const [isHovered, setIsHovered] = useState(false);

  const showSelected = isActive || isHovered;

  const handleMouseEnter = () => {
    setIsHovered(true);
  };

  const handleMouseLeave = () => {
    setIsHovered(false);
  };

  return (
    <Tooltip title={title} position="left" containerClassName="w-full">
      <button
        type="button"
        key={windowId}
        className={`w-full h-9 flex items-center justify-between rounded-lg p-2 ${showSelected ? "bg-[var(--color-dynamic-light)]" : ""}`}
        onClick={() => onSelect(windowId)}
        onMouseEnter={handleMouseEnter}
        onMouseLeave={handleMouseLeave}>
        <div
          className={`flex items-center gap-2 overflow-hidden w-10/12 text-[var(--color-baseline-90)] ${showSelected ? "text-[var(--color-dynamic-main)]" : ""}`}>
          <div className="truncate flex items-center gap-2">
            <FolderIcon
              className={`min-h-4 min-w-4 h-4 w-4 fill-[var(--color-baseline-60)] hover:fill-[var(--color-dynamic-main)] ${showSelected ? "fill-[var(--color-dynamic-main)]" : ""}`}
            />
            <span className="truncate">{title}</span>
          </div>
        </div>
        {isActive && <CheckIcon className="min-h-4 min-w-4 h-4 w-4 fill-[var(--color-dynamic-main)]" />}
      </button>
    </Tooltip>
  );
}

```

## Archivo: `packages/MainUI/components/NavigationTabs/MenuTabs/index.tsx`

```typescript
"use client";
import { useMultiWindowURL } from "@/hooks/navigation/useMultiWindowURL";
import Menu from "@workspaceui/componentlibrary/src/components/Menu";
import MenuItem from "@/components/NavigationTabs/MenuTabs/MenuItem";
import { useMetadataContext } from "@/hooks/useMetadataContext";

interface MenuTabsProps {
  anchorEl: HTMLElement | null;
  onClose: () => void;
  onSelect: (windowId: string) => void;
}

export default function MenuTabs({ anchorEl, onClose, onSelect }: MenuTabsProps) {
  const { windows } = useMultiWindowURL();
  const { getWindowTitle } = useMetadataContext();

  return (
    <Menu anchorEl={anchorEl} onClose={onClose}>
      <div
        className="w-full h-full max-h-screen bg-[var(--color-baseline-0)] border border-[var(--color-transparent-neutral-10)] rounded-xl flex flex-col gap-2 p-2 overflow-y-auto"
        style={{
          boxShadow: "0px 4px 10px var(--color-transparent-neutral-10)",
        }}>
        {windows.map((window) => {
          const windowId = window.windowId;
          const title = window.title || getWindowTitle?.(window.windowId);
          const isActive = window.isActive;
          return <MenuItem key={windowId} windowId={windowId} title={title} isActive={isActive} onSelect={onSelect} />;
        })}
      </div>
    </Menu>
  );
}

```

## Archivo: `packages/MainUI/components/NavigationTabs/WindowTab.tsx`

```typescript
import CloseIcon from "@workspaceui/componentlibrary/src/assets/icons/x.svg";
import FolderIcon from "@workspaceui/componentlibrary/src/assets/icons/folder.svg";
import { useTranslation } from "@/hooks/useTranslation";
import Tooltip from "@workspaceui/componentlibrary/src/components/Tooltip";

interface WindowTabProps {
  windowId: string;
  title: string;
  isActive: boolean;
  onActivate: () => void;
  onClose: () => void;
  canClose?: boolean;
  icon?: React.ReactNode;
}

export default function WindowTab({ title, isActive, onActivate, onClose, canClose = true }: WindowTabProps) {
  const { t } = useTranslation();

  return (
    <Tooltip title={title}>
      <button
        type="button"
        className={`
        h-9 flex gap-2 items-center justify-center p-2 cursor-pointer max-w-[220px] 
        relative group transition-all duration-200 text-(--color-baseline-90) 
        ${
          isActive
            ? "bg-(--color-baseline-0) border-b-2 border-(--color-dynamic-main)"
            : "hover:bg-(--color-baseline-0)"
        }
      `}
        style={{
          borderTopLeftRadius: "12px",
          borderTopRightRadius: "12px",
        }}
        onClick={onActivate}>
        <div className="h-full flex items-center flex-1 truncate gap-2">
          <FolderIcon className="fill-black" />
          <span className="flex-1 truncate text-sm font-medium">{title}</span>
        </div>
        {canClose && (
          <button
            type="button"
            className={`
            w-5 h-5 flex-shrink-0 rounded-full transition-opacity duration-200
            hover:bg-gray-300 hover:text-gray-800 flex items-center justify-center
          `}
            onClick={(e) => {
              e.stopPropagation();
              onClose();
            }}
            title={t("primaryTabs.closeWindow")}>
            <CloseIcon />
          </button>
        )}
      </button>
    </Tooltip>
  );
}

```

## Archivo: `packages/MainUI/components/NavigationTabs/WindowTabs.tsx`

```typescript
"use client";
import { useCallback, useState } from "react";
import { useMetadataContext } from "@/hooks/useMetadataContext";
import { useMultiWindowURL } from "@/hooks/navigation/useMultiWindowURL";
import IconButton from "@workspaceui/componentlibrary/src/components/IconButton";
import HomeIcon from "@workspaceui/componentlibrary/src/assets/icons/home.svg";
import ChevronRightIcon from "@workspaceui/componentlibrary/src/assets/icons/chevron-right.svg";
import ChevronLeftIcon from "@workspaceui/componentlibrary/src/assets/icons/chevron-left.svg";
import ChevronsRightIcon from "@workspaceui/componentlibrary/src/assets/icons/chevrons-right.svg";
import WindowTab from "@/components/NavigationTabs/WindowTab";
import MenuTabs from "@/components/NavigationTabs/MenuTabs";
import { useTabs } from "@/contexts/tabs";
import { useTranslation } from "@/hooks/useTranslation";

export default function WindowTabs() {
  const { windows, isHomeRoute, setActiveWindow, closeWindow, navigateToHome } = useMultiWindowURL();
  const { getWindowTitle } = useMetadataContext();
  const { t } = useTranslation();

  const {
    containerRef,
    windowsContainerRef,
    tabRefs,
    showLeftScrollButton,
    showRightScrollButton,
    showRightMenuButton,
    handleScrollLeft,
    handleScrollRight,
  } = useTabs();
  const [anchorEl, setAnchorEl] = useState<HTMLElement | null>(null);

  const handleTabMenuOpen = useCallback((event: React.MouseEvent<HTMLButtonElement>) => {
    setAnchorEl(event.currentTarget);
  }, []);

  const handleTabMenuClose = useCallback(() => {
    setAnchorEl(null);
  }, []);

  const handleSelectWindow = useCallback(
    (windowId: string) => {
      setActiveWindow(windowId);
    },
    [setActiveWindow]
  );

  const handleGoHome = () => {
    navigateToHome();
  };

  return (
    <div
      className="flex items-center bg-(--color-transparent-neutral-5) rounded-full overflow-hidden p-0 px-0.5 h-9 min-h-9"
      ref={containerRef}>
      <div className="flex items-center h-8">
        <IconButton
          onClick={handleGoHome}
          className={`w-8 h-8 text-[1.5rem] bg-(--color-baseline-0) hover:bg-(--color-etendo-main) hover:text-(--color-etendo-contrast-text) ${isHomeRoute ? "bg-(--color-etendo-main) text-(--color-etendo-contrast-text)" : ""}`}
          tooltip={t("primaryTabs.dashboard")}
          aria-label={t("primaryTabs.dashboard")}>
          <HomeIcon className="h-[1.125rem] w-[1.125rem]" />
        </IconButton>
      </div>
      {showLeftScrollButton && (
        <IconButton
          onClick={handleScrollLeft}
          className="max-h-7 bg-transparent w-auto h-full rounded-full p-2 text-sm hover:bg-[var(--color-transparent-neutral-5)] hover:text-(--color-baseline-80)">
          <ChevronLeftIcon className="h-[1rem] w-[1rem]" />
        </IconButton>
      )}
      <div
        className="w-full flex items-center px-2 overflow-x-auto overflow-y-hidden scroll-smooth hide-scrollbar h-9"
        ref={windowsContainerRef}>
        {windows.map((window, index) => {
          const title = window.title || getWindowTitle?.(window.windowId);
          const isActive = window.isActive;
          const canClose = windows.length > 1;

          const activeIndex = windows.findIndex((w) => w.isActive);
          const showSeparator = index !== activeIndex - 1 && index !== activeIndex;

          return (
            <div
              key={window.windowId}
              className="flex items-center h-9"
              ref={(el) => {
                tabRefs.current[window.windowId] = el;
              }}>
              <WindowTab
                windowId={window.windowId}
                title={title}
                isActive={isActive}
                onActivate={() => {
                  handleSelectWindow(window.windowId);
                }}
                onClose={() => {
                  closeWindow(window.windowId);
                }}
                canClose={canClose}
              />
              {showSeparator && index < windows.length - 1 && (
                <div className="h-4 w-0.5 bg-(--color-baseline-100) opacity-10 mx-0.5" />
              )}
            </div>
          );
        })}
      </div>
      {showRightScrollButton && (
        <IconButton
          onClick={handleScrollRight}
          className="max-h-7 bg-transparent w-auto h-full rounded-full p-2 text-sm hover:bg-[var(--color-transparent-neutral-5)] hover:text-(--color-baseline-80)">
          <ChevronRightIcon className="h-[1rem] w-[1rem]" />
        </IconButton>
      )}
      {showRightMenuButton && (
        <IconButton
          onClick={handleTabMenuOpen}
          containerClassName="h-8 w-8 flex justify-center items-center"
          className="h-8 w-8 bg-white rounded-full p-1.5 text-sm"
          tooltip={t("primaryTabs.showTabs")}
          tooltipPosition="left">
          <ChevronsRightIcon className="h-[1.125rem] w-[1.125rem]" />
        </IconButton>
      )}
      <MenuTabs anchorEl={anchorEl} onClose={handleTabMenuClose} onSelect={handleSelectWindow} />
    </div>
  );
}

```

## Archivo: `packages/MainUI/components/ProcessModal/DeprecatedFeature.tsx`

```typescript
import { useCallback } from "react";
import { useTranslation } from "@/hooks/useTranslation";
import type { ProcessDeprecatedModallProps } from "./types";
import CloseIcon from "../../../ComponentLibrary/src/assets/icons/x.svg";
import WarningIcon from "../../../ComponentLibrary/src/assets/icons/alert-triangle.svg";
import IconButton from "@workspaceui/componentlibrary/src/components/IconButton";
import { Button } from "@mui/material";

const DeprecatedFeatureModal = ({ isOpen, onClose, title, message }: ProcessDeprecatedModallProps) => {
  const { t } = useTranslation();

  const handleClose = useCallback(() => {
    onClose();
  }, [onClose]);

  if (!isOpen) return null;

  return (
    <div className="fixed inset-0 z-5000 flex items-center justify-center bg-black/50">
      <div className="relative bg-white flex flex-col w-full max-w-md border-4 border-gray-300 rounded-xl">
        <div className="flex justify-between items-center p-4 border-b border-gray-200 rounded-t-xl bg-[var(--color-baseline-10)]">
          <h2 className="text-lg font-semibold">{title || t("common.processTitle")}</h2>
          <IconButton onClick={onClose}>
            <CloseIcon />
          </IconButton>
        </div>
        <div className="p-6">
          <div className="flex items-center justify-center mb-4">
            <WarningIcon fill="red" width="2rem" height="2rem" />
          </div>
          <p className="text-center text-lg font-medium mb-4">{message || t("common.notImplemented")}</p>
        </div>
        <div className="p-4 border-t border-gray-200 flex justify-center rounded-b-xl bg-[var(--color-baseline-10)]">
          <Button onClick={handleClose} variant="contained">
            {t("common.close")}
          </Button>
        </div>
      </div>
    </div>
  );
};

export default DeprecatedFeatureModal;

```

## Archivo: `packages/MainUI/components/ProcessModal/Iframe.tsx`

```typescript
import { type ProcessMessage, useProcessMessage } from "@/hooks/useProcessMessage";
import { useTranslation } from "@/hooks/useTranslation";
import { logger } from "@/utils/logger";
import { useCallback, useEffect, useMemo, useState } from "react";
import {
  type MessageStylesType,
  type ProcessIframeModalClosedProps,
  type ProcessIframeModalOpenProps,
  isIframeModalOpen,
} from "./types";

const CLOSE_MODAL_ACTION = "closeModal";
const PROCESS_ORDER_ACTION = "processOrder";

const ProcessIframeOpenModal = ({
  isOpen,
  onClose,
  url,
  title,
  onProcessSuccess,
  tabId,
}: ProcessIframeModalOpenProps) => {
  const { t } = useTranslation();
  const [iframeLoading, setIframeLoading] = useState(true);
  const [processMessage, setProcessMessage] = useState<ProcessMessage | null>(null);
  const { fetchProcessMessage } = useProcessMessage(tabId);
  const [processWasSuccessful, setProcessWasSuccessful] = useState(false);

  const handleClose = useCallback(() => {
    if (processWasSuccessful && onProcessSuccess) {
      onProcessSuccess();
    }

    setProcessWasSuccessful(false);
    onClose();
  }, [onClose, onProcessSuccess, processWasSuccessful]);

  const handleReceivedMessage = useCallback(
    (message: ProcessMessage) => {
      if (message?.type === "info") return;
      if (message.message?.toUpperCase().includes("ERROR")) {
        setProcessMessage({
          ...message,
          type: "error",
          title: message.title || t("errors.internalServerError.title"),
        });
        setProcessWasSuccessful(false);
      } else {
        setProcessMessage(message);
        setProcessWasSuccessful(message.type === "success");
      }
    },
    [t]
  );

  const handleMessageError = useCallback(
    (error: unknown) => {
      if (error instanceof Error && !(error instanceof DOMException)) {
        logger.warn(error);
        setProcessMessage({
          type: "error",
          title: t("errors.internalServerError.title"),
          message: String(error),
        });
      }
    },
    [t]
  );

  const handleProcessMessage = useCallback(async () => {
    try {
      const message = await fetchProcessMessage();
      if (message) {
        handleReceivedMessage(message);
        return true;
      }
    } catch (error) {
      handleMessageError(error);
      return error instanceof Error && !(error instanceof DOMException);
    }
    return false;
  }, [fetchProcessMessage, handleReceivedMessage, handleMessageError]);

  const handleIframeLoad = useCallback(() => {
    setIframeLoading(false);
  }, []);

  const getMessageStyles = useCallback((type: string): MessageStylesType => {
    const normalizedType = type?.toLowerCase() || "";
    if (normalizedType.includes("error")) {
      return {
        bgColor: "var(--color-error-contrast-text)",
        borderColor: "var(--color-error-main)",
        textColor: "var(--color-error-main)",
        buttonBg: "var(--color-error-main)",
      };
    }
    switch (normalizedType) {
      case "success":
        return {
          bgColor: "var(--color-success-contrast-text)",
          borderColor: "var(--color-success-main)",
          textColor: "var(--color-success-main)",
          buttonBg: "var(--color-success-main)",
        };
      case "warning":
        return {
          bgColor: "var(--color-warning-contrast-text)",
          borderColor: "var(--color-warning-main)",
          textColor: "var(--color-warning-main)",
          buttonBg: "var(--color-warning-main)",
        };
      default:
        return {
          bgColor: "var(--color-etendo-light)",
          borderColor: "var(--color-etendo-main)",
          textColor: "var(--color-etendo-main)",
          buttonBg: "var(--color-etendo-main)",
        };
    }
  }, []);

  useEffect(() => {
    if (url) {
      setIframeLoading(true);
      setProcessMessage(null);
    }
  }, [url]);

  useEffect(() => {
    const handleMessage = async (event: MessageEvent) => {
      if (event.data?.action === CLOSE_MODAL_ACTION) {
        handleClose();
      }
      if (event.data?.action === PROCESS_ORDER_ACTION) {
        await handleProcessMessage();
      }
    };

    window.addEventListener("message", handleMessage);

    return () => {
      window.removeEventListener("message", handleMessage);
    };
  }, [handleClose, handleProcessMessage]);

  const messageStyles = useMemo(
    () =>
      processMessage
        ? getMessageStyles(processMessage.type)
        : {
            bgColor: "",
            borderColor: "",
            textColor: "",
            buttonBg: "",
          },
    [processMessage, getMessageStyles]
  );

  if (!isOpen) return null;

  return (
    <div className="fixed inset-0 z-5000 flex items-center justify-center bg-black/50">
      {/* NOTE: sizes inherited from the modal for manual processes from the previous UI */}
      <div className="relative flex h-[625px] w-[900px] flex-col rounded-xl border-4 border-gray-300 bg-white">
        <div className="flex items-center justify-between rounded-xl border-gray-200 border-b bg-[var(--color-baseline-10)] p-4">
          <h2 className="font-semibold text-lg">{title || t("common.processes")}</h2>
        </div>
        <div className="relative flex-1 overflow-hidden">
          {iframeLoading && (
            <div className="absolute inset-0 z-10 flex items-center justify-center bg-white bg-opacity-90">
              <div className="text-center">
                <div className="inline-block h-8 w-8 animate-spin rounded-full border-4 border-[var(--color-etendo-main)] border-t-transparent" />
                <p className="mt-2 font-medium">{t("common.loading")}</p>
              </div>
            </div>
          )}
          {processMessage && (
            <div
              className="-translate-x-1/2 -translate-y-1/2 absolute top-1/2 left-1/2 z-50 w-4/5 max-w-md transform overflow-hidden rounded-lg border shadow-lg"
              style={{
                borderColor: messageStyles.borderColor,
                backgroundColor: "white",
              }}>
              <div className="flex items-start gap-3 p-4" style={{ backgroundColor: messageStyles.bgColor }}>
                <div className="flex-shrink-0" />
                <div className="flex-1">
                  <h3 className="mb-1 font-semibold text-lg" style={{ color: messageStyles.textColor }}>
                    {processMessage.title || t("common.processes")}
                  </h3>
                  {processMessage.message && <p className="text-gray-700">{processMessage.message}</p>}
                </div>
              </div>
            </div>
          )}
          {!iframeLoading && !url && (
            <div className="absolute inset-0 z-10 flex items-center justify-center bg-white bg-opacity-90">
              <div className="text-center">
                <p className="text-2xl font-medium">{t("common.noDataAvailable")}</p>
              </div>
            </div>
          )}
          <iframe
            src={url}
            onLoad={handleIframeLoad}
            className="h-full w-full border-0"
            title={t("common.processes")}
          />
        </div>
        <div className="flex justify-end rounded-xl border-gray-200 border-t bg-[var(--color-baseline-10)] p-4">
          <button
            data-testid="close-button"
            type="button"
            onClick={handleClose}
            className="mx-auto rounded bg-[var(--color-etendo-main)] px-4 py-2 font-medium text-white hover:bg-[var(--color-etendo-dark)] focus:outline-none">
            {t("common.close")}
          </button>
        </div>
      </div>
    </div>
  );
};

const ProcessIframeModal = (props: ProcessIframeModalOpenProps | ProcessIframeModalClosedProps) => {
  if (isIframeModalOpen(props)) {
    return <ProcessIframeOpenModal {...props} />;
  }

  return null;
};

export default ProcessIframeModal;

```

## Archivo: `packages/MainUI/components/ProcessModal/ProcessDefinitionModal.tsx`

```typescript
import { useTabContext } from "@/contexts/tab";
import { useProcessConfig } from "@/hooks/datasource/useProcessDatasourceConfig";
import { useProcessInitialization } from "@/hooks/useProcessInitialization";
import { useProcessInitializationState } from "@/hooks/useProcessInitialState";
import { useSelected } from "@/hooks/useSelected";
import { useTranslation } from "@/hooks/useTranslation";
import { useUserContext } from "@/hooks/useUserContext";
import { buildPayloadByInputName, buildProcessPayload } from "@/utils";
import { executeStringFunction } from "@/utils/functions";
import { logger } from "@/utils/logger";
import { FIELD_REFERENCE_CODES } from "@/utils/form/constants";
import { Metadata } from "@workspaceui/api-client/src/api/metadata";
import type { Tab } from "@workspaceui/api-client/src/api/types";
import { useCallback, useEffect, useMemo, useState } from "react";
import { FormProvider, useForm } from "react-hook-form";
import CheckIcon from "../../../ComponentLibrary/src/assets/icons/check-circle.svg";
import CloseIcon from "../../../ComponentLibrary/src/assets/icons/x.svg";
import Modal from "../Modal";
import Loading from "../loading";
import WindowReferenceGrid from "./WindowReferenceGrid";
import BaseSelector from "./selectors/BaseSelector";
import ProcessParameterSelector from "./selectors/ProcessParameterSelector";
import type {
  ProcessDefinitionModalContentProps,
  ProcessDefinitionModalProps,
  RecordValues,
  ResponseMessage,
} from "./types";
import { PROCESS_DEFINITION_DATA } from "@/utils/processes/definition/constants";

export const FALLBACK_RESULT = {};
const WINDOW_REFERENCE_ID = FIELD_REFERENCE_CODES.WINDOW;

function ProcessDefinitionModalContent({ onClose, button, open, onSuccess }: ProcessDefinitionModalContentProps) {
  const { t } = useTranslation();
  const { graph } = useSelected();
  const { tab, record } = useTabContext();
  const { session } = useUserContext();

  const { onProcess, onLoad } = button.processDefinition;
  const processId = button.processDefinition.id;
  const javaClassName = button.processDefinition.javaClassName;

  const [parameters, setParameters] = useState(button.processDefinition.parameters);
  const [response, setResponse] = useState<ResponseMessage>();
  const [isExecuting, setIsExecuting] = useState(false);
  const [isSuccess, setIsSuccess] = useState(false);
  const [loading, setLoading] = useState(true);
  const [gridSelection, setGridSelection] = useState<unknown[]>([]);

  const selectedRecords = graph.getSelectedMultiple(tab);

  const windowReferenceTab = parameters.grid?.window?.tabs?.[0] as Tab;
  const entityName = windowReferenceTab?.entityName || "";
  const windowId = tab?.window || "";
  const tabId = windowReferenceTab?.id || "";

  const recordValues: RecordValues | null = useMemo(() => {
    if (!record || !tab?.fields) return FALLBACK_RESULT;
    return buildPayloadByInputName(record, tab.fields);
  }, [record, tab?.fields]);

  const hasWindowReference = useMemo(() => {
    return Object.values(parameters).some((param) => param.reference === WINDOW_REFERENCE_ID);
  }, [parameters]);

  const {
    fetchConfig,
    loading: processConfigLoading,
    error: processConfigError,
    config: processConfig,
  } = useProcessConfig({
    processId: processId || "",
    windowId: windowId || "",
    tabId,
  });

  // Process initialization for default values (adapted from FormInitialization pattern)
  const {
    processInitialization,
    loading: initializationLoading,
    error: initializationError,
    refetch: refetchDefaults,
  } = useProcessInitialization({
    processId: processId || "",
    windowId: windowId || "",
    recordId: record?.id ? String(record.id) : undefined, // Convert EntityValue to string
    enabled: !!processId && !!windowId && open, // Only fetch when modal is open
    record: record || undefined, // Pass complete record data
    tab: tab || undefined,       // Pass tab metadata
  });

  // Process form initial state (similar to useFormInitialState)
  // Memoize parameters to prevent infinite re-execution
  const memoizedParameters = useMemo(() => Object.values(parameters), [parameters]);

  const {
    initialState,
    logicFields,
    filterExpressions,
    refreshParent,
    hasData: hasInitialData,
  } = useProcessInitializationState(
    processInitialization,
    memoizedParameters // Use memoized version to prevent infinite loops
  );

  // Combined form data: record values + process defaults (similar to FormView pattern)
  const availableFormData = useMemo(() => {
    if (!record || !tab) return {};

    // Build base payload with system context fields
    const basePayload = buildProcessPayload(
      record,           // Complete record data
      tab,             // Tab metadata
      {},              // Don't include initialState here yet
      {}               // User input will be added during execution
    );

    // Use initialState directly - it's already processed by useProcessInitializationState
    // No need to reprocess the values, they're already mapped correctly
    console.log('Raw initialState from hook:', initialState);
    console.log('Available form data will be:', {
      ...basePayload,
      ...initialState
    });

    return {
      ...basePayload,        // System context fields
      ...initialState,       // Already processed defaults from useProcessInitializationState
    };
  }, [record, tab, initialState]);

  const form = useForm({
    values: availableFormData, // Pre-populate with combined data
    mode: "onChange"
  });

  // Reset form values when defaults are loaded
  useEffect(() => {
    if (hasInitialData && Object.keys(availableFormData).length > 0) {
      console.log('Resetting form with new values:', availableFormData);
      form.reset(availableFormData);
    }
  }, [hasInitialData, availableFormData, form]);

  const handleClose = useCallback(() => {
    if (isExecuting) return;
    setResponse(undefined);
    setIsExecuting(false);
    setIsSuccess(false);
    setLoading(true);
    setParameters(button.processDefinition.parameters);
    onClose();
  }, [button.processDefinition.parameters, isExecuting, onClose]);

  const handleWindowReferenceExecute = useCallback(async () => {
    if (!tab || !processId) return;

    setIsExecuting(true);
    setIsSuccess(false);

    try {
      const params = new URLSearchParams({
        processId,
        windowId: tab.window,
        _action: javaClassName,
      });

      const currentAttrs = PROCESS_DEFINITION_DATA[processId as keyof typeof PROCESS_DEFINITION_DATA];
      const currentRecordValue = recordValues?.[currentAttrs.inpPrimaryKeyColumnId];

      const payload = {
        [currentAttrs.inpColumnId]: currentRecordValue,
        [currentAttrs.inpPrimaryKeyColumnId]: currentRecordValue,
        _buttonValue: "DONE",
        _params: {
          grid: {
            _selection: gridSelection,
          },
        },
        _entityName: entityName,
      };

      const response = await Metadata.kernelClient.post(`?${params}`, payload);

      if (response?.data?.message) {
        const isSuccessResponse = response.data.message.severity === "success";

        setResponse({
          msgText: response.data.message.text || "",
          msgTitle: isSuccessResponse ? t("process.completedSuccessfully") : t("process.processError"),
          msgType: response.data.message.severity,
        });

        if (isSuccessResponse) {
          setIsSuccess(true);
          onSuccess?.();
        }
      } else if (response?.data) {
        setResponse({
          msgText: "Process completed successfully",
          msgTitle: t("process.completedSuccessfully"),
          msgType: "success",
        });

        setIsSuccess(true);
        onSuccess?.();
      }
    } catch (error) {
      logger.warn("Error executing process:", error);
      setResponse({
        msgText: error instanceof Error ? error.message : "Unknown error",
        msgTitle: t("errors.internalServerError.title"),
        msgType: "error",
      });
    } finally {
      setIsExecuting(false);
    }
  }, [tab, processId, javaClassName, recordValues, gridSelection, entityName, t, onSuccess]);

  const handleExecute = useCallback(async () => {
    if (hasWindowReference) {
      await handleWindowReferenceExecute();
      return;
    }

    if (!onProcess || !tab || !record) return;

    setIsExecuting(true);
    setIsSuccess(false);

    try {
      // Build complete payload with all context fields
      const completePayload = buildProcessPayload(
        record,                 // Complete record data
        tab,                   // Tab metadata
        initialState || {},    // Process defaults from server (handle null case)
        form.getValues()       // User input from form
      );

      const result = await executeStringFunction(onProcess, { Metadata }, button.processDefinition, {
        buttonValue: "DONE",
        windowId: tab.window,
        entityName: tab.entityName,
        recordIds: selectedRecords?.map((r) => r.id),
        ...completePayload,    // Use complete payload instead of just form values
      });

      const responseMessage = result.responseActions[0].showMsgInProcessView;
      setResponse(responseMessage);

      if (responseMessage.msgType === "success") {
        setIsSuccess(true);
        onSuccess?.();
      }
    } catch (error) {
      logger.warn("Error executing process:", error);
      setResponse({
        msgText: error instanceof Error ? error.message : "Unknown error",
        msgTitle: t("errors.internalServerError.title"),
        msgType: "error",
      });
    } finally {
      setIsExecuting(false);
    }
  }, [
    hasWindowReference,
    handleWindowReferenceExecute,
    onProcess,
    tab,
    record,
    initialState,
    button.processDefinition,
    selectedRecords,
    form,
    t,
    onSuccess,
  ]);

  useEffect(() => {
    if (open && hasWindowReference) {
      const loadConfig = async () => {
        const combinedPayload = {
          ...recordValues,
          ...session,
        };
        await fetchConfig(combinedPayload);
      };

      loadConfig();
    }
  }, [fetchConfig, recordValues, session, tabId, open, hasWindowReference]);

  // Note: Default values are now handled by availableFormData (FormInitialization pattern)
  // This replaces the previous processConfig.defaults logic with comprehensive
  // DefaultsProcessActionHandler integration including mixed types and logic fields

  // Handle initialization errors and logging
  useEffect(() => {
    if (initializationError) {
      logger.warn("Process initialization error:", initializationError);
    }
    
    if (hasInitialData) {
      logger.debug("Process defaults loaded successfully", {
        processId,
        fieldsCount: Object.keys(initialState || {}).length,
        hasLogicFields: Object.keys(logicFields || {}).length > 0,
        hasFilterExpressions: Object.keys(filterExpressions || {}).length > 0
      });
    }
  }, [initializationError, hasInitialData, processId, initialState, logicFields, filterExpressions]);

  useEffect(() => {
    if (open) {
      setIsExecuting(false);
      setIsSuccess(false);
      setResponse(undefined);
      setParameters(button.processDefinition.parameters);
      setGridSelection([]);
    }
  }, [button.processDefinition.parameters, open]);

  useEffect(() => {
    const fetchOptions = async () => {
      if (!open) return;

      try {
        setLoading(true);

        if (onLoad && tab) {
          const result = await executeStringFunction(onLoad, { Metadata }, button.processDefinition, {
            selectedRecords,
            tabId,
          });

          setParameters((prev) => {
            const newParameters = { ...prev };

            for (const [parameterName, values] of Object.entries(result)) {
              const newOptions = values as string[];
              newParameters[parameterName] = { ...newParameters[parameterName] };
              newParameters[parameterName].refList = newParameters[parameterName].refList.filter((option) =>
                newOptions.includes(option.value)
              );
            }

            return newParameters;
          });
        }

        setTimeout(() => {
          setLoading(false);
        }, 300);
      } catch (error) {
        logger.warn("Error loading parameters:", error);
        setLoading(false);
      }
    };

    fetchOptions();
  }, [button.processDefinition, onLoad, open, selectedRecords, tab, tabId]);

  const renderResponse = () => {
    if (!response) return null;

    const isSuccessMessage = response.msgType === "success";
    const messageClasses = `p-3 rounded mb-4 border-l-4 ${
      isSuccessMessage ? "bg-green-50 border-(--color-success-main)" : "bg-gray-50 border-(--color-etendo-main)"
    }`;

    return (
      <div className={messageClasses}>
        <h4 className="font-bold text-sm">{response.msgTitle}</h4>
        {/* biome-ignore lint/security/noDangerouslySetInnerHtml: <explanation> */}
        <p className="text-sm" dangerouslySetInnerHTML={{ __html: response.msgText }} />
      </div>
    );
  };

  const renderParameters = () => {
    if (isSuccess) return null;

    return Object.values(parameters).map((parameter) => {
      if (parameter.reference === WINDOW_REFERENCE_ID) {
        return (
          <WindowReferenceGrid
            key={`window-ref-${parameter.id || parameter.name}`}
            parameter={parameter}
            onSelectionChange={setGridSelection}
            tabId={tabId}
            entityName={entityName}
            windowReferenceTab={windowReferenceTab}
            processConfig={processConfig}
            processConfigLoading={processConfigLoading}
            processConfigError={processConfigError}
            recordValues={recordValues}
          />
        );
      }
      // Use new ProcessParameterSelector for enhanced field reference support
      return (
        <ProcessParameterSelector 
          key={`param-${parameter.id || parameter.name}-${parameter.reference || 'default'}`}
          parameter={parameter}
          logicFields={logicFields} // Pass logic fields from process defaults
        />
      );
    });
  };

  const renderActionButton = () => {
    if (isExecuting) {
      return <span className="animate-pulse">{t("common.loading")}...</span>;
    }

    if (isSuccess) {
      return (
        <span className="flex items-center gap-2">
          <CheckIcon fill="white" />
          {t("process.completedSuccessfully")}
        </span>
      );
    }

    return (
      <>
        {CheckIcon && <CheckIcon fill="white" />}
        {t("common.execute")}
      </>
    );
  };

  const isActionButtonDisabled = isExecuting || isSuccess || (hasWindowReference && gridSelection.length === 0);

  return (
    <Modal open={open} onClose={handleClose}>
      <FormProvider {...form}>
        <div className="fixed inset-0 flex items-center justify-center bg-black/50 z-50 p-4">
          <div className="bg-white rounded-lg shadow-lg w-full max-w-5xl max-h-full overflow-hidden flex flex-col">
            {/* Header */}
            <div className="flex items-center justify-between p-4 border-b border-gray-200">
              <div className="flex items-center gap-2">
                <h3 className="text-lg font-bold">{button.name}</h3>
              </div>
              <button
                type="button"
                onClick={handleClose}
                className="p-1 rounded-full hover:bg-(--color-baseline-10)"
                disabled={isExecuting}>
                <CloseIcon />
              </button>
            </div>

            {/* Content */}
            <div className="flex-1 overflow-auto p-4">
              <div className={`relative ${isExecuting ? "animate-pulse cursor-progress cursor-to-children" : ""}`}>
                <div
                  className={`absolute transition-opacity inset-0 flex items-center pointer-events-none justify-center bg-white ${
                    loading || initializationLoading ? "opacity-100" : "opacity-0"
                  }`}>
                  <Loading />
                </div>
                <div className={`transition-opacity ${loading || initializationLoading ? "opacity-0" : "opacity-100"}`}>
                  {renderResponse()}
                  {renderParameters()}
                </div>
              </div>
            </div>

            {/* Footer */}
            <div className="flex gap-4 justify-center mx-4 mb-4">
              <button
                type="button"
                onClick={handleClose}
                className="transition px-4 py-2 border border-(--color-baseline-60) text-(--color-baseline-90) rounded-full w-full
                font-medium focus:outline-none hover:bg-(--color-transparent-neutral-10)"
                disabled={isExecuting}>
                {t("common.close")}
              </button>
              <button
                type="button"
                onClick={handleExecute}
                className="transition px-4 py-2 text-white rounded-full w-full justify-center font-medium flex items-center gap-2 bg-(--color-baseline-100) hover:bg-(--color-etendo-main)"
                disabled={isActionButtonDisabled}>
                {renderActionButton()}
              </button>
            </div>
          </div>
        </div>
      </FormProvider>
    </Modal>
  );
}

export default function ProcessDefinitionModal({ button, onSuccess, ...props }: ProcessDefinitionModalProps) {
  if (!button) return null;

  return <ProcessDefinitionModalContent {...props} button={button} onSuccess={onSuccess} />;
}

```

## Archivo: `packages/MainUI/components/ProcessModal/WindowReferenceGrid.tsx`

```typescript
import { useTab } from "@/hooks/useTab";
import { useTranslation } from "@/hooks/useTranslation";
import { parseColumns } from "@/utils/tableColumns";
import type { EntityData, EntityValue } from "@workspaceui/api-client/src/api/types";
import {
  type MRT_ColumnFiltersState,
  type MRT_Row,
  type MRT_RowSelectionState,
  type MRT_TableOptions,
  type MRT_TopToolbarProps,
  MaterialReactTable,
  useMaterialReactTable,
} from "material-react-table";
import { useCallback, useEffect, useMemo, useRef, useState } from "react";
import { ErrorDisplay } from "../ErrorDisplay";
import EmptyState from "../Table/EmptyState";
import Loading from "../loading";
import { useDatasource } from "@/hooks/useDatasource";
import { tableStyles } from "./styles";
import type { WindowReferenceGridProps } from "./types";
import { PROCESS_DEFINITION_DATA, CREATE_LINES_FROM_ORDER_PROCESS_ID } from "@/utils/processes/definition/constants";

const MAX_WIDTH = 100;
const PAGE_SIZE = 100;

/**
 * WindowReferenceGrid Component
 * Displays a grid of referenced records that can be selected
 */
function WindowReferenceGrid({
  parameter,
  onSelectionChange,
  tabId,
  entityName,
  windowReferenceTab,
  processConfig,
  processConfigLoading,
  processConfigError,
  recordValues,
}: WindowReferenceGridProps) {
  const { t } = useTranslation();
  const contentRef = useRef<HTMLDivElement>(null);
  const { loading: tabLoading, error: tabError } = useTab(windowReferenceTab?.id);

  const [columnFilters, setColumnFilters] = useState<MRT_ColumnFiltersState>([]);
  const [rowSelection, setRowSelection] = useState<MRT_RowSelectionState>({});

  const datasourceOptions = useMemo(() => {
    const processId = processConfig?.processId;
    const currentOptionData = PROCESS_DEFINITION_DATA[processId as keyof typeof PROCESS_DEFINITION_DATA];
    const defaultKeys = currentOptionData?.defaultKeys;
    const dynamicKeys = currentOptionData?.dynamicKeys;
    const staticOptions = currentOptionData?.staticOptions;

    const options: Record<string, EntityValue> = {
      ...staticOptions,
      tabId: parameter.tab || tabId,
      pageSize: PAGE_SIZE,
    };

    if (processId === CREATE_LINES_FROM_ORDER_PROCESS_ID && dynamicKeys) {
      const { invoiceClient, invoiceBusinessPartner, invoicePriceList, invoiceCurrency } = dynamicKeys as Record<
        string,
        string
      >;
      options[invoiceClient] = recordValues?.inpadClientId || "";
      options[invoiceBusinessPartner] = recordValues?.inpcBpartnerId || "";
      options[invoicePriceList] = recordValues?.inpmPricelistId || "";
      options[invoiceCurrency] = recordValues?.inpcCurrencyId || "";
    }

    if (processConfig?.defaults) {
      for (const [key, value] of Object.entries(processConfig.defaults)) {
        options[key] = value.value;

        if (defaultKeys && key in defaultKeys) {
          const defaultKey = defaultKeys[key as keyof typeof defaultKeys];
          options[defaultKey] = value.value;
        }
      }
    }

    let criteria: Array<{ fieldName: string; operator: string; value: EntityValue }> = [];

    if (processConfig?.filterExpressions?.grid) {
      const filterCriteria = Object.entries(processConfig.filterExpressions.grid).map(([fieldName, value]) => ({
        fieldName,
        operator: "equals",
        value: value === "true" ? true : value === "false" ? false : value,
      }));

      criteria = [...criteria, ...filterCriteria];
    }

    if (criteria.length > 0) {
      options.orderBy = "documentNo desc";
    }

    return options;
  }, [tabId, parameter.tab, processConfig, recordValues]);

  const fields = useMemo(() => {
    if (windowReferenceTab?.fields) {
      return Object.values(windowReferenceTab.fields);
    }
    return [];
  }, [windowReferenceTab]);

  const columns = useMemo(() => {
    if (fields.length > 0) {
      return parseColumns(fields, t);
    }
    return [];
  }, [fields, t]);

  const {
    records,
    loading: datasourceLoading,
    error: datasourceError,
    updateColumnFilters,
    refetch,
    hasMoreRecords,
    fetchMore,
  } = useDatasource({
    entity: String(entityName),
    params: datasourceOptions,
  });

  useEffect(() => {
    setRowSelection({});
    onSelectionChange([]);
  }, [onSelectionChange]);

  const handleRowSelection = useCallback(
    (updaterOrValue: MRT_RowSelectionState | ((prev: MRT_RowSelectionState) => MRT_RowSelectionState)) => {
      const newSelection = typeof updaterOrValue === "function" ? updaterOrValue(rowSelection) : updaterOrValue;

      setRowSelection(newSelection);

      const selectedItems = records.filter((record) => {
        const recordId = String(record.id);
        return newSelection[recordId];
      });

      onSelectionChange(selectedItems);
    },
    [records, onSelectionChange, rowSelection]
  );

  const handleColumnFiltersChange = useCallback(
    (updaterOrValue: MRT_ColumnFiltersState | ((prev: MRT_ColumnFiltersState) => MRT_ColumnFiltersState)) => {
      const newColumnFilters = typeof updaterOrValue === "function" ? updaterOrValue(columnFilters) : updaterOrValue;

      const normalizedNew = newColumnFilters.map((f) => ({ id: f.id, value: f.value }));
      const normalizedCurrent = columnFilters.map((f) => ({ id: f.id, value: f.value }));

      const isRealFilterChange = JSON.stringify(normalizedNew) !== JSON.stringify(normalizedCurrent);

      setColumnFilters(newColumnFilters);

      if (isRealFilterChange && updateColumnFilters) {
        updateColumnFilters(newColumnFilters);
      }
    },
    [columnFilters, updateColumnFilters]
  );

  const handleClearSelections = useCallback(() => {
    setRowSelection({});
    onSelectionChange([]);
  }, [onSelectionChange]);

  const handleRowClick = useCallback(
    (row: MRT_Row<EntityData>) => {
      setRowSelection((prev) => {
        const newSelection = { ...prev };
        newSelection[row.id] = !newSelection[row.id];

        const selectedItems = records.filter((record) => {
          const recordId = String(record.id);
          return newSelection[recordId];
        });

        onSelectionChange(selectedItems);
        return newSelection;
      });
    },
    [records, onSelectionChange]
  );

  const renderTopToolbar = useCallback(
    (props: MRT_TopToolbarProps<EntityData>) => {
      const selectedCount = props.table.getSelectedRowModel().rows.length;
      return (
        <div className="flex justify-between items-center px-4 py-2 bg-gray-50 border-b max-h-[2.5rem]">
          <div className="text-base font-medium text-gray-800">{parameter.name}</div>
          {selectedCount > 0 && (
            <div className="flex items-center gap-2">
              <span className="text-sm text-gray-600">
                {selectedCount} {t("table.selection.multiple")}
              </span>
              <button
                type="button"
                onClick={handleClearSelections}
                className="px-3 py-1 text-sm cursor-pointer text-gray-700 border border-gray-300 rounded-full hover:bg-(--color-etendo-main) hover:text-(--color-baseline-0) transition-colors">
                {t("common.clear")}
              </button>
            </div>
          )}
        </div>
      );
    },
    [parameter.name, t, handleClearSelections]
  );

  const LoadMoreButton = ({ fetchMore }: { fetchMore: () => void }) => (
    <div className="flex justify-center p-2 border-t border-gray-200">
      <button
        type="button"
        onClick={fetchMore}
        className="px-4 py-2 text-sm border border-gray-300 rounded-full text-gray-700 hover:bg-gray-100 transition-colors">
        {t("common.loadMore")}
      </button>
    </div>
  );

  const tableOptions: MRT_TableOptions<EntityData> = {
    muiTablePaperProps: {
      className: tableStyles.paper,
      style: {
        borderRadius: "1rem",
        boxShadow: "none",
      },
    },
    muiTableHeadCellProps: {
      className: tableStyles.headCell,
    },
    muiTableBodyCellProps: {
      className: tableStyles.bodyCell,
    },
    muiTableBodyProps: {
      className: tableStyles.body,
    },
    muiTableBodyRowProps: ({ row }) => {
      return {
        onClick: () => handleRowClick(row),
        className: rowSelection[row.id]
          ? "bg-blue-50 hover:bg-blue-100 cursor-pointer"
          : "hover:bg-gray-50 cursor-pointer",
      };
    },
    muiTableContainerProps: {
      className: tableStyles.container,
    },
    layoutMode: "semantic",
    enableColumnResizing: true,
    enableGlobalFilter: false,
    enableRowSelection: true,
    enableMultiRowSelection: true,
    positionToolbarAlertBanner: "none",
    enablePagination: false,
    enableStickyHeader: true,
    enableStickyFooter: true,
    enableColumnFilters: true,
    enableSorting: true,
    enableColumnActions: true,
    manualFiltering: true,
    columns,
    data: records,
    getRowId: (row) => String(row.id),
    renderTopToolbar,
    renderBottomToolbar: hasMoreRecords ? () => <LoadMoreButton fetchMore={fetchMore} /> : undefined,
    renderEmptyRowsFallback: () => (
      <div className="flex justify-center items-center p-8 text-gray-500">
        <EmptyState maxWidth={MAX_WIDTH} />
      </div>
    ),
    initialState: {
      density: "compact",
    },
    state: {
      rowSelection,
      columnFilters,
      showColumnFilters: true,
    },
    onRowSelectionChange: handleRowSelection,
    onColumnFiltersChange: handleColumnFiltersChange,
  };
  const table = useMaterialReactTable(tableOptions);
  const isLoading = tabLoading || processConfigLoading || datasourceLoading;
  const error = tabError || processConfigError || datasourceError;

  if (isLoading) {
    return (
      <div className="p-4 flex justify-center">
        <Loading />
      </div>
    );
  }

  if (error) {
    return <ErrorDisplay title={t("errors.missingData")} description={error?.message} showRetry onRetry={refetch} />;
  }

  if ((fields.length === 0 && !tabLoading) || !records || records.length === 0) {
    return <EmptyState maxWidth={MAX_WIDTH} />;
  }

  return (
    <div
      className={`flex flex-col w-full overflow-hidden max-h-4xl h-full transition duration-100 ${
        datasourceLoading ? "opacity-40 cursor-wait cursor-to-children" : "opacity-100"
      }`}
      ref={contentRef}>
      <MaterialReactTable table={table} />
    </div>
  );
}

export default WindowReferenceGrid;

```

## Archivo: `packages/MainUI/components/ProcessModal/__tests__/ProcessParameterIntegration.test.tsx`

```typescript
/**
 * Integration test to verify the ProcessParameterSelector works with different field types
 * This test simulates the actual usage in ProcessDefinitionModal
 */
import { render, screen } from "@testing-library/react";
import { FormProvider, useForm } from "react-hook-form";
import { ProcessParameterSelector } from "../selectors/ProcessParameterSelector";

// Mock dependencies
jest.mock("@/hooks/useUserContext", () => ({
  useUserContext: () => ({ session: {} })
}));

jest.mock("@/components/Form/FormView/selectors/PasswordSelector", () => ({
  PasswordSelector: ({ field }: any) => <input data-testid="password-field" name={field.hqlName} type="password" />
}));

jest.mock("@/components/Form/FormView/selectors/BooleanSelector", () => ({
  BooleanSelector: ({ field }: any) => <input data-testid="boolean-field" name={field.hqlName} type="checkbox" />
}));

jest.mock("@/components/Form/FormView/selectors/NumericSelector", () => ({
  NumericSelector: ({ field }: any) => <input data-testid="numeric-field" name={field.hqlName} type="number" />
}));

jest.mock("@/components/Form/FormView/selectors/DateSelector", () => ({
  DateSelector: ({ field }: any) => <input data-testid="date-field" name={field.hqlName} type="date" />
}));

jest.mock("@/components/Form/FormView/selectors/DatetimeSelector", () => ({
  DatetimeSelector: ({ field }: any) => <input data-testid="datetime-field" name={field.hqlName} type="datetime-local" />
}));

jest.mock("@/components/Form/FormView/selectors/SelectSelector", () => ({
  SelectSelector: ({ field }: any) => <select data-testid="select-field" name={field.hqlName} />
}));

jest.mock("@/components/Form/FormView/selectors/TableDirSelector", () => ({
  TableDirSelector: ({ field }: any) => <select data-testid="tabledir-field" name={field.hqlName} />
}));

jest.mock("@/components/Form/FormView/selectors/QuantitySelector", () => {
  return function QuantitySelector({ field }: any) {
    return <input data-testid="quantity-field" name={field.hqlName} type="number" step="any" />;
  };
});

jest.mock("@/components/Form/FormView/selectors/ListSelector", () => ({
  ListSelector: ({ field }: any) => <select data-testid="list-field" name={field.hqlName} />
}));

jest.mock("../selectors/GenericSelector", () => {
  return function GenericSelector({ parameter }: any) {
    return <input data-testid="generic-field" name={parameter.name} />;
  };
});

jest.mock("@/components/Label", () => {
  return function Label({ name }: any) {
    return <label data-testid="field-label">{name}</label>;
  };
});

// Test wrapper
const TestWrapper = ({ children }: { children: React.ReactNode }) => {
  const form = useForm();
  return <FormProvider {...form}>{children}</FormProvider>;
};

describe("ProcessParameterSelector Integration", () => {
  describe("Phase 1 Field Types (Foundation)", () => {
    it("should render Password field correctly", () => {
      const passwordParameter = {
        id: "pwd-1",
        name: "User Password",
        dBColumnName: "user_password",
        reference: "Password",
        mandatory: true,
        defaultValue: "",
        refList: []
      };

      render(
        <TestWrapper>
          <ProcessParameterSelector parameter={passwordParameter} />
        </TestWrapper>
      );

      expect(screen.getByTestId("field-label")).toHaveTextContent("User Password");
      expect(screen.getByTestId("password-field")).toBeInTheDocument();
      expect(screen.getByTestId("password-field")).toHaveAttribute("type", "password");
      expect(screen.getByText("*")).toBeInTheDocument(); // Mandatory indicator
    });

    it("should render Boolean field correctly", () => {
      const booleanParameter = {
        id: "bool-1",
        name: "Is Active",
        dBColumnName: "is_active",
        reference: "Yes/No",
        mandatory: false,
        defaultValue: "N",
        refList: []
      };

      render(
        <TestWrapper>
          <ProcessParameterSelector parameter={booleanParameter} />
        </TestWrapper>
      );

      expect(screen.getByTestId("field-label")).toHaveTextContent("Is Active");
      expect(screen.getByTestId("boolean-field")).toBeInTheDocument();
      expect(screen.getByTestId("boolean-field")).toHaveAttribute("type", "checkbox");
      expect(screen.queryByText("*")).not.toBeInTheDocument(); // Not mandatory
    });

    it("should render Numeric field correctly", () => {
      const numericParameter = {
        id: "num-1",
        name: "Payment Amount",
        dBColumnName: "payment_amount",
        reference: "Amount",
        mandatory: true,
        defaultValue: "0.00",
        refList: []
      };

      render(
        <TestWrapper>
          <ProcessParameterSelector parameter={numericParameter} />
        </TestWrapper>
      );

      expect(screen.getByTestId("field-label")).toHaveTextContent("Payment Amount");
      expect(screen.getByTestId("numeric-field")).toBeInTheDocument();
      expect(screen.getByTestId("numeric-field")).toHaveAttribute("type", "number");
      expect(screen.getByText("*")).toBeInTheDocument(); // Mandatory indicator
    });

    it("should handle Integer reference as numeric", () => {
      const integerParameter = {
        id: "int-1",
        name: "Quantity",
        dBColumnName: "quantity",
        reference: "Integer",
        mandatory: false,
        defaultValue: "1",
        refList: []
      };

      render(
        <TestWrapper>
          <ProcessParameterSelector parameter={integerParameter} />
        </TestWrapper>
      );

      expect(screen.getByTestId("numeric-field")).toBeInTheDocument();
    });
  });

  describe("Fallback Behavior", () => {
    it("should use GenericSelector for unsupported field types", () => {
      const unsupportedParameter = {
        id: "unsup-1",
        name: "Complex Field",
        dBColumnName: "complex_field",
        reference: "ComplexType",
        mandatory: false,
        defaultValue: "",
        refList: []
      };

      render(
        <TestWrapper>
          <ProcessParameterSelector parameter={unsupportedParameter} />
        </TestWrapper>
      );

      expect(screen.getByTestId("field-label")).toHaveTextContent("Complex Field");
      expect(screen.getByTestId("generic-field")).toBeInTheDocument();
    });

    it("should use GenericSelector for String/Text types (current behavior)", () => {
      const textParameter = {
        id: "text-1",
        name: "Description",
        dBColumnName: "description",
        reference: "String",
        mandatory: false,
        defaultValue: "",
        refList: []
      };

      render(
        <TestWrapper>
          <ProcessParameterSelector parameter={textParameter} />
        </TestWrapper>
      );

      expect(screen.getByTestId("field-label")).toHaveTextContent("Description");
      expect(screen.getByTestId("generic-field")).toBeInTheDocument();
    });
  });

  describe("Field Mapping Quality", () => {
    it("should handle parameters without dBColumnName", () => {
      const parameterWithoutDbColumn = {
        id: "no-db-col",
        name: "Display Name",
        reference: "Boolean",
        mandatory: false,
        defaultValue: "N",
        refList: []
      };

      render(
        <TestWrapper>
          <ProcessParameterSelector parameter={parameterWithoutDbColumn} />
        </TestWrapper>
      );

      expect(screen.getByTestId("boolean-field")).toBeInTheDocument();
      expect(screen.getByTestId("boolean-field")).toHaveAttribute("name", "Display Name");
    });

    it("should handle different boolean reference formats", () => {
      const booleanFormats = ["Yes/No", "YesNo", "Boolean"];
      
      booleanFormats.forEach((format, index) => {
        const { unmount } = render(
          <TestWrapper>
            <ProcessParameterSelector 
              parameter={{
                id: `bool-${index}`,
                name: `Boolean Field ${index}`,
                dBColumnName: `bool_field_${index}`,
                reference: format,
                mandatory: false,
                defaultValue: "N",
                refList: []
              }} 
            />
          </TestWrapper>
        );
        
        expect(screen.getByTestId("boolean-field")).toBeInTheDocument();
        unmount();
      });
    });
  });

  describe("Progress Tracking", () => {
    it("should support 11 out of 11 field reference types (100% Phase 3 target)", () => {
      // Phase 1 + Phase 2 + Phase 3 supported types: All field types now supported
      const supportedTypes = [
        "Password", "Yes/No", "Boolean", "Amount", "Integer", "Decimal", "Quantity",
        "Date", "DateTime", "Select", "Product", "TableDir", "Table Directory", "List", "Window"
      ];
      
      // Only fallback types remain: String, Text, etc.
      const fallbackTypes = ["String", "Text"];
      
      // Test that all supported types work correctly
      supportedTypes.forEach((type, index) => {
        const { unmount } = render(
          <TestWrapper>
            <ProcessParameterSelector 
              parameter={{
                id: `supported-${index}`,
                name: `Supported Field ${index}`,
                dBColumnName: `supported_field_${index}`,
                reference: type,
                mandatory: false,
                defaultValue: "",
                refList: []
              }} 
            />
          </TestWrapper>
        );
        
        // Should render specialized selector (not generic)
        const hasSpecializedSelector = 
          screen.queryByTestId("password-field") ||
          screen.queryByTestId("boolean-field") ||
          screen.queryByTestId("numeric-field") ||
          screen.queryByTestId("date-field") ||
          screen.queryByTestId("datetime-field") ||
          screen.queryByTestId("select-field") ||
          screen.queryByTestId("tabledir-field") ||
          screen.queryByTestId("quantity-field") ||
          screen.queryByTestId("list-field") ||
          screen.queryByTestId("generic-field"); // Window uses GenericSelector with WindowReferenceGrid
          
        expect(hasSpecializedSelector).toBeInTheDocument();
        unmount();
      });
      
      // Verify fallback types use GenericSelector
      fallbackTypes.forEach((type, index) => {
        const { unmount } = render(
          <TestWrapper>
            <ProcessParameterSelector 
              parameter={{
                id: `future-${index}`,
                name: `Future Field ${index}`,
                dBColumnName: `future_field_${index}`,
                reference: type,
                mandatory: false,
                defaultValue: "",
                refList: []
              }} 
            />
          </TestWrapper>
        );
        
        expect(screen.getByTestId("generic-field")).toBeInTheDocument();
        unmount();
      });
    });
  });
});
```

## Archivo: `packages/MainUI/components/ProcessModal/mappers/ProcessParameterMapper.ts`

```typescript
import type { Field, ProcessParameter } from "@workspaceui/api-client/src/api/types";
import { FIELD_REFERENCE_CODES } from "@/utils/form/constants";
import type { 
  ExtendedProcessParameter,
  ProcessDefaultsResponse,
  ProcessDefaultValue
} from "../types/ProcessParameterExtensions";
import { 
  isReferenceValue,
  isSimpleValue
} from "../types/ProcessParameterExtensions";
import { logger } from "@/utils/logger";

/**
 * Maps ProcessParameter to FormView Field interface
 * This allows reuse of existing FormView selectors in ProcessModal
 */
export class ProcessParameterMapper {
  /**
   * Maps a ProcessParameter to a FormView Field interface
   * @param parameter - The ProcessParameter from the process definition
   * @returns Field interface compatible with FormView selectors
   */
  static mapToField(parameter: ProcessParameter | ExtendedProcessParameter): Field {
    const mappedReference = this.mapReferenceType(parameter.reference);
    
    return {
      // Core identification properties
      hqlName: parameter.dBColumnName || parameter.name,
      inputName: parameter.dBColumnName || parameter.name,
      columnName: parameter.dBColumnName || parameter.name,
      id: parameter.id,
      name: parameter.name,
      
      // Form behavior properties
      isMandatory: parameter.mandatory || false,
      displayed: true,
      startnewline: false,
      showInGridView: false,
      isDisplayed: true,
      isUpdatable: true,
      sequenceNumber: 0,
      
      // Reference and type information
      column: {
        length: "255", // Default length, can be overridden
        ...parameter.column,
        reference: mappedReference
      },
      
      // Selector configuration for datasource fields
      selector: this.mapSelectorInfo(mappedReference, parameter),
      
      // List data for select/list fields
      refList: parameter.refList || [],
      
      // Logic expressions for dynamic behavior
      displayLogicExpression: parameter.displayLogic,
      readOnlyLogicExpression: parameter.readOnlyLogicExpression,
      isReadOnly: false, // Will be evaluated dynamically
      
      // Description and help
      description: parameter.description || "",
      helpComment: parameter.help || "",
      
      // Default values
      hasDefaultValue: !!parameter.defaultValue,
      
      // Placeholder properties for Field interface compatibility
      process: "",
      shownInStatusBar: false,
      tab: "",
      fieldGroup$_identifier: "",
      fieldGroup: "",
      module: "",
      refColumnName: "",
      targetEntity: "",
      gridProps: {
        sort: 0,
        autoExpand: false,
        editorProps: {
          displayField: "_identifier",
          valueField: "id"
        },
        displaylength: 0,
        fkField: false,
        selectOnClick: false,
        canSort: false,
        canFilter: false,
        showHover: false,
        filterEditorProperties: {
          keyProperty: "id"
        },
        showIf: ""
      },
      type: parameter.reference || "String",
      field: [],
      referencedEntity: "",
      referencedWindowId: "",
      referencedTabId: ""
    };
  }

  /**
   * Maps selector information for datasource-dependent field types
   * @param reference - The mapped reference code
   * @param parameter - The original ProcessParameter
   * @returns Selector configuration object
   */
  static mapSelectorInfo(reference: string, parameter: ProcessParameter | ExtendedProcessParameter): any {
    // If parameter already has selector info, use it
    if (parameter.selector) {
      return parameter.selector;
    }

    // Map reference types to appropriate datasource names
    const datasourceMap: Record<string, string> = {
      [FIELD_REFERENCE_CODES.PRODUCT]: "ProductByPriceAndWarehouse",
      [FIELD_REFERENCE_CODES.TABLE_DIR_19]: "ComboTableDatasourceService",
      [FIELD_REFERENCE_CODES.TABLE_DIR_18]: "ComboTableDatasourceService",
      [FIELD_REFERENCE_CODES.SELECT_30]: "ComboTableDatasourceService",
    };

    const datasourceName = datasourceMap[reference];
    
    if (datasourceName) {
      return {
        datasourceName,
        _textMatchStyle: "startsWith",
        _noCount: true,
        _selectedProperties: "id",
        _extraProperties: "_identifier,",
        extraSearchFields: "",
      };
    }

    // Return undefined for field types that don't need datasource
    return undefined;
  }

  /**
   * Maps process parameter reference types to FormView field reference codes
   * @param reference - The reference type from ProcessParameter
   * @returns Mapped reference code for FormView compatibility
   */
  private static mapReferenceType(reference: string): string {
    // Map textual references from process definition to reference codes
    const referenceMap: Record<string, string> = {
      // Boolean types
      "Yes/No": FIELD_REFERENCE_CODES.BOOLEAN,
      "YesNo": FIELD_REFERENCE_CODES.BOOLEAN,
      "Boolean": FIELD_REFERENCE_CODES.BOOLEAN,
      
      // Numeric types
      "Amount": FIELD_REFERENCE_CODES.DECIMAL,
      "Number": FIELD_REFERENCE_CODES.DECIMAL,
      "Decimal": FIELD_REFERENCE_CODES.DECIMAL,
      "Integer": FIELD_REFERENCE_CODES.INTEGER,
      "Quantity": FIELD_REFERENCE_CODES.QUANTITY_29,
      
      // Date types
      "Date": FIELD_REFERENCE_CODES.DATE,
      "DateTime": FIELD_REFERENCE_CODES.DATETIME,
      
      // List types
      "List": FIELD_REFERENCE_CODES.LIST_17,
      
      // Select types
      "Select": FIELD_REFERENCE_CODES.SELECT_30,
      
      // Product types
      "Product": FIELD_REFERENCE_CODES.PRODUCT,
      
      // Table Directory types
      "TableDir": FIELD_REFERENCE_CODES.TABLE_DIR_19,
      "Table Directory": FIELD_REFERENCE_CODES.TABLE_DIR_19,
      
      // Password
      "Password": FIELD_REFERENCE_CODES.PASSWORD,
      
      // Window reference
      "Window": FIELD_REFERENCE_CODES.WINDOW,
      
      // String/Text (default)
      "String": "10", // Text reference
      "Text": "10"
    };

    // Return mapped reference or the original reference if already a code
    return referenceMap[reference] || reference || "10";
  }

  /**
   * Validates if a ProcessParameter can be mapped to a Field
   * @param parameter - The ProcessParameter to validate
   * @returns true if mappable, false otherwise
   */
  static canMapParameter(parameter: ProcessParameter | ExtendedProcessParameter): boolean {
    // Check if required properties exist
    if (!parameter || !parameter.name) {
      return false;
    }

    // Check if reference type is supported
    const supportedReferences = [
      "String", "Text", "Password", "Yes/No", "YesNo", "Boolean",
      "Amount", "Number", "Decimal", "Integer", "Quantity",
      "Date", "DateTime", "List", "Select", "Product", "TableDir", "Table Directory", "Window"
    ];

    return !parameter.reference || 
           supportedReferences.includes(parameter.reference) ||
           Object.values(FIELD_REFERENCE_CODES).includes(parameter.reference as any);
  }

  /**
   * Gets the expected field type for UI rendering
   * @param parameter - The ProcessParameter
   * @returns Field type identifier for selector routing
   */
  static getFieldType(parameter: ProcessParameter | ExtendedProcessParameter): string {
    const reference = this.mapReferenceType(parameter.reference);
    
    if (reference === FIELD_REFERENCE_CODES.PASSWORD) return "password";
    if (reference === FIELD_REFERENCE_CODES.BOOLEAN) return "boolean";
    if ([FIELD_REFERENCE_CODES.DECIMAL, FIELD_REFERENCE_CODES.INTEGER].includes(reference as any)) {
      return "numeric";
    }
    if ([FIELD_REFERENCE_CODES.QUANTITY_29, FIELD_REFERENCE_CODES.QUANTITY_22].includes(reference as any)) {
      return "quantity";
    }
    if (reference === FIELD_REFERENCE_CODES.DATE) return "date";
    if (reference === FIELD_REFERENCE_CODES.DATETIME) return "datetime";
    if (reference === FIELD_REFERENCE_CODES.SELECT_30) return "select";
    if (reference === FIELD_REFERENCE_CODES.PRODUCT) return "product";
    if ([FIELD_REFERENCE_CODES.TABLE_DIR_19, FIELD_REFERENCE_CODES.TABLE_DIR_18].includes(reference as any)) return "tabledir";
    if ([FIELD_REFERENCE_CODES.LIST_17, FIELD_REFERENCE_CODES.LIST_13].includes(reference as any)) return "list";
    if (reference === FIELD_REFERENCE_CODES.WINDOW) return "window";
    
    return "text"; // Default fallback
  }

  /**
   * Maps DefaultsProcessActionHandler response to parameter-based field names
   * This handles the complex response structure with mixed value types
   * @param response - Raw response from DefaultsProcessActionHandler
   * @param parameters - Array of ProcessParameters for field name mapping
   * @returns Processed response with mapped field names
   */
  static mapInitializationResponse(
    response: Record<string, any>,
    parameters: ProcessParameter[]
  ): ProcessDefaultsResponse {
    try {
      // Create parameter lookup maps for efficient mapping
      const parameterByName = new Map<string, ProcessParameter>();
      const parameterByColumn = new Map<string, ProcessParameter>();
      
      parameters.forEach(param => {
        parameterByName.set(param.name, param);
        if (param.dBColumnName) {
          parameterByColumn.set(param.dBColumnName, param);
        }
      });

      const defaults: Record<string, ProcessDefaultValue> = {};
      const filterExpressions: Record<string, Record<string, any>> = {};

      // Process the raw response
      for (const [key, value] of Object.entries(response)) {
        if (key === 'filterExpressions') {
          // Handle filter expressions directly
          Object.assign(filterExpressions, value || {});
          continue;
        }

        if (key === 'refreshParent') {
          // Skip - handled separately
          continue;
        }

        // Try to map field names from response keys
        let mappedFieldName = key;
        
        // Handle 'inp' prefixed fields (common in Openbravo responses)
        if (key.startsWith('inp')) {
          const fieldName = key.substring(3); // Remove 'inp' prefix
          
          // Try to find parameter by various naming patterns
          const parameter = parameterByName.get(fieldName) || 
                           parameterByColumn.get(fieldName) ||
                           parameterByName.get(fieldName.toLowerCase()) ||
                           parameterByColumn.get(fieldName.toLowerCase());
          
          if (parameter) {
            mappedFieldName = parameter.name;
          } else {
            mappedFieldName = fieldName;
          }
        }

        // Store the mapped value
        defaults[mappedFieldName] = value;
      }

      const processedResponse: ProcessDefaultsResponse = {
        defaults,
        filterExpressions,
        refreshParent: !!response.refreshParent
      };

      logger.debug("Mapped initialization response:", {
        originalKeys: Object.keys(response).length,
        mappedDefaults: Object.keys(defaults).length,
        filterExpressions: Object.keys(filterExpressions).length,
        refreshParent: processedResponse.refreshParent
      });

      return processedResponse;
    } catch (error) {
      logger.error("Error mapping initialization response:", error);
      
      // Return safe fallback
      return {
        defaults: {},
        filterExpressions: {},
        refreshParent: false
      };
    }
  }

  /**
   * Processes process defaults for React Hook Form compatibility
   * @param processDefaults - ProcessDefaultsResponse from backend
   * @param parameters - Array of ProcessParameters for type information
   * @returns Object ready for form initialization
   */
  static processDefaultsForForm(
    processDefaults: ProcessDefaultsResponse,
    parameters: ProcessParameter[]
  ): Record<string, any> {
    const formData: Record<string, any> = {};
    
    try {
      // Create parameter lookup for type information
      const parameterMap = new Map<string, ProcessParameter>();
      parameters.forEach(param => {
        parameterMap.set(param.name, param);
      });

      for (const [fieldName, value] of Object.entries(processDefaults.defaults)) {
        try {
          // Skip logic fields (processed separately)
          if (fieldName.endsWith('_display_logic') || fieldName.endsWith('_readonly_logic')) {
            continue;
          }

          const parameter = parameterMap.get(fieldName);
          
          if (isReferenceValue(value)) {
            // Handle reference objects with value/identifier
            formData[fieldName] = value.value;
            if (value.identifier) {
              formData[`${fieldName}$_identifier`] = value.identifier;
            }
            
            logger.debug(`Processed reference field ${fieldName}:`, {
              value: value.value,
              identifier: value.identifier,
              parameterType: parameter?.reference
            });
          } else if (isSimpleValue(value)) {
            // Handle simple values with type conversion
            if (parameter?.reference === FIELD_REFERENCE_CODES.BOOLEAN || 
                parameter?.reference === "Yes/No" || 
                parameter?.reference === "Boolean") {
              // Convert string "Y"/"N" to boolean
              formData[fieldName] = value === "Y" || value === true;
            } else {
              formData[fieldName] = value;
            }
            
            logger.debug(`Processed simple field ${fieldName}:`, {
              value: value,
              type: typeof value,
              parameterType: parameter?.reference
            });
          } else {
            // Fallback for unexpected types
            logger.warn(`Unexpected value type for field ${fieldName}:`, value);
            formData[fieldName] = String(value || "");
          }
        } catch (fieldError) {
          logger.error(`Error processing field ${fieldName}:`, fieldError);
          formData[fieldName] = ""; // Safe fallback
        }
      }

      logger.debug("Processed form data:", {
        totalFields: Object.keys(formData).length,
        fieldNames: Object.keys(formData)
      });

      return formData;
    } catch (error) {
      logger.error("Error processing defaults for form:", error);
      return {}; // Safe fallback
    }
  }

  /**
   * Extracts logic fields from process defaults
   * @param processDefaults - ProcessDefaultsResponse from backend
   * @returns Object with display and readonly logic flags
   */
  static extractLogicFields(processDefaults: ProcessDefaultsResponse): Record<string, boolean> {
    const logicFields: Record<string, boolean> = {};
    
    try {
      for (const [fieldName, value] of Object.entries(processDefaults.defaults)) {
        if (fieldName.endsWith('_display_logic')) {
          const baseField = fieldName.replace('_display_logic', '');
          logicFields[`${baseField}.display`] = value === "Y";
        } else if (fieldName.endsWith('_readonly_logic')) {
          const baseField = fieldName.replace('_readonly_logic', '');
          logicFields[`${baseField}.readonly`] = value === "Y";
        }
      }

      logger.debug("Extracted logic fields:", logicFields);
      return logicFields;
    } catch (error) {
      logger.error("Error extracting logic fields:", error);
      return {};
    }
  }
}
```

## Archivo: `packages/MainUI/components/ProcessModal/mappers/__tests__/ProcessParameterMapper.test.ts`

```typescript
import { ProcessParameterMapper } from "../ProcessParameterMapper";
import { FIELD_REFERENCE_CODES } from "@/utils/form/constants";
import type { ProcessDefaultsResponse } from "../../types/ProcessParameterExtensions";

// Mock logger
jest.mock('@/utils/logger', () => ({
  logger: {
    debug: jest.fn(),
    warn: jest.fn(),
    error: jest.fn(),
    info: jest.fn(),
  },
}));

describe("ProcessParameterMapper", () => {
  const mockParameter = {
    id: "test-id",
    name: "Test Parameter",
    dBColumnName: "test_column",
    reference: "String",
    mandatory: true,
    defaultValue: "",
    refList: []
  } as any;

  describe("mapToField", () => {
    it("should map basic ProcessParameter to Field interface", () => {
      const field = ProcessParameterMapper.mapToField(mockParameter);

      expect(field.hqlName).toBe("test_column");
      expect(field.inputName).toBe("test_column");
      expect(field.columnName).toBe("test_column");
      expect(field.id).toBe("test-id");
      expect(field.name).toBe("Test Parameter");
      expect(field.isMandatory).toBe(true);
      expect(field.displayed).toBe(true);
      expect(field.isDisplayed).toBe(true);
    });

    it("should handle missing dBColumnName by using name", () => {
      const parameterWithoutDbColumn = { ...mockParameter };
      delete parameterWithoutDbColumn.dBColumnName;

      const field = ProcessParameterMapper.mapToField(parameterWithoutDbColumn);

      expect(field.hqlName).toBe("Test Parameter");
      expect(field.inputName).toBe("Test Parameter");
      expect(field.columnName).toBe("Test Parameter");
    });

    it("should map reference types correctly", () => {
      const passwordParam = { ...mockParameter, reference: "Password" };
      const passwordField = ProcessParameterMapper.mapToField(passwordParam);
      expect(passwordField.column.reference).toBe(FIELD_REFERENCE_CODES.PASSWORD);

      const booleanParam = { ...mockParameter, reference: "Yes/No" };
      const booleanField = ProcessParameterMapper.mapToField(booleanParam);
      expect(booleanField.column.reference).toBe(FIELD_REFERENCE_CODES.BOOLEAN);

      const numericParam = { ...mockParameter, reference: "Amount" };
      const numericField = ProcessParameterMapper.mapToField(numericParam);
      expect(numericField.column.reference).toBe(FIELD_REFERENCE_CODES.DECIMAL);
    });

    it("should preserve refList for list fields", () => {
      const listParam = {
        ...mockParameter,
        reference: "List",
        refList: [
          { id: "1", label: "Option 1", value: "opt1" },
          { id: "2", label: "Option 2", value: "opt2" }
        ]
      };

      const field = ProcessParameterMapper.mapToField(listParam);
      expect(field.refList).toHaveLength(2);
      expect(field.refList[0]).toEqual({ id: "1", label: "Option 1", value: "opt1" });
    });

    it("should handle display and readonly logic", () => {
      const paramWithLogic = {
        ...mockParameter,
        displayLogic: "@someField@='Y'",
        readOnlyLogicExpression: "@anotherField@='N'"
      };

      const field = ProcessParameterMapper.mapToField(paramWithLogic);
      expect(field.displayLogicExpression).toBe("@someField@='Y'");
      expect(field.readOnlyLogicExpression).toBe("@anotherField@='N'");
    });
  });

  describe("canMapParameter", () => {
    it("should return true for valid parameters", () => {
      expect(ProcessParameterMapper.canMapParameter(mockParameter)).toBe(true);
    });

    it("should return false for null/undefined parameters", () => {
      expect(ProcessParameterMapper.canMapParameter(null as any)).toBe(false);
      expect(ProcessParameterMapper.canMapParameter(undefined as any)).toBe(false);
    });

    it("should return false for parameters without name", () => {
      const paramWithoutName = { ...mockParameter };
      delete paramWithoutName.name;
      expect(ProcessParameterMapper.canMapParameter(paramWithoutName)).toBe(false);
    });

    it("should return true for supported reference types", () => {
      const supportedTypes = [
        "String", "Password", "Yes/No", "Boolean", "Amount", "Integer", "Decimal", 
        "Quantity", "Date", "DateTime", "List", "Select", "Product", "TableDir", 
        "Table Directory", "Window"
      ];
      
      supportedTypes.forEach(referenceType => {
        const param = { ...mockParameter, reference: referenceType };
        expect(ProcessParameterMapper.canMapParameter(param)).toBe(true);
      });
    });

    it("should return true for parameters without reference (defaults to String)", () => {
      const paramWithoutReference = { ...mockParameter };
      delete paramWithoutReference.reference;
      expect(ProcessParameterMapper.canMapParameter(paramWithoutReference)).toBe(true);
    });
  });

  describe("getFieldType", () => {
    it("should return correct field types for mapping", () => {
      expect(ProcessParameterMapper.getFieldType({ ...mockParameter, reference: "Password" })).toBe("password");
      expect(ProcessParameterMapper.getFieldType({ ...mockParameter, reference: "Yes/No" })).toBe("boolean");
      expect(ProcessParameterMapper.getFieldType({ ...mockParameter, reference: "Boolean" })).toBe("boolean");
      expect(ProcessParameterMapper.getFieldType({ ...mockParameter, reference: "Amount" })).toBe("numeric");
      expect(ProcessParameterMapper.getFieldType({ ...mockParameter, reference: "Integer" })).toBe("numeric");
      expect(ProcessParameterMapper.getFieldType({ ...mockParameter, reference: "Decimal" })).toBe("numeric");
      expect(ProcessParameterMapper.getFieldType({ ...mockParameter, reference: "Quantity" })).toBe("quantity");
      expect(ProcessParameterMapper.getFieldType({ ...mockParameter, reference: "Date" })).toBe("date");
      expect(ProcessParameterMapper.getFieldType({ ...mockParameter, reference: "DateTime" })).toBe("datetime");
      expect(ProcessParameterMapper.getFieldType({ ...mockParameter, reference: "Select" })).toBe("select");
      expect(ProcessParameterMapper.getFieldType({ ...mockParameter, reference: "Product" })).toBe("product");
      expect(ProcessParameterMapper.getFieldType({ ...mockParameter, reference: "TableDir" })).toBe("tabledir");
      expect(ProcessParameterMapper.getFieldType({ ...mockParameter, reference: "Table Directory" })).toBe("tabledir");
      expect(ProcessParameterMapper.getFieldType({ ...mockParameter, reference: "List" })).toBe("list");
      expect(ProcessParameterMapper.getFieldType({ ...mockParameter, reference: "Window" })).toBe("window");
      expect(ProcessParameterMapper.getFieldType({ ...mockParameter, reference: "String" })).toBe("text");
      expect(ProcessParameterMapper.getFieldType({ ...mockParameter, reference: "Unknown" })).toBe("text");
    });

    it("should default to text for undefined reference", () => {
      const paramWithoutReference = { ...mockParameter };
      delete paramWithoutReference.reference;
      expect(ProcessParameterMapper.getFieldType(paramWithoutReference)).toBe("text");
    });
  });

  describe("mapSelectorInfo", () => {
    it("should map Product reference to ProductByPriceAndWarehouse datasource", () => {
      const productParam = { ...mockParameter, reference: "Product" };
      const field = ProcessParameterMapper.mapToField(productParam);
      
      expect(field.selector).toBeDefined();
      expect(field.selector.datasourceName).toBe("ProductByPriceAndWarehouse");
    });

    it("should map TableDir reference to ComboTableDatasourceService", () => {
      const tableDirParam = { ...mockParameter, reference: "TableDir" };
      const field = ProcessParameterMapper.mapToField(tableDirParam);
      
      expect(field.selector).toBeDefined();
      expect(field.selector.datasourceName).toBe("ComboTableDatasourceService");
    });

    it("should map Select reference to ComboTableDatasourceService", () => {
      const selectParam = { ...mockParameter, reference: "Select" };
      const field = ProcessParameterMapper.mapToField(selectParam);
      
      expect(field.selector).toBeDefined();
      expect(field.selector.datasourceName).toBe("ComboTableDatasourceService");
    });

    it("should not map selector for non-datasource field types", () => {
      const textParam = { ...mockParameter, reference: "String" };
      const field = ProcessParameterMapper.mapToField(textParam);
      
      expect(field.selector).toBeUndefined();
    });

    it("should preserve existing selector info if provided", () => {
      const paramWithSelector = { 
        ...mockParameter, 
        reference: "Product",
        selector: {
          datasourceName: "CustomDatasource",
          customProperty: "test"
        }
      };
      const field = ProcessParameterMapper.mapToField(paramWithSelector);
      
      expect(field.selector.datasourceName).toBe("CustomDatasource");
      expect(field.selector.customProperty).toBe("test");
    });
  });

  describe('processDefaultsForForm', () => {
    const mockProcessDefaults: ProcessDefaultsResponse = {
      defaults: {
        "trxtype": "",
        "ad_org_id": {
          "value": "E443A31992CB4635AFCAEABE7183CE85",
          "identifier": "F&B España - Región Norte"
        },
        "actual_payment": "1.85",
        "issotrx": true,
        "trxtype_display_logic": "N",
        "actual_payment_readonly_logic": "N"
      },
      filterExpressions: {},
      refreshParent: false
    };

    const mockParameters = [
      {
        id: '1',
        name: 'trxtype',
        reference: 'String',
        mandatory: false,
        defaultValue: '',
        refList: []
      },
      {
        id: '2',
        name: 'ad_org_id',
        reference: 'Search',
        mandatory: true,
        defaultValue: '',
        refList: []
      },
      {
        id: '3',
        name: 'actual_payment',
        reference: 'Amount',
        mandatory: false,
        defaultValue: '',
        refList: []
      },
      {
        id: '4',
        name: 'issotrx',
        reference: 'Boolean',
        mandatory: false,
        defaultValue: '',
        refList: []
      }
    ] as any[];

    it('should process defaults for React Hook Form correctly', () => {
      const result = ProcessParameterMapper.processDefaultsForForm(mockProcessDefaults, mockParameters);

      expect(result).toEqual({
        "trxtype": "",
        "ad_org_id": "E443A31992CB4635AFCAEABE7183CE85",
        "ad_org_id$_identifier": "F&B España - Región Norte",
        "actual_payment": "1.85",
        "issotrx": true
      });
    });

    it('should handle boolean conversion for Yes/No fields', () => {
      const booleanParameter = {
        id: '5',
        name: 'test_boolean',
        reference: 'Yes/No',
        mandatory: false,
        defaultValue: '',
        refList: []
      } as any;

      const booleanDefaults: ProcessDefaultsResponse = {
        defaults: {
          "test_boolean": "Y"
        },
        filterExpressions: {},
        refreshParent: false
      };

      const result = ProcessParameterMapper.processDefaultsForForm(
        booleanDefaults, 
        [booleanParameter]
      );

      expect(result["test_boolean"]).toBe(true);
    });

    it('should skip logic fields', () => {
      const result = ProcessParameterMapper.processDefaultsForForm(mockProcessDefaults, mockParameters);

      expect(result["trxtype_display_logic"]).toBeUndefined();
      expect(result["actual_payment_readonly_logic"]).toBeUndefined();
    });
  });

  describe('extractLogicFields', () => {
    const mockProcessDefaults: ProcessDefaultsResponse = {
      defaults: {
        "trxtype": "",
        "trxtype_display_logic": "N",
        "ad_org_id_display_logic": "Y",
        "actual_payment_readonly_logic": "N",
        "received_from_readonly_logic": "Y"
      },
      filterExpressions: {},
      refreshParent: false
    };

    it('should extract logic fields correctly', () => {
      const result = ProcessParameterMapper.extractLogicFields(mockProcessDefaults);

      expect(result).toEqual({
        "trxtype.display": false,
        "ad_org_id.display": true,
        "actual_payment.readonly": false,
        "received_from.readonly": true
      });
    });

    it('should handle empty logic fields', () => {
      const emptyDefaults: ProcessDefaultsResponse = {
        defaults: {
          "trxtype": "test"
        },
        filterExpressions: {},
        refreshParent: false
      };

      const result = ProcessParameterMapper.extractLogicFields(emptyDefaults);
      expect(result).toEqual({});
    });
  });

  describe('Integration with real response structure', () => {
    it('should handle complete real world response', () => {
      const realResponse: ProcessDefaultsResponse = {
        "defaults": {
          "trxtype": "",
          "ad_org_id": {
            "value": "E443A31992CB4635AFCAEABE7183CE85",
            "identifier": "F&B España - Región Norte"
          },
          "bslamount": "",
          "payment_documentno": "<1000373>",
          "c_currency_id": {
            "value": "102",
            "identifier": "EUR"
          },
          "actual_payment": "1.85",
          "payment_date": "05-08-2025",
          "transaction_type": "I",
          "customer_credit": "0",
          "issotrx": true,
          "StdPrecision": "2",
          "generateCredit": "0",
          "DOCBASETYPE": "ARR",
          "overpayment_action_display_logic": "N",
          "trxtype_display_logic": "N",
          "actual_payment_readonly_logic": "N",
          "received_from_readonly_logic": "Y"
        },
        "filterExpressions": {
          "order_invoice": {
            "paymentMethodName": "Transferencia"
          },
          "glitem": {},
          "credit_to_use": {}
        },
        "refreshParent": true
      };

      const mockParams = [
        { id: '1', name: 'trxtype', reference: 'String', mandatory: false, defaultValue: '', refList: [] },
        { id: '2', name: 'ad_org_id', reference: 'Search', mandatory: true, defaultValue: '', refList: [] },
        { id: '3', name: 'actual_payment', reference: 'Amount', mandatory: false, defaultValue: '', refList: [] },
        { id: '4', name: 'issotrx', reference: 'Boolean', mandatory: false, defaultValue: '', refList: [] }
      ] as any[];
      
      // Extract form data
      const formData = ProcessParameterMapper.processDefaultsForForm(realResponse, mockParams);
      
      // Extract logic fields
      const logicFields = ProcessParameterMapper.extractLogicFields(realResponse);

      // Verify form data
      expect(formData["ad_org_id"]).toBe("E443A31992CB4635AFCAEABE7183CE85");
      expect(formData["ad_org_id$_identifier"]).toBe("F&B España - Región Norte");
      expect(formData["actual_payment"]).toBe("1.85");
      expect(formData["issotrx"]).toBe(true);

      // Verify logic fields
      expect(logicFields["trxtype.display"]).toBe(false);
      expect(logicFields["received_from.readonly"]).toBe(true);

      // Verify filter expressions
      expect(realResponse.filterExpressions["order_invoice"]["paymentMethodName"]).toBe("Transferencia");
      expect(realResponse.refreshParent).toBe(true);
    });
  });
});
```

## Archivo: `packages/MainUI/components/ProcessModal/selectors/BaseSelector.tsx`

```typescript
import Label from "@/components/Label";
import GenericSelector from "./GenericSelector";
import type { ProcessParameter } from "@workspaceui/api-client/src/api/types";
import { useMemo } from "react";
import { useUserContext } from "@/hooks/useUserContext";
import { compileExpression } from "@/components/Form/FormView/selectors/BaseSelector";
import { useForm } from "react-hook-form";
import { logger } from "@/utils/logger";

const BaseSelector = ({ parameter }: { parameter: ProcessParameter }) => {
  const { session } = useUserContext();
  const { getValues } = useForm();

  const isReadOnly = useMemo(() => {
    if (!parameter.readOnlyLogicExpression) return false;
    const compiledExpr = compileExpression(parameter.readOnlyLogicExpression);

    try {
      return compiledExpr(session, getValues());
    } catch (error) {
      logger.warn("Error executing expression:", compiledExpr, error);

      return true;
    }
  }, [getValues, parameter.readOnlyLogicExpression, session]);

  return (
    <div className="flex flex-col gap-4 items-start justify-start" title={"description"}>
      <div className="relative pr-2">
        {parameter.mandatory && (
          <span className="absolute -top-1 right-0 text-[#DC143C] font-bold" aria-required>
            *
          </span>
        )}
        <Label htmlFor={parameter.dBColumnName} name={parameter.name} />
      </div>
      <div className="w-full pb-8">
        <GenericSelector parameter={parameter} readOnly={isReadOnly} />
      </div>
    </div>
  );
};

export default BaseSelector;

```

## Archivo: `packages/MainUI/components/ProcessModal/selectors/GenericSelector.tsx`

```typescript
import { getFieldReference } from "@/utils";
import { FieldType, type ProcessParameter } from "@workspaceui/api-client/src/api/types";
import { useFormContext } from "react-hook-form";
import RadioSelector from "./RadioSelector";

const GenericSelector = ({ parameter, readOnly }: { parameter: ProcessParameter; readOnly?: boolean }) => {
  const { register } = useFormContext();
  const reference = getFieldReference(parameter.reference);

  if (reference === FieldType.LIST) {
    return <RadioSelector parameter={parameter} />;
    // return <ListSelector parameter={parameter} />;
  }
  return (
    <input
      readOnly={readOnly}
      className={`w-full px-3 py-2 border border-gray-200 rounded-md focus:outline-none focus:border-(--color-etendo-main) ${readOnly ? "bg-(--color-baseline-10) font-medium text-zinc-500" : ""}`}
      {...register(parameter.dBColumnName, {
        required: parameter.required,
        disabled: readOnly,
      })}
    />
  );
};

export default GenericSelector;

```

## Archivo: `packages/MainUI/components/ProcessModal/selectors/ListSelector.tsx`

```typescript
import { useTranslation } from "@/hooks/useTranslation";
import ChevronDown from "@workspaceui/componentlibrary/src/assets/icons/chevron-down.svg";
import ChevronUp from "@workspaceui/componentlibrary/src/assets/icons/chevron-up.svg";
import type { ListOption, ProcessParameter } from "@workspaceui/api-client/src/api/types";
import { useCallback, useEffect, useMemo, useRef, useState } from "react";
import { useFormContext } from "react-hook-form";

const SelectOption = ({ option, onClick }: { option: ListOption; onClick: (value: string) => void }) => {
  const handleClick = useCallback(() => {
    onClick(option.value);
  }, [onClick, option]);

  return (
    <div
      onClick={handleClick}
      className="px-3 py-2 hover:bg-baseline-10 cursor-pointer"
      onKeyDown={(e) => {
        if (e.key === "Enter" || e.key === " ") {
          e.preventDefault();
          handleClick();
        }
      }}>
      {option.label}
    </div>
  );
};

const ListSelector = ({ parameter }: { parameter: ProcessParameter }) => {
  const [open, setOpen] = useState(false);
  const [selected, setSelected] = useState<string | null>(null);
  const { setValue } = useFormContext();
  const ref = useRef<HTMLDivElement>(null);
  const { t } = useTranslation();

  const toggleOpen = useCallback(() => setOpen((prev) => !prev), []);

  const handleSelect = useCallback(
    (value: string) => {
      setSelected(value);
      setValue(parameter.dBColumnName, value);
      setOpen(false);
    },
    [parameter.dBColumnName, setValue]
  );

  const handleClickOutside = useCallback((e: MouseEvent) => {
    if (ref.current && !ref.current.contains(e.target as Node)) {
      setOpen(false);
    }
  }, []);

  const selectedLabel = useMemo(
    () => parameter.refList.find((opt) => opt.value === selected)?.label ?? t("form.select.placeholder"),
    [parameter.refList, selected, t]
  );

  useEffect(() => {
    document.addEventListener("mousedown", handleClickOutside);

    return () => document.removeEventListener("mousedown", handleClickOutside);
  }, [handleClickOutside]);

  return (
    <div className="relative" ref={ref}>
      <button
        type="button"
        onClick={toggleOpen}
        className="w-full flex items-center justify-between px-3 py-2 h-10 border border-baseline-10 hover:border-baseline-100 rounded bg-white text-baseline-90 cursor-pointer transition-colors">
        <span>{selectedLabel}</span>
        {open ? <ChevronUp fill="currentColor" /> : <ChevronDown fill="currentColor" />}
      </button>

      <div
        className={`absolute z-10 mt-1 w-full bg-white border border-baseline-20 rounded shadow-lg max-h-60 overflow-y-auto origin-top transition-all duration-200 ${open ? "opacity-100 scale-y-100 pointer-events-auto" : "opacity-0 scale-y-0 pointer-events-none"}`}
        style={{ transformOrigin: "top" }}>
        {parameter.refList.map((option) => (
          <SelectOption option={option} onClick={handleSelect} key={option.id} />
        ))}
      </div>
    </div>
  );
};

export default ListSelector;

```

## Archivo: `packages/MainUI/components/ProcessModal/selectors/ProcessParameterSelector.tsx`

```typescript
import type { ProcessParameter } from "@workspaceui/api-client/src/api/types";
import type { ExtendedProcessParameter } from "../types/ProcessParameterExtensions";
import { useMemo } from "react";
import { useUserContext } from "@/hooks/useUserContext";
import { useFormContext } from "react-hook-form";
import { logger } from "@/utils/logger";
import { compileExpression } from "@/components/Form/FormView/selectors/BaseSelector";
import Label from "@/components/Label";

// Import FormView selectors for reuse
import { PasswordSelector } from "@/components/Form/FormView/selectors/PasswordSelector";
import { BooleanSelector } from "@/components/Form/FormView/selectors/BooleanSelector";
import { NumericSelector } from "@/components/Form/FormView/selectors/NumericSelector";
import { DateSelector } from "@/components/Form/FormView/selectors/DateSelector";
import { DatetimeSelector } from "@/components/Form/FormView/selectors/DatetimeSelector";
import { SelectSelector } from "@/components/Form/FormView/selectors/SelectSelector";
import { TableDirSelector } from "@/components/Form/FormView/selectors/TableDirSelector";
import QuantitySelector from "@/components/Form/FormView/selectors/QuantitySelector";
import { ListSelector } from "@/components/Form/FormView/selectors/ListSelector";

// Import mapper
import { ProcessParameterMapper } from "../mappers/ProcessParameterMapper";

// Import existing ProcessModal selectors for fallback
import GenericSelector from "./GenericSelector";

interface ProcessParameterSelectorProps {
  parameter: ProcessParameter | ExtendedProcessParameter;
  logicFields?: Record<string, boolean>; // Optional logic fields from process defaults
}

/**
 * Main selector component that routes ProcessParameters to appropriate form controls
 * This component bridges ProcessParameters with FormView selectors for consistent UI
 */
export const ProcessParameterSelector = ({ parameter, logicFields }: ProcessParameterSelectorProps) => {
  const { session } = useUserContext();
  const { getValues } = useFormContext();

  // Map ProcessParameter to Field interface for FormView selector compatibility
  const mappedField = useMemo(() => {
    return ProcessParameterMapper.mapToField(parameter);
  }, [parameter]);

  // Evaluate display logic expression (combine parameter logic with process defaults logic)
  const isDisplayed = useMemo(() => {
    // Check process defaults logic first (takes precedence)
    const defaultsDisplayLogic = logicFields?.[`${parameter.name}.display`];
    if (defaultsDisplayLogic !== undefined) {
      return defaultsDisplayLogic;
    }
    
    // Fallback to parameter's own display logic
    if (!parameter.displayLogic) return true;
    
    // Skip compilation if display logic looks like a field name (contains underscores and ends with _logic)
    if (parameter.displayLogic.includes('_logic') && !parameter.displayLogic.includes('@')) {
      logger.warn("Invalid display logic expression - looks like field name:", parameter.displayLogic);
      return true; // Default to visible for malformed expressions
    }
    
    // WAIT for form data to be available before evaluating expressions
    const currentValues = getValues();
    if (!currentValues || Object.keys(currentValues).length === 0) {
      // Form data not loaded yet, default to visible to avoid errors
      return true;
    }

    try {
      const compiledExpr = compileExpression(parameter.displayLogic);
      return compiledExpr(session, currentValues);
    } catch (error) {
      logger.warn("Error executing display logic expression:", parameter.displayLogic, error);
      return true; // Default to visible on error
    }
  }, [parameter.displayLogic, parameter.name, logicFields, session, getValues]);

  // Evaluate readonly logic expression (combine parameter logic with process defaults logic)
  const isReadOnly = useMemo(() => {
    // Check process defaults logic first (takes precedence)
    const defaultsReadOnlyLogic = logicFields?.[`${parameter.name}.readonly`];
    if (defaultsReadOnlyLogic !== undefined) {
      return defaultsReadOnlyLogic;
    }
    
    // Fallback to parameter's own readonly logic
    if (!parameter.readOnlyLogicExpression) return false;
    
    try {
      const compiledExpr = compileExpression(parameter.readOnlyLogicExpression);
      return compiledExpr(session, getValues());
    } catch (error) {
      logger.warn("Error executing readonly logic expression:", parameter.readOnlyLogicExpression, error);
      return false; // Default to editable on error
    }
  }, [parameter.readOnlyLogicExpression, parameter.name, logicFields, session, getValues]);

  // Get field type for selector routing
  const fieldType = useMemo(() => {
    return ProcessParameterMapper.getFieldType(parameter);
  }, [parameter]);

  // Don't render if display logic evaluates to false
  if (!isDisplayed) {
    return null;
  }

  // Render the appropriate selector based on field type
  const renderSelector = () => {
    try {
      // Validate field mapping before rendering
      if (!mappedField.hqlName) {
        logger.warn("Missing hqlName for parameter:", parameter.name);
        return <GenericSelector parameter={parameter} readOnly={isReadOnly} />;
      }

      switch (fieldType) {
        case "password":
          return (
            <PasswordSelector 
              field={mappedField}
              disabled={isReadOnly}
              placeholder={parameter.description}
            />
          );

        case "boolean":
          return (
            <BooleanSelector 
              field={mappedField}
              isReadOnly={isReadOnly}
            />
          );

        case "numeric":
          return (
            <NumericSelector 
              field={mappedField}
              disabled={isReadOnly}
              placeholder={parameter.description}
            />
          );

        case "date":
          return (
            <DateSelector 
              field={mappedField}
              isReadOnly={isReadOnly}
            />
          );

        case "datetime":
          return (
            <DatetimeSelector 
              field={mappedField}
              isReadOnly={isReadOnly}
            />
          );

        case "select":
          return (
            <SelectSelector 
              field={mappedField}
              isReadOnly={isReadOnly}
              pageSize={20}
              initialPageSize={20}
            />
          );

        case "tabledir":
        case "product":
          return (
            <TableDirSelector 
              field={mappedField}
              isReadOnly={isReadOnly}
            />
          );

        case "quantity":
          return (
            <QuantitySelector 
              field={mappedField}
              value={mappedField.hasDefaultValue ? parameter.defaultValue : ""}
              name={mappedField.hqlName}
              readOnly={isReadOnly}
              min={null}
              max={null}
            />
          );

        case "list":
          if (!mappedField.refList || mappedField.refList.length === 0) {
            logger.warn("List field without options, falling back to GenericSelector:", parameter.name);
            return <GenericSelector parameter={parameter} readOnly={isReadOnly} />;
          }
          return (
            <ListSelector 
              field={mappedField}
              isReadOnly={isReadOnly}
            />
          );

        // Window references already handled by GenericSelector with WindowReferenceGrid
        case "window":
        case "text":
        default:
          // Fallback to existing ProcessModal GenericSelector
          return <GenericSelector parameter={parameter} readOnly={isReadOnly} />;
      }
    } catch (error) {
      logger.error("Error rendering selector for parameter:", parameter.name, error);
      // Fallback to GenericSelector on error
      return <GenericSelector parameter={parameter} readOnly={isReadOnly} />;
    }
  };

  return (
    <div className="flex flex-col gap-4 items-start justify-start" title={parameter.description}>
      <div className="relative pr-2">
        {parameter.mandatory && (
          <span className="absolute -top-1 right-0 text-[#DC143C] font-bold" aria-required>
            *
          </span>
        )}
        <Label htmlFor={mappedField.hqlName} name={parameter.name} />
      </div>
      <div className="w-full pb-8">
        {renderSelector()}
      </div>
    </div>
  );
};

export default ProcessParameterSelector;
```

## Archivo: `packages/MainUI/components/ProcessModal/selectors/RadioSelector.tsx`

```typescript
import type { ProcessParameter } from "@workspaceui/api-client/src/api/types";
import { RadioGrid } from "@workspaceui/componentlibrary/src/components";
import type { RadioGridOption } from "@workspaceui/componentlibrary/src/components/RadioGrid";
import { useEffect } from "react";
import { useFormContext } from "react-hook-form";

const RadioSelector = ({ parameter }: { parameter: ProcessParameter }) => {
  const { register, setValue, watch } = useFormContext();
  const selectedOption = watch(parameter.dBColumnName);

  useEffect(() => {
    if (parameter.defaultValue && !selectedOption) {
      setValue(parameter.dBColumnName, parameter.defaultValue);
    }
  }, [parameter, selectedOption, setValue]);

  const handleSelect = (value: string) => {
    setValue(parameter.dBColumnName, value);
  };

  const radioOptions: RadioGridOption[] = parameter.refList.map((option) => ({
    value: option.value,
    label: option.label,
    description: option.value !== option.label ? option.value : undefined,
  }));

  return (
    <div>
      <RadioGrid
        options={radioOptions}
        selectedValue={selectedOption || null}
        onSelect={handleSelect}
        columns={parameter.refList.length <= 2 ? (parameter.refList.length as 1 | 2) : 3}
        name={parameter.dBColumnName}
        className="grid-flow-col"
      />
      <input
        type="hidden"
        {...register(parameter.dBColumnName, {
          required: parameter.required,
        })}
      />
    </div>
  );
};

export default RadioSelector;

```

## Archivo: `packages/MainUI/components/ProcessModal/selectors/__tests__/ProcessParameterSelector.test.tsx`

```typescript
import { render, screen } from "@testing-library/react";
import { FormProvider, useForm } from "react-hook-form";
import { ProcessParameterSelector } from "../ProcessParameterSelector";

// Mock hooks and components
jest.mock("@/hooks/useUserContext", () => ({
  useUserContext: () => ({ session: {} })
}));

jest.mock("@/components/Form/FormView/selectors/PasswordSelector", () => ({
  PasswordSelector: ({ field }: any) => <input data-testid="password-selector" name={field.hqlName} type="password" />
}));

jest.mock("@/components/Form/FormView/selectors/BooleanSelector", () => ({
  BooleanSelector: ({ field }: any) => <input data-testid="boolean-selector" name={field.hqlName} type="checkbox" />
}));

jest.mock("@/components/Form/FormView/selectors/NumericSelector", () => ({
  NumericSelector: ({ field }: any) => <input data-testid="numeric-selector" name={field.hqlName} type="number" />
}));

jest.mock("@/components/Form/FormView/selectors/DateSelector", () => ({
  DateSelector: ({ field }: any) => <input data-testid="date-selector" name={field.hqlName} type="date" />
}));

jest.mock("@/components/Form/FormView/selectors/DatetimeSelector", () => ({
  DatetimeSelector: ({ field }: any) => <input data-testid="datetime-selector" name={field.hqlName} type="datetime-local" />
}));

jest.mock("@/components/Form/FormView/selectors/SelectSelector", () => ({
  SelectSelector: ({ field }: any) => <select data-testid="select-selector" name={field.hqlName} />
}));

jest.mock("@/components/Form/FormView/selectors/TableDirSelector", () => ({
  TableDirSelector: ({ field }: any) => <select data-testid="tabledir-selector" name={field.hqlName} />
}));

jest.mock("@/components/Form/FormView/selectors/QuantitySelector", () => {
  return function QuantitySelector({ field }: any) {
    return <input data-testid="quantity-selector" name={field.hqlName} type="number" step="any" />;
  };
});

jest.mock("@/components/Form/FormView/selectors/ListSelector", () => ({
  ListSelector: ({ field }: any) => <select data-testid="list-selector" name={field.hqlName} />
}));

jest.mock("../GenericSelector", () => {
  return function GenericSelector({ parameter }: any) {
    return <input data-testid="generic-selector" name={parameter.name} />;
  };
});

jest.mock("@/components/Label", () => {
  return function Label({ name }: any) {
    return <label data-testid="parameter-label">{name}</label>;
  };
});

// Test wrapper component with form context
const TestWrapper = ({ children }: { children: React.ReactNode }) => {
  const form = useForm();
  return <FormProvider {...form}>{children}</FormProvider>;
};

describe("ProcessParameterSelector", () => {
  const baseParameter = {
    id: "test-id",
    name: "Test Parameter",
    dBColumnName: "test_column",
    reference: "String",
    mandatory: false,
    defaultValue: "",
    refList: []
  } as any;

  it("should render parameter label correctly", () => {
    render(
      <TestWrapper>
        <ProcessParameterSelector parameter={baseParameter} />
      </TestWrapper>
    );

    expect(screen.getByTestId("parameter-label")).toHaveTextContent("Test Parameter");
  });

  it("should show mandatory indicator when parameter is mandatory", () => {
    const mandatoryParameter = { ...baseParameter, mandatory: true };
    
    render(
      <TestWrapper>
        <ProcessParameterSelector parameter={mandatoryParameter} />
      </TestWrapper>
    );

    expect(screen.getByText("*")).toBeInTheDocument();
  });

  it("should render PasswordSelector for password reference", () => {
    const passwordParameter = { ...baseParameter, reference: "Password" };
    
    render(
      <TestWrapper>
        <ProcessParameterSelector parameter={passwordParameter} />
      </TestWrapper>
    );

    expect(screen.getByTestId("password-selector")).toBeInTheDocument();
    expect(screen.getByTestId("password-selector")).toHaveAttribute("type", "password");
  });

  it("should render BooleanSelector for boolean reference", () => {
    const booleanParameter = { ...baseParameter, reference: "Yes/No" };
    
    render(
      <TestWrapper>
        <ProcessParameterSelector parameter={booleanParameter} />
      </TestWrapper>
    );

    expect(screen.getByTestId("boolean-selector")).toBeInTheDocument();
    expect(screen.getByTestId("boolean-selector")).toHaveAttribute("type", "checkbox");
  });

  it("should render NumericSelector for numeric references", () => {
    const numericParameter = { ...baseParameter, reference: "Amount" };
    
    render(
      <TestWrapper>
        <ProcessParameterSelector parameter={numericParameter} />
      </TestWrapper>
    );

    expect(screen.getByTestId("numeric-selector")).toBeInTheDocument();
    expect(screen.getByTestId("numeric-selector")).toHaveAttribute("type", "number");
  });

  it("should render GenericSelector for unsupported references", () => {
    const textParameter = { ...baseParameter, reference: "String" };
    
    render(
      <TestWrapper>
        <ProcessParameterSelector parameter={textParameter} />
      </TestWrapper>
    );

    expect(screen.getByTestId("generic-selector")).toBeInTheDocument();
  });

  it("should render GenericSelector as fallback for unknown references", () => {
    const unknownParameter = { ...baseParameter, reference: "UnknownType" };
    
    render(
      <TestWrapper>
        <ProcessParameterSelector parameter={unknownParameter} />
      </TestWrapper>
    );

    expect(screen.getByTestId("generic-selector")).toBeInTheDocument();
  });

  it("should handle parameters without reference type", () => {
    const parameterWithoutReference = { ...baseParameter };
    delete parameterWithoutReference.reference;
    
    render(
      <TestWrapper>
        <ProcessParameterSelector parameter={parameterWithoutReference} />
      </TestWrapper>
    );

    expect(screen.getByTestId("generic-selector")).toBeInTheDocument();
  });

  it("should render with description as title attribute", () => {
    const parameterWithDescription = { 
      ...baseParameter, 
      description: "This is a test parameter description" 
    };
    
    render(
      <TestWrapper>
        <ProcessParameterSelector parameter={parameterWithDescription} />
      </TestWrapper>
    );

    const container = screen.getByTitle("This is a test parameter description");
    expect(container).toBeInTheDocument();
  });

  it("should handle integer reference as numeric type", () => {
    const integerParameter = { ...baseParameter, reference: "Integer" };
    
    render(
      <TestWrapper>
        <ProcessParameterSelector parameter={integerParameter} />
      </TestWrapper>
    );

    expect(screen.getByTestId("numeric-selector")).toBeInTheDocument();
  });

  it("should handle different boolean reference formats", () => {
    const booleanFormats = ["Yes/No", "YesNo", "Boolean"];
    
    booleanFormats.forEach((format, index) => {
      const { unmount } = render(
        <TestWrapper>
          <ProcessParameterSelector parameter={{ ...baseParameter, reference: format, id: `test-${index}` }} />
        </TestWrapper>
      );
      
      expect(screen.getByTestId("boolean-selector")).toBeInTheDocument();
      unmount();
    });
  });

  it("should render DateSelector for date reference", () => {
    const dateParameter = { ...baseParameter, reference: "Date" };
    
    render(
      <TestWrapper>
        <ProcessParameterSelector parameter={dateParameter} />
      </TestWrapper>
    );

    expect(screen.getByTestId("date-selector")).toBeInTheDocument();
    expect(screen.getByTestId("date-selector")).toHaveAttribute("type", "date");
  });

  it("should render DatetimeSelector for datetime reference", () => {
    const datetimeParameter = { ...baseParameter, reference: "DateTime" };
    
    render(
      <TestWrapper>
        <ProcessParameterSelector parameter={datetimeParameter} />
      </TestWrapper>
    );

    expect(screen.getByTestId("datetime-selector")).toBeInTheDocument();
    expect(screen.getByTestId("datetime-selector")).toHaveAttribute("type", "datetime-local");
  });

  it("should render SelectSelector for select reference", () => {
    const selectParameter = { ...baseParameter, reference: "Select" };
    
    render(
      <TestWrapper>
        <ProcessParameterSelector parameter={selectParameter} />
      </TestWrapper>
    );

    expect(screen.getByTestId("select-selector")).toBeInTheDocument();
  });

  it("should render TableDirSelector for product reference", () => {
    const productParameter = { ...baseParameter, reference: "Product" };
    
    render(
      <TestWrapper>
        <ProcessParameterSelector parameter={productParameter} />
      </TestWrapper>
    );

    expect(screen.getByTestId("tabledir-selector")).toBeInTheDocument();
  });

  it("should render TableDirSelector for table directory reference", () => {
    const tableDirParameter = { ...baseParameter, reference: "TableDir" };
    
    render(
      <TestWrapper>
        <ProcessParameterSelector parameter={tableDirParameter} />
      </TestWrapper>
    );

    expect(screen.getByTestId("tabledir-selector")).toBeInTheDocument();
  });

  it("should render QuantitySelector for quantity references", () => {
    const quantityFormats = ["Quantity"];
    
    quantityFormats.forEach((format, index) => {
      const { unmount } = render(
        <TestWrapper>
          <ProcessParameterSelector parameter={{ ...baseParameter, reference: format, id: `test-quantity-${index}` }} />
        </TestWrapper>
      );
      
      expect(screen.getByTestId("quantity-selector")).toBeInTheDocument();
      expect(screen.getByTestId("quantity-selector")).toHaveAttribute("type", "number");
      expect(screen.getByTestId("quantity-selector")).toHaveAttribute("step", "any");
      unmount();
    });
  });

  it("should render ListSelector for list reference", () => {
    const listParameter = { 
      ...baseParameter, 
      reference: "List", 
      refList: [
        { id: "1", label: "Option 1", value: "opt1" },
        { id: "2", label: "Option 2", value: "opt2" }
      ]
    };
    
    render(
      <TestWrapper>
        <ProcessParameterSelector parameter={listParameter} />
      </TestWrapper>
    );

    expect(screen.getByTestId("list-selector")).toBeInTheDocument();
  });

  it("should fallback to GenericSelector for list without options", () => {
    const listParameter = { ...baseParameter, reference: "List", refList: [] };
    
    render(
      <TestWrapper>
        <ProcessParameterSelector parameter={listParameter} />
      </TestWrapper>
    );

    expect(screen.getByTestId("generic-selector")).toBeInTheDocument();
  });
});
```

## Archivo: `packages/MainUI/components/ProcessModal/styles.ts`

```typescript
import { useTheme, type Theme, type SxProps } from "@mui/material";
import { useMemo } from "react";

export const useStyle = () => {
  const theme = useTheme();

  return useMemo(
    () =>
      ({
        styles: {
          dialog: {
            "& .MuiDialog-paper": {
              borderRadius: "1rem",
            },
          },
          dialogTitle: {
            padding: "1.5rem",
          },
          dialogContent: {
            padding: "1.5rem",
          },
          dialogActions: {
            padding: "1rem 1.5rem",
          },
          messageBox: {
            padding: "1rem",
            borderRadius: "0.75rem",
            backgroundColor: theme.palette.baselineColor.neutral[5],
            marginTop: "1rem",
          },
          responseBox: {
            margin: 0,
            padding: "0.75rem",
            backgroundColor: theme.palette.baselineColor.neutral[10],
            borderRadius: "0.5rem",
            fontSize: "0.875rem",
          },
          cancelButton: {
            fontWeight: 600,
            fontSize: "0.875rem",
            padding: "0.5rem 1rem",
            height: "2.5rem",
            borderRadius: "6.25rem",
            color: theme.palette.baselineColor.neutral[100],
            background: theme.palette.baselineColor.neutral[20],
            "&:hover": {
              borderRadius: "6.25rem",
              border: "none",
              background: theme.palette.dynamicColor.main,
            },
          },
          executeButton: {
            fontWeight: 600,
            fontSize: "0.875rem",
            padding: "0.5rem 1rem",
            height: "2.5rem",
            borderRadius: "6.25rem",
            color: theme.palette.baselineColor.neutral[100],
            background: theme.palette.specificColor.warning.main,
            "&:hover": {
              borderRadius: "6.25rem",
              border: "none",
              background: theme.palette.dynamicColor.main,
            },
            "&.Mui-disabled": {
              background: theme.palette.baselineColor.transparentNeutral[20],
              color: theme.palette.baselineColor.transparentNeutral[40],
            },
          },
          message: {
            fontSize: "1rem",
            color: theme.palette.baselineColor.neutral[80],
            marginBottom: "1rem",
          },
          errorMessage: {
            fontSize: "0.875rem",
            fontWeight: 500,
            color: theme.palette.specificColor.error.main,
            marginBottom: "0.5rem",
          },
          successMessage: {
            fontSize: "0.875rem",
            fontWeight: 500,
            color: theme.palette.baselineColor.neutral[80],
            marginBottom: "0.5rem",
          },
          clearButtonHover: {
            width: "2rem",
            height: "2rem",
            transition: "background-color 0.3s, color 0.3s",
            "&:hover": {
              borderRadius: "50%",
              "& .MuiSvgIcon-root": {
                color: theme.palette.baselineColor.neutral[100],
              },
            },
          },
        },
      }) satisfies Record<string, SxProps<Theme>>,
    [theme]
  );
};

export const tableStyles = {
  paper: "rounded-lg overflow-hidden border-2 border-gray-200 flex flex-col flex-1 shadow-none max-h-[30rem]",
  headCell:
    "whitespace-nowrap overflow-hidden text-ellipsis border-r border-gray-200 bg-gray-50 font-medium text-gray-800 text-sm py-2 px-3 last:border-r-0",
  bodyCell: "border-r border-gray-200 first:text-center py-1 px-3 text-sm last:border-r-0 bg-red-400",
  body: "min-h-min cursor-pointer h-full",
  container: "flex-1 overflow-auto",
};

```

## Archivo: `packages/MainUI/components/ProcessModal/types.ts`

```typescript
import type { ProcessConfigResponse } from "@/hooks/datasource/useProcessDatasourceConfig";
import type { EntityData, EntityValue, ProcessParameter, Tab } from "@workspaceui/api-client/src/api/types";
import type { Field, ProcessAction } from "@workspaceui/api-client/src/api/types";
import type { MRT_Row, MRT_RowData, MRT_TableBodyRowProps, MRT_TableInstance } from "material-react-table";

export interface BaseButton extends Field {
  id: string;
  name: string;
  action: string;
  enabled: boolean;
  visible: boolean;
}

export interface BaseProcessButton extends BaseButton {
  processId: string;
  buttonText: string;
  displayLogic?: string;
  processInfo: ProcessInfo;
}

export interface ProcessDefinitionButton extends BaseProcessButton {
  processDefinition: ProcessDefinition;
}

export interface ProcessActionButton extends BaseProcessButton {
  processAction: ProcessAction;
}

export type ProcessButton = ProcessDefinitionButton | ProcessActionButton;

export enum ProcessButtonType {
  PROCESS_DEFINITION = "processDefinition",
  PROCESS_ACTION = "processAction",
}

export interface ProcessResponse {
  responseActions?: Array<{
    showMsgInProcessView?: {
      msgType: string;
      msgTitle: string;
      msgText: string;
    };
  }>;
  refreshParent?: boolean;
  showInIframe?: boolean;
  iframeUrl?: string;
}

export interface MessageStylesType {
  bgColor: string;
  borderColor: string;
  textColor: string;
  buttonBg: string;
}

export interface ProcessIframeModalClosedProps {
  isOpen: false;
}

export interface ProcessIframeModalOpenProps {
  isOpen: true;
  url?: string;
  title?: string;
  tabId: string;
  onProcessSuccess?: () => void;
  onClose: () => void;
}

export type ProcessIframeModalProps = ProcessIframeModalClosedProps | ProcessIframeModalOpenProps;

export const isIframeModalOpen = (props: ProcessIframeModalProps): props is ProcessIframeModalOpenProps => {
  return props.isOpen === true;
};

export interface ProcessDefinitionModalProps {
  onClose: () => void;
  open: boolean;
  button?: ProcessDefinitionButton | null;
  onSuccess?: () => void;
  onError?: () => void;
}

export interface ProcessDefinitionModalContentProps extends ProcessDefinitionModalProps {
  button: NonNullable<ProcessDefinitionModalProps["button"]>;
}

export interface ProcessDeprecatedModallProps {
  isOpen: boolean;
  onClose: () => void;
  title?: string;
  message?: string;
}

export interface ProcessInfo {
  loadFunction: string;
  searchKey: string;
  clientSideValidation: string;
  _entityName: string;
  id: string;
  name: string;
  javaClassName: string;
  parameters: Array<{
    defaultValue: string;
    id: string;
    name: string;
  }>;
}

export type ListOption = { id: string; label: string; value: string };

export type ProcessParameters = Record<string, ProcessParameter>;

export interface ProcessDefinition extends Record<string, unknown> {
  id: string;
  name: string;
  javaClassName: string;
  parameters: ProcessParameters;
  onLoad: string;
  onProcess: string;
}
export interface ResponseMessage {
  msgText: string;
  msgTitle: string;
  msgType: string;
}

//Window References types

export type RecordValues = { [key: string]: EntityValue };
export interface WindowReferenceGridProps {
  parameter: ProcessParameter;
  onSelectionChange: (selection: unknown[]) => void;
  entityName?: EntityValue;
  recordId?: EntityValue;
  tabId: string;
  windowReferenceTab: Tab;
  windowId?: string;
  processConfig?: ProcessConfigResponse | null;
  processConfigLoading: boolean;
  processConfigError: Error | null;
  recordValues: RecordValues | null;
}

export type RowProps = (props: {
  isDetailPanel?: boolean;
  row: MRT_Row<EntityData>;
  table: MRT_TableInstance<EntityData>;
}) => Omit<MRT_TableBodyRowProps<MRT_RowData>, "staticRowIndex">;

export const isProcessActionButton = (button: ProcessButton): button is ProcessActionButton =>
  ProcessButtonType.PROCESS_ACTION in button;

export const isProcessDefinitionButton = (button: ProcessButton): button is ProcessDefinitionButton =>
  ProcessButtonType.PROCESS_DEFINITION in button;

```

## Archivo: `packages/MainUI/components/ProcessModal/types/ProcessParameterExtensions.ts`

```typescript
import type { ProcessParameter } from "@workspaceui/api-client/src/api/types";

/**
 * Extended ProcessParameter interface that includes properties found in actual API responses
 * but not covered by the base ProcessParameter type
 */
export interface ExtendedProcessParameter extends Omit<ProcessParameter, keyof Record<string, string>> {
  // Core ProcessParameter properties
  id: string;
  name: string;
  reference: string;
  mandatory: boolean;
  defaultValue: string;
  refList: Array<{ id: string; label: string; value: string }>;
  readOnlyLogicExpression?: string;
  window?: any; // WindowMetadata type
  
  // Additional properties found in API responses
  dBColumnName?: string;
  displayLogic?: string;
  description?: string;
  help?: string;
  sequenceNumber?: number;
  length?: number;
  
  // Allow additional string properties for flexibility
  [key: string]: any;
}

/**
 * Process defaults response from DefaultsProcessActionHandler
 * This structure is different from FormInitializationResponse
 */
export interface ProcessDefaultsResponse {
  defaults: Record<string, ProcessDefaultValue>;
  filterExpressions: Record<string, Record<string, any>>;
  refreshParent: boolean;
}

/**
 * Union type for process default values
 * Can be simple string/number/boolean or complex object with value/identifier
 */
export type ProcessDefaultValue = 
  | string 
  | number 
  | boolean 
  | {
      value: string;
      identifier: string;
    };

/**
 * Type guard to check if a value is a reference object with value/identifier
 */
export function isReferenceValue(value: ProcessDefaultValue): value is { value: string; identifier: string } {
  return (
    typeof value === 'object' &&
    value !== null &&
    'value' in value &&
    'identifier' in value &&
    typeof value.value === 'string' &&
    typeof value.identifier === 'string'
  );
}

/**
 * Type guard to check if a value is a simple string/number/boolean
 */
export function isSimpleValue(value: ProcessDefaultValue): value is string | number | boolean {
  return typeof value === 'string' || typeof value === 'number' || typeof value === 'boolean';
}

/**
 * Interface for logic field values (display_logic, readonly_logic)
 * These are string values that can be "Y" or "N"
 */
export interface ProcessLogicFields {
  [key: `${string}_display_logic`]: "Y" | "N";
  [key: `${string}_readonly_logic`]: "Y" | "N";
}

/**
 * Type guard to check if a parameter has the required properties for mapping
 */
export function isValidProcessParameter(param: unknown): param is ExtendedProcessParameter {
  return (
    typeof param === 'object' &&
    param !== null &&
    'id' in param &&
    'name' in param &&
    typeof (param as any).id === 'string' &&
    typeof (param as any).name === 'string'
  );
}
```

## Archivo: `packages/MainUI/components/ProcessModal/types/__tests__/ProcessParameterExtensions.test.ts`

```typescript
import { isReferenceValue, isSimpleValue } from '../ProcessParameterExtensions';

describe('ProcessParameterExtensions Type Guards', () => {
  describe('isReferenceValue', () => {
    it('should return true for valid reference objects', () => {
      const referenceValue = {
        value: "E443A31992CB4635AFCAEABE7183CE85",
        identifier: "F&B España - Región Norte"
      };

      expect(isReferenceValue(referenceValue)).toBe(true);
    });

    it('should return false for simple string values', () => {
      expect(isReferenceValue("simple string")).toBe(false);
      expect(isReferenceValue("")).toBe(false);
    });

    it('should return false for numbers', () => {
      expect(isReferenceValue(123)).toBe(false);
      expect(isReferenceValue(0)).toBe(false);
    });

    it('should return false for booleans', () => {
      expect(isReferenceValue(true)).toBe(false);
      expect(isReferenceValue(false)).toBe(false);
    });

    it('should return false for null or undefined', () => {
      expect(isReferenceValue(null)).toBe(false);
      expect(isReferenceValue(undefined)).toBe(false);
    });

    it('should return false for objects missing required properties', () => {
      expect(isReferenceValue({ value: "123" })).toBe(false);
      expect(isReferenceValue({ identifier: "test" })).toBe(false);
      expect(isReferenceValue({ value: 123, identifier: "test" })).toBe(false);
      expect(isReferenceValue({ value: "123", identifier: 456 })).toBe(false);
    });
  });

  describe('isSimpleValue', () => {
    it('should return true for strings', () => {
      expect(isSimpleValue("test")).toBe(true);
      expect(isSimpleValue("")).toBe(true);
      expect(isSimpleValue("1.85")).toBe(true);
    });

    it('should return true for numbers', () => {
      expect(isSimpleValue(123)).toBe(true);
      expect(isSimpleValue(0)).toBe(true);
      expect(isSimpleValue(1.85)).toBe(true);
    });

    it('should return true for booleans', () => {
      expect(isSimpleValue(true)).toBe(true);
      expect(isSimpleValue(false)).toBe(true);
    });

    it('should return false for objects', () => {
      expect(isSimpleValue({ value: "123", identifier: "test" })).toBe(false);
      expect(isSimpleValue({})).toBe(false);
      expect(isSimpleValue([])).toBe(false);
    });

    it('should return false for null or undefined', () => {
      expect(isSimpleValue(null)).toBe(false);
      expect(isSimpleValue(undefined)).toBe(false);
    });
  });

  describe('Real world data', () => {
    it('should correctly identify real response values', () => {
      const realResponseData = {
        "trxtype": "",
        "ad_org_id": {
          "value": "E443A31992CB4635AFCAEABE7183CE85",
          "identifier": "F&B España - Región Norte"
        },
        "bslamount": "",
        "payment_documentno": "<1000373>",
        "actual_payment": "1.85",
        "issotrx": true,
        "StdPrecision": "2"
      };

      // Simple values
      expect(isSimpleValue(realResponseData.trxtype)).toBe(true);
      expect(isSimpleValue(realResponseData.bslamount)).toBe(true);
      expect(isSimpleValue(realResponseData.payment_documentno)).toBe(true);
      expect(isSimpleValue(realResponseData.actual_payment)).toBe(true);
      expect(isSimpleValue(realResponseData.issotrx)).toBe(true);
      expect(isSimpleValue(realResponseData.StdPrecision)).toBe(true);

      // Reference values
      expect(isReferenceValue(realResponseData.ad_org_id)).toBe(true);

      // Cross-validation
      expect(isReferenceValue(realResponseData.trxtype)).toBe(false);
      expect(isSimpleValue(realResponseData.ad_org_id)).toBe(false);
    });
  });
});
```

## Archivo: `packages/MainUI/components/ProcessModal/utils/ProcessDefaultsErrorBoundary.tsx`

```typescript
import React, { Component, ErrorInfo, ReactNode } from "react";
import { logger } from "@/utils/logger";

interface ProcessDefaultsErrorBoundaryProps {
  children: ReactNode;
  fallback?: ReactNode;
  onError?: (error: Error, errorInfo: ErrorInfo) => void;
  processId?: string;
}

interface ProcessDefaultsErrorBoundaryState {
  hasError: boolean;
  error: Error | null;
  errorId: string | null;
}

/**
 * Error boundary specifically for process defaults functionality
 * Provides graceful error handling and recovery options
 */
export class ProcessDefaultsErrorBoundary extends Component<
  ProcessDefaultsErrorBoundaryProps,
  ProcessDefaultsErrorBoundaryState
> {
  constructor(props: ProcessDefaultsErrorBoundaryProps) {
    super(props);
    this.state = {
      hasError: false,
      error: null,
      errorId: null,
    };
  }

  static getDerivedStateFromError(error: Error): Partial<ProcessDefaultsErrorBoundaryState> {
    const errorId = `defaults_error_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
    
    return {
      hasError: true,
      error,
      errorId,
    };
  }

  componentDidCatch(error: Error, errorInfo: ErrorInfo) {
    const { processId, onError } = this.props;
    const { errorId } = this.state;

    // Log error with context
    logger.error("ProcessDefaultsErrorBoundary: Error caught", {
      errorId,
      processId,
      error: error.message,
      stack: error.stack,
      componentStack: errorInfo.componentStack,
      timestamp: Date.now(),
    });

    // Call custom error handler if provided
    if (onError) {
      onError(error, errorInfo);
    }

    // Report error to monitoring service if available
    this.reportError(error, errorInfo);
  }

  private reportError = (error: Error, errorInfo: ErrorInfo) => {
    const { processId } = this.props;
    const { errorId } = this.state;

    // This could integrate with error reporting services like Sentry
    const errorReport = {
      errorId,
      processId,
      message: error.message,
      stack: error.stack,
      componentStack: errorInfo.componentStack,
      userAgent: navigator.userAgent,
      url: window.location.href,
      timestamp: new Date().toISOString(),
      context: "ProcessDefaults",
    };

    // Log error report for now
    logger.error("Error report generated:", errorReport);
  };

  private handleRetry = () => {
    this.setState({
      hasError: false,
      error: null,
      errorId: null,
    });
  };

  render() {
    const { hasError, error, errorId } = this.state;
    const { children, fallback, processId } = this.props;

    if (hasError) {
      // Use custom fallback if provided
      if (fallback) {
        return fallback;
      }

      // Default error UI
      return (
        <div className="process-defaults-error-boundary">
          <div className="p-4 border border-red-200 rounded-lg bg-red-50">
            <div className="flex items-start gap-3">
              <div className="flex-shrink-0">
                <svg
                  className="w-5 h-5 text-red-400"
                  fill="currentColor"
                  viewBox="0 0 20 20"
                >
                  <path
                    fillRule="evenodd"
                    d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z"
                    clipRule="evenodd"
                  />
                </svg>
              </div>
              <div className="flex-1">
                <h3 className="text-sm font-medium text-red-800">
                  Process Defaults Error
                </h3>
                <p className="mt-1 text-sm text-red-700">
                  Failed to load default values for this process. You can continue 
                  without defaults or try again.
                </p>
                {errorId && (
                  <p className="mt-1 text-xs text-red-600">
                    Error ID: {errorId}
                  </p>
                )}
                {process.env.NODE_ENV === 'development' && error && (
                  <details className="mt-2">
                    <summary className="text-xs text-red-600 cursor-pointer">
                      Error Details (Development)
                    </summary>
                    <pre className="mt-1 text-xs text-red-600 whitespace-pre-wrap">
                      {error.message}
                      {error.stack && `\n\n${error.stack}`}
                    </pre>
                  </details>
                )}
              </div>
            </div>
            <div className="mt-4 flex gap-2">
              <button
                type="button"
                onClick={this.handleRetry}
                className="text-sm bg-red-100 text-red-800 px-3 py-1 rounded hover:bg-red-200 transition-colors"
              >
                Try Again
              </button>
              <button
                type="button"
                onClick={() => {
                  // Continue without defaults
                  this.setState({
                    hasError: false,
                    error: null,
                    errorId: null,
                  });
                }}
                className="text-sm bg-gray-100 text-gray-800 px-3 py-1 rounded hover:bg-gray-200 transition-colors"
              >
                Continue Without Defaults
              </button>
            </div>
          </div>
        </div>
      );
    }

    return children;
  }
}

// Hook for using error boundary functionality
export const useProcessDefaultsErrorHandler = (processId?: string) => {
  const handleError = React.useCallback((error: Error, errorInfo: ErrorInfo) => {
    logger.error("Process defaults error handled by hook", {
      processId,
      error: error.message,
      componentStack: errorInfo.componentStack,
    });
  }, [processId]);

  return {
    handleError,
    ErrorBoundary: React.useCallback(
      ({ children, fallback }: { children: ReactNode; fallback?: ReactNode }) => (
        <ProcessDefaultsErrorBoundary
          processId={processId}
          onError={handleError}
          fallback={fallback}
        >
          {children}
        </ProcessDefaultsErrorBoundary>
      ),
      [processId, handleError]
    ),
  };
};
```

## Archivo: `packages/MainUI/components/ProfileModal/ProfileModal.tsx`

```typescript
"use client";

import { useLanguage } from "@/contexts/language";
import { useTranslation } from "@/hooks/useTranslation";
import { Button, useTheme } from "@mui/material";
import IconButton from "@workspaceui/componentlibrary/src/components/IconButton";
import type { Option } from "@workspaceui/componentlibrary/src/components/Input/Select/types";
import Menu from "@workspaceui/componentlibrary/src/components/Menu";
import type { Language } from "@workspaceui/componentlibrary/src/locales/types";
import type React from "react";
import { useCallback, useEffect, useMemo, useState } from "react";
import CheckCircle from "../../../ComponentLibrary/src/assets/icons/check-circle.svg";
import ToggleSection from "./ToggleButton";
import SelectorList from "./ToggleSection";
import UserProfile from "./UserProfile";
import { useStyle } from "./styles";
import type { ProfileModalProps } from "./types";

const DefaultOrg = { title: "*", value: "0", id: "0" };

const ProfileModal: React.FC<ProfileModalProps> = ({
  userPhotoUrl,
  userName,
  userEmail,
  icon,
  sections,
  currentRole,
  currentOrganization,
  currentWarehouse,
  roles,
  changeProfile,
  onSetDefaultConfiguration,
  logger,
  translations,
  onSignOff,
  language,
  languages,
  onLanguageChange,
  saveAsDefault,
  onSaveAsDefaultChange,
}) => {
  const { t } = useTranslation();
  const theme = useTheme();
  const { styles, sx } = useStyle();
  const [currentSection, setCurrentSection] = useState<string>("profile");
  const { language: initialLanguage, getFlag } = useLanguage();
  const [languagesFlags, setLanguageFlags] = useState(getFlag(initialLanguage));
  const [anchorEl, setAnchorEl] = useState<HTMLButtonElement | null>(null);

  const [selectedRole, setSelectedRole] = useState<Option | null>(() => {
    if (currentRole) {
      return { title: currentRole.name, value: currentRole.id, id: currentRole.id };
    }
    return null;
  });

  const selectedClient = useMemo(() => {
    const client = selectedRole && roles.find((r) => r.id === selectedRole.value)?.client;
    return client ? { title: client, value: client, id: client } : null;
  }, [selectedRole, roles]);

  const [selectedOrg, setSelectedOrg] = useState<Option>(() => {
    if (currentOrganization) {
      return { title: currentOrganization.name, value: currentOrganization.id, id: currentOrganization.id };
    }
    return DefaultOrg;
  });

  const [selectedWarehouse, setSelectedWarehouse] = useState<Option | null>(() => {
    if (currentWarehouse) {
      return { title: currentWarehouse.name, value: currentWarehouse.id, id: currentWarehouse.id };
    }
    return null;
  });

  const [selectedLanguage, setSelectedLanguage] = useState<Option | null>(() => {
    const currentLang = languages.find((lang) => lang.language === language);
    return currentLang
      ? {
          title: currentLang.name,
          value: currentLang.language,
          id: currentLang.id,
        }
      : null;
  });

  useEffect(() => {
    if (currentRole) {
      setSelectedRole({ title: currentRole.name, value: currentRole.id, id: currentRole.id });
    }

    if (currentOrganization) {
      setSelectedOrg({ title: currentOrganization.name, value: currentOrganization.id, id: currentOrganization.id });
    }

    if (currentWarehouse) {
      setSelectedWarehouse({
        title: currentWarehouse.name,
        value: currentWarehouse.id,
        id: currentWarehouse.id,
      });
    }
  }, [currentRole, currentOrganization, currentWarehouse]);

  useEffect(() => {
    if (language) {
      const currentLang = languages.find((lang) => lang.language === language);
      if (currentLang) {
        setSelectedLanguage({
          title: currentLang.name,
          value: currentLang.language,
          id: currentLang.id,
        });
      }
    }
  }, [language, languages]);

  const handleRoleChange = useCallback((_event: React.SyntheticEvent<Element, Event>, value: Option | null) => {
    setSelectedRole(value);
    setSelectedOrg(DefaultOrg);
    setSelectedWarehouse(null);
  }, []);

  const handleOrgChange = useCallback((_event: React.SyntheticEvent<Element, Event>, value: Option | null) => {
    setSelectedOrg(value ?? DefaultOrg);
    setSelectedWarehouse(null);
  }, []);

  const handleWarehouseChange = useCallback((_event: React.SyntheticEvent<Element, Event>, value: Option | null) => {
    setSelectedWarehouse(value);
    if (value) {
      localStorage.setItem("currentWarehouse", JSON.stringify(value));
    }
  }, []);

  const handleToggle = useCallback((section: string) => {
    setCurrentSection(section);
  }, []);

  const handleClick = useCallback(
    (event: React.MouseEvent<HTMLButtonElement>) => {
      if (!anchorEl) {
        setAnchorEl(event.currentTarget);
      } else {
        setAnchorEl(null);
      }
    },
    [anchorEl]
  );

  const handleClose = useCallback(() => {
    setAnchorEl(null);
  }, []);

  const handleSave = useCallback(async () => {
    if (currentSection === "profile") {
      try {
        const params: { role?: string; organization?: string; warehouse?: string } = {};

        if (selectedRole && selectedRole.value !== currentRole?.id) {
          params.role = selectedRole.value;
        }

        if (selectedOrg && selectedOrg.value !== currentOrganization?.id) {
          params.organization = selectedOrg.value;
        }

        if (selectedWarehouse && selectedWarehouse.value !== currentWarehouse?.id) {
          params.warehouse = selectedWarehouse.value;

          const newWarehouse = {
            id: selectedWarehouse.id,
            title: selectedWarehouse.title,
            value: selectedWarehouse.value,
          };
          setSelectedWarehouse(newWarehouse);
          localStorage.setItem("currentWarehouse", JSON.stringify(newWarehouse));
        }

        if (Object.keys(params).length > 0) {
          await changeProfile(params);
        }

        if (selectedLanguage && selectedLanguage.value !== language) {
          onLanguageChange(selectedLanguage.value as Language);
        }

        if (saveAsDefault) {
          await onSetDefaultConfiguration({
            defaultRole: selectedRole?.value,
            defaultWarehouse: selectedWarehouse?.value,
            organization: selectedOrg?.value,
            language: selectedLanguage?.id,
          });
        }
        handleClose();
      } catch (error) {
        logger.warn("Error changing role, warehouse, or saving default configuration:", error);
      }
    }
  }, [
    currentSection,
    selectedRole,
    currentRole?.id,
    selectedOrg,
    currentOrganization?.id,
    selectedWarehouse,
    currentWarehouse?.id,
    selectedLanguage,
    language,
    saveAsDefault,
    handleClose,
    changeProfile,
    onLanguageChange,
    onSetDefaultConfiguration,
    logger,
  ]);

  const isSaveDisabled = useMemo(() => {
    if (!selectedRole) {
      return true;
    }

    const roleChanged = selectedRole && selectedRole?.value !== currentRole?.id;
    const orgChanged = selectedOrg && selectedOrg?.value !== currentOrganization?.id;
    const warehouseChanged = selectedWarehouse && selectedWarehouse?.value !== currentWarehouse?.id;
    const languageChanged = selectedLanguage && selectedLanguage?.value !== language;

    const somethingChanged = roleChanged || orgChanged || warehouseChanged || languageChanged || saveAsDefault;

    return !somethingChanged;
  }, [
    currentRole?.id,
    currentOrganization?.id,
    currentWarehouse?.id,
    language,
    saveAsDefault,
    selectedRole,
    selectedOrg,
    selectedWarehouse,
    selectedLanguage,
  ]);

  const handleLanguageChange = useCallback(
    (_event: React.SyntheticEvent<Element, Event>, value: Option | null) => {
      if (value) {
        setSelectedLanguage(value);
        setLanguageFlags(getFlag(value.value as Language));
      }
    },
    [getFlag]
  );

  return (
    <div>
      <IconButton onClick={handleClick} className="w-10 h-10">
        {icon}
      </IconButton>
      <Menu anchorEl={anchorEl} onClose={handleClose} className="w-88">
        <UserProfile photoUrl={userPhotoUrl} name={userName} email={userEmail} onSignOff={onSignOff} />
        <div style={styles.toggleSectionStyles}>
          <ToggleSection sections={sections} currentSection={currentSection} onToggle={handleToggle} />
        </div>
        <SelectorList
          section={currentSection}
          onRoleChange={handleRoleChange}
          onOrgChange={handleOrgChange}
          onWarehouseChange={handleWarehouseChange}
          onLanguageChange={handleLanguageChange}
          roles={roles}
          selectedRole={selectedRole}
          selectedClient={selectedClient}
          selectedOrg={selectedOrg}
          selectedWarehouse={selectedWarehouse}
          languages={languages}
          selectedLanguage={selectedLanguage}
          saveAsDefault={saveAsDefault}
          onSaveAsDefaultChange={onSaveAsDefaultChange}
          translations={translations}
          languagesFlags={languagesFlags}
        />
        <div style={styles.buttonContainerStyles}>
          <Button sx={sx.buttonStyles} onClick={handleClose}>
            {t("common.cancel")}
          </Button>
          <Button
            startIcon={<CheckCircle fill={theme.palette.baselineColor.neutral[0]} />}
            sx={sx.saveButtonStyles}
            onClick={handleSave}
            disabled={isSaveDisabled}>
            {t("common.save")}
          </Button>
        </div>
      </Menu>
    </div>
  );
};

export default ProfileModal;

```

## Archivo: `packages/MainUI/components/ProfileModal/ToggleButton/index.tsx`

```typescript
import { Button, useTheme } from "@mui/material";
import { useStyle } from "./styles";
import type { ToggleSectionsProps } from "./types";

const ToggleSections: React.FC<ToggleSectionsProps> = ({ sections, currentSection, onToggle }) => {
  const theme = useTheme();
  const { styles } = useStyle();

  return (
    <div style={styles.toggleContainerStyles}>
      {sections.map(({ id, label, icon }) => {
        const isActive = currentSection === id;
        return (
          <Button
            key={id}
            style={{
              ...styles.toggleButtonStyles,
              backgroundColor: isActive ? theme.palette.baselineColor.neutral[0] : "",
            }}
            onClick={() => onToggle(id)}
            startIcon={isActive ? icon : null}>
            {label}
          </Button>
        );
      })}
    </div>
  );
};

export default ToggleSections;

```

## Archivo: `packages/MainUI/components/ProfileModal/ToggleButton/styles.ts`

```typescript
import type { CSSProperties } from "react";
import { useTheme } from "@mui/material";

type StylesType = {
  [key: string]: CSSProperties;
};

export const useStyle = () => {
  const theme = useTheme();

  const styles: StylesType = {
    toggleContainerStyles: {
      display: "flex",
      padding: "0.25rem",
      justifyContent: "space-between",
      alignItems: "center",
      alignSelf: "stretch",
      borderRadius: "12.5rem",
      background: theme.palette.baselineColor.transparentNeutral[10],
    },
    toggleButtonStyles: {
      height: "2.5rem",
      padding: "0.75rem 1rem",
      cursor: "pointer",
      justifyContent: "center",
      alignItems: "center",
      flex: "1 0 0",
      border: "0px solid",
      borderRadius: "12.5rem",
    },
  };

  return { styles };
};

```

## Archivo: `packages/MainUI/components/ProfileModal/ToggleButton/types.ts`

```typescript
export interface Section {
  id: string;
  label: string;
  icon: React.ReactElement;
}

export interface ToggleSectionsProps {
  sections: Section[];
  currentSection: string;
  onToggle: (section: string) => void;
}

```

## Archivo: `packages/MainUI/components/ProfileModal/ToggleSection/index.tsx`

```typescript
import { useTranslation } from "@/hooks/useTranslation";
import { Checkbox, FormControl, FormControlLabel, Grid, styled, useTheme } from "@mui/material";
import { InputPassword } from "@workspaceui/componentlibrary/src/components";
import Select from "@workspaceui/componentlibrary/src/components/Input/Select";
import type { Option } from "@workspaceui/componentlibrary/src/components/Input/Select/types";
import { Item } from "@workspaceui/componentlibrary/src/components/enums";
import { useMemo, useState } from "react";
import ClientIcon from "../../../../ComponentLibrary/src/assets/icons/github.svg";
import LockOutlined from "../../../../ComponentLibrary/src/assets/icons/lock.svg";
import OrganizationIcon from "../../../../ComponentLibrary/src/assets/icons/user.svg";
import WarehouseIcon from "../../../../ComponentLibrary/src/assets/icons/warehouse.svg";
import type { SelectorListProps } from "../types";
import { useStyle } from "./styles";
import { useLanguage } from "@/contexts/language";
import type { Language } from "@/contexts/types";

const isOptionEqualToValue = (option: Option, value: Option) => option.id === value.id;

const SelectorList: React.FC<SelectorListProps> = ({
  section,
  onRoleChange,
  onOrgChange,
  onWarehouseChange,
  roles,
  selectedRole,
  selectedClient,
  selectedOrg,
  selectedWarehouse,
  onLanguageChange,
  selectedLanguage,
  languages,
  saveAsDefault,
  onSaveAsDefaultChange,
  translations,
  languagesFlags,
}) => {
  const { t } = useTranslation();
  const { styles, defaultFill } = useStyle();
  const theme = useTheme();
  const { getFlag } = useLanguage();
  const [password, setPassword] = useState("");
  const [newPassword, setNewPassword] = useState("");
  const [newPasswordConfirmation, setNewPasswordConfirmation] = useState("");

  const FlagEmoji = ({ flag }: { flag: string }) => <span style={styles.flagStyles}>{flag}</span>;

  const icons: { [key in Item]: React.ReactElement } = {
    [Item.Role]: <></>,
    [Item.Client]: <ClientIcon fill={defaultFill} />,
    [Item.Organization]: <OrganizationIcon fill={defaultFill} />,
    [Item.Warehouse]: <WarehouseIcon fill={defaultFill} />,
    [Item.Language]: <FlagEmoji flag={languagesFlags} />,
  };

  const CustomCheckbox = styled(Checkbox)(() => ({
    "&.Mui-checked": {
      color: theme.palette.dynamicColor.main,
    },
  }));

  const isSystem = selectedRole?.id === "0";

  const clientOptions = useMemo(() => {
    if (!selectedRole || isSystem) return [];

    const client = roles.find((r) => r.id === selectedRole.value)?.client;
    return client ? [{ title: client, value: client, id: client }] : [];
  }, [roles, selectedRole, isSystem]);

  const organizationOptions = useMemo(() => {
    if (!selectedRole || isSystem) {
      return [];
    }

    const role = roles.find((r) => r.id === selectedRole.value);
    if (!role) return [];

    return role.organizations.map((org) => ({
      title: org.name,
      value: org.id,
      id: org.id,
    }));
  }, [roles, selectedRole, isSystem]);

  const warehouses = useMemo(() => {
    if (selectedRole && !isSystem) {
      const role = roles.find((r) => r.id === selectedRole.value);
      const org = role?.organizations.find((o) => o.id === selectedOrg.value);

      if (org?.warehouses.length) {
        return org.warehouses;
      }

      const uniqueWarehousesMap = new Map();

      if (role) {
        for (const org of role.organizations) {
          for (const warehouse of org.warehouses) {
            uniqueWarehousesMap.set(warehouse.id, warehouse);
          }
        }
      }

      return Array.from(uniqueWarehousesMap.values());
    }
    return [];
  }, [roles, selectedRole, selectedOrg, isSystem]);

  const roleOptions = useMemo(
    () =>
      roles?.map((role) => ({
        title: role.name,
        value: role.id,
        id: role.id,
      })),
    [roles]
  );

  const warehouseOptions = useMemo(
    () =>
      isSystem
        ? []
        : warehouses.map((warehouse) => ({
            title: warehouse.name,
            value: warehouse.id,
            id: warehouse.id,
          })),
    [isSystem, warehouses]
  );

  const languageOptions = useMemo(
    () =>
      languages?.map((lang: { name: string; language: string; id: string }) => ({
        id: lang.id,
        title: lang.name,
        value: lang.language,
        iconLeft: getFlag(lang.language as Language),
      })),
    [languages, getFlag]
  );

  return (
    <div style={styles.selectorListStyles}>
      {section === "profile" && (
        <>
          <FormControl fullWidth style={styles.formStyle}>
            <Select
              id="role-select"
              title={Item.Role}
              options={roleOptions}
              value={selectedRole}
              onChange={onRoleChange}
              iconLeft={icons[Item.Role]}
              isOptionEqualToValue={isOptionEqualToValue}
            />
            <Select
              id="client-select"
              title={Item.Client}
              options={clientOptions}
              value={selectedClient}
              iconLeft={icons[Item.Client]}
              isOptionEqualToValue={isOptionEqualToValue}
              disabled={true}
            />
            <Select
              id="organization-select"
              title={Item.Organization}
              options={organizationOptions}
              value={selectedOrg}
              onChange={onOrgChange}
              iconLeft={icons[Item.Organization]}
              isOptionEqualToValue={isOptionEqualToValue}
              disabled={!selectedClient || isSystem}
            />
            <Select
              id="warehouse-select"
              title={Item.Warehouse}
              options={warehouseOptions}
              value={isSystem ? null : selectedWarehouse}
              onChange={onWarehouseChange}
              iconLeft={icons[Item.Warehouse]}
              disabled={!selectedOrg || isSystem}
              isOptionEqualToValue={isOptionEqualToValue}
            />
            <Select
              id="language-select"
              title={Item.Language}
              options={languageOptions}
              value={selectedLanguage}
              onChange={onLanguageChange}
              iconLeft={icons[Item.Language]}
              isOptionEqualToValue={isOptionEqualToValue}
            />
          </FormControl>
          <FormControlLabel
            control={<CustomCheckbox size="small" checked={saveAsDefault} onChange={onSaveAsDefaultChange} />}
            label={translations?.saveAsDefault}
          />
        </>
      )}
      {section === "password" && (
        <Grid margin="0.5rem">
          <form action="#" autoComplete="off">
            <InputPassword
              label={t("common.notImplemented")}
              value={password}
              setValue={setPassword}
              leftIcon={<LockOutlined fill={defaultFill} />}
              autoComplete="new-password"
              disabled
            />
            <InputPassword
              label={t("common.notImplemented")}
              value={newPassword}
              setValue={setNewPassword}
              leftIcon={<LockOutlined fill={defaultFill} />}
              autoComplete="new-password"
              disabled
            />
            <InputPassword
              label={t("common.notImplemented")}
              value={newPasswordConfirmation}
              setValue={setNewPasswordConfirmation}
              leftIcon={<LockOutlined fill={defaultFill} />}
              autoComplete="new-password"
              disabled
            />
          </form>
        </Grid>
      )}
    </div>
  );
};

export default SelectorList;

```

## Archivo: `packages/MainUI/components/ProfileModal/ToggleSection/styles.ts`

```typescript
import type { CSSProperties } from "react";
import { useTheme } from "@mui/material";

type toggleSection = {
  [key: string]: CSSProperties;
};

export const useStyle = () => {
  const theme = useTheme();
  const defaultFill = theme.palette.baselineColor.neutral[60];

  const styles: toggleSection = {
    selectorListStyles: {
      padding: "0rem 1rem 0.75rem 1rem",
    },
    formStyle: {
      margin: "0rem 0rem 1rem 0rem",
    },
    labelStyles: {
      color: theme.palette.baselineColor.neutral[80],
      fontWeight: "600",
    },
    iconStyles: {
      paddingLeft: "0.5rem",
    },
    flagStyles: {
      fontSize: "1rem",
      color: theme.palette.baselineColor.neutral[100],
    },
  };

  return { styles, defaultFill };
};

```

## Archivo: `packages/MainUI/components/ProfileModal/UserProfile.tsx`

```typescript
"use client";

import { useCallback } from "react";
import Image from "next/image";
import { useStyle, TEXT_LOGO } from "./styles";
import BackgroundGradient from "../../../ComponentLibrary/src/assets/images/backgroundGradient.svg?url";
import LogoutIcon from "../../../ComponentLibrary/src/assets/icons/log-out.svg";
import IconButton from "@workspaceui/componentlibrary/src/components/IconButton";
import type { UserProfileProps } from "./types";

const UserProfile: React.FC<UserProfileProps> = ({ photoUrl, name, onSignOff }) => {
  const { styles } = useStyle();

  const handleSignOff = useCallback(() => {
    onSignOff();
  }, [onSignOff]);

  return (
    <div style={styles.userProfileStyles}>
      <div style={styles.svgContainerStyles}>
        <Image
          src={BackgroundGradient}
          height={window.innerHeight}
          width={window.innerWidth}
          alt="Background Gradient"
        />
      </div>
      <div className="absolute top-4 right-4 z-10">
        <IconButton tooltip="Log out" onClick={handleSignOff} className="h-6 w-6 [&>svg]:w-4 [&>svg]:h-4">
          <LogoutIcon />
        </IconButton>
      </div>
      <div style={styles.profileImageContainerStyles}>
        {photoUrl ? (
          <Image
            src={photoUrl}
            height={window.innerHeight}
            width={window.innerWidth}
            alt="Profile"
            style={styles.profileImageStyles}
          />
        ) : (
          <div
            style={{
              ...styles.profileImageStyles,
              ...styles.profileWithoutImage,
            }}>
            {TEXT_LOGO}
          </div>
        )}
      </div>
      {/* <p style={styles.nameStyles}>{name}</p> */}
      <div style={styles.profileDetailsStyles}>
        <p style={styles.emailStyles}>{name}</p>
      </div>
    </div>
  );
};

export default UserProfile;

```

## Archivo: `packages/MainUI/components/ProfileModal/styles.ts`

```typescript
import { type CSSProperties, useMemo } from "react";
import { type SxProps, type Theme, useTheme } from "@mui/material";

export const MODAL_WIDTH = 332;
export const menuSyle = { paddingY: 0 };
export const TEXT_LOGO = "Etendo";

export const useStyle = () => {
  const theme = useTheme();

  return useMemo(
    () => ({
      styles: {
        userProfileStyles: {
          display: "flex",
          flexDirection: "column",
          alignItems: "center",
          borderRadius: "0.75rem",
          background: theme.palette.baselineColor.neutral[0],
          position: "relative",
          overflow: "hidden",
        },
        iconButtonStyles: {
          width: "2.5rem",
          height: "2.5rem",
          color: theme.palette.baselineColor.neutral[80],
        },
        iconStyles: {
          width: "1.25rem",
          height: "1.25rem",
          color: theme.palette.baselineColor.neutral[80],
        },
        profileImageContainerStyles: {
          position: "relative",
          marginTop: "1rem",
          width: "4.5rem",
          height: "4.5rem",
          zIndex: "2",
          borderRadius: "4.5rem",
          border: `4px solid ${theme.palette.baselineColor.neutral[0]}`,
        },

        profileImageStyles: {
          width: "100%",
          height: "100%",
          borderRadius: "50%",
          position: "relative",
          zIndex: 2,
        },
        profileWithoutImage: {
          display: "flex",
          alignItems: "center",
          justifyContent: "center",
          color: theme.palette.baselineColor.neutral[0],
          backgroundColor: theme.palette.baselineColor.neutral[80],
          fontWeight: "bold",
          fontSize: "1rem",
        },
        svgContainerStyles: {
          display: "flex",
          justifyContent: "center",
          position: "absolute",
          zIndex: 1,
        },
        profileDetailsStyles: {
          display: "flex",
          flexDirection: "column",
          alignItems: "center",
          zIndex: 2,
          padding: "0rem 0.5rem",
          background: theme.palette.dynamicColor.light,
          borderRadius: "12.5rem",
          margin: "0.5rem 0",
        },
        nameStyles: {
          margin: 0,
          zIndex: 2,
          padding: "0 0 0.25rem 0",
        },
        emailStyles: {
          margin: 0,
          color: theme.palette.dynamicColor.main,
          zIndex: 2,
        },
        paperStyleMenu: {
          borderRadius: "0.75rem",
        },
        //Toggle Styles
        toggleContainerStyles: {
          display: "flex",
          padding: "0.25rem",
          justifyContent: "space-between",
          alignItems: "center",
          alignSelf: "stretch",
          borderRadius: "12.5rem",
        },
        toggleButtonStyles: {
          height: "2.5rem",
          padding: "0.75rem 1rem",
          cursor: "pointer",
          justifyContent: "center",
          alignItems: "center",
          flex: "1 0 0",
          border: "0px solid",
          borderRadius: "12.5rem",
        },
        toggleSectionStyles: {
          display: "flex",
          padding: "1rem 0.75rem 0.5rem 0.75rem",
          alignItems: "center",
          flexDirection: "column",
          gap: "0.5rem",
        },
        // Button Container
        buttonContainerStyles: {
          display: "flex",
          padding: "0rem 0.75rem 0.75rem 0.75rem",
          justifyContent: "flex-end",
          alignItems: "center",
          gap: "0.5rem",
          flex: "1 0 0",
        },
      } as { [key: string]: CSSProperties },
      sx: {
        buttonStyles: {
          fontWeight: "600",
          fontSize: "0.875rem",
          padding: "0.5rem 1rem",
          cursor: "pointer",
          height: "2.5rem",
          borderRadius: "6.25rem",
          border: `1px solid ${theme.palette.baselineColor.transparentNeutral[20]}`,
          flex: "1 0 0",
          color: theme.palette.baselineColor.transparentNeutral[70],
          background: theme.palette.baselineColor.neutral[0],
          "&:hover": {
            borderRadius: "6.25rem",
            background: theme.palette.dynamicColor.main,
            color: theme.palette.baselineColor.neutral[0],
          },
        },
        saveButtonStyles: {
          fontWeight: "600",
          fontSize: "0.875rem",
          color: theme.palette.baselineColor.neutral[0],
          padding: "0.5rem 1rem",
          background: theme.palette.baselineColor.neutral[100],
          flex: "1 0 0",
          borderRadius: "6.25rem",
          border: `1px solid ${theme.palette.baselineColor.transparentNeutral[80]}`,
          height: "2.5rem",
          transition: "all 0.2s ease-in-out",
          "&:hover": {
            borderRadius: "6.25rem",
            background: theme.palette.dynamicColor.main,
            color: theme.palette.baselineColor.neutral[0],
          },
          "&:disabled": {
            background: theme.palette.baselineColor.neutral[80],
            color: theme.palette.baselineColor.neutral[60],
            border: `1px solid ${theme.palette.baselineColor.transparentNeutral[60]}`,
            opacity: 0.7,
            cursor: "not-allowed",
            boxShadow: "none",
          },
        },
      } as { [key: string]: SxProps<Theme> },
    }),
    [theme]
  );
};

```

## Archivo: `packages/MainUI/components/ProfileModal/types.ts`

```typescript
import type { Logger } from "@/utils/logger";
import type { Option } from "@workspaceui/componentlibrary/src/components/Input/Select/types";
import type { Language } from "@workspaceui/componentlibrary/src/locales/types";
import type {
  CurrentOrganization,
  CurrentRole,
  CurrentWarehouse,
  LoginResponse,
  SessionResponse,
} from "@workspaceui/api-client/src/api/types";
import type { ReactNode } from "react";
import type { Section } from "./ToggleButton/types";

export interface Translations {
  saveAsDefault: string;
}

export interface BaseUser {
  photoUrl: string;
  name: string;
  email: string;
  sectionTooltip: string;
}

export interface BaseRole {
  id: string;
  name: string;
  orgList: Array<{
    id: string;
    name: string;
    warehouseList: Array<{
      id: string;
      name: string;
    }>;
  }>;
}

export interface BaseWarehouse {
  id: string;
  name: string;
}

export interface BaseDefaultConfiguration {
  defaultRole?: string;
  defaultWarehouse?: string;
  organization?: string;
  language?: string;
  client?: string;
}

export interface BaseProfileModalProps {
  icon: string | ReactNode;
  userPhotoUrl: string;
  userName: string;
  userEmail: string;
  sections: Section[];
  section: string;
  translations: Translations;
}

export interface SelectionProps {
  saveAsDefault: boolean;
  onSaveAsDefaultChange: (event: React.ChangeEvent<HTMLInputElement>) => void;
}

export interface ActionProps {
  onChangeRole?: (roleId: string) => Promise<void>;
  onChangeWarehouse?: (warehouseId: string) => Promise<void>;
  onSetDefaultConfiguration: (config: BaseDefaultConfiguration) => Promise<void>;
}

export interface LanguageOption {
  id: string;
  language: string;
  name: string;
}
export interface ProfileModalProps extends BaseProfileModalProps, SelectionProps, ActionProps {
  currentRole: CurrentRole | undefined;
  currentWarehouse: CurrentWarehouse | undefined;
  currentOrganization: CurrentOrganization | undefined;
  roles: SessionResponse["roles"];
  logger: Logger;
  onSignOff: () => void;
  onLanguageChange: (e: Language) => void;
  language: string | null;
  languages: LanguageOption[];
  languagesFlags: string;
  // biome-ignore lint/suspicious/noConfusingVoidType: <explanation>
  changeProfile: (params: { role?: string; warehouse?: string }) => Promise<LoginResponse | void>;
}

export interface UserProfileProps {
  photoUrl: string;
  name: string;
  email: string;
  onSignOff: () => void;
}

export interface SelectorListProps {
  section: string;
  onRoleChange: (event: React.SyntheticEvent<Element, Event>, value: Option | null) => void;
  onWarehouseChange: (event: React.SyntheticEvent<Element, Event>, value: Option | null) => void;
  onOrgChange: (event: React.SyntheticEvent<Element, Event>, value: Option | null) => void;
  roles: SessionResponse["roles"];
  selectedRole: Option | null;
  selectedWarehouse: Option | null;
  selectedClient: Option | null;
  selectedOrg: Option;
  onLanguageChange: (event: React.SyntheticEvent<Element, Event>, value: Option | null) => void;
  selectedLanguage: Option | null;
  languages: Array<{
    id: string;
    language: string;
    name: string;
  }>;
  saveAsDefault: boolean;
  onSaveAsDefaultChange: (event: React.ChangeEvent<HTMLInputElement>) => void;
  translations: Translations;
  languagesFlags: string;
}

```

## Archivo: `packages/MainUI/components/Sidebar.tsx`

```typescript
"use client";

import { useCallback, useEffect, useMemo, useState } from "react";
import { usePathname, useRouter } from "next/navigation";
import { Drawer } from "@workspaceui/componentlibrary/src/components/Drawer/index";
import EtendoLogotype from "../public/etendo.png";
import { useTranslation } from "../hooks/useTranslation";
import { useUserContext } from "../hooks/useUserContext";
import { RecentlyViewed } from "./Drawer/RecentlyViewed";
import type { Menu } from "@workspaceui/api-client/src/api/types";
import { useMenuTranslation } from "../hooks/useMenuTranslation";
import { createSearchIndex, filterItems } from "@workspaceui/componentlibrary/src/utils/searchUtils";
import { useLanguage } from "@/contexts/language";
import { useMultiWindowURL } from "@/hooks/navigation/useMultiWindowURL";
import { useMenu } from "@/hooks/useMenu";

export default function Sidebar() {
  const { t } = useTranslation();
  const { token, currentRole, prevRole } = useUserContext();
  const { language, prevLanguage } = useLanguage();
  const { translateMenuItem } = useMenuTranslation();
  const menu = useMenu(token, currentRole || undefined, language);
  const router = useRouter();
  const pathname = usePathname();

  const { activeWindow, openWindow, buildURL, getNextOrder, windows } = useMultiWindowURL();

  const [searchValue, setSearchValue] = useState("");
  const [expandedItems, setExpandedItems] = useState<Set<string>>(new Set());

  const searchIndex = useMemo(() => createSearchIndex(menu), [menu]);
  const { filteredItems, searchExpandedItems } = useMemo(() => {
    const result = filterItems(menu, searchValue, searchIndex);
    return result;
  }, [menu, searchValue, searchIndex]);

  const handleClick = useCallback(
    (item: Menu) => {
      const windowId = item.windowId ?? "";

      if (!windowId) {
        console.warn("Menu item without windowId:", item);
        return;
      }

      const isInWindowRoute = pathname.includes("window");

      if (isInWindowRoute) {
        openWindow(windowId, item.name);
      } else {
        const newWindow = {
          windowId,
          window_identifier: item.name,
          isActive: true,
          order: getNextOrder(windows),
          title: item.name,
          selectedRecords: {},
          tabFormStates: {},
        };

        const targetURL = buildURL([newWindow]);

        router.push(targetURL);
      }
    },
    [pathname, router, windows, openWindow, buildURL, getNextOrder]
  );

  const searchContext = useMemo(
    () => ({
      searchValue,
      setSearchValue,
      filteredItems,
      searchExpandedItems,
      expandedItems,
      setExpandedItems,
      searchIndex,
    }),
    [expandedItems, filteredItems, searchExpandedItems, searchIndex, searchValue]
  );

  const getTranslatedName = useCallback((item: Menu) => translateMenuItem(item), [translateMenuItem]);

  useEffect(() => {
    if ((prevRole && prevRole?.id !== currentRole?.id) || prevLanguage !== language) {
      setSearchValue("");
    }
  }, [currentRole?.id, language, prevLanguage, prevRole]);

  const currentWindowId = activeWindow?.windowId;

  return (
    <Drawer
      windowId={currentWindowId}
      logo={EtendoLogotype.src}
      title={t("common.etendo")}
      items={menu}
      onClick={handleClick}
      onReportClick={handleClick}
      onProcessClick={handleClick}
      getTranslatedName={getTranslatedName}
      RecentlyViewedComponent={RecentlyViewed}
      searchContext={searchContext}
    />
  );
}

```

## Archivo: `packages/MainUI/components/Table/EmptyState.tsx`

```typescript
import { useTranslation } from "@/hooks/useTranslation";
import type { EntityData } from "@workspaceui/api-client/src/api/types";
import type { MRT_TableInstance } from "material-react-table";

const EmptyState = ({ table, maxWidth }: { table?: MRT_TableInstance<EntityData>; maxWidth?: number }) => {
  const { t } = useTranslation();
  maxWidth = table?.refs.tableContainerRef.current?.clientWidth ?? maxWidth;

  return (
    <span className="text-center py-8" style={{ maxWidth }}>
      <div className="w-16 h-8 text-gray-300" />
      <h3 className="text-lg font-semibold text-gray-700 mb-2">{t("table.labels.emptyRecords")}</h3>
      <p className="text-sm text-gray-500 mb-4">{t("status.noRecords")}</p>
    </span>
  );
};

export default EmptyState;

```

## Archivo: `packages/MainUI/components/Table/TabNavigation/TabContent.tsx`

```typescript
import type { TabContentProps } from "./types";
import ChevronUp from "../../../../ComponentLibrary/src/assets/icons/chevron-up.svg";
import ChevronDown from "../../../../ComponentLibrary/src/assets/icons/chevron-down.svg";
import ChevronUpRight from "../../../../ComponentLibrary/src/assets/icons/chevron-right.svg";
import XCircle from "../../../../ComponentLibrary/src/assets/icons/x.svg";
import IconButton from "@workspaceui/componentlibrary/src/components/IconButton";

export const TabContent: React.FC<TabContentProps> = ({
  identifier,
  type,
  handleFullSize,
  isFullSize,
  isMainTab = false,
  onClose,
}) => {
  return (
    <div className="flex flex-col h-full">
      <div
        data-header
        className={`h-11 min-h-[44px] flex justify-between items-center px-4 rounded-t-xl sticky top-0 z-10 w-full flex-shrink-0 border-b border-[rgba(0,3,13,0.1)] bg-[rgba(0,3,13,0.05)]
          ${isMainTab ? "cursor-default" : "cursor-ns-resize"}`}
        onDoubleClick={isMainTab ? undefined : handleFullSize}>
        <div className="flex items-center overflow-hidden rounded-2xl">
          <div className="flex items-center px-2 rounded-full h-8 flex-shrink-0 bg-[rgba(0,3,13,0.05)] border border-[rgba(0,3,13,0.1)]">
            <p className="text-sm whitespace-nowrap">{type}</p>
          </div>
          <div className="ml-2 min-w-8 overflow-hidden">
            <p className="truncate text-[#00030D] font-semibold text-xl">{identifier}</p>
          </div>
        </div>
        <div className="flex items-center flex-shrink-0">
          {!isMainTab && (
            <IconButton onClick={handleFullSize} className="bg-transparent">
              {isFullSize ? <ChevronDown /> : <ChevronUp />}
            </IconButton>
          )}
          <IconButton className="bg-transparent">
            <ChevronUpRight />
          </IconButton>
          <IconButton onClick={onClose} className="bg-transparent ml-1 text-red-500 hover:text-red-700">
            <XCircle />
          </IconButton>
        </div>
      </div>
    </div>
  );
};

export default TabContent;

```

## Archivo: `packages/MainUI/components/Table/TabNavigation/styles.ts`

```typescript
import { type SxProps, type Theme, useTheme } from "@mui/material";
import { useMemo } from "react";

export const useStyle = () => {
  const theme = useTheme();

  return useMemo(
    () => ({
      sx: {
        paper: {
          position: "absolute",
          bottom: 0,
          borderRadius: "1rem 1rem 0 0",
          transition: "transform 0.3s ease, height 0.3s ease",
          zIndex: 9999,
        },
        resizer: {
          position: "absolute",
          top: 0,
          left: "50%",
          transform: "translateX(-50%)",
          width: "4rem",
          height: "0.5rem",
          backgroundColor: theme.palette.grey[300],
          marginTop: "0.25rem",
          borderRadius: "0.5rem",
          cursor: "ns-resize",
          "&:hover": {
            backgroundColor: theme.palette.grey[400],
          },
        },
        container: {
          overflow: "auto",
          height: "100%",
        },
        //Record Styles
        recordContainer: {
          display: "flex",
          flexDirection: "column",
          cursor: "ns-resize",
        },
        recordContainerItems: {
          display: "flex",
          alignItems: "center",
        },
        recordHeader: {
          height: "2.75rem",
          display: "flex",
          justifyContent: "space-between",
          padding: "1rem",
          borderRadius: "1rem 1rem 0 0",
          border: `1px solid ${theme.palette.baselineColor.transparentNeutral[10]}`,
          background: theme.palette.baselineColor.transparentNeutral[5],
        },
        typeBox: {
          display: "flex",
          alignItems: "center",
          background: theme.palette.baselineColor.transparentNeutral[5],
          border: `1px solid ${theme.palette.baselineColor.transparentNeutral[10]}`,
          padding: "0 0.5rem 0 0.5rem",
          borderRadius: "1.5rem",
          maxHeight: "2rem",
        },
        identifierBox: {
          marginLeft: "0.5rem",
          minWidth: "2rem",
        },
        title: {
          color: theme.palette.baselineColor.neutral[100],
          fontWeight: 600,
          fontSize: "1.25rem",
        },
        iconButton: {
          background: "none",
          "&:hover": {
            background: theme.palette.baselineColor.transparentNeutral[5],
          },
        },
        contentContainer: {
          flexGrow: 1,
          overflowY: "auto",
          height: "100%",
        },
      } as { [key: string]: SxProps<Theme> },
    }),
    [theme]
  );
};

```

## Archivo: `packages/MainUI/components/Table/TabNavigation/types.ts`

```typescript
import type { EntityData, Tab } from "@workspaceui/api-client/src/api/types";

export interface SelectedRecord extends EntityData {}

export type IsMainTab = boolean;

export interface TabProps {
  isOpen: boolean;
  onClose: () => void;
  selectedRecord: SelectedRecord | null;
  noIdentifierLabel?: string;
  noTypeLabel?: string;
  handleFullSize: () => void;
  isFullSize: boolean;
  tab?: Tab;
  childTabs?: Tab[];
  windowId?: string;
  isMainTab?: IsMainTab;
}

export interface TabContentProps {
  identifier: string | null;
  type: string | null;
  onClose: () => void;
  handleFullSize: () => void;
  isFullSize: boolean;
  tab?: Tab;
  selectedRecord?: SelectedRecord;
  isMainTab?: IsMainTab;
}

```

## Archivo: `packages/MainUI/components/Table/index.tsx`

```typescript
import {
  MaterialReactTable,
  type MRT_ColumnFiltersState,
  type MRT_Row,
  useMaterialReactTable,
  type MRT_TableBodyRowProps,
  type MRT_TableInstance,
  type MRT_VisibilityState,
} from "material-react-table";
import { useStyle } from "./styles";
import type { DatasourceOptions, EntityData } from "@workspaceui/api-client/src/api/types";
import { useCallback, useEffect, useMemo, useRef, useState } from "react";
import { useSearch } from "../../contexts/searchContext";
import ColumnVisibilityMenu from "../Toolbar/Menus/ColumnVisibilityMenu";
import { useDatasourceContext } from "@/contexts/datasourceContext";
import EmptyState from "./EmptyState";
import { useToolbarContext } from "@/contexts/ToolbarContext";
import { useLanguage } from "@/contexts/language";
import useTableSelection from "@/hooks/useTableSelection";
import { ErrorDisplay } from "../ErrorDisplay";
import { useTranslation } from "@/hooks/useTranslation";
import { useTabContext } from "@/contexts/tab";
import { useDatasource } from "@/hooks/useDatasource";
import { useSelected } from "@/hooks/useSelected";
import { useColumns } from "@/hooks/table/useColumns";

type RowProps = (props: {
  isDetailPanel?: boolean;
  row: MRT_Row<EntityData>;
  table: MRT_TableInstance<EntityData>;
}) => Omit<MRT_TableBodyRowProps<EntityData>, "staticRowIndex">;

const getRowId = (row: EntityData) => String(row.id);
interface DynamicTableProps {
  setRecordId: React.Dispatch<React.SetStateAction<string>>;
  onRecordSelection?: (recordId: string) => void;
}

const DynamicTable = ({ setRecordId, onRecordSelection }: DynamicTableProps) => {
  const { sx } = useStyle();
  const { searchQuery } = useSearch();
  const { language } = useLanguage();
  const { t } = useTranslation();
  const [columnFilters, setColumnFilters] = useState<MRT_ColumnFiltersState>([]);
  const [columnVisibility, setColumnVisibility] = useState<MRT_VisibilityState>({});
  const [columnMenuAnchor, setColumnMenuAnchor] = useState<HTMLElement | null>(null);
  const { graph } = useSelected();

  const toggleColumnsDropdown = useCallback(
    (buttonRef?: HTMLElement | null) => {
      if (columnMenuAnchor) {
        setColumnMenuAnchor(null);
      } else {
        setColumnMenuAnchor(buttonRef || null);
      }
    },
    [columnMenuAnchor]
  );

  const handleCloseColumnMenu = useCallback(() => {
    setColumnMenuAnchor(null);
  }, []);
  const { registerDatasource, unregisterDatasource, registerRefetchFunction } = useDatasourceContext();
  const { registerActions } = useToolbarContext();
  const { tab, parentTab, parentRecord, parentRecords } = useTabContext();
  const tabId = tab.id;
  const parentId = String(parentRecord?.id ?? "");
  const tableContainerRef = useRef<HTMLDivElement>(null);

  const clickTimeoutsRef = useRef<Map<string, ReturnType<typeof setTimeout>>>(new Map());

  const columns = useColumns(tab);

  const query: DatasourceOptions = useMemo(() => {
    const fieldName = tab.parentColumns[0] || "id";
    const value = parentId;
    const operator = "equals";

    const options: DatasourceOptions = {
      windowId: tab.window,
      tabId: tab.id,
      isImplicitFilterApplied: tab.hqlfilterclause?.length > 0 || tab.sQLWhereClause?.length > 0,
      pageSize: 100,
    };

    if (language) {
      options.language = language;
    }

    if (value && value !== "" && value !== undefined) {
      options.criteria = [
        {
          fieldName,
          value,
          operator,
        },
      ];
    }
    return options;
  }, [
    tab.parentColumns,
    tab.window,
    tab.id,
    tab.hqlfilterclause?.length,
    tab.sQLWhereClause?.length,
    parentId,
    language,
  ]);

  const {
    updateColumnFilters,
    toggleImplicitFilters,
    fetchMore,
    records,
    removeRecordLocally,
    error,
    refetch,
    loading,
    hasMoreRecords,
  } = useDatasource({
    entity: tab.entityName,
    params: query,
    columns,
    searchQuery,
    skip: parentTab ? Boolean(!parentRecord || (parentRecords && parentRecords.length !== 1)) : false,
  });

  const handleColumnFiltersChange = useCallback(
    (updaterOrValue: MRT_ColumnFiltersState | ((prev: MRT_ColumnFiltersState) => MRT_ColumnFiltersState)) => {
      let isRealFilterChange = false;

      setColumnFilters((columnFilters) => {
        let newColumnFilters: MRT_ColumnFiltersState;

        if (typeof updaterOrValue === "function") {
          newColumnFilters = updaterOrValue(columnFilters);
        } else {
          newColumnFilters = updaterOrValue;
        }

        isRealFilterChange =
          JSON.stringify(newColumnFilters.map((f) => ({ id: f.id, value: f.value }))) !==
          JSON.stringify(columnFilters.map((f) => ({ id: f.id, value: f.value })));

        if (isRealFilterChange) {
          updateColumnFilters(newColumnFilters);
        }

        return newColumnFilters;
      });
    },
    [updateColumnFilters]
  );

  const handleTableSelectionChange = useCallback(
    (recordId: string) => {
      if (onRecordSelection) {
        onRecordSelection(recordId);
      }
    },
    [onRecordSelection]
  );

  const rowProps = useCallback<RowProps>(
    ({ row, table }) => {
      const record = row.original as Record<string, never>;
      const isSelected = row.getIsSelected();
      const rowId = String(record.id);

      return {
        onClick: (event) => {
          const existingTimeout = clickTimeoutsRef.current.get(rowId);
          if (existingTimeout) {
            clearTimeout(existingTimeout);
            clickTimeoutsRef.current.delete(rowId);
          }

          const timeout = setTimeout(() => {
            if (!event.ctrlKey) {
              table.setRowSelection({});
            }
            row.toggleSelected();
            clickTimeoutsRef.current.delete(rowId);
          }, 250);

          clickTimeoutsRef.current.set(rowId, timeout);
        },

        onDoubleClick: (event) => {
          event.stopPropagation();

          const timeout = clickTimeoutsRef.current.get(rowId);
          if (timeout) {
            clearTimeout(timeout);
            clickTimeoutsRef.current.delete(rowId);
          }

          const parent = graph.getParent(tab);
          const parentSelection = parent ? graph.getSelected(parent) : undefined;

          if (!isSelected) {
            row.toggleSelected();
          }

          graph.setSelected(tab, row.original);

          if (parent && parentSelection) {
            setTimeout(() => graph.setSelected(parent, parentSelection), 10);
          }
          setRecordId(record.id);
        },

        sx: {
          ...(isSelected && {
            ...sx.rowSelected,
          }),
        },
        row,
        table,
      };
    },
    [graph, setRecordId, sx.rowSelected, tab]
  );

  const renderEmptyRowsFallback = useCallback(
    ({ table }: { table: MRT_TableInstance<EntityData> }) => <EmptyState table={table} />,
    []
  );

  const fetchMoreOnBottomReached = useCallback(
    (event: React.UIEvent<HTMLDivElement>) => {
      const containerRefElement = event.target as HTMLDivElement;

      if (containerRefElement) {
        const { scrollHeight, scrollTop, clientHeight } = containerRefElement;
        if (scrollHeight - scrollTop - clientHeight < 10 && !loading && hasMoreRecords) {
          fetchMore();
        }
      }
    },
    [fetchMore, hasMoreRecords, loading]
  );

  const table = useMaterialReactTable<EntityData>({
    muiTablePaperProps: { sx: sx.tablePaper },
    muiTableHeadCellProps: { sx: sx.tableHeadCell },
    muiTableBodyCellProps: { sx: sx.tableBodyCell },
    muiTableBodyProps: { sx: sx.tableBody },
    layoutMode: "semantic",
    enableGlobalFilter: false,
    columns,
    data: records,
    enableRowSelection: true,
    enableMultiRowSelection: true,
    positionToolbarAlertBanner: "none",
    muiTableBodyRowProps: rowProps,
    muiTableContainerProps: {
      ref: tableContainerRef,
      sx: { flex: 1, height: "100%", maxHeight: "100%" },
      onScroll: fetchMoreOnBottomReached,
    },
    enablePagination: false,
    enableStickyHeader: true,
    enableColumnVirtualization: true,
    enableRowVirtualization: true,
    enableTopToolbar: false,
    enableBottomToolbar: false,
    enableHiding: true,
    initialState: { density: "compact" },
    state: {
      columnFilters,
      columnVisibility,
      showColumnFilters: true,
      showProgressBars: loading,
    },
    onColumnFiltersChange: handleColumnFiltersChange,
    onColumnVisibilityChange: setColumnVisibility,
    getRowId,
    enableColumnFilters: true,
    enableSorting: true,
    enableColumnResizing: true,
    enableColumnActions: true,
    manualFiltering: true,
    renderEmptyRowsFallback,
  });

  useTableSelection(tab, records, table.getState().rowSelection, handleTableSelectionChange);

  useEffect(() => {
    const handleGraphClear = (eventTab: typeof tab) => {
      if (eventTab.id === tab.id) {
        const currentSelection = table.getState().rowSelection;
        const hasTableSelection = Object.keys(currentSelection).some((id) => currentSelection[id]);

        if (hasTableSelection) {
          table.resetRowSelection(true);
        }
      }
    };

    graph.addListener("unselected", handleGraphClear);
    graph.addListener("unselectedMultiple", handleGraphClear);

    return () => {
      graph.removeListener("unselected", handleGraphClear);
      graph.removeListener("unselectedMultiple", handleGraphClear);
    };
  }, [graph, table, tabId]);

  useEffect(() => {
    if (removeRecordLocally) {
      registerDatasource(tabId, removeRecordLocally);
    }

    registerRefetchFunction(tabId, refetch);

    return () => {
      unregisterDatasource(tabId);
    };
  }, [tabId, removeRecordLocally, registerDatasource, unregisterDatasource, registerRefetchFunction, refetch]);

  useEffect(() => {
    registerActions({
      refresh: refetch,
      filter: toggleImplicitFilters,
      save: async () => {},
      columnFilters: toggleColumnsDropdown,
    });
  }, [refetch, registerActions, toggleImplicitFilters, toggleColumnsDropdown]);

  if (error) {
    return (
      <ErrorDisplay title={t("errors.tableError.title")} description={error?.message} showRetry onRetry={refetch} />
    );
  }

  if (parentTab && !parentRecord) {
    return (
      <div className="h-full flex items-center justify-center text-gray-500">
        <div className="text-center">
          <div className="text-lg mb-2">{t("errors.selectionError.title")}</div>
          <div className="text-sm">{t("errors.selectionError.description")}</div>
        </div>
      </div>
    );
  }

  return (
    <div
      className={`h-full overflow-hidden rounded-3xl transition-opacity ${
        loading ? "opacity-60 cursor-progress cursor-to-children" : "opacity-100"
      }`}>
      <MaterialReactTable table={table} />

      <ColumnVisibilityMenu anchorEl={columnMenuAnchor} onClose={handleCloseColumnMenu} table={table} />
    </div>
  );
};

export default DynamicTable;

```

## Archivo: `packages/MainUI/components/Table/styles.ts`

```typescript
import { type SxProps, type Theme, useTheme } from "@mui/material";
import { useMemo } from "react";

type StylesType = {
  sx: Record<string, SxProps<Theme>>;
};

export const useStyle = (): StylesType => {
  const theme = useTheme();

  return useMemo(
    () => ({
      sx: {
        tablePaper: {
          display: "flex",
          flexDirection: "column",
          flex: 1,
          minHeight: 0,
          height: "100%",
          maxHeight: "100%",
        },
        tableHeadCell: {
          whiteSpace: "nowrap",
          textOverflow: "ellipsis",
          borderRight: `1px solid ${theme.palette.divider}`,
          background: theme.palette.baselineColor.transparentNeutral[5],
          fontWeight: "bold",
          color: theme.palette.text.primary,
          "&:last-child": {
            borderRight: "none",
          },
          "& .MuiBox-root": {
            whiteSpace: "nowrap",
          },
        },
        tableBodyCell: {
          borderRight: `1px solid ${theme.palette.divider}`,
          "&:first-of-type": {
            textAlign: "center",
          },
        },
        tableBody: {
          "& tr": {
            backgroundColor: theme.palette.background.paper,
          },
          cursor: "pointer",
        },
        // multiselect
        multiSelectContainer: {
          display: "flex",
        },
        rowSelected: {
          cursor: "pointer",
          backgroundColor: `${theme.palette.baselineColor.neutral[20]} !important`,
          "&:hover": {
            backgroundColor: `${theme.palette.baselineColor.neutral[10]} !important`,
          },
        },
        contentContainer: {
          flex: 1,
        },
        titleContainer: {
          margin: "0.5rem",
        },
        selectedContainer: {
          borderRadius: "0.25rem 0 0 0.25rem",
          minHeight: "8rem",
          maxHeight: "8rem",
          overflow: "auto",
          background: theme.palette.baselineColor.neutral[20],
          borderBottom: `1px solid ${theme.palette.divider}`,
        },
        selectedItem: {
          display: "flex",
          justifyContent: "space-between",
          alignItems: "center",
          padding: "0.5rem 0.75rem",
          borderBottom: `1px solid ${theme.palette.baselineColor.neutral[10]}`,
        },
        selectedItemHover: {
          backgroundColor: theme.palette.baselineColor.neutral[5],
        },
        emptyState: {
          display: "flex",
          justifyContent: "center",
          alignItems: "center",
          height: "100%",
          color: theme.palette.baselineColor.neutral[100],
        },
        searchBarBase: {
          display: "flex",
          flexDirection: "column",
          alignItems: "center",
          justifyContent: "space-between",
          minWidth: "2rem",
          maxHeight: "8rem",
          borderRadius: "0 0.25rem 0.25rem 0",
          padding: "0.5rem 0.75rem",
          marginTop: "1.5rem",
          color: theme.palette.baselineColor.neutral[0],
          background: theme.palette.baselineColor.neutral[50],
        },
        clearButton: {
          background: theme.palette.baselineColor.neutral[10],
        },
        clearButtonHover: {
          background: theme.palette.baselineColor.neutral[50],
        },
        dialogContent: {
          padding: "1rem",
        },
      },
    }),
    [theme]
  );
};

```

## Archivo: `packages/MainUI/components/Table/top-toolbar/index.tsx`

```typescript
import { FilterAlt, FilterAltOff } from "@mui/icons-material";
import useStyle from "./styles";
import { Box, Button, Chip, Stack, Typography } from "@mui/material";
import { useTranslation } from "@/hooks/useTranslation";
import { useCallback, useMemo } from "react";
import type { MRT_TableInstance } from "material-react-table";
import type { EntityData } from "@workspaceui/api-client/src/api/types";

export default function TopToolbar({
  filterActive,
  toggleFilter,
  table,
}: {
  filterActive: boolean;
  toggleFilter: () => void;
  table: MRT_TableInstance<EntityData>;
}) {
  const styles = useStyle();
  const { t } = useTranslation();
  const label = t(filterActive ? "table.tooltips.implicitFilterOn" : "table.tooltips.implicitFilterOff");
  const rowSelection = table.getState().rowSelection;
  const selectedCount = useMemo(() => Object.keys(rowSelection).length, [rowSelection]);
  const selectionLabel = t(selectedCount === 1 ? "table.selection.single" : "table.selection.multiple");
  const handleClearSelection = useCallback(() => table.setRowSelection({}), [table]);

  return (
    <div className="flex justify-between items-center border-b border-b-transparent-neutral-10">
      <div>
        {selectedCount > 0 && (
          <Stack direction="row" spacing={1} alignItems="center" pl={1}>
            <Chip label={`${selectedCount} ${selectionLabel}`} color="primary" />
            <Button size="small" onClick={handleClearSelection} variant="outlined">
              {t("common.clear")}
            </Button>
          </Stack>
        )}
      </div>
      <Box sx={styles.container} onClick={toggleFilter} className="cursor-pointer">
        <Typography aria-label={label}>{label}</Typography>
        {filterActive ? <FilterAlt sx={styles.icon} /> : <FilterAltOff sx={styles.icon} />}
      </Box>
    </div>
  );
}

```

## Archivo: `packages/MainUI/components/Table/top-toolbar/styles.ts`

```typescript
import { css, useTheme } from "@mui/material";
import { useMemo } from "react";

export const useStyle = () => {
  const theme = useTheme();

  return useMemo(
    () => ({
      container: css({
        display: "flex",
        alignItems: "center",
        justifyContent: "space-between",
      }),
      icon: css({
        cursor: "pointer",
        margin: theme.spacing(1),
      }),
    }),
    [theme]
  );
};

export default useStyle;

```

## Archivo: `packages/MainUI/components/Toolbar/Menus/ColumnVisibilityMenu.tsx`

```typescript
"use client";

import type { ToggleableItem } from "@workspaceui/componentlibrary/src/components/DragModal/DragModal.types";
import type { MRT_TableInstance, MRT_RowData } from "material-react-table";
import { useTranslation } from "@/hooks/useTranslation";
import { useMemo, useState, useCallback } from "react";
import Menu from "@workspaceui/componentlibrary/src/components/Menu";
import DragModalContent from "@workspaceui/componentlibrary/src/components/DragModal/DragModalContent";

interface ColumnVisibilityMenuProps<T extends MRT_RowData = MRT_RowData> {
  anchorEl: HTMLElement | null;
  onClose: () => void;
  table: MRT_TableInstance<T>;
}

const ColumnVisibilityMenu = <T extends MRT_RowData = MRT_RowData>({
  anchorEl,
  onClose,
  table,
}: ColumnVisibilityMenuProps<T>) => {
  const { t } = useTranslation();

  // Convert table columns to ToggleableItem format
  const columnItems = useMemo<ToggleableItem[]>(() => {
    return table
      .getAllLeafColumns()
      .filter((column) => column.columnDef.enableHiding !== false)
      .map((column) => ({
        id: column.id,
        label: typeof column.columnDef.header === "string" ? column.columnDef.header : column.id,
        isActive: column.getIsVisible(),
      }));
  }, [table]);

  const [items, setItems] = useState<ToggleableItem[]>(columnItems);

  // Update items when columns change
  useMemo(() => {
    setItems(columnItems);
  }, [columnItems]);

  const handleBack = useCallback(() => {
    onClose();
  }, [onClose]);

  // Sync changes back to the table when items change
  useMemo(() => {
    for (const item of items) {
      const column = table.getAllLeafColumns().find((col) => col.id === item.id);
      if (column && column.getIsVisible() !== item.isActive) {
        column.toggleVisibility();
      }
    }
  }, [items, table]);

  return (
    <Menu anchorEl={anchorEl} onClose={onClose} className="w-80">
      <DragModalContent
        items={items}
        setItems={setItems}
        onBack={handleBack}
        backButtonText={t("common.close")}
        activateAllText={t("navigation.waterfall.activateAll")}
        deactivateAllText={t("navigation.waterfall.deactivateAll")}
        buttonText={t("table.tooltips.columns")}
      />
    </Menu>
  );
};

export default ColumnVisibilityMenu;

```

## Archivo: `packages/MainUI/components/Toolbar/Menus/ProcessMenu.tsx`

```typescript
"use client";

import useDisplayLogic from "@/hooks/useDisplayLogic";
import Menu from "@workspaceui/componentlibrary/src/components/Menu";
import { useCallback } from "react";
import type { ProcessButton } from "../../ProcessModal/types";
import { isProcessActionButton } from "../../ProcessModal/types";
import type { ProcessMenuProps } from "../types";

interface ProcessMenuItemProps {
  button: ProcessButton;
  onProcessClick: (button: ProcessButton) => void;
  disabled: boolean;
}

const ProcessMenuItem = ({ button, onProcessClick, disabled }: ProcessMenuItemProps) => {
  const isDisplayed = useDisplayLogic({ field: button });

  const handleClick = useCallback(() => {
    onProcessClick(button);
  }, [button, onProcessClick]);

  if (!isDisplayed) {
    return null;
  }

  return (
    <div
      onClick={disabled ? undefined : handleClick}
      className="cursor-pointer rounded-lg p-2 transition hover:bg-(--color-baseline-20)"
      onKeyDown={(e) => {
        if (e.key === "Enter" || e.key === " ") {
          e.preventDefault();
          handleClick();
        }
      }}>
      {button.name}
    </div>
  );
};

ProcessMenuItem.displayName = "ProcessMenuItem";

const ProcessDefinitionMenuItem = ({ button, onProcessClick, disabled }: ProcessMenuItemProps) => {
  const isDisplayed = useDisplayLogic({ field: button as ProcessButton });

  const handleClick = useCallback(() => {
    onProcessClick(button);
  }, [button, onProcessClick]);

  if (!isDisplayed) {
    return null;
  }

  return (
    <div
      onClick={disabled ? undefined : handleClick}
      className="cursor-pointer rounded-lg p-2 transition hover:bg-(--color-baseline-20)"
      onKeyDown={(e) => {
        if (e.key === "Enter" || e.key === " ") {
          e.preventDefault();
          handleClick();
        }
      }}>
      {button.name}
    </div>
  );
};

const ProcessMenu: React.FC<ProcessMenuProps> = ({
  anchorEl,
  onClose,
  processButtons,
  onProcessClick,
  selectedRecord,
}) => {
  return (
    <Menu anchorEl={anchorEl} onClose={onClose} className="rounded-xl">
      <div className="rounded-2xl px-2 py-4">
        {processButtons.map((button: ProcessButton, index: number) =>
          isProcessActionButton(button) ? (
            <ProcessMenuItem
              key={`${button.id}-${index}`}
              button={button}
              onProcessClick={onProcessClick}
              disabled={!selectedRecord}
            />
          ) : (
            <ProcessDefinitionMenuItem
              key={`${button.id}-${index}`}
              button={button}
              onProcessClick={onProcessClick}
              disabled={!selectedRecord}
            />
          )
        )}
      </div>
    </Menu>
  );
};

export default ProcessMenu;

```

## Archivo: `packages/MainUI/components/Toolbar/SearchPortal/index.tsx`

```typescript
import type React from "react";
import { useCallback } from "react";
import { Box, Portal } from "@mui/material";
import TextInputAutocomplete from "@workspaceui/componentlibrary/src/components/Input/TextInput/TextInputAutocomplete";
import { useStyle } from "./styles";
import type { SearchPortalProps } from "../types";

const SearchPortal: React.FC<SearchPortalProps> = ({
  isOpen,
  searchValue,
  onSearchChange,
  onClose,
  placeholder,
  autoCompleteTexts = [],
}) => {
  const { styles } = useStyle();

  const handleKeyDown = useCallback(
    (e: React.KeyboardEvent<HTMLInputElement>) => {
      if (e.key === "Escape") {
        onClose();
        onSearchChange("");
      } else if (e.key === "Enter") {
        onClose();
      }
    },
    [onClose, onSearchChange]
  );

  const handleBlur = useCallback((): void => {
    onClose();
  }, [onClose]);

  if (!isOpen) return null;

  return (
    <Portal>
      <Box sx={styles.portal}>
        <TextInputAutocomplete
          value={searchValue}
          setValue={onSearchChange}
          placeholder={placeholder}
          autoCompleteTexts={autoCompleteTexts}
          onKeyDown={handleKeyDown}
          onBlur={handleBlur}
          autoFocus={true}
        />
      </Box>
    </Portal>
  );
};

export default SearchPortal;

```

## Archivo: `packages/MainUI/components/Toolbar/SearchPortal/styles.ts`

```typescript
import { useMemo } from "react";
import { useTheme } from "@mui/material";

export const useStyle = () => {
  const theme = useTheme();

  return useMemo(
    () => ({
      styles: {
        portal: {
          position: "fixed",
          top: "5.5rem",
          right: "0.5rem",
          backgroundColor: theme.palette.baselineColor.neutral[0],
          boxShadow: "0 4px 6px -1px rgb(0 0 0 / 0.1)",
          borderRadius: "1.5rem",
          padding: "0.25rem",
          width: "20rem",
          zIndex: 9999,
        },
      },
    }),
    [theme]
  );
};

```

## Archivo: `packages/MainUI/components/Toolbar/Toolbar.tsx`

```typescript
import { useDatasourceContext } from "@/contexts/datasourceContext";
import { useTabContext } from "@/contexts/tab";
import type { ToolbarButtonMetadata } from "@/hooks/Toolbar/types";
import { useSelected } from "@/hooks/useSelected";
import { useSelectedRecord } from "@/hooks/useSelectedRecord";
import { useSelectedRecords } from "@/hooks/useSelectedRecords";
import { EMPTY_ARRAY } from "@/utils/defaults";
import StatusModal from "@workspaceui/componentlibrary/src/components/StatusModal";
import ConfirmModal from "@workspaceui/componentlibrary/src/components/StatusModal/ConfirmModal";
import type React from "react";
import { useCallback, useMemo, useState } from "react";
import { useProcessButton } from "../../hooks/Toolbar/useProcessButton";
import { useProcessExecution } from "../../hooks/Toolbar/useProcessExecution";
import { useToolbar } from "../../hooks/Toolbar/useToolbar";
import { useToolbarConfig } from "../../hooks/Toolbar/useToolbarConfig";
import { useTranslation } from "../../hooks/useTranslation";
import ProcessIframeModal from "../ProcessModal/Iframe";
import ProcessDefinitionModal from "../ProcessModal/ProcessDefinitionModal";
import {
  type ProcessButton,
  ProcessButtonType,
  type ProcessDefinitionButton,
  type ProcessResponse,
} from "../ProcessModal/types";
import ProcessMenu from "./Menus/ProcessMenu";
import SearchPortal from "./SearchPortal";
import TopToolbar from "./TopToolbar/TopToolbar";
import { createButtonByType, getButtonStyles, organizeButtonsBySection } from "@/utils/toolbar/utils";
import { createProcessMenuButton } from "@/utils/toolbar/process-button/utils";
import type { ToolbarProps } from "./types";
import type { Tab } from "@workspaceui/api-client/src/api/types";

const BaseSection = { display: "flex", alignItems: "center" };

const ToolbarCmp: React.FC<ToolbarProps> = ({ windowId, isFormView = false }) => {
  const [openIframeModal, setOpenIframeModal] = useState(false);
  const [showProcessDefinitionModal, setShowProcessDefinitionModal] = useState(false);
  const [processResponse, setProcessResponse] = useState<ProcessResponse | null>(null);
  const [selectedProcessActionButton, setSelectedProcessActionButton] = useState<ProcessButton | null>(null);
  const [selectedProcessDefinitionButton, setSelectedProcessDefinitionButton] =
    useState<ProcessDefinitionButton | null>(null);

  const [activeModal, setActiveModal] = useState<{
    button: ToolbarButtonMetadata;
    isOpen: boolean;
  } | null>(null);

  const { refetchDatasource } = useDatasourceContext();
  const { tab, parentTab, parentRecord, hasFormChanges } = useTabContext();
  const { buttons, processButtons, loading, refetch } = useToolbar(windowId, tab?.id);
  const { graph } = useSelected();
  const { executeProcess } = useProcessExecution();
  const { t } = useTranslation();
  const selectedParentItems = useSelectedRecords(parentTab as Tab);

  const [anchorEl, setAnchorEl] = useState<HTMLElement | null>(null);

  const selectedRecord = useSelectedRecord(tab);
  const hasParentTab = !!tab?.parentTabId;
  const parentId = parentRecord?.id?.toString();

  const {
    handleAction,
    searchOpen,
    setSearchOpen,
    handleSearch,
    searchValue,
    setSearchValue,
    statusModal,
    confirmAction,
    handleConfirm,
    handleCancelConfirm,
    hideStatusModal,
  } = useToolbarConfig({ windowId, tabId: tab?.id, parentId, isFormView });

  const { handleProcessClick } = useProcessButton(executeProcess, refetch);

  const handleMenuToggle = useCallback(
    (event: React.MouseEvent<HTMLButtonElement>) => {
      if (!anchorEl) {
        setAnchorEl(event.currentTarget);
      } else {
        setAnchorEl(null);
      }
    },
    [anchorEl]
  );

  const handleMenuClose = useCallback(() => {
    setAnchorEl(null);
  }, []);

  const handleProcessMenuClick = useCallback(
    async (button: ProcessButton) => {
      if (!selectedRecord) return;

      if (ProcessButtonType.PROCESS_ACTION in button) {
        const response = await handleProcessClick(button, String(selectedRecord.id));
        setProcessResponse(response);
        setSelectedProcessActionButton(button);
        setOpenIframeModal(true);
      } else if (ProcessButtonType.PROCESS_DEFINITION in button) {
        setSelectedProcessDefinitionButton(button);
        setShowProcessDefinitionModal(true);
      } else {
        throw new Error("Unknown process type");
      }

      handleMenuClose();
    },
    [handleMenuClose, handleProcessClick, selectedRecord]
  );

  const handleSearchChange = useCallback(
    (value: string) => {
      setSearchValue(value);
      handleSearch(value);
    },
    [handleSearch, setSearchValue]
  );

  const handleProcessSuccess = useCallback(() => {
    refetchDatasource(tab.id);
    graph.clearSelected(tab);
  }, [graph, refetchDatasource, tab]);

  const handleCloseProcess = useCallback(() => {
    setOpenIframeModal(false);
    setProcessResponse(null);
    setSelectedProcessActionButton(null);
  }, []);

  const handleCloseProcessDefinitionModal = useCallback(() => {
    setShowProcessDefinitionModal(false);
    setSelectedProcessDefinitionButton(null);
  }, []);

  const handleCompleteRefresh = useCallback(async () => {
    graph.clearSelected(tab);
    refetchDatasource(tab.id);
  }, [graph, refetchDatasource, tab]);

  const handleCloseSearch = useCallback(() => setSearchOpen(false), [setSearchOpen]);

  const handleCloseStatusModal = useCallback(() => setActiveModal(null), []);

  const toolbarConfig = useMemo(() => {
    const organizedButtons = organizeButtonsBySection(buttons, isFormView);
    const hasSelectedRecord = !!selectedRecord?.id;
    const hasParentRecordSelected = !hasParentTab || selectedParentItems.length === 1;

    const createSectionButtons = (sectionButtons: ToolbarButtonMetadata[]) =>
      sectionButtons.map((button) => {
        const config = createButtonByType({
          button,
          onAction: handleAction,
          isFormView,
          hasFormChanges,
          hasSelectedRecord,
          hasParentRecordSelected,
        });

        const styles = getButtonStyles(button);
        if (styles) {
          config.className = config.className ? `${config.className} ${styles}` : styles;
        }

        return config;
      });

    const config = {
      leftSection: {
        buttons: createSectionButtons(organizedButtons.left),
        style: { ...BaseSection, gap: "0.25rem" },
      },
      centerSection: {
        buttons: createSectionButtons(organizedButtons.center),
        style: { ...BaseSection, gap: "0.25rem" },
      },
      rightSection: {
        buttons: createSectionButtons(organizedButtons.right),
        style: { ...BaseSection, gap: "0.25rem" },
      },
      processButton: createProcessMenuButton(processButtons.length, hasSelectedRecord, handleMenuToggle, t, anchorEl),
      isItemSelected: hasSelectedRecord,
    };

    return config;
  }, [
    buttons,
    isFormView,
    selectedRecord?.id,
    processButtons.length,
    t,
    handleAction,
    handleMenuToggle,
    anchorEl,
    hasParentTab,
    selectedParentItems,
    hasFormChanges,
  ]);

  if (loading) return null;

  return (
    <>
      <TopToolbar {...toolbarConfig} />
      {activeModal && (
        <StatusModal
          open={activeModal.isOpen}
          statusText={`Modal para: ${activeModal.button.name}`}
          statusType="info"
          saveLabel="Cerrar"
          onClose={handleCloseStatusModal}
        />
      )}
      {statusModal.open && (
        <StatusModal
          open={statusModal.open}
          statusText={statusModal.statusText}
          statusType={statusModal.statusType}
          errorMessage={statusModal.errorMessage}
          saveLabel={statusModal.saveLabel || t("common.close")}
          secondaryButtonLabel={statusModal.secondaryButtonLabel}
          onClose={hideStatusModal}
        />
      )}
      {confirmAction && (
        <ConfirmModal
          open={!!confirmAction}
          confirmText={confirmAction.confirmText}
          onConfirm={handleConfirm}
          onCancel={handleCancelConfirm}
          saveLabel={confirmAction.saveLabel || t("common.confirm")}
          secondaryButtonLabel={confirmAction.secondaryButtonLabel || t("common.cancel")}
        />
      )}
      {processButtons.length > 0 && (
        <ProcessMenu
          anchorEl={anchorEl}
          onClose={handleMenuClose}
          processButtons={processButtons}
          onProcessClick={handleProcessMenuClick}
          selectedRecord={selectedRecord}
        />
      )}
      {searchOpen && !isFormView && (
        <SearchPortal
          isOpen={searchOpen}
          searchValue={searchValue}
          onSearchChange={handleSearchChange}
          onClose={handleCloseSearch}
          placeholder={t("table.placeholders.search")}
          autoCompleteTexts={EMPTY_ARRAY}
        />
      )}
      <ProcessIframeModal
        isOpen={openIframeModal}
        onClose={handleCloseProcess}
        url={processResponse?.iframeUrl}
        title={selectedProcessActionButton?.name}
        onProcessSuccess={handleProcessSuccess}
        tabId={tab.id}
      />
      <ProcessDefinitionModal
        open={showProcessDefinitionModal}
        onClose={handleCloseProcessDefinitionModal}
        button={selectedProcessDefinitionButton}
        onSuccess={handleCompleteRefresh}
        onError={handleCompleteRefresh}
      />
    </>
  );
};

export const Toolbar = ToolbarCmp;
export default Toolbar;

```

## Archivo: `packages/MainUI/components/Toolbar/ToolbarSection/index.tsx`

```typescript
import type { ToolbarSectionConfig } from "../types";
import IconButton from "@workspaceui/componentlibrary/src/components/IconButton";
import IconButtonWithText from "@workspaceui/componentlibrary/src/components/IconButtonWithText";
import {
  FILLED_BUTTON_TYPE,
  OUTLINED_BUTTON_TYPE,
} from "@workspaceui/componentlibrary/src/components/IconButtonWithText/constants";

const ToolbarSection: React.FC<ToolbarSectionConfig> = ({ buttons, style = {}, className = "", processButton }) => {
  if (!buttons.length) return null;

  return (
    <div style={style} className={className}>
      {buttons.map(({ key, icon, iconText, tooltip, onClick, disabled, className }) => {
        if (iconText) {
          return (
            <IconButtonWithText
              key={key}
              buttonType={FILLED_BUTTON_TYPE}
              leftIcon={icon}
              text={iconText}
              onClick={onClick}
              disabled={disabled}
              customContainerStyles={className}
            />
          );
        }
        return (
          <IconButton
            key={key}
            tooltip={tooltip}
            onClick={onClick}
            disabled={disabled}
            className={className}
            iconText={iconText}>
            {icon}
          </IconButton>
        );
      })}
      {processButton && !processButton.disabled && (
        <div className="h-full flex items-center">
          <div className="h-5 w-0.5 bg-[var(--color-transparent-neutral-20)] mx-0.5" />
          <IconButtonWithText
            buttonType={OUTLINED_BUTTON_TYPE}
            leftIcon={processButton.leftIcon}
            rightIcon={processButton.rightIcon}
            text={processButton.text}
            onClick={processButton.onClick}
            disabled={processButton.disabled}
            customContainerStyles={processButton.customContainerStyles}
          />
        </div>
      )}
    </div>
  );
};

export default ToolbarSection;

```

## Archivo: `packages/MainUI/components/Toolbar/TopToolbar/TopToolbar.tsx`

```typescript
import type { TopToolbarProps } from "../types";
import ToolbarSection from "../ToolbarSection";

export const TopToolbar = ({ leftSection, centerSection, rightSection, processButton }: TopToolbarProps) => {
  const isCenterSectionsDisabled = centerSection.buttons.every((button) => button.disabled) && processButton.disabled;
  return (
    <div className="h-10 flex justify-between items-center gap-1">
      <ToolbarSection {...leftSection} className="bg-[var(--color-baseline-0)] rounded-4xl p-1" />
      <ToolbarSection
        {...centerSection}
        processButton={processButton}
        className={`bg-[var(--color-baseline-0)] rounded-4xl p-1 w-full flex ${isCenterSectionsDisabled ? "opacity-40" : ""}`}
        style={{
          boxShadow: "0px 4px 10px var(--color-transparent-neutral-10)",
        }}
      />
      <ToolbarSection {...rightSection} className="bg-transparent-neutral-5 rounded-4xl p-1" />
    </div>
  );
};

export default TopToolbar;

```

## Archivo: `packages/MainUI/components/Toolbar/types.ts`

```typescript
import type { SxProps, Theme } from "@mui/material";
import type { ProcessButton } from "../ProcessModal/types";

export const IconSize = "1rem";

export interface Position {
  top: string;
  right: string;
}

export interface SearchPortalProps {
  isOpen: boolean;
  searchValue: string;
  onSearchChange: (value: string) => void;
  onClose: () => void;
  placeholder?: string;
  position?: Position;
  width?: string;
  autoCompleteTexts?: string[];
  theme?: Theme;
}

export interface ToolbarProps {
  windowId: string;
  tabId?: string;
  onSearch?: (value: string) => void;
  isFormView?: boolean;
}
export interface ProcessResponse {
  success: boolean;
  message?: string;
  popupOpened?: boolean;
  redirected?: boolean;
  frameUrl?: string;
  redirectUrl?: string;
  showInIframe?: boolean;
  showDeprecatedFeatureModal?: boolean;
  responseActions?: Array<{
    showMsgInProcessView?: {
      msgType: string;
      msgTitle: string;
      msgText: string;
    };
  }>;
  refreshParent?: boolean;
}

export interface ProcessButtonProps {
  button: ProcessButton;
  onClick: () => void;
  disabled?: boolean;
}

export interface ProcessMenuProps {
  anchorEl: HTMLElement | null;
  onClose: () => void;
  processButtons: ProcessButton[];
  onProcessClick: (button: ProcessButton) => void;
  selectedRecord: unknown | undefined;
}

export interface BasicToolbarButton {
  key: string;
  onClick: ((event: React.MouseEvent<HTMLButtonElement>) => void) | (() => void);
  disabled?: boolean;
}

export interface ToolbarButton extends BasicToolbarButton {
  icon: React.ReactNode;
  iconText?: string;
  tooltip?: string;
  fill?: string;
  hoverFill?: string;
  height?: number | string;
  width?: number | string;
  sx?: SxProps<Theme>;
  className?: string;
  anchorEl?: HTMLElement | null;
}

export interface ProcessAvailableButton extends BasicToolbarButton {
  leftIcon: React.ReactNode;
  rightIcon: React.ReactNode;
  text: string;
  customContainerStyles?: string;
  customTextStyles?: string;
  anchorEl?: HTMLElement | null;
}

export interface ToolbarSectionConfig {
  buttons: ToolbarButton[];
  style?: React.CSSProperties;
  toggleExpand?: (event?: React.MouseEvent<HTMLButtonElement>) => void;
  className?: string;
  processButton?: ProcessAvailableButton;
}

export interface TopToolbarProps {
  leftSection: ToolbarSectionConfig;
  centerSection: ToolbarSectionConfig;
  rightSection: ToolbarSectionConfig;
  processButton: ProcessAvailableButton;
}

```

## Archivo: `packages/MainUI/components/ad_reports/DynamicField.tsx`

```typescript
import { memo } from "react";
import { useFormContext, Controller } from "react-hook-form";
import { TextField, Autocomplete } from "@mui/material";
import type { ReportField } from "@workspaceui/api-client/src/hooks/types";
import DateSelector from "./selectors/DateSelector";
import DatabaseSelectSelector from "./selectors/DatabaseSelect";
import MultiSelect from "./selectors/MultiSelect/MultiSelector";

interface DynamicFieldProps {
  field: ReportField;
}

function DynamicFieldComponent({ field }: DynamicFieldProps) {
  const { control, setValue } = useFormContext();

  switch (field.type) {
    case "date":
      return (
        <Controller
          name={field.name}
          control={control}
          rules={{ required: field.required }}
          render={({ field: { onChange, value, onBlur }, fieldState: { error } }) => (
            <DateSelector
              label={field.label}
              name={field.name}
              value={value}
              onChange={onChange}
              onBlur={onBlur}
              required={field.required}
              error={!!error}
              helperText={error?.message}
            />
          )}
        />
      );
    case "select":
      return (
        <Controller
          name={field.name}
          control={control}
          render={({ field: { onChange, value } }) => (
            <DatabaseSelectSelector
              value={value || ""}
              name={field.name}
              title={field.label}
              onChange={onChange}
              readOnly={false}
              entity={field.entity || ""}
            />
          )}
        />
      );
    case "search":
      return (
        <Controller
          name={field.name}
          control={control}
          rules={{ required: field.required }}
          render={({ field: { onChange, value } }) => (
            <Autocomplete
              options={field.lookupConfig?.values || []}
              value={value || null}
              getOptionLabel={(option) => option?.name || ""}
              onChange={(_, newValue) => onChange(newValue)}
              fullWidth
              renderInput={(params) => (
                <TextField {...params} variant="standard" label={field.label} required={field.required} />
              )}
            />
          )}
        />
      );
    case "multiselect":
      return (
        <Controller
          name={field.name}
          control={control}
          render={({ field: { value } }) => (
            <MultiSelect
              value={value || []}
              onChange={(selectedIds) => {
                setValue(field.name, selectedIds, { shouldDirty: true });
              }}
              title={field.label}
              entity={field.entity || ""}
              columnName={field.columnName || ""}
              identifierField={field.identifierField || ""}
              columns={field.columns}
            />
          )}
        />
      );
    default:
      return (
        <Controller
          name={field.name}
          control={control}
          rules={{ required: field.required }}
          render={({ field: { onChange, value, onBlur }, fieldState: { error } }) => (
            <TextField
              fullWidth
              label={field.label}
              value={value || ""}
              onChange={onChange}
              onBlur={onBlur}
              required={field.required}
              error={!!error}
              helperText={error?.message}
            />
          )}
        />
      );
  }
}

export const DynamicField = memo(DynamicFieldComponent);

export default DynamicField;

```

## Archivo: `packages/MainUI/components/ad_reports/DynamicReport.tsx`

```typescript
import { memo } from "react";
import { useForm, FormProvider, type FieldValues } from "react-hook-form";
import { Box, Paper, Button, Grid, Typography } from "@mui/material";
import DynamicField from "./DynamicField";
import type { ReportMetadata, ReportField } from "@workspaceui/api-client/src/hooks/types";

interface DynamicReportProps<T> {
  metadata: ReportMetadata;
  onSubmit: (format: string, data: T) => Promise<void>;
}

function DynamicReport<T extends FieldValues>({ metadata, onSubmit }: DynamicReportProps<T>) {
  const methods = useForm<T>();

  const handleSubmit = async (format: string) => {
    const isValid = await methods.trigger();
    if (isValid) {
      const data = methods.getValues();
      await onSubmit(format, data);
    }
  };

  return (
    <FormProvider {...methods}>
      <Paper sx={{ p: 2 }}>
        {metadata.sections.map((section) => (
          <Box key={section.id} sx={{ mb: 4 }}>
            <Typography variant="h6" sx={{ mb: 2 }}>
              {section.title}
            </Typography>
            <Grid container spacing={2}>
              {section.fields.map((field: ReportField) => (
                <Grid item xs={8} md={4} key={field.id}>
                  <DynamicField field={field} />
                </Grid>
              ))}
            </Grid>
          </Box>
        ))}
        <Box sx={{ mt: 4, display: "flex", justifyContent: "flex-end", gap: 2 }}>
          {metadata.actions.map((action) => (
            <Button key={action.id} variant="contained" onClick={() => handleSubmit(action.format)}>
              {action.name}
            </Button>
          ))}
        </Box>
      </Paper>
    </FormProvider>
  );
}

export default memo(DynamicReport);

```

## Archivo: `packages/MainUI/components/ad_reports/selectors/BooleanSelector.tsx`

```typescript
import { useState, useCallback } from "react";
import { useStyle } from "./styles";
import type { BooleanSelectorProps } from "../../Form/FormView/types";

const BooleanSelector = ({ label, checked, onChange, name, disabled, readOnly }: BooleanSelectorProps) => {
  const [isHovered, setIsHovered] = useState(false);
  const { styles } = useStyle();

  const handleChange = useCallback(
    (e: React.ChangeEvent<HTMLInputElement>) => {
      onChange(name, e.currentTarget.checked);
    },
    [name, onChange]
  );

  const handleMouseEnter = useCallback(() => {
    setIsHovered(true);
  }, []);

  const handleMouseLeave = useCallback(() => {
    setIsHovered(false);
  }, []);

  const isDisabled = readOnly || disabled;

  const checkboxStyle = {
    ...styles.styledCheckbox,
    ...((checked && styles.styledCheckboxChecked) || {}),
    ...((readOnly && styles.disabled) || {}),
  };

  const afterStyle = {
    ...styles.styledCheckboxAfter,
    ...((checked && styles.styledCheckboxCheckedAfter) || {}),
  };

  const borderStyle = {
    ...styles.checkboxBorder,
    ...((isHovered && styles.checkboxBorderHover) || {}),
  };

  return (
    <div style={styles.checkboxContainer} onMouseEnter={handleMouseEnter} onMouseLeave={handleMouseLeave}>
      <label style={styles.checkboxLabel}>
        <input
          type="checkbox"
          style={styles.hiddenCheckbox}
          checked={checked}
          disabled={isDisabled}
          onChange={handleChange}
          name={name}
        />
        <span
          style={{
            ...checkboxStyle,
            ...(isDisabled && styles.disabled),
          }}>
          <span style={afterStyle} />
        </span>
        <span style={{ ...styles.labelText, ...(isDisabled && styles.disabled) }}>{label}</span>
      </label>
      <div style={borderStyle} />
    </div>
  );
};

export default BooleanSelector;

```

## Archivo: `packages/MainUI/components/ad_reports/selectors/DatabaseSelect.tsx`

```typescript
import { useDatasource } from "@/hooks/useDatasource";
import { useTheme } from "@mui/material";
import SearchOutlined from "@workspaceui/componentlibrary/src/assets/icons/search.svg";
import Select from "@workspaceui/componentlibrary/src/components/Input/Select";
import type { Option } from "@workspaceui/api-client/src/api/types";
import { memo, useMemo } from "react";
import type { DatabaseSelectSelector } from "../../Form/FormView/types";

const DBSelectSelector = memo(({ value, name, title, onChange, readOnly, entity }: DatabaseSelectSelector) => {
  const theme = useTheme();
  const { records = [], loading } = useDatasource({ entity });

  const options = useMemo<Option<string>[]>(
    () =>
      records.map((record) => ({
        id: String(record.id || ""),
        title: String(record._identifier || record.name || ""),
        value: String(record.id || ""),
      })),
    [records]
  );

  const currentValue = useMemo(() => options.find((opt) => opt.value === value) || null, [options, value]);

  return (
    <Select
      iconLeft={<SearchOutlined fill={theme.palette.baselineColor.neutral[90]} />}
      title={title}
      options={options}
      getOptionLabel={(option) => option.title}
      onChange={(_event, newValue) => onChange(newValue?.value || "")}
      disabled={readOnly || loading}
      name={name}
      value={currentValue}
    />
  );
});

DBSelectSelector.displayName = "DatabaseSelectSelector";

export default DBSelectSelector;

```

## Archivo: `packages/MainUI/components/ad_reports/selectors/DateSelector.tsx`

```typescript
import { memo, useRef } from "react";
import { InputAdornment, TextField } from "@mui/material";
import { styled } from "@mui/material/styles";
import CalendarIcon from "@workspaceui/componentlibrary/src/assets/icons/calendar.svg";
import type { DateSelectorProps } from "../../Form/FormView/types";
import { IconButton } from "@workspaceui/componentlibrary/src/components";
const StyledTextField = styled(TextField)(({ theme }) => ({
  "& .MuiInputBase-root": {
    borderRadius: theme.shape.borderRadius,
  },
  "& .MuiInputBase-input": {
    padding: theme.spacing(1, 0, 1, 1.5),
    margin: 0,
    "&::-webkit-calendar-picker-indicator": {
      display: "none",
    },
  },
}));

const INPUT_LABEL_PROPS = { shrink: true } as const;

const DateSelector = memo(
  ({ label, name, value, onChange, onBlur, readOnly, required, error, helperText }: DateSelectorProps) => {
    const inputRef = useRef<HTMLInputElement>(null);

    const handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {
      const newValue = event.target.value;
      if (newValue) {
        const [year, month, day] = newValue.split("-");
        const formattedDate = `${day}/${month}/${year}`;
        onChange({
          target: {
            name,
            value: formattedDate,
          },
        });
      } else {
        onChange(event);
      }
    };

    const handleIconClick = () => {
      if (inputRef.current && !readOnly) {
        inputRef.current.showPicker();
      }
    };

    const formatDateForInput = (dateString?: string) => {
      if (!dateString) return "";
      const [day, month, year] = dateString.split("/");
      return `${year}-${month}-${day}`;
    };

    return (
      <StyledTextField
        fullWidth
        label={label}
        name={name}
        type="date"
        variant="standard"
        margin="normal"
        value={formatDateForInput(value)}
        onChange={handleChange}
        onBlur={onBlur}
        disabled={readOnly}
        required={required}
        error={error}
        helperText={helperText}
        inputRef={inputRef}
        InputLabelProps={INPUT_LABEL_PROPS}
        InputProps={{
          endAdornment: (
            <InputAdornment position="end">
              <IconButton onClick={handleIconClick} disabled={readOnly} className="w-1 h-1">
                <CalendarIcon />
              </IconButton>
            </InputAdornment>
          ),
        }}
      />
    );
  }
);

DateSelector.displayName = "DateSelector";

export default DateSelector;

```

## Archivo: `packages/MainUI/components/ad_reports/selectors/ListSelector.tsx`

```typescript
import type React from "react";
import { useCallback, useEffect, useMemo, useState } from "react";
import Select from "@workspaceui/componentlibrary/src/components/Input/Select";
import SearchOutlined from "@workspaceui/componentlibrary/src/assets/icons/search.svg";
import type { Option } from "@workspaceui/componentlibrary/src/components/Input/Select/types";
import type { ListSelectorProps } from "../../Form/FormView/types";
import { useTheme } from "@mui/material";

const ListSelector: React.FC<ListSelectorProps> = ({ field, value, onChange, readOnly }) => {
  const [selectedValue, setSelectedValue] = useState<Option | null>(() => {
    if (field.refList) {
      const option = field.refList.find((item) => item.value === value);

      if (option) {
        return {
          id: option.id,
          title: option.label,
          value: option.value,
        };
      }
    }

    return null;
  });
  const theme = useTheme();

  const options: Option[] = useMemo(() => {
    if (field.refList) {
      return field.refList.map((item) => ({
        id: item.id,
        title: item.label,
        value: item.value,
      }));
    }
    return [];
  }, [field.refList]);

  useEffect(() => {
    setSelectedValue(options.find((option) => option.value === value) || null);
  }, [value, options]);

  const handleChange = useCallback(
    (_event: React.SyntheticEvent<Element, Event>, newValue: Option | null) => {
      if (newValue) {
        setSelectedValue(newValue);
        onChange(newValue.value);
      }
    },
    [onChange]
  );

  const isOptionEqualToValue = useCallback((option: Option, value: Option) => option.value === value.value, []);

  return (
    <Select
      iconLeft={<SearchOutlined fill={theme.palette.baselineColor.neutral[90]} />}
      options={options}
      onChange={handleChange}
      value={selectedValue}
      isOptionEqualToValue={isOptionEqualToValue}
      disabled={readOnly}
    />
  );
};

export default ListSelector;

```

## Archivo: `packages/MainUI/components/ad_reports/selectors/MultiSelect/MultiSelector.tsx`

```typescript
import { useStyle } from "@/components/Table/styles";
import { useDatasource } from "@/hooks/useDatasource";
import { Box, Button, Dialog, DialogActions, DialogContent, Typography } from "@mui/material";
import { type MRT_Row, MaterialReactTable } from "material-react-table";
import { useCallback, useMemo, useState } from "react";
import type { MultiSelectProps, Option, SelectorTableProps, TableData } from "../../../Form/FormView/types";
import { SearchBar } from "./SearchBar";
import { SelectedItemsContainer } from "./SelectedItemsContainer";
import { DEFAULT_COLUMNS, DIALOG_PROPS, TABLE_INITIAL_STATE } from "./constants";

const SelectorTable: React.FC<SelectorTableProps & { selectedIds: string[] }> = ({
  data,
  onRowClick,
  columns,
  title,
  selectedIds,
}) => {
  const { sx } = useStyle();

  return (
    <MaterialReactTable
      columns={columns}
      data={data}
      enableRowSelection
      enableMultiRowSelection={false}
      getRowId={(row) => String(row.id)}
      // biome-ignore lint/performance/noAccumulatingSpread: <explanation>
      state={{ rowSelection: selectedIds.reduce((acc, id) => ({ ...acc, [id]: true }), {}) }}
      renderTopToolbarCustomActions={() => (
        <Box sx={sx.titleContainer}>
          <Typography>{title}</Typography>
        </Box>
      )}
      muiTableBodyRowProps={({ row }) => ({
        onClick: () => onRowClick(row),
        sx: {
          ...sx.tableBody,
          cursor: "pointer",
        },
      })}
      muiTablePaperProps={{
        sx: sx.tablePaper,
      }}
      muiTableHeadCellProps={{
        sx: sx.tableHeadCell,
      }}
      muiTableBodyCellProps={{
        sx: sx.tableBodyCell,
      }}
      initialState={TABLE_INITIAL_STATE}
    />
  );
};

const MultiSelect: React.FC<MultiSelectProps> = ({
  value = [],
  onChange,
  readOnly,
  title,
  entity,
  columns = DEFAULT_COLUMNS,
}) => {
  const [open, setOpen] = useState(false);
  const { sx } = useStyle();
  const { records = [], loading } = useDatasource({ entity });

  const selectedOptions = useMemo(() => {
    const normalizeValue = (value: string | string[] | undefined): string[] => {
      if (Array.isArray(value)) {
        return value;
      }
      if (value) {
        return [value];
      }
      return [];
    };
    const typedRecords = records as TableData[];

    return typedRecords
      .filter((record) => normalizeValue(value).includes(String(record.id)))
      .map((record) => ({
        id: String(record.id),
        title: String(record._identifier || record.name || ""),
        value: String(record.id),
      }));
  }, [value, records]);

  const selectedIds = useMemo(() => {
    return selectedOptions.map((option) => option.id);
  }, [selectedOptions]);

  const tableData = useMemo(() => {
    if (!records || records.length === 0) return [];
    return records as TableData[];
  }, [records]);

  const handleRowClick = useCallback(
    (row: MRT_Row<TableData>) => {
      const record = row.original;
      const option: Option = {
        id: String(record.id),
        title: String(record._identifier || record.name || ""),
        value: String(record.id),
      };

      const exists = selectedOptions.some((item) => item.id === option.id);
      const newOptions = exists
        ? selectedOptions.filter((item) => item.id !== option.id)
        : [...selectedOptions, option];

      onChange(newOptions.map((opt) => opt.id));
    },
    [onChange, selectedOptions]
  );

  const handleRemoveItem = useCallback(
    (id: string) => {
      const newOptions = selectedOptions.filter((item) => item.id !== id);
      onChange(newOptions.map((opt) => opt.id));
    },
    [onChange, selectedOptions]
  );

  const handleClear = useCallback(() => {
    onChange([]);
  }, [onChange]);

  if (loading) return <div>Loading...</div>;

  return (
    <Box sx={sx.multiSelectContainer}>
      <Box sx={sx.contentContainer}>
        <Typography>{title}</Typography>
        <SelectedItemsContainer items={selectedOptions} onRemove={handleRemoveItem} />
      </Box>
      <SearchBar
        readOnly={readOnly}
        onClear={handleClear}
        onOpen={() => setOpen(true)}
        hasItems={selectedOptions.length > 0}
      />
      <Dialog open={open} onClose={() => setOpen(false)} {...DIALOG_PROPS}>
        <DialogContent sx={sx.dialogContent}>
          <SelectorTable
            data={tableData}
            onRowClick={handleRowClick}
            columns={columns}
            title={title || ""}
            selectedIds={selectedIds}
          />
        </DialogContent>
        <DialogActions>
          <Button onClick={() => setOpen(false)}>Close</Button>
        </DialogActions>
      </Dialog>
    </Box>
  );
};

export default MultiSelect;

```

## Archivo: `packages/MainUI/components/ad_reports/selectors/MultiSelect/SearchBar.tsx`

```typescript
import { Typography, Box, useTheme } from "@mui/material";
import CloseIcon from "@workspaceui/componentlibrary/src/assets/icons/x.svg";
import SearchOutlined from "@workspaceui/componentlibrary/src/assets/icons/search.svg";
import { useStyle } from "@/components/Table/styles";
import { ICON_BUTTON_SIZE, ADD_BUTTON_TEXT } from "./constants";
import type { SearchBarProps } from "./types";
import IconButton from "@workspaceui/componentlibrary/src/components/IconButton";

export const SearchBar: React.FC<SearchBarProps> = ({ readOnly, onClear, onOpen, hasItems }) => {
  const { sx } = useStyle();
  const theme = useTheme();

  const handleClear = (e: React.MouseEvent<HTMLButtonElement, MouseEvent>) => {
    e.stopPropagation();
    onClear();
  };

  const searchBarStyles = {
    ...sx.searchBarBase,
    cursor: readOnly ? "default" : "pointer",
    opacity: readOnly ? 0.7 : 1,
    "&:hover": !readOnly
      ? {
          backgroundColor: theme.palette.baselineColor.neutral[10],
          color: theme.palette.baselineColor.neutral[100],
          background: theme.palette.baselineColor.neutral[30],
        }
      : undefined,
  };

  return (
    <Box onClick={() => !readOnly && onOpen()} sx={searchBarStyles}>
      <SearchOutlined fill={theme.palette.baselineColor.neutral[90]} />
      <Typography>{ADD_BUTTON_TEXT}</Typography>
      <IconButton onClick={handleClear} disabled={readOnly || !hasItems}>
        <CloseIcon fontSize={ICON_BUTTON_SIZE} />
      </IconButton>
    </Box>
  );
};

```

## Archivo: `packages/MainUI/components/ad_reports/selectors/MultiSelect/SelectedItemsContainer.tsx`

```typescript
import { Typography, Box } from "@mui/material";
import CloseIcon from "@workspaceui/componentlibrary/src/assets/icons/x.svg";
import { useStyle } from "@/components/Table/styles";
import { ICON_BUTTON_SIZE } from "./constants";
import type { SelectedItemProps, SelectedItemsContainerProps } from "./types";
import IconButton from "@workspaceui/componentlibrary/src/components/IconButton";

export const SelectedItem: React.FC<SelectedItemProps> = ({ item, onRemove }) => {
  const { sx } = useStyle();

  return (
    <Box key={item.id} sx={sx.selectedItem}>
      <Typography>{item.title}</Typography>
      <IconButton onClick={() => onRemove(item.id)}>
        <CloseIcon fontSize={ICON_BUTTON_SIZE} />
      </IconButton>
    </Box>
  );
};

export const SelectedItemsContainer: React.FC<SelectedItemsContainerProps> = ({ items, onRemove }) => {
  const { sx } = useStyle();

  return (
    <Box sx={sx.selectedContainer}>
      {items.map((item) => (
        <SelectedItem key={item.id} item={item} onRemove={onRemove} />
      ))}
      {items.length === 0 && <Box sx={sx.emptyState}>No items selected</Box>}
    </Box>
  );
};

```

## Archivo: `packages/MainUI/components/ad_reports/selectors/MultiSelect/constants.ts`

```typescript
import type { MRT_ColumnDef } from "material-react-table";
import type { TableData } from "../../../Form/FormView/types";

export const DEFAULT_COLUMNS: MRT_ColumnDef<TableData>[] = [
  {
    header: "ID",
    accessorKey: "id",
  },
  {
    header: "Name",
    accessorKey: "_identifier",
  },
] as const;

export const TABLE_INITIAL_STATE = {
  density: "compact" as const,
  pagination: {
    pageSize: 10,
    pageIndex: 0,
  },
} as const;

export const DIALOG_PROPS = {
  maxWidth: "lg" as const,
  fullWidth: true,
} as const;

export const ICON_BUTTON_SIZE = "small" as const;

export const LOADING_TEXT = "Loading..." as const;
export const EMPTY_STATE_TEXT = "No items selected" as const;
export const ADD_BUTTON_TEXT = "Add" as const;
export const CLOSE_BUTTON_TEXT = "Close" as const;

```

## Archivo: `packages/MainUI/components/ad_reports/selectors/MultiSelect/types.ts`

```typescript
import type { Option } from "../../../Form/FormView/types";

export interface SearchBarProps {
  readOnly?: boolean;
  onClear: () => void;
  onOpen: () => void;
  hasItems: boolean;
}

export interface SelectedItemProps {
  item: Option;
  onRemove: (id: string) => void;
}

export interface SelectedItemsContainerProps {
  items: Option[];
  onRemove: (id: string) => void;
}

```

## Archivo: `packages/MainUI/components/ad_reports/selectors/NumberSelector.tsx`

```typescript
import { memo } from "react";
import { TextField } from "@mui/material";
import type { NumberSelectorProps } from "../../Form/FormView/types";

const NumberSelector: React.FC<NumberSelectorProps> = memo(({ name, value, readOnly, onChange }) => (
  <TextField
    fullWidth
    margin="normal"
    name={name}
    type="number"
    value={value}
    onChange={(e) => onChange(name, Number(e.target.value))}
    disabled={readOnly}
  />
));

NumberSelector.displayName = "NumberSelector";

export default NumberSelector;

```

## Archivo: `packages/MainUI/components/ad_reports/selectors/SearchSelector.tsx`

```typescript
import { useCallback, useMemo, useEffect, useState } from "react";
import SearchOutlined from "@workspaceui/componentlibrary/src/assets/icons/search.svg";
import { useTheme } from "@mui/material";
import type { Option, SearchSelectorProps } from "../../Form/FormView/types";
import Spinner from "@workspaceui/componentlibrary/src/components/Spinner";
import Select from "@workspaceui/componentlibrary/src/components/Input/Select";
import { useComboSelect } from "@/hooks/useComboSelect";

const getOptionLabel = (option: Option) => option.title;

const optionEqualValue = (option: Option, value: { id: string }) => option.id === value.id || option.value === value.id;

const SearchSelector = ({ onChange, value, field, name, disabled, readOnly }: SearchSelectorProps) => {
  const theme = useTheme();
  const { records, loading, error } = useComboSelect({ field });
  const [selectedValue, setSelectedValue] = useState<Option | null>(null);

  const isDisabled = disabled || readOnly;

  const options = useMemo(() => {
    const valueField = (field.selector?.valueField ?? "") as string;

    return records.map((record) => ({
      id: record[valueField] as string,
      title: (record._identifier || record.name || record.id) as string,
      value: record[valueField] as string,
    }));
  }, [field?.selector?.valueField, records]);

  useEffect(() => {
    if (value && options.length > 0) {
      const option = options.find((opt) => {
        if (typeof value === "object" && "id" in value) {
          return opt.id === value.id || opt.value === value.id;
        }
        return opt.id === String(value) || opt.value === String(value);
      });
      if (option) {
        setSelectedValue(option);
      } else {
        setSelectedValue(null);
      }
    } else {
      setSelectedValue(null);
    }
  }, [value, options]);

  const handleChange = useCallback(
    (_event: React.SyntheticEvent<Element, Event>, newValue: Option | null) => {
      setSelectedValue(newValue);
      if (newValue) {
        onChange(newValue.id);
      }
    },
    [onChange]
  );

  if (loading) return <Spinner />;
  if (error) return <div>Error: {error?.message}</div>;

  return (
    <Select
      iconLeft={<SearchOutlined fill={theme.palette.baselineColor.neutral[90]} />}
      options={options}
      onChange={handleChange}
      value={selectedValue}
      getOptionLabel={getOptionLabel}
      isOptionEqualToValue={optionEqualValue}
      name={name}
      disabled={isDisabled}
    />
  );
};

export default SearchSelector;

```

## Archivo: `packages/MainUI/components/ad_reports/selectors/SelectSelector.tsx`

```typescript
import { memo, useCallback, useMemo } from "react";
import Select from "@workspaceui/componentlibrary/src/components/Input/Select";
import SearchOutlined from "@workspaceui/componentlibrary/src/assets/icons/search.svg";
import type { SelectSelectorProps } from "../../Form/FormView/types";
import { useTheme } from "@mui/material";
import type { Option } from "@workspaceui/api-client/src/api/types";

const SelectSelector = memo(({ value, name, title, onChange, readOnly, field }: SelectSelectorProps) => {
  const theme = useTheme();
  const options = useMemo<Option[]>(
    () =>
      field.refList.map((v) => ({
        id: v.id,
        title: v.label,
        value: v.value,
      })),
    [field.refList]
  );
  const handleChange = useCallback(
    (_: React.SyntheticEvent<Element, Event>, newValue: Option<string> | null) => {
      onChange(newValue?.value || "");
    },
    [onChange]
  );
  const current = useMemo(() => options.find((opt) => opt.value === value), [options, value]);

  return (
    <Select
      iconLeft={<SearchOutlined fill={theme.palette.baselineColor.neutral[90]} />}
      title={title}
      options={options}
      getOptionLabel={(option) => option.title}
      onChange={handleChange}
      disabled={readOnly}
      name={name}
      value={current}
    />
  );
});

SelectSelector.displayName = "SelectSelector";

export default SelectSelector;

```

## Archivo: `packages/MainUI/components/ad_reports/selectors/StringSelector.tsx`

```typescript
import TextInputBase from "@workspaceui/componentlibrary/src/components/Input/TextInput/TextInputBase";

export const StringSelector = TextInputBase;

```

## Archivo: `packages/MainUI/components/ad_reports/selectors/TableDirSelector.tsx`

```typescript
import { useDatasource } from "@/hooks/useDatasource";
import { useTheme } from "@mui/material";
import SearchOutlined from "@workspaceui/componentlibrary/src/assets/icons/search.svg";
import Select from "@workspaceui/componentlibrary/src/components/Input/Select";
import Spinner from "@workspaceui/componentlibrary/src/components/Spinner";
import { useCallback, useEffect, useMemo, useState } from "react";
import type { Option, TableDirSelectorProps } from "../../Form/FormView/types";

const getOptionLabel = (option: Option) => option.title;

const optionEqualValue = (option: Option, value: { id: string }) => option.id === value.id || option.value === value.id;

const TableDirSelector = ({ onChange, entity, value, name, isReadOnly }: TableDirSelectorProps) => {
  const theme = useTheme();
  const { records, loading, error, loaded } = useDatasource({ entity });
  const [selectedValue, setSelectedValue] = useState<Option | null>(null);

  const options = useMemo(
    () =>
      records.map((record) => ({
        id: record.id as string,
        title: (record._identifier || record.name || record.id) as string,
        value: record.id as string,
      })),
    [records]
  );

  useEffect(() => {
    // biome-ignore lint/suspicious/noImplicitAnyLet: <explanation>
    let option;

    if (value && options.length > 0) {
      option = options.find((opt) => {
        if (typeof value === "object" && "id" in value) {
          return opt.id === value.id || opt.value === value.id;
        }
        return opt.id === String(value) || opt.value === String(value);
      });
    }

    setSelectedValue(option ?? null);
  }, [value, options]);

  const handleChange = useCallback(
    (_event: React.SyntheticEvent<Element, Event>, newValue: Option | null) => {
      setSelectedValue(newValue);
      if (newValue) {
        onChange(newValue.id);
      }
    },
    [onChange]
  );

  if (loading || !loaded) return <Spinner />;
  if (error) return <div>Error: {error?.message}</div>;

  return (
    <Select
      iconLeft={<SearchOutlined fill={theme.palette.baselineColor.neutral[90]} />}
      options={options}
      onChange={handleChange}
      value={selectedValue}
      getOptionLabel={getOptionLabel}
      isOptionEqualToValue={optionEqualValue}
      name={name}
      disabled={isReadOnly}
    />
  );
};

export default TableDirSelector;

```

## Archivo: `packages/MainUI/components/ad_reports/selectors/styles.ts`

```typescript
import { useTheme } from "@mui/material";
import { type CSSProperties, useMemo } from "react";

export const useStyle = () => {
  const theme = useTheme();

  return useMemo(
    () => ({
      styles: {
        checkboxContainer: {
          position: "relative",
          height: "3rem",
          display: "flex",
          alignItems: "center",
        },
        checkboxBorder: {
          position: "absolute",
          bottom: 0,
          left: 0,
          right: 0,
          height: "1px",
          backgroundColor: theme.palette.baselineColor.transparentNeutral[10],
          transition: "height 0.2s ease-in-out",
        },
        checkboxBorderHover: {
          backgroundColor: theme.palette.baselineColor.neutral[90],
          height: "2px",
        },
        checkboxLabel: {
          display: "inline-block",
          position: "relative",
          paddingLeft: "2rem",
          cursor: "pointer",
          userSelect: "none",
        },
        hiddenCheckbox: {
          position: "absolute",
          opacity: 0,
          cursor: "pointer",
          height: 0,
          width: 0,
        },
        styledCheckbox: {
          position: "absolute",
          top: "2px",
          left: 0,
          height: "1.25rem",
          width: "1.25rem",
          backgroundColor: theme.palette.dynamicColor.contrastText,
          transition: "background-color 0.25s ease",
          borderRadius: "0.375rem",
        },
        styledCheckboxChecked: {
          backgroundColor: theme.palette.dynamicColor.main,
        },
        styledCheckboxAfter: {
          content: '""',
          position: "absolute",
          left: "0.5rem",
          top: "0.25rem",
          width: "0.375rem",
          height: "0.625rem",
          border: `solid ${theme.palette.dynamicColor.contrastText}`,
          borderWidth: "0 2px 2px 0",
          borderRadius: "1px",
          transform: "rotate(45deg)",
          opacity: 0,
          transition: "opacity 0.25s ease",
        },
        styledCheckboxCheckedAfter: {
          opacity: 1,
        },
        labelText: {
          color: theme.palette.baselineColor.neutral[90],
          lineHeight: 1.4,
        },
        disabled: {
          opacity: 0.5,
          cursor: "not-allowed",
        },
      } as { [key: string]: CSSProperties },
    }),
    [theme]
  );
};

```

## Archivo: `packages/MainUI/components/layout.tsx`

```typescript
"use client";
import Navigation from "./navigation";
import Sidebar from "./Sidebar";
import GlobalLoading from "./Layout/GlobalLoading";

function LayoutContent({ children }: { children: React.ReactNode }) {
  return (
    <div className="flex w-full h-full relative overflow-hidden">
      <GlobalLoading />
      <Sidebar />
      <div className="flex flex-1 flex-col max-w-auto max-h-auto overflow-hidden">
        <div className="w-full h-14 min-h-14 p-1">
          <Navigation />
        </div>
        <div className="flex flex-1 max-h-auto max-w-auto overflow-hidden">{children}</div>
      </div>
    </div>
  );
}

export default function Layout({ children }: { children: React.ReactNode }) {
  return <LayoutContent>{children}</LayoutContent>;
}

```

## Archivo: `packages/MainUI/components/loading.tsx`

```typescript
import { CircularProgress } from "@mui/material";

export default function Loading({
  className,
  customIconProps,
}: {
  className?: string;
  customIconProps?: React.ComponentProps<typeof CircularProgress>;
}) {
  return (
    <div className={`h-full mx-auto flex flex-col items-center justify-center ${className}`}>
      <CircularProgress {...customIconProps} />
    </div>
  );
}

export { Loading };

```

## Archivo: `packages/MainUI/components/navigation.tsx`

```typescript
"use client";

import { useLanguage } from "@/contexts/language";
import type { Language } from "@/contexts/types";
import { UserContext } from "@/contexts/user";
import { logger } from "@/utils/logger";
import NotificationIcon from "@workspaceui/componentlibrary/src/assets/icons/bell.svg";
import AddIcon from "@workspaceui/componentlibrary/src/assets/icons/plus.svg";
import PersonIcon from "@workspaceui/componentlibrary/src/assets/icons/user.svg";
import {
  CopilotButton,
  CopilotPopup,
  NotificationButton,
  NotificationModal,
  Waterfall,
} from "@workspaceui/componentlibrary/src/components";
import type { Item } from "@workspaceui/componentlibrary/src/components/DragModal/DragModal.types";
import Nav from "@workspaceui/componentlibrary/src/components/Nav/Nav";
import { useCallback, useContext, useEffect, useMemo, useState } from "react";
import { NOTIFICATIONS, menuItems, sections } from "../../storybook/src/mocks";
import { useTranslation } from "../hooks/useTranslation";
import ProfileModal from "./ProfileModal/ProfileModal";
import { useAssistants } from "@/hooks/useAssistants";
import { useCopilotLabels } from "@/hooks/useCopilotLabels";
import { useCopilot } from "@/hooks/useCopilot";
import { buildContextString } from "@/utils/contextUtils";
import ConfigurationSection from "./Header/ConfigurationSection";

const handleClose = () => {
  return true;
};

const item: Item[] = [];

const Navigation: React.FC = () => {
  const { t } = useTranslation();
  const {
    setDefaultConfiguration,
    currentRole,
    currentOrganization,
    profile,
    currentWarehouse,
    changeProfile,
    roles,
    languages,
  } = useContext(UserContext);
  const [saveAsDefault, setSaveAsDefault] = useState(false);
  const { language, setLanguage, getFlag } = useLanguage();
  const [anchorEl] = useState<HTMLElement | null>(null);

  const [copilotOpen, setCopilotOpen] = useState(false);
  const [copilotExpanded, setCopilotExpanded] = useState(false);
  const [pendingContextString, setPendingContextString] = useState<string | null>(null);
  const [pendingContextItems, setPendingContextItems] = useState<any[]>([]);

  const { assistants, getAssistants } = useAssistants();
  const { labels, getLabels } = useCopilotLabels();

  const { clearUserData } = useContext(UserContext);

  const handleSignOff = useCallback(() => {
    clearUserData();
  }, [clearUserData]);

  const handleSaveAsDefaultChange = useCallback((event: React.ChangeEvent<HTMLInputElement>) => {
    setSaveAsDefault(event.target.checked);
  }, []);

  const handleCopilotOpen = useCallback(() => {
    setCopilotOpen(true);
  }, []);

  const handleCopilotOpenWithContext = useCallback((contextString: string, contextItems: any[]) => {
    setPendingContextString(contextString);
    setPendingContextItems(contextItems);
    setCopilotOpen(true);
  }, []);

  const handleCopilotClose = useCallback(() => {
    setCopilotOpen(false);
    setPendingContextString(null);
    setPendingContextItems([]);
  }, []);

  const handleCopilotToggleExpanded = useCallback(() => {
    setCopilotExpanded(!copilotExpanded);
  }, [copilotExpanded]);

  const languagesWithFlags = useMemo(() => {
    return languages.map((lang) => ({
      ...lang,
      flagEmoji: getFlag(lang.language as Language),
      displayName: `${getFlag(lang.language as Language)} ${lang.name}`,
    }));
  }, [languages, getFlag]);

  const flagString = getFlag(language);

  const { messages, selectedAssistant, isLoading, handleSendMessage, handleSelectAssistant, handleResetConversation } =
    useCopilot();

  const handleCopilotSendMessage = useCallback(
    (message: string, _files?: File[]) => {
      if (pendingContextString) {
        const messageWithContext = `${pendingContextString}\n\n${message}`;
        handleSendMessage(messageWithContext);
        setPendingContextString(null);
        setPendingContextItems([]);
      } else {
        handleSendMessage(message);
      }
    },
    [pendingContextString, handleSendMessage]
  );

  const handleRemoveContext = useCallback(
    (contextId: string) => {
      setPendingContextItems((items) => {
        const newItems = items.filter((item) => item.id !== contextId);

        if (newItems.length === 0) {
          setPendingContextString(null);
        } else {
          const newContextString = buildContextString({
            contextItems: newItems,
            registersText: t("copilot.contextPreview.selectedRegisters"),
          });
          setPendingContextString(newContextString);
        }

        return newItems;
      });
    },
    [t]
  );

  useEffect(() => {
    getLabels();
    getAssistants();
  }, [getLabels, getAssistants]);

  useEffect(() => {
    const handleCopilotWithContext = (event: CustomEvent) => {
      const { contextString, contextItems, hasContext } = event.detail;
      if (hasContext) {
        handleCopilotOpenWithContext(contextString, contextItems);
      } else {
        handleCopilotOpen();
      }
    };

    window.addEventListener("openCopilotWithContext", handleCopilotWithContext as EventListener);

    return () => {
      window.removeEventListener("openCopilotWithContext", handleCopilotWithContext as EventListener);
    };
  }, [handleCopilotOpen, handleCopilotOpenWithContext]);

  if (!currentRole) {
    return null;
  }

  return (
    <>
      <Nav title={t("common.notImplemented")}>
        <Waterfall
          menuItems={menuItems}
          backButtonText={t("modal.secondaryButtonLabel")}
          activateAllText={t("navigation.waterfall.activateAll")}
          deactivateAllText={t("navigation.waterfall.deactivateAll")}
          tooltipWaterfallButton={t("navigation.waterfall.tooltipButton")}
          buttonText={t("navigation.waterfall.buttons")}
          customizeText={t("navigation.waterfall.customize")}
          items={item}
          icon={<AddIcon />}
          setItems={() => {}}
        />
        <ConfigurationSection />
        <CopilotButton onClick={handleCopilotOpen} tooltip="Copilot" />
        <NotificationButton notifications={NOTIFICATIONS} icon={<NotificationIcon />}>
          <NotificationModal
            notifications={NOTIFICATIONS}
            anchorEl={anchorEl}
            onClose={handleClose}
            title={{
              icon: <NotificationIcon fill="#2E365C" />,
              label: t("navigation.notificationModal.title"),
            }}
            linkTitle={{
              label: t("navigation.notificationModal.markAllAsRead"),
              url: "/home",
            }}
            emptyStateImageAlt={t("navigation.notificationModal.emptyStateImageAlt")}
            emptyStateMessage={t("navigation.notificationModal.emptyStateMessage")}
            emptyStateDescription={t("navigation.notificationModal.emptyStateDescription")}
            actionButtonLabel={t("navigation.notificationModal.actionButtonLabel")}
          />
        </NotificationButton>
        <ProfileModal
          icon={<PersonIcon />}
          sections={sections}
          section={""}
          translations={{
            saveAsDefault: t("navigation.profile.saveAsDefault"),
          }}
          currentRole={currentRole}
          currentWarehouse={currentWarehouse}
          currentOrganization={currentOrganization}
          roles={roles}
          saveAsDefault={saveAsDefault}
          onSaveAsDefaultChange={handleSaveAsDefaultChange}
          onLanguageChange={setLanguage}
          language={language}
          languagesFlags={flagString}
          changeProfile={changeProfile}
          onSetDefaultConfiguration={setDefaultConfiguration}
          logger={logger}
          onSignOff={handleSignOff}
          languages={languagesWithFlags}
          userName={profile.name}
          userEmail={profile.email}
          userPhotoUrl={profile.image}
        />
      </Nav>
      <CopilotPopup
        open={copilotOpen}
        onClose={handleCopilotClose}
        assistants={assistants}
        labels={labels}
        isExpanded={copilotExpanded}
        onToggleExpanded={handleCopilotToggleExpanded}
        messages={messages}
        selectedAssistant={selectedAssistant}
        isLoading={isLoading}
        onSelectAssistant={handleSelectAssistant}
        onSendMessage={handleCopilotSendMessage}
        onResetConversation={handleResetConversation}
        hasContextPending={!!pendingContextString}
        contextItems={pendingContextItems}
        onRemoveContext={handleRemoveContext}
        translations={{
          copilotProfile: t("copilot.copilotProfile"),
          backToSelection: t("copilot.backToSelection"),
          minimize: t("copilot.minimize"),
          maximize: t("copilot.maximize"),
          close: t("copilot.close"),
          contextText: t("copilot.contextText"),
          selectedRegisters: t("copilot.contextPreview.selectedRegisters"),
          assistantSelector: {
            errorInvalidData: t("copilot.assistantSelector.errorInvalidData"),
            errorNoAssistantsAvailable: t("copilot.assistantSelector.errorNoAssistantsAvailable"),
            defaultDescription: t("copilot.assistantSelector.defaultDescription"),
            welcomeMessage: t("copilot.assistantSelector.welcomeMessage"),
            profilesTitle: t("copilot.assistantSelector.profilesTitle"),
            learnMoreText: t("copilot.assistantSelector.learnMoreText"),
            filterPlaceholder: t("copilot.assistantSelector.filterPlaceholder"),
          },
          messageInput: {
            placeholder: t("copilot.messageInput.placeholder"),
          },
          messageList: {
            contextRecords: t("copilot.messageList.contextRecords"),
            welcomeMessage: t("copilot.messageList.welcomeMessage"),
            typing: t("copilot.messageList.typing"),
          },
        }}
      />
    </>
  );
};

export default Navigation;

```

## Archivo: `packages/MainUI/components/styles.ts`

```typescript
export const styles = {
  content: {
    overflow: "hidden",
    flex: 1,
    display: "flex",
    flexDirection: "column",
    position: "relative",
  },
  breadCrum: {
    padding: "0 0.5rem",
  },
  box: {
    margin: "0 0 0.5rem 0",
  },
};

```

## Archivo: `packages/MainUI/components/types.ts`

```typescript
export interface ErrorDisplayProps {
  title: string;
  description?: string;
  showRetry?: boolean;
  onRetry?: () => void;
  showHomeButton?: boolean;
}

```

## Archivo: `packages/MainUI/components/window/SubTabsSwitch.tsx`

```typescript
"use client";

import type { TabsSwitchProps } from "@/components/window/types";
import { TabButton } from "@/components/window/TabButton";
import { IconButton } from "@workspaceui/componentlibrary/src/components";
import ChevronDown from "../../../ComponentLibrary/src/assets/icons/chevron-down.svg";

export const SubTabsSwitch = ({ tabs, current, onClick, onClose, onDoubleClick, collapsed }: TabsSwitchProps) => {
  return (
    <div
      onDoubleClick={() => {
        collapsed ? onClick(current) : onClose();
      }}
      className="flex items-center justify-between px-2 py-2 bg-(--color-transparent-neutral-5) max-h-[2.75rem]">
      <div>
        {tabs.map((tab) => (
          <TabButton
            key={tab.id}
            tab={tab}
            onClick={onClick}
            active={current.id === tab.id}
            onDoubleClick={onDoubleClick}
          />
        ))}
      </div>
      <IconButton className="bg-transparent">
        <ChevronDown
          onClick={collapsed ? () => onClick(current) : onClose}
          className={`transition-transform duration-300 ease-in-out ${collapsed ? "rotate-180" : "rotate-0"}`}
        />
      </IconButton>
    </div>
  );
};

export default SubTabsSwitch;

```

## Archivo: `packages/MainUI/components/window/Tab.tsx`

```typescript
"use client";

import { Toolbar } from "../Toolbar/Toolbar";
import DynamicTable from "../Table";
import { useMetadataContext } from "../../hooks/useMetadataContext";
import { FormView } from "@/components/Form/FormView";
import { FormMode } from "@workspaceui/api-client/src/api/types";
import type { TabLevelProps } from "@/components/window/types";
import { useCallback, useEffect } from "react";
import { useToolbarContext } from "@/contexts/ToolbarContext";
import { useSelected } from "@/hooks/useSelected";
import { useMultiWindowURL } from "@/hooks/navigation/useMultiWindowURL";
import { NEW_RECORD_ID, FORM_MODES, TAB_MODES } from "@/utils/url/constants";

export function Tab({ tab, collapsed }: TabLevelProps) {
  const { window } = useMetadataContext();
  const {
    activeWindow,
    setSelectedRecord,
    clearSelectedRecord,
    setTabFormState,
    clearTabFormState,
    getTabFormState,
    getSelectedRecord,
  } = useMultiWindowURL();
  const { registerActions } = useToolbarContext();
  const { graph } = useSelected();

  const windowId = activeWindow?.windowId;

  const tabFormState = windowId ? getTabFormState(windowId, tab.id) : undefined;
  const selectedRecordId = windowId ? getSelectedRecord(windowId, tab.id) : undefined;

  const currentMode = tabFormState?.mode || TAB_MODES.TABLE;
  const currentRecordId = tabFormState?.recordId || "";
  const currentFormMode = tabFormState?.formMode;

  const handleSetRecordId = useCallback<React.Dispatch<React.SetStateAction<string>>>(
    (value) => {
      const newValue = typeof value === "function" ? value(currentRecordId) : value;

      if (newValue && windowId) {
        const formMode = newValue === NEW_RECORD_ID ? FORM_MODES.NEW : FORM_MODES.EDIT;

        if (newValue === NEW_RECORD_ID) {
          setTabFormState(windowId, tab.id, newValue, TAB_MODES.FORM, formMode);
        } else {
          if (selectedRecordId !== newValue) {
            setSelectedRecord(windowId, tab.id, newValue);
            setTimeout(() => {
              setTabFormState(windowId, tab.id, newValue, TAB_MODES.FORM, formMode);
            }, 50);
          } else {
            setTabFormState(windowId, tab.id, newValue, TAB_MODES.FORM, formMode);
          }
        }
      } else if (windowId) {
        clearTabFormState(windowId, tab.id);
      }
    },
    [currentRecordId, windowId, setTabFormState, clearTabFormState, tab.id, setSelectedRecord, selectedRecordId]
  );

  const handleRecordSelection = useCallback(
    (recordId: string) => {
      if (windowId) {
        if (recordId) {
          setSelectedRecord(windowId, tab.id, recordId);
        } else {
          clearSelectedRecord(windowId, tab.id);

          setTimeout(() => {
            graph.clearSelected(tab);
          }, 0);
        }
      }
    },
    [windowId, tab, setSelectedRecord, clearSelectedRecord, graph]
  );

  const handleNew = useCallback(() => {
    if (windowId) {
      setTabFormState(windowId, tab.id, NEW_RECORD_ID, TAB_MODES.FORM, FORM_MODES.NEW);
    }
  }, [windowId, tab, setTabFormState]);

  const handleBack = useCallback(() => {
    if (windowId) {
      clearTabFormState(windowId, tab.id);

      graph.clearSelected(tab);
    }
  }, [windowId, clearTabFormState, tab, graph]);

  const handleClearChildren = useCallback(() => {
    if (!windowId) return;

    const children = graph.getChildren(tab);
    if (children && children.length > 0) {
      for (const child of children) {
        clearSelectedRecord(windowId, child.id);
        clearTabFormState(windowId, child.id);
      }
    }
  }, [windowId, graph, tab, clearSelectedRecord, clearTabFormState]);

  useEffect(() => {
    const actions = {
      new: handleNew,
      back: handleBack,
    };

    registerActions(actions);
  }, [registerActions, handleNew, handleBack, tab.id]);

  useEffect(() => {
    const handleDeselection = (eventTab: typeof tab) => {
      if (eventTab.id === tab.id) {
        if (windowId) {
          const currentTabState = getTabFormState(windowId, tab.id);
          const isInFormMode = currentTabState?.mode === TAB_MODES.FORM;
          if (!isInFormMode) {
            handleClearChildren();
          }
        }
      }
    };

    graph.addListener("unselected", handleDeselection);

    return () => {
      graph.removeListener("unselected", handleDeselection);
    };
  }, [graph, tab, handleClearChildren, windowId, getTabFormState]);

  useEffect(() => {
    if (currentRecordId === NEW_RECORD_ID) {
      graph.clearSelected(tab);
    }
  }, [currentRecordId, graph, tab]);

  const shouldShowForm = currentMode === TAB_MODES.FORM && !!currentRecordId;
  const formMode = currentFormMode === FORM_MODES.NEW ? FormMode.NEW : FormMode.EDIT;

  return (
    <div
      className={`bg-(linear-gradient(180deg, #C6CFFF 0%, #FCFCFD 55.65%)) flex gap-2 max-w-auto overflow-hidden flex-col min-h-0 shadow-lg ${
        collapsed ? "hidden" : "flex-1 h-full"
      }`}>
      <Toolbar windowId={window?.id || tab.window} tabId={tab.id} isFormView={shouldShowForm} />
      {shouldShowForm ? (
        <FormView
          mode={formMode}
          tab={tab}
          window={window}
          recordId={currentRecordId}
          setRecordId={handleSetRecordId}
        />
      ) : (
        <DynamicTable setRecordId={handleSetRecordId} onRecordSelection={handleRecordSelection} />
      )}
    </div>
  );
}

export default Tab;

```

## Archivo: `packages/MainUI/components/window/TabButton.tsx`

```typescript
"use client";

import { useCallback, useMemo } from "react";
import { useMetadataContext } from "@/hooks/useMetadataContext";
import type { TabSwitchProps } from "@/components/window/types";

export const TabButton = ({
  tab,
  onClick,
  active,
  onDoubleClick,
  isWindow = false,
  showIcon = false,
  onClose,
  canClose = true,
}: TabSwitchProps) => {
  const { window } = useMetadataContext();

  const title = useMemo(() => {
    if (isWindow) {
      return tab.title || tab.name;
    }

    if (tab.tabLevel === 0) {
      return window?.name;
    }

    return tab.name;
  }, [tab.tabLevel, tab.name, tab.title, window?.name, isWindow]);

  const handleClick = useCallback(() => {
    onClick(tab);
  }, [onClick, tab]);

  const handleDoubleClick = useCallback(() => {
    onDoubleClick(tab);
  }, [onDoubleClick, tab]);

  const handleClose = useCallback(
    (e: React.MouseEvent) => {
      e.stopPropagation();
      onClose?.(e);
    },
    [onClose]
  );

  const getWindowButtonClass = () => {
    const baseWindowClass = `
      flex items-center gap-2 px-4 py-2 cursor-pointer min-w-[120px] max-w-[200px]
      transition-colors appearance-none w-full text-left
    `;

    if (active) {
      return `${baseWindowClass} bg-(--color-baseline-0) text-(--color-baseline-30)`;
    }

    return `${baseWindowClass} bg-gray-100 hover:bg-gray-50 text-gray-600`;
  };

  const getTabButtonClass = () => {
    const baseTabClass = `
      px-2 py-1 w-auto border-b-2 font-semibold
      transition-colors appearance-none
      hover:text-(--color-neutral-90) hover:border-b-(--color-neutral-90)
    `;

    if (tab.tabLevel === 0) {
      return `${baseTabClass} text-xl mb-2`;
    }

    if (active) {
      return `${baseTabClass} border-b-(--color-neutral-90)`;
    }

    return `${baseTabClass} border-b-transparent`;
  };

  // Extract close button styling logic
  const getCloseButtonClass = () => {
    const baseCloseClass = `
      w-4 h-4 flex-shrink-0 rounded-full flex items-center justify-center
      hover:bg-gray-200 transition-colors
    `;

    if (active) {
      return `${baseCloseClass} opacity-70 hover:opacity-100`;
    }

    return `${baseCloseClass} opacity-50 hover:opacity-70`;
  };

  const baseClass = isWindow ? getWindowButtonClass() : getTabButtonClass();

  if (isWindow) {
    return (
      <div className="flex items-center w-full gap-2">
        <button
          type="button"
          onClick={handleClick}
          onDoubleClick={handleDoubleClick}
          title={title}
          aria-label={title}
          className={baseClass}>
          {showIcon && <div className="w-4 h-4 flex-shrink-0">🏠</div>}
          <span className="flex-1 truncate text-sm" title={title}>
            {title}
          </span>
        </button>
        {canClose && onClose && (
          <button type="button" className={getCloseButtonClass()} onClick={handleClose} title="Cerrar ventana">
            ✕
          </button>
        )}
      </div>
    );
  }

  if (!title) return null;

  return (
    <span>
      <button
        type="button"
        onClick={handleClick}
        onDoubleClick={handleDoubleClick}
        title={title}
        aria-label={title}
        className={baseClass}>
        {title}
      </button>
    </span>
  );
};

export default TabButton;

```

## Archivo: `packages/MainUI/components/window/TabContainer.tsx`

```typescript
import type { Tab } from "@workspaceui/api-client/src/api/types";

const BASE_STYLES = "flex flex-col overflow-hidden min-h-0 m-0 mb-2 rounded-xl";
const COLLAPSED_STYLES = "cursor-pointer";
const MAIN_TAB_STYLES = "";
const SUB_TAB_STYLES = "border border-(--color-transparent-neutral-10) flex flex-col gap-2";

export type ContainerProps = React.PropsWithChildren<
  React.HTMLProps<HTMLDivElement> & {
    collapsed: boolean;
    current: Tab;
    isTopExpanded?: boolean;
    customHeight?: number;
  }
>;

export function TabContainer({
  className = "",
  collapsed,
  current,
  isTopExpanded = false,
  customHeight,
  ...props
}: ContainerProps) {
  const getExpansionStyles = () => {
    if (collapsed) {
      return COLLAPSED_STYLES;
    }

    if (isTopExpanded) {
      return "flex-1";
    }

    return "";
  };

  const getCustomStyle = () => {
    if (!collapsed && !isTopExpanded) {
      return { height: `${customHeight}%` };
    }
    return {};
  };

  return (
    <div
      {...props}
      className={`${BASE_STYLES} ${current.tabLevel === 0 ? MAIN_TAB_STYLES : SUB_TAB_STYLES} ${getExpansionStyles()} ${className}`}
      style={{ ...props.style, ...getCustomStyle() }}
    />
  );
}

export default TabContainer;

```

## Archivo: `packages/MainUI/components/window/Tabs.tsx`

```typescript
"use client";

import { useCallback, useState, useEffect } from "react";
import type { Tab as TabType } from "@workspaceui/api-client/src/api/types";
import type { TabsProps } from "@/components/window/types";
import { TabContainer } from "@/components/window/TabContainer";
import { SubTabsSwitch } from "@/components/window/SubTabsSwitch";
import { Tab } from "@/components/window/Tab";
import { useSelected } from "@/hooks/useSelected";
import TabContextProvider from "@/contexts/tab";
import ResizeHandle from "@workspaceui/componentlibrary/src/components/ResizeHandle";

interface ExtendedTabsProps extends TabsProps {
  isTopGroup?: boolean;
  onTabChange?: (tab: TabType) => void;
}

export default function TabsComponent({ tabs, isTopGroup = false, onTabChange }: ExtendedTabsProps) {
  const { activeLevels, setActiveLevel } = useSelected();
  const [current, setCurrent] = useState(tabs[0]);
  const collapsed = !activeLevels.includes(current.tabLevel);
  const [expand, setExpanded] = useState(false);
  const [customHeight, setCustomHeight] = useState(50);

  useEffect(() => {
    if (onTabChange && current) {
      onTabChange(current);
    }
  }, [current, onTabChange]);

  const handleClick = useCallback(
    (tab: TabType) => {
      setCustomHeight(50);
      setCurrent(tab);
      setActiveLevel(tab.tabLevel);
    },
    [setActiveLevel]
  );

  const handleDoubleClick = useCallback(
    (tab: TabType) => {
      setCurrent(tab);
      const newExpand = !expand;
      setExpanded(newExpand);
      setActiveLevel(tab.tabLevel, newExpand);
    },
    [expand, setActiveLevel]
  );

  const handleHeightChange = useCallback((height: number) => {
    setCustomHeight(height);
  }, []);

  const handleClose = useCallback(() => {
    setActiveLevel(current.tabLevel - 1);
  }, [current.tabLevel, setActiveLevel]);

  const isTopExpanded = !collapsed && isTopGroup;
  const showResizeHandle = !isTopExpanded && !collapsed;

  const renderTabContent = () => {
    if (current.tabLevel === 0) {
      return null;
    }

    const subTabsSwitch = (
      <SubTabsSwitch
        current={current}
        tabs={tabs}
        collapsed={collapsed}
        onClick={handleClick}
        onDoubleClick={handleDoubleClick}
        onClose={handleClose}
      />
    );

    if (showResizeHandle) {
      return (
        <ResizeHandle initialHeight={customHeight} minHeight={9} maxOffsetRem={9} onHeightChange={handleHeightChange}>
          {subTabsSwitch}
        </ResizeHandle>
      );
    }

    return subTabsSwitch;
  };

  return (
    <TabContainer current={current} collapsed={collapsed} isTopExpanded={isTopExpanded} customHeight={customHeight}>
      {renderTabContent()}
      <TabContextProvider tab={current}>
        <Tab tab={current} collapsed={collapsed} />
      </TabContextProvider>
    </TabContainer>
  );
}

```

## Archivo: `packages/MainUI/components/window/TabsContainer.tsx`

```typescript
"use client";

import { useEffect, useMemo, useState, useCallback } from "react";
import Tabs from "@/components/window/Tabs";
import { useMetadataContext } from "@/hooks/useMetadataContext";
import { useMultiWindowURL } from "@/hooks/navigation/useMultiWindowURL";
import { useSelected } from "@/hooks/useSelected";
import { groupTabsByLevel } from "@workspaceui/api-client/src/utils/metadata";
import { useTranslation } from "@/hooks/useTranslation";
import AppBreadcrumb from "@/components/Breadcrums";
import type { Tab } from "@workspaceui/api-client/src/api/types";
import { shouldShowTab, type TabWithParentInfo } from "@/utils/tabUtils";

export default function TabsContainer() {
  const { activeLevels, clearAllStates } = useSelected();
  const { activeWindow } = useMultiWindowURL();
  const { getWindowMetadata } = useMetadataContext();
  const { t } = useTranslation();

  const [activeTabsByLevel, setActiveTabsByLevel] = useState<Map<number, string>>(new Map());

  const windowData = useMemo(() => {
    return activeWindow ? getWindowMetadata(activeWindow.windowId) : undefined;
  }, [activeWindow, getWindowMetadata]);

  useEffect(() => {
    if (activeWindow?.windowId) {
      clearAllStates();
      setActiveTabsByLevel(new Map());
    }
  }, [activeWindow?.windowId, clearAllStates]);

  const groupedTabs = useMemo(() => {
    return windowData ? groupTabsByLevel(windowData) : [];
  }, [windowData]);

  const handleTabChange = useCallback((tab: Tab) => {
    setActiveTabsByLevel((prev) => {
      const newMap = new Map(prev);
      newMap.set(tab.tabLevel, tab.id);
      return newMap;
    });
  }, []);

  const getActiveTabForLevel = useCallback(
    (level: number): Tab | null => {
      const tabGroup = groupedTabs.find((group) => group[0]?.tabLevel === level);
      if (!tabGroup || tabGroup.length === 0) return null;

      const activeTabId = activeTabsByLevel.get(level);
      if (activeTabId) {
        const activeTab = tabGroup.find((tab) => tab.id === activeTabId);
        if (activeTab) return activeTab;
      }

      return tabGroup[0];
    },
    [groupedTabs, activeTabsByLevel]
  );

  const filteredGroupedTabs = useMemo(() => {
    return groupedTabs.map((tabGroup) => {
      const currentLevel = tabGroup[0]?.tabLevel;

      if (currentLevel === 0) {
        return tabGroup;
      }

      const parentLevel = currentLevel - 1;
      const activeParentTab = getActiveTabForLevel(parentLevel);

      const filtered = tabGroup.filter((tab) => {
        const shouldShow = shouldShowTab(tab as TabWithParentInfo, activeParentTab);
        return shouldShow;
      });

      return filtered;
    });
  }, [groupedTabs, getActiveTabForLevel]);

  if (!windowData) {
    return <div>{t("common.loadingWindowContent")}</div>;
  }

  const firstExpandedIndex = filteredGroupedTabs.findIndex(
    (tabs) => tabs.length > 0 && activeLevels.includes(tabs[0].tabLevel)
  );

  return (
    <>
      <AppBreadcrumb allTabs={filteredGroupedTabs} />
      <div className="flex flex-col flex-1 overflow-hidden w-full">
        {filteredGroupedTabs.map((tabs, index) => {
          if (tabs.length === 0) return null;

          const isTopGroup = index === firstExpandedIndex && firstExpandedIndex !== -1;

          return <Tabs key={tabs[0].id} tabs={tabs} isTopGroup={isTopGroup} onTabChange={handleTabChange} />;
        })}
      </div>
    </>
  );
}

```

## Archivo: `packages/MainUI/components/window/Window.tsx`

```typescript
"use client";

import { useEffect } from "react";
import { ErrorDisplay } from "@/components/ErrorDisplay";
import Loading from "@/components/loading";
import { SelectedProvider } from "@/contexts/selected";
import { useMetadataContext } from "@/hooks/useMetadataContext";
import { useTranslation } from "@/hooks/useTranslation";
import TabsContainer from "@/components/window/TabsContainer";

export default function Window({ windowId }: { windowId: string }) {
  const { getWindowMetadata, isWindowLoading, getWindowError, loadWindowData } = useMetadataContext();
  const { t } = useTranslation();

  const windowData = getWindowMetadata(windowId);
  const isLoading = isWindowLoading(windowId);
  const error = getWindowError(windowId);

  useEffect(() => {
    if (!windowData && !isLoading && !error) {
      loadWindowData(windowId);
    }
  }, [windowId, windowData, isLoading, error, loadWindowData]);

  if (isLoading) return <Loading />;
  if (error) return <ErrorDisplay title={error.message} />;
  if (!windowData)
    return (
      <ErrorDisplay title={t("errors.windowNotFound.title")} description={t("errors.windowNotFound.description")} />
    );

  return (
    <SelectedProvider tabs={windowData.tabs} windowId={windowId}>
      <TabsContainer />
    </SelectedProvider>
  );
}

```

## Archivo: `packages/MainUI/components/window/styles.ts`

```typescript
import { useMemo } from "react";
import { type Theme, useTheme, type SxProps } from "@mui/material";

type StylesType = {
  sx: {
    container: SxProps<Theme>;
    button: (isActive?: boolean) => SxProps<Theme>;
  };
};

export const useStyle = (): StylesType => {
  const theme = useTheme();

  return useMemo(
    () => ({
      sx: {
        container: {
          padding: "0.5rem",
        },
        button: (isActive?: boolean) => ({
          color: isActive ? theme.palette.text.primary : theme.palette.text.secondary,
          backgroundColor: isActive ? theme.palette.background.default : theme.palette.action.disabled,
          borderRadius: "0.5rem",
          border: `1px solid ${theme.palette.divider}`,
          padding: theme.spacing(1),
          transition: theme.transitions.create(["color", "background-color"], {
            duration: theme.transitions.duration.short,
          }),
          "&:hover": {
            borderRadius: "0.5rem",
            border: `1px solid ${theme.palette.divider}`,
            background: theme.palette.baselineColor.neutral[20],
          },
        }),
      },
    }),
    [theme]
  );
};

```

## Archivo: `packages/MainUI/components/window/types.ts`

```typescript
import type { Tab } from "@workspaceui/api-client/src/api/types";

export type TabsProps = { tabs: Tab[] };
export type TabsSwitchProps = {
  current: Tab;
  tabs: Tab[];
  collapsed?: boolean;
  onClick: (tab: Tab) => void;
  onDoubleClick: (tab: Tab) => void;
  onClose: () => void;
};
export type TabSwitchProps = {
  tab: Tab;
  active: boolean;
  onClick: (tab: Tab) => void;
  onDoubleClick: (tab: Tab) => void;
  isWindow?: boolean;
  showIcon?: boolean;
  onClose?: (e: React.MouseEvent) => void;
  canClose?: boolean;
};

export type TabLevelProps = { tab: Tab; collapsed?: boolean };

```

## Archivo: `packages/MainUI/constants/breadcrumb.ts`

```typescript
export const ROUTE_IDS = {
  NEW_RECORD: "new-record",
};

export const BREADCRUMB = {
  HOME: {
    ICON: "🏠",
  },
};

```

## Archivo: `packages/MainUI/constants/config.ts`

```typescript
export const CALLOUTS_ENABLED = true;
export const HEALTH_CHECK_MAX_ATTEMPTS = 5;
export const HEALTH_CHECK_RETRY_DELAY_MS = 2000;

```

## Archivo: `packages/MainUI/constants/iconConstants.tsx`

```typescript
import ChevronDown from "../../ComponentLibrary/src/assets/icons/chevron-down.svg";
import { theme } from "@workspaceui/componentlibrary/src/theme";

export const defaultIcon = <ChevronDown fill={theme.palette.baselineColor.neutral[80]} />;

```

## Archivo: `packages/MainUI/contexts/FormInitializationContext.tsx`

```typescript
import { createContext, useContext } from "react";

interface FormInitializationContextType {
  isFormInitializing: boolean;
}

const FormInitializationContext = createContext<FormInitializationContextType | undefined>(undefined);

export const FormInitializationProvider = FormInitializationContext.Provider;

export const useFormInitializationContext = () => {
  const context = useContext(FormInitializationContext);
  if (context === undefined) {
    return { isFormInitializing: false };
  }
  return context;
};

```

## Archivo: `packages/MainUI/contexts/ToolbarContext.tsx`

```typescript
"use client";

import { createContext, useContext, useState, useCallback, useMemo } from "react";

type ToolbarActions = {
  save: () => Promise<void>;
  refresh: () => void;
  new: () => void;
  back: () => void;
  filter: () => void;
  columnFilters: (buttonRef?: HTMLElement | null) => void;
};

type ToolbarContextType = {
  onSave: () => Promise<void>;
  onRefresh: () => void;
  onNew: () => void;
  onBack: () => void;
  onFilter: () => void;
  onColumnFilters: (buttonRef?: HTMLElement | null) => void;
  registerActions: (actions: Partial<ToolbarActions>) => void;
};

const initialState: ToolbarActions = {
  save: async () => {},
  refresh: () => {},
  new: () => {},
  back: () => {},
  filter: () => {},
  columnFilters: () => {},
};

const ToolbarContext = createContext<ToolbarContextType>({} as ToolbarContextType);

export const useToolbarContext = () => useContext(ToolbarContext);

export const ToolbarProvider = ({ children }: React.PropsWithChildren) => {
  const [
    { new: onNew, refresh: onRefresh, save: onSave, back: onBack, filter: onFilter, columnFilters: onColumnFilters },
    setActions,
  ] = useState<ToolbarActions>(initialState);

  const registerActions = useCallback((newActions: Partial<ToolbarActions>) => {
    setActions((prev) => ({ ...prev, ...newActions }));
  }, []);

  const value = useMemo(
    () => ({ onSave, onRefresh, onNew, onBack, onFilter, onColumnFilters, registerActions }),
    [onNew, onRefresh, onSave, onBack, onFilter, onColumnFilters, registerActions]
  );

  return <ToolbarContext.Provider value={value}>{children}</ToolbarContext.Provider>;
};

```

## Archivo: `packages/MainUI/contexts/api/index.tsx`

```typescript
"use client";

import { createContext, useCallback, useEffect, useReducer, useRef } from "react";
import { ErrorDisplay } from "@/components/ErrorDisplay";
import { useTranslation } from "@/hooks/useTranslation";
import { HEALTH_CHECK_MAX_ATTEMPTS, HEALTH_CHECK_RETRY_DELAY_MS } from "@/constants/config";
import { initialState, stateReducer } from "./state";
import { performHealthCheck } from "../../utils/health-check";
import { Metadata } from "@workspaceui/api-client/src/api/metadata";
import { datasource } from "@workspaceui/api-client/src/api/datasource";
import Loading from "@/components/loading";

export const ApiContext = createContext<string | null>(null);

export default function ApiProvider({ children, url }: React.PropsWithChildren<{ url: string }>) {
  const [state, dispatch] = useReducer(stateReducer, initialState);
  const controllerRef = useRef<AbortController>(new AbortController());
  const { t } = useTranslation();

  const healthCheck = useCallback(() => {
    const signal = controllerRef.current.signal;

    if (url && !signal.aborted) {
      dispatch({ type: "RESET" });
      performHealthCheck(
        url,
        signal,
        HEALTH_CHECK_MAX_ATTEMPTS,
        HEALTH_CHECK_RETRY_DELAY_MS,
        () => {
          if (signal.aborted) return;
          dispatch({ type: "SET_CONNECTED" });
        },
        () => {
          if (signal.aborted) return;
          dispatch({ type: "SET_ERROR" });
        }
      );
    }
  }, [url]);

  useEffect(() => {
    const controller = controllerRef.current;
    healthCheck();

    return () => {
      controller.abort();
      controllerRef.current = new AbortController();
    };
  }, [healthCheck]);

  useEffect(() => {
    if (url) {
      Metadata.setBaseUrl(url);
      datasource.setBaseUrl(url);
    }
  }, [url]);

  if (state.connected) {
    return <ApiContext.Provider value={url}>{children}</ApiContext.Provider>;
  }

  if (state.error) {
    return (
      <div className="flex flex-col items-center justify-center h-full w-full">
        <ErrorDisplay
          title={t("errors.networkError.title")}
          description={t("errors.networkError.description")}
          showRetry={true}
          onRetry={healthCheck}
        />
      </div>
    );
  }

  return <Loading />;
}

```

## Archivo: `packages/MainUI/contexts/api/state.ts`

```typescript
export interface State {
  connected: boolean;
  error: boolean;
  loading: boolean;
}

export type Action = { type: "SET_CONNECTED" } | { type: "SET_ERROR" } | { type: "RESET" };

export const initialState: State = {
  connected: false,
  error: false,
  loading: false,
};

export function stateReducer(state: State, action: Action): State {
  switch (action.type) {
    case "SET_CONNECTED":
      return { ...state, connected: true, error: false, loading: false };
    case "SET_ERROR":
      return { ...state, error: true, connected: false, loading: false };
    case "RESET":
      return initialState;
    default:
      return state;
  }
}

```

## Archivo: `packages/MainUI/contexts/api/wrapper.tsx`

```typescript
import { FALLBACK_URL } from "@/utils/constants";
import { connection } from "next/server";
import ApiProvider from ".";

export default async function ApiProviderWrapper({ children }: React.PropsWithChildren) {
  await connection();

  const url = process.env.ETENDO_CLASSIC_URL || FALLBACK_URL;

  return <ApiProvider url={url}>{children}</ApiProvider>;
}

```

## Archivo: `packages/MainUI/contexts/datasourceContext.tsx`

```typescript
"use client";

import { createContext, useContext, useCallback, useRef, type ReactNode, useMemo } from "react";

interface DatasourceContextValue {
  registerDatasource: (tabId: string, removeRecordLocally: (recordId: string) => void) => void;
  unregisterDatasource: (tabId: string) => void;
  removeRecordFromDatasource: (tabId: string, recordId: string) => void;
  refetchDatasource: (tabId: string) => void;
  registerRefetchFunction: (tabId: string, refetchFunction: () => void) => void;
}

const DatasourceContext = createContext<DatasourceContextValue | undefined>(undefined);

export function DatasourceProvider({ children }: { children: ReactNode }) {
  const datasourcesRef = useRef<Record<string, (recordId: string) => void>>({});

  const refetchFunctionsRef = useRef<Record<string, () => void>>({});

  const registerRefetchFunction = useCallback((tabId: string, refetchFunction: () => void) => {
    refetchFunctionsRef.current[tabId] = refetchFunction;
  }, []);

  const refetchDatasource = useCallback((tabId: string) => {
    const refetchFunction = refetchFunctionsRef.current[tabId];
    if (refetchFunction) {
      refetchFunction();
    }
  }, []);

  const registerDatasource = useCallback((tabId: string, removeRecordLocally: (recordId: string) => void) => {
    datasourcesRef.current[tabId] = removeRecordLocally;
  }, []);

  const unregisterDatasource = useCallback((tabId: string) => {
    delete datasourcesRef.current[tabId];
  }, []);

  const removeRecordFromDatasource = useCallback((tabId: string, recordId: string) => {
    const removeFunction = datasourcesRef.current[tabId];
    if (removeFunction) {
      removeFunction(recordId);
    }
  }, []);

  const value = useMemo(
    () => ({
      registerDatasource,
      unregisterDatasource,
      removeRecordFromDatasource,
      registerRefetchFunction,
      refetchDatasource,
    }),
    [registerDatasource, unregisterDatasource, removeRecordFromDatasource, registerRefetchFunction, refetchDatasource]
  );

  return <DatasourceContext.Provider value={value}>{children}</DatasourceContext.Provider>;
}

export function useDatasourceContext() {
  const context = useContext(DatasourceContext);
  if (context === undefined) {
    throw new Error("useDatasourceContext must be used within a DatasourceProvider");
  }
  return context;
}

```

## Archivo: `packages/MainUI/contexts/language.tsx`

```typescript
"use client";

import { usePrevious } from "@/hooks/usePrevious";
import useLocalStorage from "@workspaceui/componentlibrary/src/hooks/useLocalStorage";
import { Metadata } from "@workspaceui/api-client/src/api/metadata";
import type { Labels } from "@workspaceui/api-client/src/api/types";
import { useRouter } from "next/navigation";
import { createContext, useCallback, useContext, useEffect, useMemo, useState } from "react";
import { getLanguageFlag } from "../utils/languageFlags";
import type { Language, LanguageContextType } from "./types";

export const LanguageContext = createContext({} as LanguageContextType);

export default function LanguageProvider({ children }: React.PropsWithChildren) {
  const [language, setLanguage] = useLocalStorage<Language | null>("language", null);
  const [labels, setLabels] = useState<Labels>({});
  const prevLanguage = usePrevious(language);
  const router = useRouter();

  const getFlag = useCallback(
    (lang?: Language | null) => {
      return getLanguageFlag(lang || language);
    },
    [language]
  );

  const getLabel = useCallback((label: string) => labels[label] ?? label, [labels]);

  const value = useMemo(
    () => ({
      language,
      setLanguage,
      setLabels,
      getFlag,
      prevLanguage,
      getLabel,
    }),
    [language, setLanguage, getFlag, prevLanguage, getLabel]
  );

  useEffect(() => {
    if (language) {
      Metadata.setLanguage(language);
    }
  }, [language]);

  useEffect(() => {
    if (prevLanguage && language !== prevLanguage) {
      router.push("/");
    }
  }, [language, prevLanguage, router]);

  return <LanguageContext.Provider value={value}>{children}</LanguageContext.Provider>;
}

export const useLanguage = () => {
  const context = useContext(LanguageContext);

  if (context === undefined) {
    throw new Error("useLanguage must be used within a LanguageProvider");
  }

  return context;
};

```

## Archivo: `packages/MainUI/contexts/loading.tsx`

```typescript
"use client";

import { createContext, useContext, useState, useCallback, useMemo } from "react";

type LoadingContextType = {
  isLoading: boolean;
  showLoading: () => void;
  hideLoading: () => void;
};

const LoadingContext = createContext<LoadingContextType | undefined>(undefined);

export default function LoadingProvider({
  children,
}: {
  children: React.ReactNode;
}) {
  const [isLoading, setIsLoading] = useState(false);

  const showLoading = useCallback(() => {
    setIsLoading(true);
  }, []);

  const hideLoading = useCallback(() => {
    setIsLoading(false);
  }, []);

  const value = useMemo<LoadingContextType>(
    () => ({ isLoading, showLoading, hideLoading }),
    [isLoading, showLoading, hideLoading]
  );

  return <LoadingContext.Provider value={value}>{children}</LoadingContext.Provider>;
}

export const useLoading = (): LoadingContextType => {
  const context = useContext(LoadingContext);

  if (context === undefined) {
    throw new Error("useLoading must be used within a LoadingProvider");
  }

  return context;
};

```

## Archivo: `packages/MainUI/contexts/metadata.tsx`

```typescript
"use client";

import { createContext, useCallback, useEffect, useMemo, useState } from "react";
import { type Etendo, Metadata } from "@workspaceui/api-client/src/api/metadata";
import { groupTabsByLevel } from "@workspaceui/api-client/src/utils/metadata";
import type { IMetadataContext } from "./types";
import { useDatasourceContext } from "./datasourceContext";
import { mapBy } from "@/utils/structures";
import { useMultiWindowURL } from "@/hooks/navigation/useMultiWindowURL";
import { logger } from "@/utils/logger";

export const MetadataContext = createContext({} as IMetadataContext);

export default function MetadataProvider({ children }: React.PropsWithChildren) {
  const [windowsData, setWindowsData] = useState<Record<string, Etendo.WindowMetadata>>({});
  const [loadingWindows, setLoadingWindows] = useState<Record<string, boolean>>({});
  const [errors, setErrors] = useState<Record<string, Error | undefined>>({});

  const { activeWindow } = useMultiWindowURL();
  const { removeRecordFromDatasource } = useDatasourceContext();

  const currentWindowId = activeWindow?.windowId;
  const currentWindow = currentWindowId ? windowsData[currentWindowId] : undefined;
  const currentLoading = currentWindowId ? loadingWindows[currentWindowId] || false : false;
  const currentError = currentWindowId ? errors[currentWindowId] : undefined;

  const currentGroupedTabs = useMemo(() => {
    return currentWindow ? groupTabsByLevel(currentWindow) : [];
  }, [currentWindow]);

  const currentTabs = useMemo(() => {
    return currentWindow?.tabs ? mapBy(currentWindow.tabs, "id") : {};
  }, [currentWindow?.tabs]);

  const loadWindowData = useCallback(
    async (windowId: string): Promise<Etendo.WindowMetadata> => {
      if (windowsData[windowId]) {
        return windowsData[windowId];
      }

      try {
        setLoadingWindows((prev) => ({ ...prev, [windowId]: true }));
        setErrors((prev) => ({ ...prev, [windowId]: undefined }));

        logger.info(`Loading metadata for window ${windowId}`);

        Metadata.clearWindowCache(windowId);
        const newWindowData = await Metadata.forceWindowReload(windowId);

        setWindowsData((prev) => ({ ...prev, [windowId]: newWindowData }));

        return newWindowData;
      } catch (err) {
        const error = err as Error;
        logger.warn(`Error loading window ${windowId}:`, error);

        setErrors((prev) => ({ ...prev, [windowId]: error }));
        throw error;
      } finally {
        setLoadingWindows((prev) => ({ ...prev, [windowId]: false }));
      }
    },
    [windowsData]
  );

  const getWindowMetadata = useCallback(
    (windowId: string) => {
      return windowsData[windowId];
    },
    [windowsData]
  );

  const getWindowTitle = useCallback(
    (windowId: string) => {
      const windowData = windowsData[windowId];
      return windowData?.name || windowData?.window$_identifier || `Window ${windowId}`;
    },
    [windowsData]
  );

  const isWindowLoading = useCallback(
    (windowId: string) => {
      return loadingWindows[windowId] || false;
    },
    [loadingWindows]
  );

  const getWindowError = useCallback(
    (windowId: string) => {
      return errors[windowId];
    },
    [errors]
  );

  useEffect(() => {
    if (activeWindow?.windowId && !windowsData[activeWindow.windowId] && !loadingWindows[activeWindow.windowId]) {
      loadWindowData(activeWindow.windowId).catch(() => {
        // Error handled in load
      });
    }
  }, [activeWindow?.windowId, windowsData, loadingWindows, loadWindowData]);

  const removeRecord = useCallback(
    (tabId: string, recordId: string) => {
      removeRecordFromDatasource(tabId, recordId);
    },
    [removeRecordFromDatasource]
  );

  const emptyWindowDataName = useCallback(() => {
    if (!currentWindowId) return;

    setWindowsData((prevWindowsData) => ({
      ...prevWindowsData,
      [currentWindowId]: {
        ...prevWindowsData[currentWindowId],
        name: "",
        window$_identifier: "",
      } as Etendo.WindowMetadata,
    }));
  }, [currentWindowId]);

  const refetchCurrentWindow = useCallback(() => {
    if (currentWindowId) {
      setWindowsData((prev) => {
        const { [currentWindowId]: _, ...rest } = prev;
        return rest;
      });

      return loadWindowData(currentWindowId);
    }
    return Promise.resolve({} as Etendo.WindowMetadata);
  }, [currentWindowId, loadWindowData]);

  const value = useMemo<IMetadataContext>(
    () => ({
      windowId: currentWindowId,
      window: currentWindow,
      loading: currentLoading,
      error: currentError,
      groupedTabs: currentGroupedTabs,
      tabs: currentTabs,
      refetch: refetchCurrentWindow,
      removeRecord,
      emptyWindowDataName,

      loadWindowData,
      getWindowMetadata,
      getWindowTitle,
      isWindowLoading,
      getWindowError,
      windowsData,
      loadingWindows,
      errors,
    }),
    [
      currentWindowId,
      currentWindow,
      currentLoading,
      currentError,
      currentGroupedTabs,
      currentTabs,
      refetchCurrentWindow,
      removeRecord,
      emptyWindowDataName,
      loadWindowData,
      getWindowMetadata,
      getWindowTitle,
      isWindowLoading,
      getWindowError,
      windowsData,
      loadingWindows,
      errors,
    ]
  );

  return <MetadataContext.Provider value={value}>{children}</MetadataContext.Provider>;
}

```

## Archivo: `packages/MainUI/contexts/record.tsx`

```typescript
"use client";

import { useState, useMemo, useCallback } from "react";
import { ensureString } from "@workspaceui/componentlibrary/src/helpers/ensureString";
import translations from "@workspaceui/componentlibrary/src/locales";
import { createContext } from "react";
import type { Organization } from "../../storybook/src/stories/Components/Table/types";

export interface RecordContextType {
  selectedRecord: Organization | null;
  setSelectedRecord: (record: Organization | null) => void;
  getFormattedRecord: (record: Organization | null) => { identifier: string; type: string } | null;
}

export const RecordContext = createContext({} as RecordContextType);

export function RecordProvider({ children }: React.PropsWithChildren) {
  const [selectedRecord, setSelectedRecord] = useState<Organization | null>(null);

  const getFormattedRecord: RecordContextType["getFormattedRecord"] = useCallback((record: Organization | null) => {
    if (!record) return null;
    return {
      identifier: ensureString(record.documentNo?.value) || translations.en_US.table.labels.noIdentifier,
      type: ensureString(record.transactionDocument?.value) || translations.en_US.table.labels.noType,
    };
  }, []);

  const value: RecordContextType = useMemo(
    () => ({
      selectedRecord,
      setSelectedRecord,
      getFormattedRecord,
    }),
    [getFormattedRecord, selectedRecord]
  );

  return <RecordContext.Provider value={value}>{children}</RecordContext.Provider>;
}

```

## Archivo: `packages/MainUI/contexts/searchContext.tsx`

```typescript
import { createContext, useContext, useMemo, useState } from "react";

interface SearchContextType {
  searchQuery: string;
  setSearchQuery: (query: string) => void;
}

const SearchContext = createContext<SearchContextType>({} as SearchContextType);

export const SearchProvider = ({ children }: { children: React.ReactNode }) => {
  const [searchQuery, setSearchQuery] = useState("");
  const value = useMemo(() => ({ searchQuery, setSearchQuery }), [searchQuery]);

  return <SearchContext.Provider value={value}>{children}</SearchContext.Provider>;
};

export const useSearch = () => useContext(SearchContext);

```

## Archivo: `packages/MainUI/contexts/selected.tsx`

```typescript
"use client";

import Graph from "@/data/graph";
import type { Tab } from "@workspaceui/api-client/src/api/types";
import { createContext, useCallback, useMemo, useState } from "react";
import { type TabMode, TAB_MODES } from "@/utils/url/constants";

interface TabStates {
  [tabId: string]: {
    recordId: string;
    mode: TabMode;
  };
}

interface SelectedContext {
  graph: Graph<Tab>;
  activeLevels: number[];
  tabStates: TabStates;
  setActiveLevel: (level: number, expand?: boolean) => void;
  setTabRecordId: (tabId: string, recordId: string) => void;
  getTabRecordId: (tabId: string) => string;
  clearTabRecord: (tabId: string) => void;
  clearAllStates: () => void;
}

export const SelectContext = createContext<SelectedContext>({} as SelectedContext);

const windowGraphCache = new Map<string, Graph<Tab>>();

export const SelectedProvider = ({
  children,
  tabs,
  windowId,
}: React.PropsWithChildren<{
  tabs: Tab[];
  windowId: string;
}>) => {
  const [activeLevels, setActiveLevels] = useState<number[]>([0]);
  const [tabStates, setTabStates] = useState<TabStates>({});

  const graph = useMemo(() => {
    if (!windowGraphCache.has(windowId)) {
      windowGraphCache.set(windowId, new Graph<Tab>(tabs));
    }
    const cachedGraph = windowGraphCache.get(windowId);
    if (!cachedGraph) {
      throw new Error(`Failed to retrieve graph for window id: ${windowId}`);
    }
    return cachedGraph;
  }, [windowId, tabs]);

  const clearAllStates = useCallback(() => {
    setTabStates({});
    setActiveLevels([0]);

    for (const tab of tabs) {
      graph.clearSelected(tab);
      graph.clearSelectedMultiple(tab);
    }
  }, [tabs, graph]);

  const setTabRecordId = useCallback((tabId: string, recordId: string) => {
    setTabStates((prev) => ({
      ...prev,
      [tabId]: {
        recordId,
        mode: recordId ? TAB_MODES.FORM : TAB_MODES.TABLE,
      },
    }));
  }, []);

  const getTabRecordId = useCallback(
    (tabId: string) => {
      return tabStates[tabId]?.recordId || "";
    },
    [tabStates]
  );

  const clearTabRecord = useCallback((tabId: string) => {
    setTabStates((prev) => {
      const newState = { ...prev };
      delete newState[tabId];
      return newState;
    });
  }, []);

  const setActiveLevel = useCallback(
    (level: number, expand?: boolean) => {
      setActiveLevels((prev) => {
        if (expand) {
          return [level];
        }

        const maxLevel = prev[prev.length - 1];

        if (level === 0) {
          return [0];
        }
        if (maxLevel === level) {
          return prev;
        }
        if (maxLevel > level) {
          return [level - 1, level];
        }
        if (maxLevel > level) {
          setTabStates((currentStates) => {
            const newStates = { ...currentStates };
            for (const tabId of Object.keys(newStates)) {
              const tab = tabs.find((t) => t.id === tabId);
              if (tab && tab.tabLevel > level) {
                delete newStates[tabId];
              }
            }
            return newStates;
          });
          return [level - 1, level];
        }
        return [maxLevel, level];
      });
    },
    [tabs]
  );

  const value = useMemo<SelectedContext>(
    () => ({
      graph,
      activeLevels,
      tabStates,
      setActiveLevel,
      setTabRecordId,
      getTabRecordId,
      clearTabRecord,
      clearAllStates,
    }),
    [activeLevels, graph, setActiveLevel, tabStates, setTabRecordId, getTabRecordId, clearTabRecord, clearAllStates]
  );

  return <SelectContext.Provider value={value}>{children}</SelectContext.Provider>;
};

export default SelectedProvider;

```

## Archivo: `packages/MainUI/contexts/tab.tsx`

```typescript
import { createContext, useCallback, useContext, useMemo, useState } from "react";
import type { EntityData, Tab } from "@workspaceui/api-client/src/api/types";
import { ToolbarProvider } from "./ToolbarContext";
import { SearchProvider } from "./searchContext";
import { useSelectedRecord } from "@/hooks/useSelectedRecord";
import { useSelected } from "@/hooks/useSelected";
import { useSelectedRecords } from "@/hooks/useSelectedRecords";

interface TabContextI {
  tab: Tab;
  record?: EntityData | null;
  parentTab?: Tab | null;
  parentRecord?: EntityData | null;
  parentRecords?: EntityData[] | null;
  hasFormChanges: boolean;
  markFormAsChanged: () => void;
  resetFormChanges: () => void;
}

const TabContext = createContext<TabContextI>({} as TabContextI);

export default function TabContextProvider({ tab, children }: React.PropsWithChildren<{ tab: Tab }>) {
  const [hasFormChanges, setHasFormChanges] = useState(false);
  const { graph } = useSelected();
  const record = useSelectedRecord(tab);
  const parentTab = graph.getParent(tab);
  const parentRecord = useSelectedRecord(parentTab);
  const parentRecords = useSelectedRecords(parentTab);

  const markFormAsChanged = useCallback(() => setHasFormChanges(true), []);
  const resetFormChanges = useCallback(() => setHasFormChanges(false), []);

  const value = useMemo(
    () => ({
      tab,
      record,
      parentTab,
      parentRecord,
      parentRecords,
      hasFormChanges,
      markFormAsChanged,
      resetFormChanges,
    }),
    [parentRecord, parentTab, parentRecords, record, tab, hasFormChanges, markFormAsChanged, resetFormChanges]
  );

  return (
    <TabContext.Provider value={value}>
      <ToolbarProvider>
        <SearchProvider>{children}</SearchProvider>
      </ToolbarProvider>
    </TabContext.Provider>
  );
}

export const useTabContext = () => {
  const context = useContext(TabContext);

  if (!context) {
    throw new Error("useTabContext must be used within a TabContextProvider");
  }

  return context;
};

```

## Archivo: `packages/MainUI/contexts/tabs.tsx`

```typescript
"use client";

import { createContext, useContext, useMemo, useRef, useState, useCallback, useEffect } from "react";
import { useMultiWindowURL } from "@/hooks/navigation/useMultiWindowURL";

type TabsContextType = {
  containerRef: React.RefObject<HTMLDivElement>;
  windowsContainerRef: React.RefObject<HTMLDivElement>;
  tabRefs: React.MutableRefObject<{ [key: string]: HTMLDivElement | null }>;
  showLeftScrollButton: boolean;
  showRightScrollButton: boolean;
  showRightMenuButton: boolean;
  handleScrollLeft: (e: React.MouseEvent) => void;
  handleScrollRight: (e: React.MouseEvent) => void;
};

const DEFAULT_SCROLL_AMOUNT = 200;
const DEFAULT_BUTTON_ICON_SIZE = 50;
const DEFAULT_DEBOUNCE_DELAY = 200;

const checkIfAtStart = (scrollLeft: number) => {
  return scrollLeft <= 0;
};

const checkIfAtEnd = (scrollRight: number, clientWidth: number, scrollWidth: number) => {
  return scrollRight + clientWidth >= scrollWidth - DEFAULT_BUTTON_ICON_SIZE;
};

const TabsContext = createContext<TabsContextType | undefined>(undefined);

export default function TabsProvider({
  children,
}: {
  children: React.ReactNode;
}) {
  const { activeWindow } = useMultiWindowURL();

  const containerRef = useRef<HTMLDivElement>(null);
  const windowsContainerRef = useRef<HTMLDivElement>(null);
  const tabRefs = useRef<{ [key: string]: HTMLDivElement | null }>({});
  const [showLeftScrollButton, setShowLeftScrollButton] = useState(false);
  const [showRightScrollButton, setShowRightScrollButton] = useState(false);
  const [showRightMenuButton, setShowRightMenuButton] = useState(false);

  const updateScrollButtons = useCallback((clientWidth: number, scrollWidth: number, scrollLeft: number) => {
    const hasHorizontalScroll = scrollWidth > clientWidth;
    if (!hasHorizontalScroll) {
      setShowLeftScrollButton(false);
      setShowRightScrollButton(false);
      setShowRightMenuButton(false);
      return;
    }

    const isAtStart = checkIfAtStart(scrollLeft);
    const isAtEnd = checkIfAtEnd(scrollLeft, clientWidth, scrollWidth);
    const showMenuButton = !isAtStart || !isAtEnd;

    setShowLeftScrollButton(!isAtStart);
    setShowRightScrollButton(!isAtEnd);
    setShowRightMenuButton(showMenuButton);
  }, []);

  const updateScrollState = useCallback(() => {
    const container = windowsContainerRef.current;
    if (!container) return;

    const { clientWidth, scrollWidth, scrollLeft } = container;
    updateScrollButtons(clientWidth, scrollWidth, scrollLeft);
  }, [updateScrollButtons]);

  useEffect(() => {
    const container = containerRef.current;
    const windowsContainer = windowsContainerRef.current;
    if (!container || !windowsContainer) return;

    let lastWidth = container.clientWidth;
    let timeoutId: NodeJS.Timeout;

    const debouncedResize = () => {
      clearTimeout(timeoutId);
      timeoutId = setTimeout(() => {
        const currentWidth = container.clientWidth;
        const isDrawerWidthChange = currentWidth !== lastWidth;
        if (isDrawerWidthChange) {
          lastWidth = currentWidth;
          updateScrollState();
        }
      }, DEFAULT_DEBOUNCE_DELAY);
    };

    const resizeObserver = new ResizeObserver(debouncedResize);
    resizeObserver.observe(windowsContainer);

    updateScrollState();

    return () => {
      resizeObserver.disconnect();
      clearTimeout(timeoutId);
    };
  }, [updateScrollState]);

  useEffect(() => {
    const container = windowsContainerRef.current;
    if (!container) return;

    const handleScroll = () => {
      const { clientWidth, scrollWidth, scrollLeft } = container;
      updateScrollButtons(clientWidth, scrollWidth, scrollLeft);
    };

    container.addEventListener("scroll", handleScroll, { passive: true });
    return () => container.removeEventListener("scroll", handleScroll);
  }, [updateScrollButtons]);

  useEffect(() => {
    if (!activeWindow) return;

    const tabElement = tabRefs.current[activeWindow.windowId];
    const container = windowsContainerRef.current;

    if (tabElement && container) {
      tabElement.scrollIntoView({
        behavior: "smooth",
        block: "nearest",
        inline: "center",
      });
    }
  }, [activeWindow]);

  const handleScrollLeft = useCallback((e: React.MouseEvent) => {
    e.stopPropagation();
    const container = windowsContainerRef.current;
    if (!container) return;

    container.scrollBy({
      left: -DEFAULT_SCROLL_AMOUNT,
      behavior: "smooth",
    });
  }, []);

  const handleScrollRight = useCallback((e: React.MouseEvent) => {
    e.stopPropagation();
    const container = windowsContainerRef.current;
    if (!container) return;

    container.scrollBy({
      left: DEFAULT_SCROLL_AMOUNT,
      behavior: "smooth",
    });
  }, []);

  const value = useMemo<TabsContextType>(
    () => ({
      containerRef,
      windowsContainerRef,
      tabRefs,
      showLeftScrollButton,
      showRightScrollButton,
      showRightMenuButton,
      handleScrollLeft,
      handleScrollRight,
    }),
    [
      containerRef,
      windowsContainerRef,
      tabRefs,
      showLeftScrollButton,
      showRightScrollButton,
      showRightMenuButton,
      handleScrollLeft,
      handleScrollRight,
    ]
  );

  return <TabsContext.Provider value={value}>{children}</TabsContext.Provider>;
}

export const useTabs = (): TabsContextType => {
  const context = useContext(TabsContext);

  if (context === undefined) {
    throw new Error("useTabs must be used within a TabsProvider");
  }

  return context;
};

```

## Archivo: `packages/MainUI/contexts/types.ts`

```typescript
import type { Etendo } from "@workspaceui/api-client/src/api/metadata";
import type {
  CurrentClient,
  CurrentOrganization,
  CurrentRole,
  CurrentWarehouse,
  ISession,
  Labels,
  LoginResponse,
  ProfileInfo,
  SessionResponse,
  Tab,
  User,
} from "@workspaceui/api-client/src/api/types";

export type Language = "en_US" | "es_ES";

export interface LanguageContextType {
  language: Language | null;
  prevLanguage: Language | null;
  setLanguage: (lang: Language) => void;
  setLabels: React.Dispatch<React.SetStateAction<Labels>>;
  getFlag: (language?: Language | null) => string;
  getLabel: (key: string) => string;
}

export interface DefaultConfiguration {
  defaultRole?: string;
  defaultWarehouse?: string;
  organization?: string;
  language?: string;
  client?: string;
}

export interface LanguageOption {
  id: string;
  language: string;
  name: string;
  key?: string;
}

export interface IUserContext {
  user: User;
  login: (username: string, password: string) => Promise<void>;
  // biome-ignore lint/suspicious/noConfusingVoidType: <explanation>
  changeProfile: (params: { role?: string; warehouse?: string }) => Promise<LoginResponse | void>;
  token: string | null;
  roles: SessionResponse["roles"];
  currentRole: CurrentRole | undefined;
  prevRole: CurrentRole | undefined;
  profile: ProfileInfo;
  currentWarehouse: CurrentWarehouse | undefined;
  currentClient: CurrentClient | undefined;
  currentOrganization: CurrentOrganization | undefined;
  setToken: React.Dispatch<React.SetStateAction<string | null>>;
  clearUserData: () => void;
  setDefaultConfiguration: (config: DefaultConfiguration) => Promise<void>;
  languages: LanguageOption[];
  session: ISession;
  setSession: React.Dispatch<React.SetStateAction<ISession>>;
}

export interface IMetadataContext {
  windowId?: string;
  window?: Etendo.WindowMetadata;
  loading: boolean;
  error?: Error;
  groupedTabs: Etendo.Tab[][];
  tabs: Record<string, Tab>;
  refetch: () => Promise<Etendo.WindowMetadata>;
  removeRecord: (tabId: string, recordId: string) => void;
  emptyWindowDataName: () => void;
  loadWindowData: (windowId: string) => Promise<Etendo.WindowMetadata>;
  getWindowMetadata: (windowId: string) => Etendo.WindowMetadata | undefined;
  getWindowTitle: (windowId: string) => string;
  isWindowLoading: (windowId: string) => boolean;
  getWindowError: (windowId: string) => Error | undefined;
  windowsData: Record<string, Etendo.WindowMetadata>;
  loadingWindows: Record<string, boolean>;
  errors: Record<string, Error | undefined>;
}

```

## Archivo: `packages/MainUI/contexts/user.tsx`

```typescript
"use client";

import { createContext, useCallback, useEffect, useMemo, useState } from "react";
import { logger } from "../utils/logger";
import { Metadata } from "@workspaceui/api-client/src/api/metadata";
import { datasource } from "@workspaceui/api-client/src/api/datasource";
import { login as doLogin } from "@workspaceui/api-client/src/api/authentication";
import { changeProfile as doChangeProfile } from "@workspaceui/api-client/src/api/changeProfile";
import { getSession } from "@workspaceui/api-client/src/api/getSession";
import { HTTP_CODES } from "@workspaceui/api-client/src/api/constants";
import type { DefaultConfiguration, IUserContext, Language, LanguageOption } from "./types";
import type {
  ISession,
  ProfileInfo,
  SessionResponse,
  User,
  CurrentWarehouse,
  CurrentRole,
  CurrentClient,
  CurrentOrganization,
} from "@workspaceui/api-client/src/api/types";
import { setDefaultConfiguration as apiSetDefaultConfiguration } from "@workspaceui/api-client/src/api/defaultConfig";
import useLocalStorage from "@workspaceui/componentlibrary/src/hooks/useLocalStorage";
import { useLanguage } from "./language";
import LoginScreen from "@/screens/Login";
import { usePrevious } from "@/hooks/usePrevious";
import { useRouter } from "next/navigation";

export const UserContext = createContext({} as IUserContext);

export default function UserProvider(props: React.PropsWithChildren) {
  const router = useRouter();
  const [token, setToken] = useLocalStorage<string | null>("token", null);
  const [ready, setReady] = useState(false);
  const [user, setUser] = useState<IUserContext["user"]>({} as User);
  const [session, setSession] = useState<ISession>({});
  const [currentOrganization, setCurrentOrganization] = useState<CurrentOrganization>();
  const [currentWarehouse, setCurrentWarehouse] = useState<CurrentWarehouse>();
  const [currentRole, setCurrentRole] = useState<CurrentRole>();
  const [currentClient, setCurrentClient] = useState<CurrentClient>();
  const prevRole = usePrevious(currentRole);

  const [roles, setRoles] = useState<SessionResponse["roles"]>(() => {
    const savedRoles = localStorage.getItem("roles");
    return savedRoles ? JSON.parse(savedRoles) : [];
  });

  const INITIAL_PROFILE: ProfileInfo = useMemo(
    () => ({
      name: "",
      email: "",
      image: "",
    }),
    []
  );

  const [profile, setProfile] = useState<ProfileInfo>(() => {
    const savedProfile = localStorage.getItem("currentInfo");
    return savedProfile ? JSON.parse(savedProfile) : INITIAL_PROFILE;
  });

  const [languages, setLanguages] = useState<LanguageOption[]>([]);

  const setDefaultConfiguration = useCallback(async (config: DefaultConfiguration) => {
    try {
      return apiSetDefaultConfiguration(config);
    } catch (error) {
      logger.warn("Error setting default configuration:", error);

      throw error;
    }
  }, []);

  const updateProfile = useCallback((newProfile: ProfileInfo) => {
    setProfile(newProfile);
    localStorage.setItem("currentInfo", JSON.stringify(newProfile));
  }, []);

  const { language, setLanguage } = useLanguage();

  const updateSessionInfo = useCallback(
    async (sessionResponse: SessionResponse) => {
      const currentProfileInfo: ProfileInfo = {
        name: sessionResponse.user.name,
        email: sessionResponse.user.client$_identifier,
        image: sessionResponse.user.image || "",
      };

      setSession((prev) => ({ ...prev, ...sessionResponse.attributes }));
      updateProfile(currentProfileInfo);
      setUser(sessionResponse.user);
      setProfile(currentProfileInfo);

      localStorage.setItem("currentInfo", JSON.stringify(currentProfileInfo));
      localStorage.setItem("currentRole", JSON.stringify(sessionResponse.currentRole));
      localStorage.setItem("currentRoleId", sessionResponse.currentRole.id);

      const defaultLanguage = sessionResponse.user.defaultLanguage as Language;

      if (!language && defaultLanguage) {
        setLanguage(defaultLanguage);
      }

      setLanguages(Object.values(sessionResponse.languages));
      setCurrentClient(sessionResponse.currentClient);
      setCurrentRole(sessionResponse.currentRole);
      setCurrentOrganization(sessionResponse.currentOrganization);
      setCurrentWarehouse(sessionResponse.currentWarehouse);
      setRoles(sessionResponse.roles);
    },
    [language, setLanguage, updateProfile]
  );

  const clearUserData = useCallback(() => {
    setToken(null);
    setRoles([]);
    setCurrentRole(undefined);
    setCurrentWarehouse(undefined);
    setCurrentOrganization(undefined);
    setCurrentClient(undefined);
    setProfile(INITIAL_PROFILE);
    setUser({} as User);
    localStorage.removeItem("token");
    localStorage.removeItem("roles");
    localStorage.removeItem("currentRole");
    localStorage.removeItem("currentInfo");
    localStorage.removeItem("currentWarehouse");
    localStorage.removeItem("currentLanguage");
  }, [INITIAL_PROFILE, setToken]);

  const changeProfile = useCallback(
    async (params: { role?: string; client?: string; organization?: string; warehouse?: string }) => {
      if (!token) {
        throw new Error("Authentication token is not available");
      }

      try {
        const response = await doChangeProfile(params);

        localStorage.setItem("token", response.token);
        setToken(response.token);
      } catch (error) {
        logger.warn("Error updating profile:", error);
        throw error;
      }
    },
    [setToken, token]
  );

  const login = useCallback(
    async (username: string, password: string) => {
      try {
        const loginResponse = await doLogin(username, password);

        localStorage.setItem("token", loginResponse.token);
        Metadata.setToken(loginResponse.token);
        datasource.setToken(loginResponse.token);
        setToken(loginResponse.token);
      } catch (e) {
        logger.warn("Login or session retrieval error:", e);
        throw e;
      }
    },
    [setToken]
  );

  const value = useMemo<IUserContext>(
    () => ({
      login,
      roles,
      currentRole,
      profile,
      changeProfile,
      currentWarehouse,
      currentClient,
      currentOrganization,
      token,
      clearUserData,
      setToken,
      setDefaultConfiguration,
      languages,
      session,
      setSession,
      user,
      prevRole,
    }),
    [
      login,
      roles,
      currentRole,
      profile,
      changeProfile,
      currentWarehouse,
      currentClient,
      currentOrganization,
      token,
      clearUserData,
      setToken,
      setDefaultConfiguration,
      languages,
      session,
      user,
      prevRole,
    ]
  );

  useEffect(() => {
    const verifySession = async () => {
      try {
        if (token) {
          Metadata.setToken(token);
          datasource.setToken(token);
          const sessionData = await getSession();
          await updateSessionInfo(sessionData);
        }
      } catch (error) {
        console.error(error);
        clearUserData();
      } finally {
        setReady(true);
      }
    };

    verifySession().catch(logger.warn);
  }, [clearUserData, token, updateSessionInfo]);

  useEffect(() => {
    const interceptor = (response: Response) => {
      if (response.status === HTTP_CODES.UNAUTHORIZED) {
        clearUserData();
      }

      return response;
    };

    if (token) {
      const unregisterMetadataInterceptor = Metadata.registerInterceptor(interceptor);
      const unregisterDatasourceInterceptor = datasource.registerInterceptor(interceptor);

      return () => {
        unregisterMetadataInterceptor();
        unregisterDatasourceInterceptor();
      };
    }
  }, [clearUserData, token]);

  useEffect(() => {
    if (ready && prevRole && prevRole?.id !== currentRole?.id) {
      router.push("/");
    }
  }, [currentRole?.id, prevRole, ready, router]);

  if (!ready) {
    return null;
  }

  return <UserContext.Provider value={value}>{token ? props.children : <LoginScreen />}</UserContext.Provider>;
}

```

## Archivo: `packages/MainUI/custom.d.ts`

```typescript
declare global {
  interface Window {
    currentValues: unknown;
    context: unknown;
  }
}

export {};

```

## Archivo: `packages/MainUI/data/graph.ts`

```typescript
// biome-ignore lint/style/useNodejsImportProtocol: <explanation>
import EventEmitter from "events";
import { logger } from "@/utils/logger";
import type { EntityData, Tab } from "@workspaceui/api-client/src/api/types";

type GraphNode<T> = {
  value: T;
  neighbors: Set<GraphNode<T>>;
  selected?: EntityData;
  selectedMultiple: EntityData[];
};

export type GraphEvents = {
  selected: [tab: Tab, record: EntityData];
  unselected: [tab: Tab];
  selectedMultiple: [tab: Tab, records: EntityData[]];
  unselectedMultiple: [tab: Tab];
};

export type GraphEventListener<K extends keyof GraphEvents> = (...args: GraphEvents[K]) => void;

export type GraphEventNames = keyof GraphEvents;

export class Graph<T extends Tab> extends EventEmitter<GraphEvents> {
  public nodes: Map<string, GraphNode<T>>;
  private activeLevels: number[];

  public constructor(tabs: T[]) {
    super();
    this.setMaxListeners(50);
    this.nodes = new Map();
    this.activeLevels = [];

    tabs.forEach(this.addNode);
    for (const tab of tabs) {
      if (tab.parentTabId) {
        this.addEdge(tab.parentTabId, tab.id);
      }
    }
  }

  private addNode = (value: T) => {
    if (!this.nodes.has(value.id)) {
      this.nodes.set(value.id, { value, neighbors: new Set(), selectedMultiple: [] });
    }

    return this;
  };

  private addEdge = (sourceId: string, destinationId: string) => {
    const sourceNode = this.nodes.get(sourceId);
    const destNode = this.nodes.get(destinationId);

    if (!sourceNode || !destNode) {
      logger.warn("Both nodes must exist before adding an edge", { sourceNode, destNode });

      return this;
    }

    sourceNode.neighbors.add(destNode);

    return this;
  };

  public toJSON = (rootId: string) => {
    const rootNode = this.nodes.get(rootId);
    if (!rootNode) throw new Error("Root node not found");

    return this.buildJSON(rootNode);
  };

  private buildJSON = (node: GraphNode<T>): unknown => {
    return {
      id: node.value.id,
      name: node.value.name,
      children: Array.from(node.neighbors).map(this.buildJSON),
    };
  };

  public printTree = (rootId: string) => {
    const rootNode = this.nodes.get(rootId);
    if (!rootNode) throw new Error("Root node not found");

    const printNode = (node: GraphNode<T>, level: number) => {
      for (const child of node.neighbors) {
        printNode(child, level + 1);
      }
    };

    printNode(rootNode, 0);
  };

  public setActiveLevels = (level: number) => {
    const trimmed = this.activeLevels.filter((lvl) => lvl < level);

    if (trimmed[trimmed.length - 1] !== level) {
      this.activeLevels = [...trimmed, level].slice(-2);
    } else {
      this.activeLevels = trimmed;
    }
  };

  public getChildren = (tab?: Tab) => {
    if (tab) {
      const node = this.nodes.get(tab.id);

      if (node) {
        return Array.from(node.neighbors).map((child) => child.value);
      }
    }
  };

  public getParent = (tab?: Tab) => {
    if (tab) {
      for (const node of this.nodes.values()) {
        for (const neighbor of node.neighbors) {
          if (neighbor.value.id === tab.id) {
            return node.value;
          }
        }
      }
    }
  };

  public setSelected = (tab?: Tab, record: EntityData = {}) => {
    if (tab) {
      const node = this.nodes.get(tab.id);

      if (node) {
        node.selected = record;
        node.neighbors.forEach(this.clearSelectedNode);

        this.emit("selected", tab, record);
      }
    }
  };

  public clearSelected = (tab?: Tab) => {
    if (tab) {
      const node = this.nodes.get(tab.id);

      if (node) {
        this.clearSelectedNode(node);

        this.emit("unselected", tab);
      }
    }
  };

  public clear = (tab?: Tab) => {
    this.clearSelected(tab);
    this.clearSelectedMultiple(tab);
  };

  private clearSelectedNode = (node: GraphNode<T>) => {
    node.selected = undefined;
    node.neighbors.forEach(this.clearSelectedNode);
  };

  public setSelectedMultiple = (tab?: Tab, records: EntityData[] = []) => {
    if (tab) {
      const node = this.nodes.get(tab.id);

      if (node) {
        node.selectedMultiple = records;
        node.neighbors.forEach(this.clearSelectedMultipleNode);

        this.emit("selectedMultiple", tab, records);
      }
    }
  };

  public clearSelectedMultiple = (tab?: Tab) => {
    if (tab) {
      const node = this.nodes.get(tab.id);

      if (node) {
        this.clearSelectedMultipleNode(node);

        this.emit("unselectedMultiple", tab);
      }
    }
  };

  private clearSelectedMultipleNode = (node: GraphNode<T>) => {
    node.selectedMultiple = [];
    node.neighbors.forEach(this.clearSelectedMultipleNode);
  };

  public getSelected = (tab?: Tab) => {
    return tab ? this.nodes.get(tab.id)?.selected : undefined;
  };

  public getSelectedMultiple = (tab?: Tab) => {
    return tab ? this.nodes.get(tab.id)?.selectedMultiple : undefined;
  };
}

export default Graph;

```

## Archivo: `packages/MainUI/hooks/Toolbar/types.ts`

```typescript
import type { BaseFieldDefinition } from "@workspaceui/api-client/src/api/types";
import type { ProcessActionButton, ProcessButton, ProcessDefinitionButton } from "@/components/ProcessModal/types";
import type { TOOLBAR_BUTTONS_TYPES } from "@/utils/toolbar/constants";

export type ButtonType = keyof typeof TOOLBAR_BUTTONS_TYPES;
export type ButtonSection = "left" | "center" | "right";

export interface ToolbarButtonMetadata {
  id: string;
  action: string;
  name: string;
  icon?: string | null;
  active: boolean;
  seqno?: number | null;
  buttonType: ButtonType;
  section: ButtonSection;
  modalConfig?: {
    title?: string;
    size?: "small" | "medium" | "large";
  };
  dropdownConfig?: {
    items?: Array<{ label: string; action: string }>;
  };
}

export interface OrganizedSections {
  left: ToolbarButtonMetadata[];
  center: ToolbarButtonMetadata[];
  right: ToolbarButtonMetadata[];
}

export interface ExecuteProcessParams {
  button: ProcessButton;
  recordId: BaseFieldDefinition<string>;
  params?: Record<string, unknown>;
}

export interface ExecuteProcessDefinitionParams {
  button: ProcessDefinitionButton;
  recordId: BaseFieldDefinition<string>;
  params?: Record<string, unknown>;
}

export interface ExecuteProcessActionParams {
  button: ProcessActionButton;
  recordId: BaseFieldDefinition<string>;
  params?: Record<string, unknown>;
}

export interface ToolbarResponse {
  response: {
    data: Array<ToolbarButtonMetadata>;
  } & Record<string, string>;
  windowId: string;
  isNew: boolean;
}

```

## Archivo: `packages/MainUI/hooks/Toolbar/useProcessButton.ts`

```typescript
import type { ProcessButton, ProcessResponse } from "@/components/ProcessModal/types";
import { logger } from "@/utils/logger";
import type { BaseFieldDefinition } from "@workspaceui/api-client/src/api/types";
import type { FieldType } from "@workspaceui/api-client/src/api/types";
import type { ExecuteProcessParams } from "./types";

export const useProcessButton = (
  executeProcess: (params: ExecuteProcessParams) => Promise<ProcessResponse>,
  refetch: () => Promise<void>
) => {
  const handleProcessClick = async (btn: ProcessButton, recordId: string | undefined): Promise<ProcessResponse> => {
    if (!recordId) {
      throw new Error("No record selected");
    }

    const processParams =
      Object.values(btn.processInfo?.parameters || {})?.reduce(
        (acc, param) => {
          acc[param.id] = param.defaultValue ?? null;
          return acc;
        },
        {} as Record<string, unknown>
      ) || {};

    const recordIdField: BaseFieldDefinition<string> = {
      value: recordId,
      type: "string" as FieldType,
      label: "Record ID",
      name: "recordId",
      original: {} as never,
    };

    try {
      const result = await executeProcess({
        button: btn,
        recordId: recordIdField,
        params: processParams,
      });

      if (result.refreshParent) {
        await refetch();
      }

      return result;
    } catch (error) {
      logger.warn("Error executing process", error);

      const message = error instanceof Error ? error?.message : "Unknown error occurred";

      return {
        responseActions: [
          {
            showMsgInProcessView: {
              msgType: "error",
              msgTitle: "Error",
              msgText: message,
            },
          },
        ],
      };
    }
  };

  return { handleProcessClick };
};

```

## Archivo: `packages/MainUI/hooks/Toolbar/useProcessExecution.ts`

```typescript
import {
  type ProcessActionButton,
  type ProcessResponse,
  isProcessActionButton,
  isProcessDefinitionButton,
} from "@/components/ProcessModal/types";
import { useTabContext } from "@/contexts/tab";
import { logger } from "@/utils/logger";
import { API_FORWARD_PATH } from "@workspaceui/api-client/src/api/constants";
import { Metadata } from "@workspaceui/api-client/src/api/metadata";
import { useParams } from "next/navigation";
import { useCallback, useContext, useState } from "react";
import { UserContext } from "../../contexts/user";
import { useApiContext } from "../useApiContext";
import { useMetadataContext } from "../useMetadataContext";
import type { ExecuteProcessDefinitionParams, ExecuteProcessParams } from "./types";
import { getParams } from "@/utils/processes/manual/utils";
import data from "@/utils/processes/manual/data.json";

export function useProcessExecution() {
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<Error | null>(null);
  const [iframeUrl, setIframeUrl] = useState("");
  const API_BASE_URL = useApiContext();

  const { token } = useContext(UserContext);
  const { windowId } = useMetadataContext();
  const { tab, record } = useTabContext();
  const { recordId } = useParams<{ recordId: string }>();

  const executeProcessDefinition = useCallback(
    async ({ button, recordId, params = {} }: ExecuteProcessDefinitionParams): Promise<ProcessResponse> => {
      try {
        setLoading(true);
        setError(null);

        const queryParams = new URLSearchParams({
          processId: button.processDefinition.id,
        });

        const processParams: Record<string, unknown> = {};
        for (const param of button.processInfo.parameters) {
          if (params[param.id]) {
            processParams[param.id] = params[param.id];
          }
        }
        const payload = {
          recordIds: [recordId],
          _buttonValue: button.buttonText,
          _params: processParams,
          _entityName: button.processInfo?._entityName || "",
        };

        const { ok, data, status } = await Metadata.kernelClient.post(`?${queryParams}`, {
          method: "POST",
          body: JSON.stringify(payload),
        });

        if (!ok) {
          throw new Error(`HTTP error! status: ${status}`);
        }

        if (data.response?.status === -1) {
          throw new Error(data.response.error?.message || "Unknown server error");
        }

        return data;
      } catch (error) {
        logger.warn(error);

        const processError = error instanceof Error ? error : new Error("Process execution failed");
        setError(processError);
        throw processError;
      } finally {
        setLoading(false);
      }
    },
    []
  );

  const executeProcessAction = useCallback(
    async (button: ProcessActionButton): Promise<ProcessResponse> => {
      return new Promise((resolve, reject) => {
        try {
          setLoading(true);
          setError(null);

          if (!record || !tab.id || !tab.window || !button.id) {
            throw new Error("Record or Tab or Button not found");
          }

          const currentButtonId = button.id;
          const safeWindowId = windowId || (tab.window ? String(tab.window) : "");
          const safeTabId = tab.id ? String(tab.id) : "";
          const safeRecordId = String(record.id || recordId || "");
          const safeTableId = tab.table ? String(tab.table) : "";

          const requiredData = [safeWindowId, safeTabId, safeRecordId, currentButtonId, safeTableId];

          if (!requiredData.every((value) => value)) {
            throw new Error("Required data not found");
          }

          if (!(currentButtonId in data)) {
            throw new Error("Button ID not found in data");
          }

          const processAction = data[currentButtonId as keyof typeof data];
          const baseUrl = `${API_BASE_URL}${API_FORWARD_PATH}${processAction.url}`;
          const isPostedProcess = currentButtonId === "Posted";

          const params = getParams({
            currentButtonId,
            record,
            recordId: safeRecordId,
            windowId: safeWindowId,
            tabId: safeTabId,
            tableId: safeTableId,
            token,
            isPostedProcess,
          });

          const completeUrl = `${baseUrl}?${params.toString()}`;
          setIframeUrl(completeUrl);

          resolve({
            showInIframe: true,
            iframeUrl: completeUrl,
          });
        } catch (error) {
          logger.warn(error);

          const processError = error instanceof Error ? error : new Error("Process execution failed");
          setError(processError);
          reject(processError);
        } finally {
          setLoading(false);
        }
      });
    },
    [record, recordId, tab.id, tab.window, token, windowId, API_BASE_URL]
  );

  const executeProcess = useCallback(
    async ({ button, recordId, params = {} }: ExecuteProcessParams): Promise<ProcessResponse> => {
      try {
        if (isProcessActionButton(button)) {
          return await executeProcessAction(button);
        }
        if (isProcessDefinitionButton(button)) {
          return await executeProcessDefinition({ button, recordId, params });
        }
        throw new Error("Tipo de proceso no soportado");
      } catch (error) {
        console.error(error);
        throw new Error("Tipo de proceso no soportado");
      }
    },
    [executeProcessAction, executeProcessDefinition]
  );

  const resetIframeUrl = useCallback(() => setIframeUrl(""), []);

  return {
    executeProcess,
    loading,
    error,
    iframeUrl,
    resetIframeUrl,
    currentRecord: record,
    recordsLoaded: !!record,
    recordsLoading: loading,
    recordData: record,
    recordId,
  };
}

```

## Archivo: `packages/MainUI/hooks/Toolbar/useStatusModal.ts`

```typescript
import type { StatusModalState, StatusType } from "@workspaceui/componentlibrary/src/components/StatusModal/types";
import { useState, useCallback } from "react";

const initialState: StatusModalState = {
  open: false,
  statusType: "info",
  statusText: "",
  isDeleteSuccess: false,
};

interface ConfirmOptions {
  confirmText: string;
  onConfirm: () => void;
  saveLabel?: string;
  secondaryButtonLabel?: string;
}

export const useStatusModal = () => {
  const [state, setState] = useState<StatusModalState>(initialState);
  const [confirmAction, setConfirmAction] = useState<ConfirmOptions | null>(null);

  const showStatusModal = useCallback(
    (
      statusType: StatusType,
      statusText: string,
      options?: {
        errorMessage?: string;
        saveLabel?: string;
        secondaryButtonLabel?: string;
        onAfterClose?: () => void;
        isDeleteSuccess?: boolean;
      }
    ) => {
      setState({
        open: true,
        statusType,
        statusText,
        isDeleteSuccess: options?.isDeleteSuccess || false,
        ...options,
      });
    },
    []
  );

  const showSuccessModal = useCallback(
    (
      statusText: string,
      options?: {
        saveLabel?: string;
        secondaryButtonLabel?: string;
        onAfterClose?: () => void;
        isDeleteSuccess?: boolean;
      }
    ) => {
      showStatusModal("success", statusText, options);
    },
    [showStatusModal]
  );

  const showDeleteSuccessModal = useCallback(
    (
      statusText: string,
      options?: {
        saveLabel?: string;
        onAfterClose?: () => void;
      }
    ) => {
      showStatusModal("success", statusText, {
        ...options,
        isDeleteSuccess: true,
        saveLabel: options?.saveLabel || "Close",
      });
    },
    [showStatusModal]
  );

  const showErrorModal = useCallback(
    (
      statusText: string,
      options?: {
        errorMessage?: string;
        saveLabel?: string;
        secondaryButtonLabel?: string;
        onAfterClose?: () => void;
      }
    ) => {
      showStatusModal("error", statusText, options);
    },
    [showStatusModal]
  );

  const showWarningModal = useCallback(
    (
      statusText: string,
      options?: {
        errorMessage?: string;
        saveLabel?: string;
        secondaryButtonLabel?: string;
        onAfterClose?: () => void;
      }
    ) => {
      showStatusModal("warning", statusText, options);
    },
    [showStatusModal]
  );

  const showConfirmModal = useCallback((options: ConfirmOptions) => {
    setConfirmAction(options);
  }, []);

  const handleConfirm = useCallback(() => {
    if (confirmAction) {
      const { onConfirm } = confirmAction;
      setConfirmAction(null);
      onConfirm();
    }
  }, [confirmAction]);

  const handleCancelConfirm = useCallback(() => {
    setConfirmAction(null);
  }, []);

  const hideStatusModal = useCallback(() => {
    setState((prev) => ({ ...prev, open: false }));
  }, []);

  return {
    statusModal: state,
    confirmAction,
    showStatusModal,
    showSuccessModal,
    showDeleteSuccessModal,
    showErrorModal,
    showWarningModal,
    showConfirmModal,
    handleConfirm,
    handleCancelConfirm,
    hideStatusModal,
  };
};

```

## Archivo: `packages/MainUI/hooks/Toolbar/useToolbar.ts`

```typescript
import { useCallback, useEffect, useMemo, useState } from "react";
import { Metadata } from "@workspaceui/api-client/src/api/metadata";
import type { ToolbarButtonMetadata, ToolbarResponse } from "./types";
import { logger } from "@/utils/logger";
import { useTabContext } from "@/contexts/tab";
import { useSelectedRecords } from "@/hooks/useSelectedRecords";
import useFormFields from "@/hooks/useFormFields";
import { compileExpression } from "@/components/Form/FormView/selectors/BaseSelector";
import { useUserContext } from "@/hooks/useUserContext";
import type { ProcessButton } from "@/components/ProcessModal/types";

export function useToolbar(windowId: string, tabId?: string) {
  const [toolbar, setToolbar] = useState<ToolbarResponse | null>(null);
  const [loading, setLoading] = useState(!!windowId);
  const [error, setError] = useState<Error | null>(null);

  const { session } = useUserContext();
  const { tab } = useTabContext();
  const selectedItems = useSelectedRecords(tab);
  const {
    fields: { actionFields },
  } = useFormFields(tab);

  const processButtons = useMemo(() => {
    const buttons = Object.values(actionFields) || [];
    return buttons.filter((button) => {
      if (!button.displayed) return false;
      if (selectedItems?.length === 0) return false;
      if (selectedItems?.length > 1 && !button?.processDefinition?.isMultiRecord) return false;
      if (!button.displayLogicExpression) return true;

      const compiledExpr = compileExpression(button.displayLogicExpression);

      try {
        const checkRecord = (record: Record<string, unknown>) => compiledExpr(session, record);
        return button?.processDefinition?.isMultiRecord
          ? selectedItems.every(checkRecord)
          : selectedItems.some(checkRecord);
      } catch {
        return true;
      }
    }) as ProcessButton[];
  }, [actionFields, selectedItems, session]);

  const fetchToolbar = useCallback(async () => {
    if (!windowId) return;

    try {
      setLoading(true);
      setError(null);

      const params = new URLSearchParams();
      params.append("_operationType", "fetch");
      params.append("_startRow", "0");
      params.append("_endRow", "75");
      // params.append(
      //   'criteria',
      //   JSON.stringify({
      //     // Create a criteria that returns every recoord when tab id null and filter the records by tabId when it has one
      //   }),
      // );

      const url = tabId ? "etmeta_Toolbar" : `toolbar/${windowId}`;

      const response = await Metadata.datasourceServletClient.post(url, params, {
        headers: {
          "Content-Type": "application/x-www-form-urlencoded",
        },
      });

      setToolbar(response.data);
    } catch (error) {
      logger.warn(error);

      setError(error instanceof Error ? error : new Error("Failed to fetch toolbar"));
    } finally {
      setLoading(false);
    }
  }, [windowId, tabId]);

  const buttons: ToolbarButtonMetadata[] = useMemo(() => toolbar?.response?.data ?? [], [toolbar]);

  useEffect(() => {
    if (windowId) {
      fetchToolbar();
    }
  }, [fetchToolbar, windowId]);

  return {
    loading,
    error,
    buttons,
    processButtons,
    refetch: fetchToolbar,
  };
}

```

## Archivo: `packages/MainUI/hooks/Toolbar/useToolbarConfig.ts`

```typescript
import { useToolbarContext } from "@/contexts/ToolbarContext";
import { useTabContext } from "@/contexts/tab";
import { logger } from "@/utils/logger";
import type { Tab, EntityData } from "@workspaceui/api-client/src/api/types";
import { useCallback, useEffect, useMemo, useState } from "react";
import { useSearch } from "../../contexts/searchContext";
import { useDeleteRecord } from "../useDeleteRecord";
import { useMetadataContext } from "../useMetadataContext";
import { useTranslation } from "../useTranslation";
import { useStatusModal } from "./useStatusModal";
import { useMultiWindowURL } from "@/hooks/navigation/useMultiWindowURL";
import { useSelected } from "@/hooks/useSelected";
import { useSelectedRecords } from "@/hooks/useSelectedRecords";
import { useSelectedRecord } from "@/hooks/useSelectedRecord";
import { useRecordContext } from "@/hooks/useRecordContext";
import type { ToolbarButtonMetadata } from "./types";

export const useToolbarConfig = ({
  tabId,
}: {
  windowId?: string;
  tabId?: string;
  parentId?: string | null;
  isFormView?: boolean;
}) => {
  const { setSearchQuery } = useSearch();
  const [searchOpen, setSearchOpen] = useState(false);
  const [searchValue, setSearchValue] = useState("");
  const { removeRecord } = useMetadataContext();
  const {
    statusModal,
    confirmAction,
    showDeleteSuccessModal,
    showErrorModal,
    showConfirmModal,
    handleConfirm,
    handleCancelConfirm,
    hideStatusModal,
  } = useStatusModal();
  const { t } = useTranslation();
  const { onRefresh, onSave, onNew, onBack, onFilter, onColumnFilters } = useToolbarContext();

  const [isDeleting, setIsDeleting] = useState(false);

  const { tab } = useTabContext();
  const { activeWindow, getSelectedRecord, clearSelectedRecord } = useMultiWindowURL();
  const { graph } = useSelected();

  const selectedMultiple = useSelectedRecords(tab);
  const selectedRecord = useSelectedRecord(tab);
  const { contextString, hasSelectedRecords, contextItems } = useRecordContext();

  const selectedRecordId = useMemo(() => {
    if (!activeWindow?.windowId || !tab) return null;
    return getSelectedRecord(activeWindow.windowId, tab.id);
  }, [activeWindow?.windowId, tab, getSelectedRecord]);

  const selectedIds = useMemo(() => {
    if (selectedMultiple.length > 0) {
      return selectedMultiple.map((r) => String(r.id));
    }

    if (selectedRecordId) {
      return [selectedRecordId];
    }

    return [];
  }, [selectedMultiple, selectedRecordId]);

  const { deleteRecord, loading: deleteLoading } = useDeleteRecord({
    tab: tab as Tab,
    onSuccess: (deletedCount) => {
      if (!tabId) return;

      let recordName = "";
      if (selectedMultiple.length > 1) {
        recordName = `${selectedMultiple.length} ${t("common.records")}`;
      } else if (selectedMultiple.length === 1) {
        const record = selectedMultiple[0];
        recordName = String(record._identifier || record.id || `${t("common.record")}`);
      } else if (selectedRecord) {
        recordName = String(selectedRecord._identifier || selectedRecord.id || `${t("common.records")}`);
      } else {
        recordName = `${deletedCount} ${t("common.records")}`;
      }

      const entityType = tab?.title || "";

      for (const recordId of selectedIds) {
        removeRecord(tabId, recordId);
      }

      const successMessage = `${entityType} '${recordName}' ${t("status.deleteSuccess")}`;

      showDeleteSuccessModal(successMessage, {
        saveLabel: t("common.close"),
        onAfterClose: () => {
          setIsDeleting(false);

          if (activeWindow?.windowId && tab) {
            clearSelectedRecord(activeWindow.windowId, tab.id);
            graph.clearSelected(tab);
            graph.clearSelectedMultiple(tab);
          }
        },
      });
    },
    onError: (error) => {
      logger.warn("Error deleting record(s):", error);

      showErrorModal(t("status.deleteError"), {
        errorMessage: error,
        saveLabel: t("common.close"),
        secondaryButtonLabel: t("modal.secondaryButtonLabel"),
        onAfterClose: () => {
          setIsDeleting(false);
        },
      });
    },
  });

  useEffect(() => {
    if (!statusModal.open && isDeleting) {
      setIsDeleting(false);
    }
  }, [statusModal.open, isDeleting]);

  const actionHandlers = useMemo<Record<string, (event?: React.MouseEvent<HTMLElement>) => void>>(
    () => ({
      CANCEL: () => {
        onBack?.();
      },
      NEW: () => {
        onNew?.();
      },
      FIND: () => {
        setSearchOpen(true);
      },
      TAB_CONTROL: () => {
        logger.info("Tab control clicked");
      },
      FILTER: () => {
        onFilter?.();
      },
      SAVE: () => {
        onSave?.();
      },
      DELETE: () => {
        if (tab) {
          if (selectedIds.length > 0) {
            let recordsToDelete: EntityData[] | EntityData;

            if (selectedMultiple.length > 0) {
              recordsToDelete = selectedMultiple;
            } else {
              recordsToDelete = selectedIds.map((id) => ({ id }) as EntityData);
            }
            let confirmText: string;
            if (selectedIds.length === 1) {
              const recordToDelete = Array.isArray(recordsToDelete) ? recordsToDelete[0] : recordsToDelete;
              const identifier = String(recordToDelete._identifier || recordToDelete.id);
              confirmText = `${t("status.deleteConfirmation")} ${identifier}?`;
            } else {
              confirmText = `${t("status.multipleDeleteConfirmation")} ${selectedIds.length} ${t("common.records")}?`;
            }

            showConfirmModal({
              confirmText,
              onConfirm: () => {
                setIsDeleting(true);
                deleteRecord(
                  selectedIds.length === 1 && Array.isArray(recordsToDelete) ? recordsToDelete[0] : recordsToDelete
                );
              },
              saveLabel: t("common.confirm"),
              secondaryButtonLabel: t("common.cancel"),
            });
          } else {
            showErrorModal(t("status.selectRecordError"), {
              saveLabel: t("common.close"),
              secondaryButtonLabel: t("modal.secondaryButtonLabel"),
            });
          }
        }
      },
      REFRESH: () => {
        onRefresh?.();
      },
      COPILOT: () => {
        const customEvent = new CustomEvent("openCopilotWithContext", {
          detail: {
            contextString: hasSelectedRecords ? contextString : null,
            contextItems: hasSelectedRecords ? contextItems : [],
            hasContext: hasSelectedRecords,
          },
        });
        window.dispatchEvent(customEvent);
      },
      COLUMN_FILTERS: (event?: React.MouseEvent<HTMLElement>) => {
        const buttonElement = event?.currentTarget as HTMLElement;
        onColumnFilters?.(buttonElement);
      },
    }),
    [
      deleteRecord,
      onBack,
      onFilter,
      onNew,
      onRefresh,
      onSave,
      onColumnFilters,
      selectedIds,
      selectedMultiple,
      showConfirmModal,
      showErrorModal,
      t,
      tab,
      contextString,
      contextItems,
      hasSelectedRecords,
    ]
  );

  const handleAction = useCallback(
    (action: string, _button?: ToolbarButtonMetadata, event?: React.MouseEvent<HTMLElement>) => {
      if (isDeleting) {
        return;
      }

      const handler = actionHandlers[action];
      if (handler) {
        handler(event);
        return;
      }

      console.warn(`[useToolbarConfig ${tabId}] No handler found for action: ${action}`);
    },
    [actionHandlers, isDeleting, tabId]
  );

  const handleSearch = useCallback(
    (query: string) => {
      setSearchValue(query);
      setSearchQuery(query);
    },
    [setSearchQuery]
  );

  return useMemo(
    () => ({
      handleAction,
      searchOpen,
      setSearchOpen,
      handleSearch,
      searchValue,
      setSearchValue,
      deleteLoading,
      statusModal,
      confirmAction,
      handleConfirm,
      handleCancelConfirm,
      hideStatusModal,
      isDeleting,
      actionHandlers,
      selectedRecord,
      selectedMultiple,
      selectedIds,
      selectedRecordId,
    }),
    [
      handleAction,
      handleSearch,
      searchOpen,
      searchValue,
      deleteLoading,
      statusModal,
      confirmAction,
      handleConfirm,
      handleCancelConfirm,
      hideStatusModal,
      isDeleting,
      actionHandlers,
      selectedRecord,
      selectedMultiple,
      selectedIds,
      selectedRecordId,
    ]
  );
};

```

## Archivo: `packages/MainUI/hooks/__tests__/useProcessInitialState.test.ts`

```typescript
import { renderHook } from '@testing-library/react';
import { useProcessInitialState, useProcessLogicFields, useProcessFilterExpressions } from '../useProcessInitialState';
import type { ProcessDefaultsResponse } from '@/components/ProcessModal/types/ProcessParameterExtensions';
import type { ProcessParameter } from '@workspaceui/api-client/src/api/types';

// Mock logger
jest.mock('@/utils/logger', () => ({
  logger: {
    debug: jest.fn(),
    warn: jest.fn(),
    error: jest.fn(),
    info: jest.fn(),
  },
}));

describe('useProcessInitialState', () => {
  const mockParameters: ProcessParameter[] = [
    {
      id: '1',
      name: 'trxtype',
      reference: 'String',
      mandatory: false,
      defaultValue: '',
      refList: []
    },
    {
      id: '2',
      name: 'ad_org_id',
      reference: 'Search',
      mandatory: true,
      defaultValue: '',
      refList: []
    },
    {
      id: '3',
      name: 'actual_payment',
      reference: 'Amount',
      mandatory: false,
      defaultValue: '',
      refList: []
    },
    {
      id: '4',
      name: 'issotrx',
      reference: 'Boolean',
      mandatory: false,
      defaultValue: '',
      refList: []
    }
  ];

  const mockProcessDefaults: ProcessDefaultsResponse = {
    defaults: {
      "trxtype": "",
      "ad_org_id": {
        "value": "E443A31992CB4635AFCAEABE7183CE85",
        "identifier": "F&B España - Región Norte"
      },
      "bslamount": "",
      "payment_documentno": "<1000373>",
      "actual_payment": "1.85",
      "issotrx": true,
      "StdPrecision": "2",
      "trxtype_display_logic": "N",
      "ad_org_id_display_logic": "N",
      "actual_payment_readonly_logic": "N",
      "received_from_readonly_logic": "Y"
    },
    filterExpressions: {
      "order_invoice": {
        "paymentMethodName": "Transferencia"
      },
      "glitem": {},
      "credit_to_use": {}
    },
    refreshParent: true
  };

  describe('useProcessInitialState', () => {
    it('should return null when no process defaults provided', () => {
      const { result } = renderHook(() => 
        useProcessInitialState(null, mockParameters)
      );

      expect(result.current).toBeNull();
    });

    it('should return empty object when no defaults in process response', () => {
      const emptyDefaults: ProcessDefaultsResponse = {
        defaults: {},
        filterExpressions: {},
        refreshParent: false
      };

      const { result } = renderHook(() => 
        useProcessInitialState(emptyDefaults, mockParameters)
      );

      expect(result.current).toEqual({});
    });

    it('should process simple values correctly', () => {
      const { result } = renderHook(() => 
        useProcessInitialState(mockProcessDefaults, mockParameters)
      );

      const initialState = result.current;
      expect(initialState).not.toBeNull();
      expect(initialState!['trxtype']).toBe('');
      expect(initialState!['payment_documentno']).toBe('<1000373>');
      expect(initialState!['actual_payment']).toBe('1.85');
      expect(initialState!['issotrx']).toBe(true);
      expect(initialState!['StdPrecision']).toBe('2');
    });

    it('should process reference values correctly', () => {
      const { result } = renderHook(() => 
        useProcessInitialState(mockProcessDefaults, mockParameters)
      );

      const initialState = result.current;
      expect(initialState).not.toBeNull();
      expect(initialState!['ad_org_id']).toBe('E443A31992CB4635AFCAEABE7183CE85');
      expect(initialState!['ad_org_id$_identifier']).toBe('F&B España - Región Norte');
    });

    it('should skip logic fields', () => {
      const { result } = renderHook(() => 
        useProcessInitialState(mockProcessDefaults, mockParameters)
      );

      const initialState = result.current;
      expect(initialState).not.toBeNull();
      expect(initialState!['trxtype_display_logic']).toBeUndefined();
      expect(initialState!['ad_org_id_display_logic']).toBeUndefined();
      expect(initialState!['actual_payment_readonly_logic']).toBeUndefined();
    });

    it('should handle parameters without parameter mapping', () => {
      const { result } = renderHook(() => 
        useProcessInitialState(mockProcessDefaults, [])
      );

      const initialState = result.current;
      expect(initialState).not.toBeNull();
      // Should still process fields even without parameter mapping
      expect(initialState!['trxtype']).toBe('');
      expect(initialState!['ad_org_id']).toBe('E443A31992CB4635AFCAEABE7183CE85');
    });
  });

  describe('useProcessLogicFields', () => {
    it('should extract display logic fields', () => {
      const { result } = renderHook(() => 
        useProcessLogicFields(mockProcessDefaults)
      );

      const logicFields = result.current;
      expect(logicFields['trxtype.display']).toBe(false); // "N" -> false
      expect(logicFields['ad_org_id.display']).toBe(false); // "N" -> false
    });

    it('should extract readonly logic fields', () => {
      const { result } = renderHook(() => 
        useProcessLogicFields(mockProcessDefaults)
      );

      const logicFields = result.current;
      expect(logicFields['actual_payment.readonly']).toBe(false); // "N" -> false
      expect(logicFields['received_from.readonly']).toBe(true); // "Y" -> true
    });

    it('should return empty object when no defaults provided', () => {
      const { result } = renderHook(() => 
        useProcessLogicFields(null)
      );

      expect(result.current).toEqual({});
    });
  });

  describe('useProcessFilterExpressions', () => {
    it('should return filter expressions from response', () => {
      const { result } = renderHook(() => 
        useProcessFilterExpressions(mockProcessDefaults)
      );

      const filterExpressions = result.current;
      expect(filterExpressions).toEqual({
        "order_invoice": {
          "paymentMethodName": "Transferencia"
        },
        "glitem": {},
        "credit_to_use": {}
      });
    });

    it('should return empty object when no filter expressions', () => {
      const noFilters: ProcessDefaultsResponse = {
        defaults: {},
        filterExpressions: {},
        refreshParent: false
      };

      const { result } = renderHook(() => 
        useProcessFilterExpressions(noFilters)
      );

      expect(result.current).toEqual({});
    });

    it('should return empty object when no response provided', () => {
      const { result } = renderHook(() => 
        useProcessFilterExpressions(null)
      );

      expect(result.current).toEqual({});
    });
  });

  describe('Error handling', () => {
    it('should handle malformed field processing gracefully', () => {
      const malformedDefaults: ProcessDefaultsResponse = {
        defaults: {
          "normal_field": "normal_value",
          "broken_field": { value: 123 } as any, // Invalid reference object
        },
        filterExpressions: {},
        refreshParent: false
      };

      const { result } = renderHook(() => 
        useProcessInitialState(malformedDefaults, mockParameters)
      );

      const initialState = result.current;
      expect(initialState).not.toBeNull();
      expect(initialState!['normal_field']).toBe('normal_value');
      expect(initialState!['broken_field']).toBe('{"value":123}'); // Should stringify object
    });
  });
});
```

## Archivo: `packages/MainUI/hooks/datasource/constants.ts`

```typescript
// constants/datasource.ts
import { DATASOURCE_REFERENCE_CODES } from "@/utils/form/constants";

export const REFERENCE_IDS = {
  PRODUCT: DATASOURCE_REFERENCE_CODES.PRODUCT,
} as const;

export const PRODUCT_SELECTOR_DEFAULTS = {
  FALLBACK_SELECTOR_ID: DATASOURCE_REFERENCE_CODES.FALLBACK_SELECTOR_ID,
  SEARCH_FIELDS: ["productName", "searchKey"],
} as const;

export const TABLEDIR_SELECTOR_DEFAULTS = {
  SEARCH_FIELDS: ["name", "value", "description"],
} as const;

export const INVOICE_FIELD_MAPPINGS: Record<string, string> = {
  priceList: "inpmPricelistId",
  currency: "inpcCurrencyId",
  businessPartner: "inpcBpartnerId",
  invoiceDate: "inpdateinvoiced",
  documentType: "inpcDoctypeId",
  transactionDocument: "inpcDoctypetargetId",
  paymentTerms: "inpcPaymenttermId",
  salesRepresentative: "inpsalesrepId",
  partnerAddress: "inpcBpartnerLocationId",
  paymentMethod: "inpfinPaymentmethodId",
  project: "inpcProjectId",
  costcenter: "inpcCostcenterId",
  salesCampaign: "inpcCampaignId",
  activity: "inpcActivityId",
  asset: "inpaAssetId",
  withholding: "inpwithholding",
  orderReference: "inporderReference",
  salesOrder: "inpcOrderId",
  stDimension: "inpuser1Id",
  ndDimension: "inpuser2Id",
} as const;

export const FORM_VALUE_MAPPINGS = {
  true: "Y",
  false: "N",
  null: "null",
} as const;

```

## Archivo: `packages/MainUI/hooks/datasource/useProcessDatasourceConfig.ts`

```typescript
import { useCallback, useState } from "react";
import { Metadata } from "@workspaceui/api-client/src/api/metadata";
import { logger } from "@/utils/logger";
import type { EntityValue } from "@workspaceui/api-client/src/api/types";

export interface ProcessConfigResponse {
  processId: string;
  defaults?: Record<string, { value: string; identifier: string }>;
  filterExpressions?: Record<string, Record<string, string>>;
  refreshParent?: boolean;
}

interface UseProcessConfigProps {
  processId: string;
  windowId: string;
  tabId: string;
}

/**
 * Hook to obtain the configuration based on DefaultsProcessActionHandler
 * @param processId - ID of the process
 * @param windowId - ID of the window
 * @param tabId - ID of the tab
 * @returns Object with functions to handle the configuration of the process
 */
export const useProcessConfig = ({ processId, windowId, tabId }: UseProcessConfigProps) => {
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<Error | null>(null);
  const [config, setConfig] = useState<ProcessConfigResponse | null>(null);

  const fetchConfig = useCallback(
    async (payload: Record<string, EntityValue> = {}) => {
      if (!processId || !windowId || !tabId) {
        return null;
      }

      const params = new URLSearchParams({
        processId,
        windowId,
        // TODO: Remove hardcoded value and use action provided by process metadata
        _action: "org.openbravo.client.application.process.DefaultsProcessActionHandler",
      });

      const requestPayload = { ...payload };

      try {
        setLoading(true);
        setError(null);

        const { data } = await Metadata.kernelClient.post(`?${params}`, requestPayload);

        const processedConfig: ProcessConfigResponse = {
          processId,
          defaults: data?.defaults || {},
          filterExpressions: data?.filterExpressions || {},
          refreshParent: !!data?.refreshParent,
        };

        setConfig(processedConfig);
        return processedConfig;
      } catch (err) {
        const errorMessage = err instanceof Error ? err.message : "Unknown error fetching process config";

        logger.error(`Error fetching process config for process ${processId}:`, err);
        setError(new Error(errorMessage));
        return null;
      } finally {
        setLoading(false);
      }
    },
    [processId, windowId, tabId]
  );

  return {
    fetchConfig,
    loading,
    error,
    config,
  };
};

```

## Archivo: `packages/MainUI/hooks/datasource/useTableDirDatasource.ts`

```typescript
import { useTabContext } from "@/contexts/tab";
import { logger } from "@/utils/logger";
import { useCallback, useMemo, useState } from "react";
import { useFormContext } from "react-hook-form";
import { buildPayloadByInputName } from "@/utils";
import { FieldName, type UseTableDirDatasourceParams } from "../types";
import useFormParent from "../useFormParent";
import {
  REFERENCE_IDS,
  PRODUCT_SELECTOR_DEFAULTS,
  TABLEDIR_SELECTOR_DEFAULTS,
  INVOICE_FIELD_MAPPINGS,
  FORM_VALUE_MAPPINGS,
} from "./constants";
import { datasource } from "@workspaceui/api-client/src/api/datasource";
import type { EntityValue } from "@workspaceui/api-client/src/api/types";
import { FALLBACK_RESULT } from "@/components/ProcessModal/ProcessDefinitionModal";

export const useTableDirDatasource = ({ field, pageSize = 20, initialPageSize = 20 }: UseTableDirDatasourceParams) => {
  const { getValues, watch } = useFormContext();
  const { tab, parentRecord } = useTabContext();
  const windowId = tab.window;
  const [records, setRecords] = useState<Record<string, string>[]>([]);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<Error>();
  const [currentPage, setCurrentPage] = useState(0);
  const [hasMore, setHasMore] = useState(true);
  const [searchTerm, setSearchTerm] = useState("");
  const value = watch(field.hqlName);

  const isProductField = field.column.reference === REFERENCE_IDS.PRODUCT;
  const parentData = useFormParent(FieldName.INPUT_NAME);

  const invoiceContext: Record<string, EntityValue> = useMemo(() => {
    if (!isProductField && !parentRecord && !tab?.fields) {
      return FALLBACK_RESULT;
    }

    const recordValues = buildPayloadByInputName(parentRecord, tab.fields);
    const context: Record<string, EntityValue> = {};

    for (const [sourceField, targetField] of Object.entries(INVOICE_FIELD_MAPPINGS)) {
      if (!recordValues) {
        return [];
      }
      const value = recordValues[sourceField];
      if (value !== null && value !== undefined && value !== "") {
        context[targetField] = value as EntityValue;
      }
    }

    return context;
  }, [isProductField, parentRecord, tab?.fields]);

  const selectorId =
    field.selector?._selectorDefinitionId ||
    (isProductField ? PRODUCT_SELECTOR_DEFAULTS.FALLBACK_SELECTOR_ID : undefined);
  const transformFormValues = useCallback(
    (formData: Record<string, EntityValue>) => {
      const formValues: Record<string, EntityValue> = {};

      for (const [key, value] of Object.entries(formData)) {
        const currentField = tab.fields[key];
        const inputName = currentField?.inputName || key;
        const stringValue = String(value);

        const isISODate = /^\d{4}-\d{2}-\d{2}$/.test(stringValue);

        const formattedValue = isISODate ? stringValue.split("-").reverse().join("-") : stringValue;

        const safeValue = Object.prototype.hasOwnProperty.call(FORM_VALUE_MAPPINGS, formattedValue)
          ? FORM_VALUE_MAPPINGS[formattedValue as keyof typeof FORM_VALUE_MAPPINGS]
          : formattedValue;

        formValues[inputName] = safeValue;
      }

      return formValues;
    },
    [tab.fields]
  );

  const buildSearchCriteria = useCallback(
    (search: string, isProduct: boolean) => {
      const dummyId = new Date().getTime();
      const baseCriteria = [
        {
          fieldName: "_dummy",
          operator: "equals",
          value: String(dummyId),
        },
      ];

      if (isProduct) {
        const productCriteria = PRODUCT_SELECTOR_DEFAULTS.SEARCH_FIELDS.map((fieldName) => ({
          fieldName,
          operator: "iContains",
          value: search,
        }));
        return { dummyId, criteria: [...baseCriteria, ...productCriteria] };
      }
      const searchFields = [];
      if (field.selector?.displayField) {
        searchFields.push(field.selector.displayField);
      }
      if (field.selector?.extraSearchFields) {
        searchFields.push(...field.selector.extraSearchFields.split(",").map((f) => f.trim()));
      }
      if (searchFields.length === 0) {
        searchFields.push(...TABLEDIR_SELECTOR_DEFAULTS.SEARCH_FIELDS);
      }

      const tableDirCriteria = searchFields.map((fieldName) => ({
        fieldName,
        operator: "iContains",
        value: search,
      }));

      return { dummyId, criteria: [...baseCriteria, ...tableDirCriteria] };
    },
    [field.selector]
  );

  const fetch = useCallback(
    async (_currentValue: typeof value, reset = false, search = "") => {
      try {
        if (!field || !tab) return;

        setLoading(true);

        if (reset) {
          setCurrentPage(0);
          setHasMore(true);
        }

        const startRow = reset ? 0 : currentPage * pageSize;
        const endRow = reset ? initialPageSize : startRow + pageSize;
        const formValues = transformFormValues(getValues());
        const invoiceValue = transformFormValues(invoiceContext);
        const baseBody = {
          _startRow: startRow.toString(),
          _endRow: endRow.toString(),
          _operationType: "fetch",
          ...field.selector,
          moduleId: field.module,
          windowId,
          tabId: field.tab,
          inpTabId: field.tab,
          inpwindowId: windowId,
          inpTableId: field.column.table,
          initiatorField: field.hqlName,
          _constructor: "AdvancedCriteria",
          _OrExpression: "true",
          ...(typeof _currentValue !== "undefined" ? { _currentValue } : {}),
        };
        if (isProductField) {
          Object.assign(baseBody, {
            _noCount: "true",
            ...(selectorId && { _selectorDefinitionId: selectorId }),
            ...invoiceValue,
            ...formValues,
          });
        } else {
          Object.assign(baseBody, {
            _textMatchStyle: "substring",
            ...parentData,
            ...invoiceValue,
            ...formValues,
          });
        }

        const body = new URLSearchParams(baseBody);

        if (search) {
          const { dummyId, criteria } = buildSearchCriteria(search, isProductField);

          if (isProductField) {
            body.set("criteria", JSON.stringify({ fieldName: "_dummy", operator: "equals", value: dummyId }));
            body.set("operator", "or");
          }

          for (const criterion of criteria) {
            body.append("criteria", JSON.stringify(criterion));
          }
        }

        const { data } = await datasource.client.request(field.selector?.datasourceName ?? "", {
          method: "POST",
          body,
        });

        if (data?.response?.data) {
          if (!data.response.data.length || data.response.data.length < pageSize) {
            setHasMore(false);
          }

          if (reset) {
            setRecords(data.response.data);
          } else {
            const recordMap = new Map();

            for (const record of records) {
              const recordId = record.id || JSON.stringify(record);
              recordMap.set(recordId, record);
            }
            for (const record of data.response.data) {
              const recordId = record.id || JSON.stringify(record);
              recordMap.set(recordId, record);
            }

            setRecords(Array.from(recordMap.values()));
          }

          if (!reset) {
            setCurrentPage((prev) => prev + 1);
          }
        } else {
          throw new Error(data);
        }
      } catch (err) {
        logger.warn(err);

        if (reset) {
          setRecords([]);
        }

        setError(err instanceof Error ? err : new Error(String(err)));
      } finally {
        setLoading(false);
      }
    },
    [
      field,
      tab,
      currentPage,
      pageSize,
      initialPageSize,
      selectorId,
      windowId,
      isProductField,
      invoiceContext,
      parentData,
      transformFormValues,
      buildSearchCriteria,
      getValues,
      records,
    ]
  );

  const search = useCallback(
    (term: string) => {
      setSearchTerm(term);
      fetch(value, true, term);
    },
    [fetch, value]
  );

  const loadMore = useCallback(() => {
    if (!loading && hasMore) {
      fetch(value, false, searchTerm);
    }
  }, [fetch, loading, hasMore, value, searchTerm]);

  const refetch = useCallback(
    (reset = true) => {
      fetch(value, reset, searchTerm);
    },
    [fetch, value, searchTerm]
  );

  return {
    records,
    loading,
    error,
    refetch,
    loadMore,
    hasMore,
    search,
    searchTerm,
  };
};

```

## Archivo: `packages/MainUI/hooks/navigation/useMultiWindowURL.ts`

```typescript
"use client";

import { useRouter, useSearchParams } from "next/navigation";
import { useCallback, useMemo } from "react";
import {
  WINDOW_PREFIX,
  ORDER_PREFIX,
  WINDOW_IDENTIFIER_PREFIX,
  FORM_RECORD_ID_PREFIX,
  FORM_MODE_PREFIX,
  TITLE_PREFIX,
  SELECTED_RECORD_PREFIX,
  TAB_FORM_RECORD_ID_PREFIX,
  TAB_MODE_PREFIX,
  TAB_FORM_MODE_PREFIX,
  NEW_RECORD_ID,
  FORM_MODES,
  TAB_MODES,
  TAB_ACTIVE,
  TAB_INACTIVE,
  type FormMode,
  type TabMode,
} from "@/utils/url/constants";

export interface WindowState {
  windowId: string;
  isActive: boolean;
  order: number;
  window_identifier: string;
  formRecordId?: string;
  formMode?: FormMode;
  selectedRecords: Record<string, string>; // tabId -> recordId
  tabFormStates: Record<
    string,
    {
      recordId?: string;
      mode?: TabMode;
      formMode?: FormMode;
    }
  >;
  title?: string;
}

const extractWindowIds = (searchParams: URLSearchParams): Set<string> => {
  const windowIds = new Set<string>();
  for (const [key] of searchParams.entries()) {
    if (key.startsWith(WINDOW_PREFIX)) {
      windowIds.add(key.slice(2));
    }
  }
  return windowIds;
};

const processTabParameters = (
  searchParams: URLSearchParams,
  windowId: string
): {
  selectedRecords: Record<string, string>;
  tabFormStates: Record<string, { recordId?: string; mode?: TabMode; formMode?: FormMode }>;
} => {
  const selectedRecords: Record<string, string> = {};
  const tabFormStates: Record<string, { recordId?: string; mode?: TabMode; formMode?: FormMode }> = {};

  for (const [key, value] of searchParams.entries()) {
    if (!value) continue;

    const processTabParameter = (prefix: string, processor: (tabId: string, value: string) => void) => {
      if (key.startsWith(prefix)) {
        const tabId = key.slice(prefix.length);
        processor(tabId, value);
      }
    };

    processTabParameter(`${SELECTED_RECORD_PREFIX}${windowId}_`, (tabId, value) => {
      selectedRecords[tabId] = value;
    });

    processTabParameter(`${TAB_FORM_RECORD_ID_PREFIX}${windowId}_`, (tabId, value) => {
      tabFormStates[tabId] = { ...tabFormStates[tabId], recordId: value };
    });

    processTabParameter(`${TAB_MODE_PREFIX}${windowId}_`, (tabId, value) => {
      tabFormStates[tabId] = { ...tabFormStates[tabId], mode: value as TabMode };
    });

    processTabParameter(`${TAB_FORM_MODE_PREFIX}${windowId}_`, (tabId, value) => {
      tabFormStates[tabId] = { ...tabFormStates[tabId], formMode: value as FormMode };
    });
  }

  return { selectedRecords, tabFormStates };
};

const createWindowState = (windowId: string, searchParams: URLSearchParams): WindowState => {
  const isActive = searchParams.get(`${WINDOW_PREFIX}${windowId}`) === TAB_ACTIVE;
  const formRecordId = searchParams.get(`${FORM_RECORD_ID_PREFIX}${windowId}`) || undefined;
  const formMode = (searchParams.get(`${FORM_MODE_PREFIX}${windowId}`) as FormMode) || undefined;
  const order = Number.parseInt(searchParams.get(`${ORDER_PREFIX}${windowId}`) || "1", 10);
  const window_identifier = searchParams.get(`${WINDOW_IDENTIFIER_PREFIX}${windowId}`) || windowId;
  const title = searchParams.get(`${TITLE_PREFIX}${windowId}`) || undefined;

  const { selectedRecords, tabFormStates } = processTabParameters(searchParams, windowId);

  return {
    windowId,
    isActive,
    order,
    window_identifier,
    formRecordId,
    formMode,
    selectedRecords,
    tabFormStates,
    title,
  };
};

const setWindowParameters = (params: URLSearchParams, window: WindowState): void => {
  const {
    windowId,
    isActive,
    order,
    window_identifier,
    formRecordId,
    formMode,
    selectedRecords,
    tabFormStates,
    title,
  } = window;

  params.set(`${WINDOW_PREFIX}${windowId}`, isActive ? TAB_ACTIVE : TAB_INACTIVE);
  params.set(`${ORDER_PREFIX}${windowId}`, (order ?? 1).toString());
  params.set(`${WINDOW_IDENTIFIER_PREFIX}${windowId}`, window_identifier);

  if (formRecordId) {
    params.set(`${FORM_RECORD_ID_PREFIX}${windowId}`, formRecordId);
  }
  if (formMode) {
    params.set(`${FORM_MODE_PREFIX}${windowId}`, formMode);
  }
  if (title) {
    params.set(`${TITLE_PREFIX}${windowId}`, title);
  }

  for (const [tabId, selectedRecordId] of Object.entries(selectedRecords)) {
    if (selectedRecordId) {
      params.set(`${SELECTED_RECORD_PREFIX}${windowId}_${tabId}`, selectedRecordId);
    }
  }

  for (const [tabId, tabState] of Object.entries(tabFormStates)) {
    if (tabState.recordId) {
      params.set(`${TAB_FORM_RECORD_ID_PREFIX}${windowId}_${tabId}`, tabState.recordId);
    }
    if (tabState.mode && tabState.mode !== TAB_MODES.TABLE) {
      params.set(`${TAB_MODE_PREFIX}${windowId}_${tabId}`, tabState.mode);
    }
    if (tabState.formMode) {
      params.set(`${TAB_FORM_MODE_PREFIX}${windowId}_${tabId}`, tabState.formMode);
    }
  }
};

const getNextOrder = (windows: WindowState[]): number => {
  if (windows.length === 0) return 1;
  const orders = windows.map((w) => w.order || 1);
  return Math.max(...orders) + 1;
};

const normalizeWindowOrders = (windows: WindowState[]): WindowState[] => {
  return windows
    .sort((a, b) => (a.order || 1) - (b.order || 1))
    .map((window, index) => ({
      ...window,
      order: index + 1,
    }));
};

export function useMultiWindowURL() {
  const router = useRouter();
  const searchParams = useSearchParams();

  const { windows, activeWindow, isHomeRoute } = useMemo(() => {
    const windowStates: WindowState[] = [];
    let active: WindowState | undefined;

    const hasWindowActiveParams = Array.from(searchParams.entries()).some(
      ([key, value]) => key.startsWith(WINDOW_PREFIX) && value === TAB_ACTIVE
    );
    const isHome = !hasWindowActiveParams;

    const windowIds = extractWindowIds(searchParams);

    for (const windowId of windowIds) {
      const windowState = createWindowState(windowId, searchParams);
      windowStates.push(windowState);

      if (windowState.isActive) {
        active = windowState;
      }
    }

    windowStates.sort((a, b) => a.order - b.order);

    return {
      windows: windowStates,
      activeWindow: active,
      isHomeRoute: isHome,
    };
  }, [searchParams]);

  const buildURL = useCallback((newWindows: WindowState[], preserveCurrentPath?: boolean) => {
    const params = new URLSearchParams();

    for (const window of newWindows) {
      setWindowParameters(params, window);
    }

    if (preserveCurrentPath && window.location.pathname === "/") {
      return `/?${params.toString()}`;
    }

    return `/window?${params.toString()}`;
  }, []);

  const navigate = useCallback(
    (newWindows: WindowState[], preserveCurrentPath?: boolean) => {
      const url = buildURL(newWindows, preserveCurrentPath);
      router.replace(url);
    },
    [router, buildURL]
  );

  const navigateToHome = useCallback(() => {
    const updatedWindows = windows.map((w) => ({ ...w, isActive: false }));

    if (updatedWindows.length === 0) {
      router.push("/");
    } else {
      const url = `/?${buildURL(updatedWindows).split("?")[1]}`;
      router.push(url);
    }
  }, [windows, buildURL, router]);

  const openWindow = useCallback(
    (windowId: string, title?: string, window_identifier?: string) => {
      const updatedWindows = windows.map((w) => ({ ...w, isActive: false }));

      const existingIndex = updatedWindows.findIndex((w) => w.windowId === windowId);

      if (existingIndex >= 0) {
        updatedWindows[existingIndex].isActive = true;
        if (title) {
          updatedWindows[existingIndex].title = title;
        }
        if (window_identifier) {
          updatedWindows[existingIndex].window_identifier = window_identifier;
        }
      } else {
        const nextOrder = getNextOrder(updatedWindows);
        updatedWindows.push({
          windowId,
          isActive: true,
          order: nextOrder,
          window_identifier: window_identifier || windowId,
          title,
          selectedRecords: {},
          tabFormStates: {},
        });
      }

      navigate(updatedWindows);
    },
    [windows, navigate]
  );

  const closeWindow = useCallback(
    (windowId: string) => {
      const updatedWindows = windows.filter((w) => w.windowId !== windowId);

      const wasActive = windows.find((w) => w.windowId === windowId)?.isActive;
      if (wasActive && updatedWindows.length > 0) {
        updatedWindows[0].isActive = true;
      }

      const normalizedWindows = normalizeWindowOrders(updatedWindows);

      if (normalizedWindows.length === 0) {
        router.replace("/");
      } else {
        navigate(normalizedWindows);
      }
    },
    [windows, navigate, router]
  );

  const setActiveWindow = useCallback(
    (windowId: string) => {
      const updatedWindows = windows.map((w) => ({
        ...w,
        isActive: w.windowId === windowId,
      }));

      navigate(updatedWindows);
    },
    [windows, navigate]
  );

  const updateWindowTitle = useCallback(
    (windowId: string, title: string) => {
      const updatedWindows = windows.map((w) => {
        if (w.windowId === windowId) {
          return {
            ...w,
            title,
          };
        }
        return w;
      });

      navigate(updatedWindows);
    },
    [windows, navigate]
  );

  const setSelectedRecord = useCallback(
    (windowId: string, tabId: string, recordId: string) => {
      const updatedWindows = windows.map((w) => {
        if (w.windowId === windowId) {
          return {
            ...w,
            selectedRecords: {
              ...w.selectedRecords,
              [tabId]: recordId,
            },
          };
        }
        return w;
      });

      navigate(updatedWindows);
    },
    [windows, navigate]
  );

  const clearSelectedRecord = useCallback(
    (windowId: string, tabId: string) => {
      const updatedWindows = windows.map((w) => {
        if (w.windowId === windowId) {
          const newSelectedRecords = { ...w.selectedRecords };
          delete newSelectedRecords[tabId];

          return {
            ...w,
            selectedRecords: newSelectedRecords,
          };
        }
        return w;
      });

      navigate(updatedWindows);
    },
    [windows, navigate]
  );

  const getSelectedRecord = useCallback(
    (windowId: string, tabId: string): string | undefined => {
      const window = windows.find((w) => w.windowId === windowId);
      return window?.selectedRecords[tabId];
    },
    [windows]
  );

  const setTabFormState = useCallback(
    (windowId: string, tabId: string, recordId: string, mode: TabMode = TAB_MODES.FORM, formMode?: FormMode) => {
      const updatedWindows = windows.map((w) => {
        if (w.windowId === windowId) {
          const currentTabState = w.tabFormStates[tabId] || {};

          return {
            ...w,
            tabFormStates: {
              ...w.tabFormStates,
              [tabId]: {
                ...currentTabState,
                recordId,
                mode,
                formMode: formMode || (recordId === NEW_RECORD_ID ? FORM_MODES.NEW : FORM_MODES.EDIT),
              },
            },
          };
        }
        return w;
      });

      navigate(updatedWindows);
    },
    [windows, navigate]
  );

  const clearTabFormState = useCallback(
    (windowId: string, tabId: string) => {
      const updatedWindows = windows.map((w) => {
        if (w.windowId === windowId) {
          const newTabFormStates = { ...w.tabFormStates };
          delete newTabFormStates[tabId];

          return {
            ...w,
            tabFormStates: newTabFormStates,
          };
        }
        return w;
      });

      navigate(updatedWindows);
    },
    [windows, navigate]
  );

  const getTabFormState = useCallback(
    (windowId: string, tabId: string) => {
      const window = windows.find((w) => w.windowId === windowId);
      return window?.tabFormStates[tabId];
    },
    [windows]
  );

  const setRecord = useCallback(
    (windowId: string, recordId: string, tabId?: string) => {
      if (tabId) {
        const formMode: FormMode = recordId === NEW_RECORD_ID ? FORM_MODES.NEW : FORM_MODES.EDIT;
        setTabFormState(windowId, tabId, recordId, TAB_MODES.FORM, formMode);
      } else {
        const updatedWindows = windows.map((w) => {
          if (w.windowId === windowId) {
            return {
              ...w,
              formRecordId: recordId,
              formMode: recordId === NEW_RECORD_ID ? FORM_MODES.NEW : FORM_MODES.EDIT,
            };
          }
          return w;
        });
        navigate(updatedWindows);
      }
    },
    [windows, navigate, setTabFormState]
  );

  const clearRecord = useCallback(
    (windowId: string, tabId?: string) => {
      if (tabId) {
        clearTabFormState(windowId, tabId);
      } else {
        const updatedWindows = windows.map((w) => {
          if (w.windowId === windowId) {
            const { formMode, formRecordId, ...rest } = w;
            return rest;
          }
          return w;
        });
        navigate(updatedWindows);
      }
    },
    [windows, navigate, clearTabFormState]
  );

  const reorderWindows = useCallback(
    (windowId: string, newOrder: number) => {
      const updatedWindows = windows.map((w) => {
        if (w.windowId === windowId) {
          return { ...w, order: newOrder };
        }
        return w;
      });

      const normalizedWindows = normalizeWindowOrders(updatedWindows);
      navigate(normalizedWindows);
    },
    [windows, navigate]
  );

  return {
    windows,
    activeWindow,
    isHomeRoute,
    openWindow,
    closeWindow,
    setActiveWindow,
    navigateToHome,
    buildURL,
    updateWindowTitle,

    setSelectedRecord,
    clearSelectedRecord,
    getSelectedRecord,

    setTabFormState,
    clearTabFormState,
    getTabFormState,

    setRecord,
    clearRecord,

    reorderWindows,
    getNextOrder,
  };
}

```

## Archivo: `packages/MainUI/hooks/navigation/useRedirect.ts`

```typescript
import { useCallback } from "react";
import { useRouter, usePathname } from "next/navigation";
import { useMultiWindowURL } from "@/hooks/navigation/useMultiWindowURL";

export const useRedirect = () => {
  const router = useRouter();
  const pathname = usePathname();
  const { openWindow, buildURL, getNextOrder, windows } = useMultiWindowURL();

  const handleAction = useCallback(
    (windowId: string | undefined, windowIdentifier: string | undefined) => {
      if (!windowId) {
        console.warn("No windowId found");
        return;
      }

      const isInWindowRoute = pathname.includes("window");

      if (isInWindowRoute) {
        openWindow(windowId);
      } else {
        const newWindow = {
          windowId,
          window_identifier: windowIdentifier || windowId,
          isActive: true,
          order: getNextOrder(windows),
          title: windowIdentifier || windowId,
          selectedRecords: {},
          tabFormStates: {},
        };

        const targetURL = buildURL([newWindow]);

        router.push(targetURL);
      }
    },
    [router, pathname, windows, buildURL, openWindow, getNextOrder]
  );

  const handleClickRedirect = useCallback(
    (e: React.MouseEvent, windowId: string | undefined, windowIdentifier: string | undefined) => {
      e.stopPropagation();
      e.preventDefault();
      handleAction(windowId, windowIdentifier);
    },
    [handleAction]
  );

  const handleKeyDownRedirect = useCallback(
    (e: React.KeyboardEvent, windowId: string | undefined, windowIdentifier: string | undefined) => {
      e.stopPropagation();
      e.preventDefault();
      if (e.key === "Enter" || e.key === " ") {
        handleAction(windowId, windowIdentifier);
      }
    },
    [handleAction]
  );

  return {
    handleClickRedirect,
    handleKeyDownRedirect,
  };
};

```

## Archivo: `packages/MainUI/hooks/table/useColumns.tsx`

```typescript
import { useMemo } from "react";
import { parseColumns } from "@/utils/tableColumns";
import type { Tab } from "@workspaceui/api-client/src/api/types";
import type { MRT_Cell } from "material-react-table";
import type { EntityData } from "@workspaceui/api-client/src/api/types";
import type { Column } from "@workspaceui/api-client/src/api/types";
import { isEntityReference } from "@workspaceui/api-client/src/utils/metadata";
import { getFieldReference } from "@/utils";
import { useRedirect } from "@/hooks/navigation/useRedirect";

export const useColumns = (tab: Tab) => {
  const { handleClickRedirect, handleKeyDownRedirect } = useRedirect();

  const columns = useMemo(() => {
    const originalColumns = parseColumns(Object.values(tab.fields));
    const customColumns = originalColumns.map((column: Column) => {
      const isReference = isEntityReference(getFieldReference(column.column?.reference));

      if (isReference) {
        const windowId = column.referencedWindowId;
        const windowIdentifier = column._identifier;
        return {
          ...column,
          Cell: ({ cell }: { cell: MRT_Cell<EntityData, unknown> }) => {
            return (
              <button
                type="button"
                tabIndex={0}
                aria-label="Navigate to referenced window"
                className="bg-transparent border-none p-0 text-(--color-dynamic-main) hover:underline text-left"
                onClick={(e) => handleClickRedirect(e, windowId, windowIdentifier)}
                onKeyDown={(e) => handleKeyDownRedirect(e, windowId, windowIdentifier)}>
                {cell.getValue<string>()}
              </button>
            );
          },
        };
      }
      return column;
    });
    return customColumns;
  }, [tab.fields, handleClickRedirect, handleKeyDownRedirect]);

  return columns;
};

```

## Archivo: `packages/MainUI/hooks/types.ts`

```typescript
import type { EntityData, Field, Tab } from "@workspaceui/api-client/src/api/types";
import type { TranslationKeys, Translations, NestedKeyOf } from "../../ComponentLibrary/src/locales/types";

export type TranslateFunction = <K extends NestedKeyOf<TranslationKeys>>(key: K) => string;

export type { TranslationKeys, Translations };

export enum FieldName {
  INPUT_NAME = "inputName",
  HQL_NAME = "hqlName",
  COLUMN_NAME = "columnName",
}

export interface UseTableDirDatasourceParams {
  field: Field;
  tab?: Tab;
  pageSize?: number;
  initialPageSize?: number;
}

export interface ContextItem {
  id: string;
  label: string;
  contextString: string;
  recordId: string;
}

export interface RecordContextData {
  selectedRecords: EntityData[];
  hasSelectedRecords: boolean;
  contextString: string;
  contextItems: ContextItem[];
}

```

## Archivo: `packages/MainUI/hooks/useApiContext.tsx`

```typescript
import { ApiContext } from "@/contexts/api";
import { useContext } from "react";

export const useApiContext = () => {
  const context = useContext(ApiContext);

  if (!context) {
    throw new Error("useApiContext must be used within an ApiProvider");
  }

  return context;
};

```

## Archivo: `packages/MainUI/hooks/useAssistants.ts`

```typescript
import type { IAssistant } from "@workspaceui/api-client/src/api/copilot";
import { useState, useCallback, useEffect } from "react";
import { useCopilotClient } from "./useCopilotClient";
import { logger } from "@/utils/logger";

export const useAssistants = () => {
  const [selectedOption, setSelectedOption] = useState<IAssistant | null>(null);
  const [assistants, setAssistants] = useState<IAssistant[]>([]);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const copilotClient = useCopilotClient();

  const getAssistants = useCallback(
    async (retryCount = 0) => {
      if (!copilotClient.isReady) {
        logger.log("CopilotClient not ready yet, skipping getAssistants");
        return;
      }

      setLoading(true);
      setError(null);

      try {
        logger.log("Fetching assistants...");
        const data = await copilotClient.getAssistants();

        setAssistants(data);

        if (data.length > 0) {
          setSelectedOption(data[0]);
        } else {
          setSelectedOption(null);
          console.warn("No assistants available from backend");
        }
      } catch (err) {
        if (retryCount < 2) {
          setTimeout(() => getAssistants(retryCount + 1), 1000);
          return;
        }

        setError(err instanceof Error ? err.message : "Failed to load assistants");
        console.error("Error loading assistants:", err);
      } finally {
        setLoading(false);
      }
    },
    [copilotClient]
  );

  // Auto-fetch assistants when client is ready
  useEffect(() => {
    if (copilotClient.isReady) {
      getAssistants();
    }
  }, [copilotClient.isReady, getAssistants]);

  const handleOptionSelected = (value: IAssistant | null) => {
    setSelectedOption(value);
  };

  return {
    selectedOption,
    assistants,
    loading,
    error,
    getAssistants,
    handleOptionSelected,
    hasAssistants: assistants.length > 0,
  };
};

```

## Archivo: `packages/MainUI/hooks/useCallout.ts`

```typescript
import { useCallback } from "react";
import type { Field, FormInitializationResponse } from "@workspaceui/api-client/src/api/types";
import { Metadata } from "@workspaceui/api-client/src/api/metadata";
import type { FieldValues } from "react-hook-form";
import { logger } from "@/utils/logger";
import { useTabContext } from "@/contexts/tab";

export interface UseCalloutProps {
  field: Field;
  parentId?: string;
  rowId?: string;
}

const ACTION = "org.openbravo.client.application.window.FormInitializationComponent";
const MODE = "CHANGE";

export const useCallout = ({ field, parentId = "null", rowId = "null" }: UseCalloutProps) => {
  const { tab } = useTabContext();
  const tabId = tab?.id ?? "";

  return useCallback(
    async (payload: FieldValues) => {
      const params = new URLSearchParams({
        _action: ACTION,
        MODE,
        TAB_ID: tabId,
        CHANGED_COLUMN: field.inputName,
        ROW_ID: rowId,
        PARENT_ID: parentId,
      });

      try {
        const response = await Metadata.kernelClient.post(`?${params}`, payload);

        if (!response?.data) {
          throw new Error(`No data returned from callout for field "${field.inputName}".`);
        }

        return response.data as FormInitializationResponse;
      } catch (error) {
        logger.warn(`Error executing callout for field "${field.inputName}":`, error);
      }
    },
    [tabId, field.inputName, parentId, rowId]
  );
};

```

## Archivo: `packages/MainUI/hooks/useComboSelect.ts`

```typescript
import { useTabContext } from "@/contexts/tab";
import { logger } from "@/utils/logger";
import { datasource } from "@workspaceui/api-client/src/api/datasource";
import type { Field } from "@workspaceui/api-client/src/api/types";
import { useCallback, useState } from "react";
import { useFormContext } from "react-hook-form";
import { FieldName } from "./types";
import useFormParent from "./useFormParent";

export interface UseComboSelectParams {
  field: Field;
}

export const useComboSelect = ({ field }: UseComboSelectParams) => {
  const { watch, getValues } = useFormContext();
  const { tab } = useTabContext();
  const parentData = useFormParent(FieldName.INPUT_NAME);
  const windowId = tab.window;
  const value = watch(field.hqlName);
  const [records, setRecords] = useState<Record<string, string>[]>([]);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<Error>();

  const fetch = useCallback(
    async (_currentValue: typeof value) => {
      try {
        if (!field || !tab) {
          return;
        }

        setLoading(true);

        const body = new URLSearchParams({
          _startRow: "0",
          _endRow: "75",
          _operationType: "fetch",
          ...field.selector,
          moduleId: field.module,
          windowId,
          tabId: field.tab,
          inpTabId: field.tab,
          inpTableId: field.column.table,
          initiatorField: field.hqlName,
          ...(typeof _currentValue !== "undefined" ? { _currentValue } : {}),
          ...parentData,
        });

        for (const [key, value] of Object.entries(getValues())) {
          const _key = tab.fields[key]?.inputName;
          const stringValue = String(value);

          const valueMap = {
            true: "Y",
            false: "N",
            null: "null",
          };

          const safeValue = Object.prototype.hasOwnProperty.call(valueMap, stringValue)
            ? valueMap[stringValue as keyof typeof valueMap]
            : value;

          if (safeValue) {
            body.set(_key || key, safeValue);
          }
        }

        const { data, statusText } = await datasource.client.request(field.selector?.datasourceName ?? "", {
          method: "POST",
          body,
        });

        if (data?.response?.data) {
          setRecords(data.response.data);
        } else {
          throw new Error(statusText);
        }
      } catch (err) {
        logger.warn(err);

        setError(err instanceof Error ? err : new Error(String(err)));
      }
    },
    [field, getValues, parentData, tab, windowId]
  );

  return { records, loading, error, refetch: fetch };
};

```

## Archivo: `packages/MainUI/hooks/useCopilot.ts`

```typescript
import { useCallback, useMemo, useReducer } from "react";
import { useSSEConnection } from "./useSSEConnection";
import type { IMessage, IAssistant, CopilotQuestionParams } from "@workspaceui/api-client/src/api/copilot";
import { formatTime, getMessageType } from "@/utils";
import { useCopilotClient } from "./useCopilotClient";

interface CopilotState {
  messages: IMessage[];
  selectedAssistant: IAssistant | null;
  conversationId: string | null;
  isLoading: boolean;
  files: File[] | null;
  fileIds: string[] | null;
  contextValue: Record<string, unknown> | null;
  contextTitle: string | null;
}

type CopilotAction =
  | { type: "SET_MESSAGES"; messages: IMessage[] }
  | { type: "ADD_MESSAGE"; message: IMessage }
  | { type: "SET_SELECTED_ASSISTANT"; assistant: IAssistant | null }
  | { type: "SET_CONVERSATION_ID"; conversationId: string | null }
  | { type: "SET_LOADING"; isLoading: boolean }
  | { type: "SET_FILES"; files: File[] | null }
  | { type: "SET_FILE_IDS"; fileIds: string[] | null }
  | { type: "SET_CONTEXT_VALUE"; contextValue: Record<string, unknown> | null }
  | { type: "SET_CONTEXT_TITLE"; contextTitle: string | null }
  | { type: "RESET_CONVERSATION" };

const initialState: CopilotState = {
  messages: [],
  selectedAssistant: null,
  conversationId: null,
  isLoading: false,
  files: null,
  fileIds: null,
  contextValue: null,
  contextTitle: null,
};

function copilotReducer(state: CopilotState, action: CopilotAction): CopilotState {
  switch (action.type) {
    case "SET_MESSAGES":
      return { ...state, messages: action.messages };
    case "ADD_MESSAGE": {
      const lastMessage = state.messages[state.messages.length - 1];
      if (lastMessage && lastMessage.text === action.message.text && lastMessage.sender === action.message.sender) {
        return state;
      }
      return { ...state, messages: [...state.messages, action.message] };
    }
    case "SET_SELECTED_ASSISTANT":
      return { ...state, selectedAssistant: action.assistant };
    case "SET_CONVERSATION_ID":
      return { ...state, conversationId: action.conversationId };
    case "SET_LOADING":
      return { ...state, isLoading: action.isLoading };
    case "SET_FILES":
      return { ...state, files: action.files };
    case "SET_FILE_IDS":
      return { ...state, fileIds: action.fileIds };
    case "SET_CONTEXT_VALUE":
      return { ...state, contextValue: action.contextValue };
    case "SET_CONTEXT_TITLE":
      return { ...state, contextTitle: action.contextTitle };
    case "RESET_CONVERSATION":
      return {
        ...initialState,
        selectedAssistant: null,
      };
    default:
      return state;
  }
}

export const useCopilot = () => {
  const [state, dispatch] = useReducer(copilotReducer, initialState);
  const copilotClient = useCopilotClient();

  const addMessage = useCallback((sender: string, text: string) => {
    const newMessage: IMessage = {
      text,
      sender,
      timestamp: formatTime(new Date()),
    };

    dispatch({ type: "ADD_MESSAGE", message: newMessage });
  }, []);

  const handleSSEMessage = useCallback(
    (data: Record<string, unknown>) => {
      const answer = data?.answer as { conversation_id?: string; response?: string; role?: string };
      if (answer?.conversation_id) {
        dispatch({ type: "SET_CONVERSATION_ID", conversationId: answer.conversation_id });
      }

      if (answer?.response) {
        if (answer.role !== "debug") {
          addMessage("bot", answer.response);
        }
      }
    },
    [addMessage]
  );

  const handleSSEError = useCallback(
    (error: string) => {
      console.error("SSE Error:", error);

      if (error.includes("Connection error occurred")) {
        dispatch({ type: "SET_LOADING", isLoading: false });
        addMessage("error", `Error: ${error}`);
      }
    },
    [addMessage]
  );

  const handleSSEComplete = useCallback(() => {
    dispatch({ type: "SET_LOADING", isLoading: false });
  }, []);

  const { startSSEConnection, closeConnection } = useSSEConnection({
    onMessage: handleSSEMessage,
    onError: handleSSEError,
    onComplete: handleSSEComplete,
  });

  const finalQuestion = useMemo(() => {
    if (!state.contextValue) return null;
    return (message: string) => {
      const contextValueString = JSON.stringify(state.contextValue, null, 2);
      return `<Context>${contextValueString}</Context>\n<Question>${message}</Question>`;
    };
  }, [state.contextValue]);

  const handleSendMessage = useCallback(
    async (message: string) => {
      if (state.isLoading || !message.trim() || !state.selectedAssistant) {
        return;
      }

      dispatch({ type: "SET_LOADING", isLoading: true });
      addMessage("user", message);

      const questionText = finalQuestion ? finalQuestion(message) : message;

      const requestParams: Record<string, unknown> = {
        question: questionText,
        app_id: state.selectedAssistant.app_id,
      };

      if (state.conversationId) {
        requestParams.conversation_id = state.conversationId;
      }

      if (state.fileIds) {
        requestParams.file = state.fileIds;
      }

      try {
        const processedParams = await copilotClient.handleLargeQuestion(requestParams as CopilotQuestionParams);
        await startSSEConnection(processedParams);
      } catch (error) {
        console.error("Error sending message:", error);
        dispatch({ type: "SET_LOADING", isLoading: false });
        addMessage("error", "Error enviando mensaje");
      }
    },
    [
      state.isLoading,
      state.selectedAssistant,
      state.conversationId,
      state.fileIds,
      finalQuestion,
      addMessage,
      startSSEConnection,
      copilotClient,
    ]
  );

  const handleSelectAssistant = useCallback(
    (assistant: IAssistant | null) => {
      dispatch({ type: "SET_SELECTED_ASSISTANT", assistant });
      dispatch({ type: "SET_MESSAGES", messages: [] });
      dispatch({ type: "SET_CONVERSATION_ID", conversationId: null });
      closeConnection();
    },
    [closeConnection]
  );

  const handleResetConversation = useCallback(() => {
    dispatch({ type: "RESET_CONVERSATION" });
    closeConnection();
  }, [closeConnection]);

  const handleFileUpload = useCallback(
    async (uploadedFiles: File[]) => {
      try {
        const uploadResults = await Promise.all(uploadedFiles.map((file) => copilotClient.uploadFile(file)));
        const ids = uploadResults.flatMap((result) => Object.values(result));
        dispatch({ type: "SET_FILE_IDS", fileIds: ids as string[] });
        dispatch({ type: "SET_FILES", files: uploadedFiles });
      } catch (error) {
        console.error("Error uploading files:", error);
        addMessage("error", "Error subiendo archivos");
      }
    },
    [addMessage, copilotClient]
  );

  const getMessageDisplayType = useCallback((sender: string) => {
    return getMessageType(sender);
  }, []);

  const setContextTitle = useCallback((title: string | null) => {
    dispatch({ type: "SET_CONTEXT_TITLE", contextTitle: title });
  }, []);

  const setContextValue = useCallback((value: Record<string, unknown> | null) => {
    dispatch({ type: "SET_CONTEXT_VALUE", contextValue: value });
  }, []);

  return {
    messages: state.messages,
    selectedAssistant: state.selectedAssistant,
    isLoading: state.isLoading,
    files: state.files,
    contextTitle: state.contextTitle,

    setContextTitle,
    setContextValue,

    handleSendMessage,
    handleSelectAssistant,
    handleResetConversation,
    handleFileUpload,
    getMessageDisplayType,
  };
};

```

## Archivo: `packages/MainUI/hooks/useCopilotClient.ts`

```typescript
import { useEffect, useCallback, useMemo } from "react";
import { CopilotClient } from "@workspaceui/api-client/src/api/copilot";
import { useUserContext } from "./useUserContext";
import { useApiContext } from "./useApiContext";
import { performCopilotHealthCheck } from "@/utils/health-check";
import { logger } from "@/utils/logger";

export const useCopilotClient = () => {
  const token = useUserContext();
  const apiUrl = useApiContext();

  const initializeClient = useCallback(async () => {
    if (!token?.token || !apiUrl) {
      logger.log("CopilotClient: Token or API URL not available yet, skipping initialization");
      return;
    }

    logger.log("CopilotClient: Initializing with token and API URL:", apiUrl);
    CopilotClient.setBaseUrl(apiUrl);
    CopilotClient.setToken(token.token);

    const copilotUrl = CopilotClient.getCurrentBaseUrl();
    await performCopilotHealthCheck(copilotUrl, token.token);
  }, [token, apiUrl]);

  useEffect(() => {
    initializeClient();
  }, [initializeClient]);

  const client = useMemo(
    () => ({
      getAssistants: CopilotClient.getAssistants,
      getLabels: CopilotClient.getLabels,
      uploadFile: CopilotClient.uploadFile,
      uploadFiles: CopilotClient.uploadFiles,
      cacheQuestion: CopilotClient.cacheQuestion,
      sendQuestion: CopilotClient.sendQuestion,
      buildSSEUrl: CopilotClient.buildSSEUrl,
      getSSEHeaders: CopilotClient.getSSEHeaders,
      shouldCacheQuestion: CopilotClient.shouldCacheQuestion,
      handleLargeQuestion: CopilotClient.handleLargeQuestion,
      reinitialize: initializeClient,
      isReady: !!token?.token,
    }),
    [initializeClient, token?.token]
  );

  return client;
};

```

## Archivo: `packages/MainUI/hooks/useCopilotLabels.ts`

```typescript
import type { ILabels } from "@workspaceui/api-client/src/api/copilot";
import { useState, useCallback } from "react";
import { useCopilotClient } from "./useCopilotClient";

export const useCopilotLabels = () => {
  const [labels, setLabels] = useState<ILabels>({});
  const [areLabelsLoaded, setAreLabelsLoaded] = useState(false);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const copilotClient = useCopilotClient();

  const getLabels = useCallback(
    async (retryCount = 0) => {
      setLoading(true);
      setError(null);

      try {
        const data = await copilotClient.getLabels();

        if (data) {
          setLabels(data);
          setAreLabelsLoaded(true);
        }
      } catch (err) {
        if (retryCount < 2) {
          setTimeout(() => getLabels(retryCount + 1), 1000);
          return;
        }

        setError(err instanceof Error ? err.message : "Failed to load labels");
        console.error("Error loading Copilot labels:", err);
      } finally {
        setLoading(false);
      }
    },
    [copilotClient]
  );

  return {
    labels,
    areLabelsLoaded,
    loading,
    error,
    getLabels,
  };
};

```

## Archivo: `packages/MainUI/hooks/useDatasource.ts`

```typescript
import { logger } from "@/utils/logger";
import { datasource } from "@workspaceui/api-client/src/api/datasource";
import type {
  Column,
  DatasourceOptions,
  EntityData,
  MRT_ColumnFiltersState,
} from "@workspaceui/api-client/src/api/types";
import { ColumnFilterUtils, SearchUtils } from "@workspaceui/api-client/src/utils/search-utils";
import { useCallback, useEffect, useMemo, useState } from "react";

const loadData = async (entity: string, page: number, pageSize: number, params: DatasourceOptions) => {
  const safePageSize = pageSize ?? 1000;
  const startRow = (page - 1) * pageSize;
  const endRow = page * pageSize - 1;

  const processedParams = {
    ...params,
    startRow,
    endRow,
    pageSize: safePageSize,
  };

  return datasource.get(entity, processedParams);
};

const defaultParams: DatasourceOptions = {
  pageSize: 1000,
};

export type UseDatasourceOptions = {
  entity: string;
  params?: DatasourceOptions;
  searchQuery?: string;
  columns?: Column[];
  skip?: boolean;
};

export function useDatasource({ entity, params = defaultParams, columns, searchQuery, skip }: UseDatasourceOptions) {
  const [loading, setLoading] = useState(false);
  const [loaded, setLoaded] = useState(false);
  const [records, setRecords] = useState<EntityData[]>([]);
  const [error, setError] = useState<Error | undefined>(undefined);
  const [page, setPage] = useState(1);
  const [isImplicitFilterApplied, setIsImplicitFilterApplied] = useState(params.isImplicitFilterApplied ?? false);
  const [pageSize, setPageSize] = useState(params.pageSize ?? defaultParams.pageSize);
  const [activeColumnFilters, setActiveColumnFilters] = useState<MRT_ColumnFiltersState>([]);
  const [hasMoreRecords, setHasMoreRecords] = useState(true);

  const removeRecordLocally = useCallback((recordId: string) => {
    setRecords((prevRecords) => prevRecords.filter((record) => String(record.id) !== recordId));
  }, []);

  const fetchMore = useCallback(() => {
    setPage((prev) => prev + 1);
  }, []);

  const updateColumnFilters = useCallback((filters: MRT_ColumnFiltersState) => {
    setActiveColumnFilters(filters);
    setPage(1);
    setRecords([]);
  }, []);

  const changePageSize = useCallback((size: number) => {
    setPageSize(size);
  }, []);

  const toggleImplicitFilters = useCallback(() => {
    setIsImplicitFilterApplied((prev) => !prev);
    setPage(1);
  }, []);

  const reinit = useCallback(() => {
    setRecords([]);
    setPage(1);
    setHasMoreRecords(true);
  }, []);

  const columnFilterCriteria = useMemo(() => {
    if (!columns || !activeColumnFilters.length) return [];

    return ColumnFilterUtils.createColumnFilterCriteria(activeColumnFilters, columns);
  }, [activeColumnFilters, columns]);

  const queryParams = useMemo(() => {
    const baseCriteria = params.criteria || [];
    const searchCriteriaArray = searchQuery && columns ? SearchUtils.createSearchCriteria(columns, searchQuery) : [];

    let allCriteria = [...baseCriteria];

    if (searchCriteriaArray.length > 0) {
      allCriteria = [...allCriteria, ...searchCriteriaArray];
    }

    if (columnFilterCriteria.length > 0) {
      allCriteria = [...allCriteria, ...columnFilterCriteria];
    }

    return {
      ...params,
      criteria: allCriteria,
      isImplicitFilterApplied,
    };
  }, [params, searchQuery, columns, columnFilterCriteria, isImplicitFilterApplied]);

  const load = useCallback(() => {
    if (!entity || skip) {
      reinit();
      setLoaded(true);
      return;
    }

    setError(undefined);
    setLoading(true);

    const safePageSize = pageSize ?? 1000;

    const f = async () => {
      try {
        const { ok, data } = await loadData(entity, page, safePageSize, queryParams);

        if (!(ok && data.response.data)) {
          throw data;
        }
        setHasMoreRecords(data.response.data.length >= safePageSize);
        setRecords((prev) => (page === 1 || searchQuery ? data.response.data : prev.concat(data.response.data)));
        setLoaded(true);
      } catch (e) {
        logger.warn(e);

        if (!isImplicitFilterApplied) {
          setError(e as Error);
        } else {
          setIsImplicitFilterApplied(false);
        }
      } finally {
        setLoading(false);
      }
    };

    f();
  }, [entity, isImplicitFilterApplied, page, pageSize, queryParams, reinit, searchQuery, skip]);

  useEffect(() => {
    reinit();
    setLoaded(false);
  }, []);

  useEffect(() => {
    load();
  }, [load]);

  const refetch = useCallback(() => {
    reinit();
    setLoaded(false);
    load();
  }, [load]);

  return {
    loading,
    error,
    fetchMore,
    changePageSize,
    load,
    records,
    loaded,
    isImplicitFilterApplied,
    toggleImplicitFilters,
    updateColumnFilters,
    activeColumnFilters,
    removeRecordLocally,
    refetch,
    hasMoreRecords,
  };
}

```

## Archivo: `packages/MainUI/hooks/useDebounce.ts`

```typescript
import { useCallback, useEffect, useRef } from "react";

interface PromiseRef<T> {
  resolve: (value: T | PromiseLike<T>) => void;
  reject: (reason?: unknown) => void;
}

/**
 * Hook personalizado para realizar debounce de una función asíncrona
 * Similar a _.debounce de lodash pero como un hook de React
 * Soporta funciones que devuelven promesas
 *
 * @template T - Tipo del valor devuelto por la función
 * @template Args - Tipos de argumentos que recibe la función
 * @param {(...args: Args) => Promise<T> | T} fn - La función a ejecutar con debounce
 * @param {number} delay - Tiempo de espera en milisegundos
 * @param {DependencyList} deps - Dependencias adicionales
 * @returns {(...args: Args) => Promise<T>} - Función con debounce aplicado que devuelve una promesa
 */
// biome-ignore lint/suspicious/noExplicitAny: <explanation>
function useDebounce<T, Args extends any[] = any[]>(fn: ((...args: Args) => Promise<T> | T) | undefined, delay = 500) {
  const timerRef = useRef<NodeJS.Timeout | null>(null);
  const latestPromiseRef = useRef<PromiseRef<T> | null>(null);

  useEffect(() => {
    return () => {
      if (timerRef.current) {
        clearTimeout(timerRef.current);
      }
    };
  }, []);

  return useCallback(
    (...args: Args): Promise<T> | undefined => {
      if (!fn) return undefined;
      // Creamos una nueva promesa
      const promiseRef: PromiseRef<T> = {} as PromiseRef<T>;
      const promise = new Promise<T>((resolve, reject) => {
        promiseRef.resolve = resolve;
        promiseRef.reject = reject;
      });

      latestPromiseRef.current = promiseRef;

      if (timerRef.current) {
        clearTimeout(timerRef.current);
      }

      timerRef.current = setTimeout(() => {
        if (latestPromiseRef.current === promiseRef) {
          Promise.resolve(fn(...args))
            .then((result) => promiseRef.resolve(result))
            .catch((err) => promiseRef.reject(err));
        }
      }, delay);

      return promise;
    },
    [fn, delay]
  );
}

export { useDebounce };

export default useDebounce;

```

## Archivo: `packages/MainUI/hooks/useDeleteRecord.ts`

```typescript
import { useCallback, useRef, useState } from "react";
import type { EntityData, Tab } from "@workspaceui/api-client/src/api/types";
import { useUserContext } from "./useUserContext";
import { Metadata } from "@workspaceui/api-client/src/api/metadata";
import { useTranslation } from "./useTranslation";

export interface UseDeleteRecordParams {
  tab: Tab;
  onSuccess?: (deletedCount: number) => void;
  onError?: (error: string) => void;
  showConfirmation?: boolean;
}

export const useDeleteRecord = ({ tab, onSuccess, onError }: UseDeleteRecordParams) => {
  const [loading, setLoading] = useState(false);
  const controller = useRef<AbortController>(new AbortController());
  const { user } = useUserContext();
  const userId = user?.id;
  const { t } = useTranslation();

  const deleteRecord = useCallback(
    async (recordOrRecords: EntityData | EntityData[]) => {
      const records = Array.isArray(recordOrRecords) ? recordOrRecords : [recordOrRecords];

      if (records.length === 0) {
        onError?.(t("status.noRecordsError"));
        return false;
      }

      if (!tab || !tab.entityName) {
        onError?.(t("status.noEntityError"));
        return false;
      }

      try {
        setLoading(true);

        controller.current.abort();
        controller.current = new AbortController();

        const deletePromises = records.map((record) => {
          if (!record || !record.id) {
            throw new Error(t("status.noIdError"));
          }

          const queryParams = new URLSearchParams({
            windowId: String(tab.window),
            tabId: String(tab.id),
            moduleId: String(tab.module || "0"),
            _operationType: "remove",
            _noActiveFilter: "true",
            sendOriginalIDBack: "true",
            _extraProperties: "",
            Constants_FIELDSEPARATOR: "$",
            _className: "OBViewDataSource",
            Constants_IDENTIFIER: "_identifier",
            csrfToken: userId || "",
            id: String(record.id),
          });

          const url = `/${tab.entityName}?${queryParams}`;

          return Metadata.datasourceServletClient.request(url, {
            method: "DELETE",
            signal: controller.current.signal,
          });
        });

        const responses = await Promise.allSettled(deletePromises);

        const errors = responses.filter((response) => response.status === "rejected") as PromiseRejectedResult[];

        if (errors.length > 0) {
          const errorMessages = errors.map((err) =>
            err.reason instanceof Error ? err.reason.message : String(err.reason)
          );

          throw new Error(errorMessages.join("; "));
        }

        setLoading(false);

        if (onSuccess) {
          onSuccess(records.length);
        }

        return true;
      } catch (err) {
        setLoading(false);

        if (err instanceof Error && err.name === "AbortError") {
          return false;
        }

        if (onError) {
          onError(err instanceof Error ? err.message : String(err));
        }

        return false;
      }
    },
    [tab, onError, t, userId, onSuccess]
  );

  return { deleteRecord, loading };
};

```

## Archivo: `packages/MainUI/hooks/useDisplayLogic.ts`

```typescript
import { compileExpression } from "@/components/Form/FormView/selectors/BaseSelector";
import { useUserContext } from "./useUserContext";
import { useTabContext } from "@/contexts/tab";
import type { Field } from "@workspaceui/api-client/src/api/types";
import { useMemo } from "react";
import { useFormContext } from "react-hook-form";
import { logger } from "@/utils/logger";

interface UseDisplayLogicProps {
  field: Field;
  values?: Field;
}

export default function useDisplayLogic({ field, values }: UseDisplayLogicProps) {
  const { session } = useUserContext();
  const { tab, record } = useTabContext();

  const formContext = useFormContext();
  const formValues = formContext?.watch?.();

  const isDisplayed: boolean = useMemo(() => {
    if (!tab) {
      return false;
    }

    if (!field.displayed) return false;

    if (!field.displayLogicExpression) return true;

    const compiledExpr = compileExpression(field.displayLogicExpression);

    try {
      const currentValues = values || formValues || record;
      return compiledExpr(session, currentValues);
    } catch (error) {
      return logger.error("Unexpected error", error);
    }
  }, [field.displayLogicExpression, field.displayed, formValues, record, session, tab, values]);

  return isDisplayed;
}

```

## Archivo: `packages/MainUI/hooks/useFieldValue.ts`

```typescript
import { useMemo } from "react";
import { useFormContext } from "react-hook-form";
import { type Field, FieldType } from "@workspaceui/api-client/src/api/types";
import { formatNumber, getFieldReference } from "@/utils";

/**
 * Hook to safely get field value with proper identifier/value synchronization
 */
export const useFieldValue = (field: Field) => {
  const { watch } = useFormContext();
  const [value, identifier] = watch([field.hqlName, `${field.hqlName}$_identifier`]);

  const displayValue = useMemo(() => {
    if (identifier !== null && identifier !== undefined && identifier !== "") {
      return identifier;
    }

    if (value === null || value === undefined || value === "") {
      return "";
    }

    const reference = getFieldReference(field.column?.reference);

    switch (reference) {
      case FieldType.DATE:
        try {
          return new Date(value).toLocaleDateString();
        } catch {
          return String(value);
        }
      case FieldType.BOOLEAN:
        return value ? "Y" : "N";
      case FieldType.NUMBER:
      case FieldType.QUANTITY:
        return formatNumber(value);
      default:
        return String(value);
    }
  }, [field, identifier, value]);

  return {
    value,
    identifier,
    displayValue,
    hasIdentifier: identifier !== null && identifier !== undefined && identifier !== "",
    isEmpty:
      (value === null || value === undefined || value === "") &&
      (identifier === null || identifier === undefined || identifier === ""),
  };
};

```

## Archivo: `packages/MainUI/hooks/useFormAction.ts`

```typescript
import { buildFormPayload, buildQueryString } from "@/utils";
import { shouldRemoveIdFields } from "@/utils/form/entityConfig";
import { Metadata } from "@workspaceui/api-client/src/api/metadata";
import type { EntityData, FormMode, Tab, WindowMetadata } from "@workspaceui/api-client/src/api/types";
import { useCallback, useEffect, useMemo, useRef, useState } from "react";
import type { UseFormHandleSubmit } from "react-hook-form";
import { useUserContext } from "./useUserContext";

export interface UseFormActionParams {
  windowMetadata?: WindowMetadata;
  tab: Tab;
  mode: FormMode;
  onSuccess: (data: EntityData) => void;
  onError: (data: string) => void;
  initialState?: EntityData;
  submit: UseFormHandleSubmit<EntityData>;
}

export const useFormAction = ({
  windowMetadata,
  tab,
  mode,
  onSuccess,
  onError,
  initialState,
  submit,
}: UseFormActionParams) => {
  const [loading, setLoading] = useState(false);
  const controller = useRef<AbortController>(new AbortController());
  const { user } = useUserContext();
  const userId = user?.id;

  const execute = useCallback(
    async (values: EntityData) => {
      try {
        setLoading(true);

        const queryStringParams = buildQueryString({ mode, windowMetadata, tab });

        const shouldRemoveId = shouldRemoveIdFields(tab.entityName, mode);

        let processedValues = { ...values };
        let processedInitialState = { ...initialState };

        if (shouldRemoveId) {
          const { id, id$_identifier: idIdentifier, ...valuesWithoutId } = processedValues;
          processedValues = valuesWithoutId as EntityData;

          if (processedInitialState) {
            const { id: initialId, id$_identifier: initialIdIdentifier, ...initialWithoutId } = processedInitialState;
            processedInitialState = initialWithoutId as EntityData;
          }
        }

        const body = buildFormPayload({
          values: processedValues,
          oldValues: processedInitialState,
          mode,
          csrfToken: userId,
        });

        const url = `${tab.entityName}?${queryStringParams}`;
        const options = { signal: controller.current.signal, method: "POST", body };
        const { ok, data } = await Metadata.datasourceServletClient.request(url, options);

        if (ok && data?.response?.status === 0 && !controller.current.signal.aborted) {
          setLoading(false);
          onSuccess?.(data.response.data[0]);
        } else {
          throw new Error(data.response.error?.message);
        }
      } catch (err) {
        setLoading(false);
        onError?.(String(err));
      }
    },
    [initialState, mode, onError, onSuccess, tab, userId, windowMetadata]
  );

  const save = useMemo(() => submit(execute), [execute, submit]);

  useEffect(() => {
    const _controller = controller.current;

    return () => {
      _controller.abort();
      controller.current = new AbortController();
    };
  }, []);

  return { save, loading };
};

```

## Archivo: `packages/MainUI/hooks/useFormFields.ts`

```typescript
import { getFieldReference } from "@/utils";
import { type EntityValue, type Field, FieldType, FormMode, type Tab } from "@workspaceui/api-client/src/api/types";
import { useMemo } from "react";
import { useFormContext } from "react-hook-form";
import { useTranslation } from "./useTranslation";

const createAuditField = (fieldName: string, label: string, columnName: string, reference: string): Field =>
  ({
    id: `audit_${fieldName}`,
    name: label,
    hqlName: fieldName,
    displayed: true,
    displayLogicExpression: null,
    isReadOnly: true,
    isUpdatable: false,
    isMandatory: false,
    helpComment: `${label} information for audit purposes`,
    inputName: `inp${fieldName}`,
    isEditable: false,
    isFirstFocusedField: false,
    isParentRecordProperty: false,
    sequenceNumber: 9999,
    shownInStatusBar: false,
    fieldGroup: "audit",
    fieldGroup$_identifier: "Audit",
    displayField: "_identifier",
    column: {
      id: `audit_col_${fieldName}`,
      name: columnName,
      reference,
      dBColumnName: columnName,
    },
    displayFieldOnly: false,
    displayOnSameLine: false,
    displayedLength: reference === "16" ? 20 : 32,
    gridPosition: null,
    ignoreInWad: false,
    processAction: null,
    processDefinition: null,
    readOnly: true,
    startinoddcolumn: false,
    startnewline: false,
    showInGridView: false,
  }) as unknown as Field;

interface UseFormFieldsReturn {
  fields: {
    statusBarFields: Record<string, Field>;
    formFields: Record<string, Field>;
    actionFields: Record<string, Field>;
    otherFields: Record<string, Field>;
  };
  groups: Array<
    [
      string,
      {
        id: string | null;
        identifier: string;
        sequenceNumber: number;
        fields: Record<string, Field>;
      },
    ]
  >;
}

export default function useFormFields(
  tab: Tab,
  mode: FormMode = FormMode.EDIT,
  hasAuditData = false,
  availableFormData: { [x: string]: EntityValue } = {}
): UseFormFieldsReturn {
  const { t } = useTranslation();
  const formContext = useFormContext();

  const autoDetectAuditData = useMemo(() => {
    if (mode === FormMode.NEW) {
      return false;
    }

    const formValues = formContext?.watch?.() || availableFormData || {};

    const hasAuditInForm = !!(
      formValues?.creationDate ||
      formValues?.createdBy$_identifier ||
      formValues?.updated ||
      formValues?.updatedBy$_identifier
    );

    const hasAuditInTab = !!(
      tab.fields.creationDate ||
      tab.fields.createdBy$_identifier ||
      tab.fields.updated ||
      tab.fields.updatedBy$_identifier
    );

    const result = hasAuditInForm || hasAuditInTab || hasAuditData;
    return result;
  }, [mode, formContext, hasAuditData, tab.fields, availableFormData]);

  const createAuditFields = useMemo(() => {
    return () => {
      const auditFields: Record<string, Field> = {};

      const formValues = formContext?.watch?.() || availableFormData || {};

      if (tab.fields.creationDate || formValues.creationDate) {
        auditFields.creationDate = createAuditField("creationDate", t("audit.createdDate"), "creationDate", "16");
      }
      if (tab.fields.createdBy || formValues.createdBy || formValues.createdBy$_identifier) {
        auditFields.createdBy = createAuditField("createdBy$_identifier", t("audit.createdBy"), "createdBy", "19");
      }
      if (tab.fields.updated || formValues.updated) {
        auditFields.updated = createAuditField("updated", t("audit.updated"), "updated", "16");
      }
      if (tab.fields.updatedBy || formValues.updatedBy || formValues.updatedBy$_identifier) {
        auditFields.updatedBy = createAuditField("updatedBy$_identifier", t("audit.updatedBy"), "updatedBy", "18");
      }

      return auditFields;
    };
  }, [tab.fields, formContext, t, availableFormData]);

  const fields = useMemo(() => {
    const statusBarFields: Record<string, Field> = {};
    const formFields: Record<string, Field> = {};
    const actionFields: Record<string, Field> = {};
    const otherFields: Record<string, Field> = {};

    for (const [, field] of Object.entries(tab.fields)) {
      const reference = getFieldReference(field.column?.reference);
      if (field.processAction || field.processDefinition || reference === FieldType.BUTTON) {
        actionFields[field.hqlName] = field;
      } else if (field.shownInStatusBar) {
        statusBarFields[field.hqlName] = field;
      } else if (field.displayed) {
        formFields[field.hqlName] = field;
      } else {
        otherFields[field.hqlName] = field;
      }
    }

    if (autoDetectAuditData) {
      const auditFields = createAuditFields();
      Object.assign(formFields, auditFields);
    }

    return { statusBarFields, formFields, actionFields, otherFields };
  }, [autoDetectAuditData, tab.fields, createAuditFields]);

  const fieldGroups = useMemo(() => {
    const groups = {} as Record<
      string,
      { id: string | null; identifier: string; sequenceNumber: number; fields: Record<string, Field> }
    >;

    for (const [fieldName, field] of Object.entries(fields.formFields)) {
      const [id = "", identifier = ""] = [field.fieldGroup, field.fieldGroup$_identifier];

      if (!groups[id]) {
        groups[id] = {
          id: id || null,
          identifier: identifier || t("forms.sections.main"),
          sequenceNumber: Number.MAX_SAFE_INTEGER,
          fields: {},
        };
      }

      groups[id].fields[fieldName] = field;

      if (groups[id].sequenceNumber > field.sequenceNumber) {
        groups[id].sequenceNumber = field.sequenceNumber;
      }
    }

    if (groups.audit) {
      groups.audit.sequenceNumber = 9999;
      groups.audit.identifier = t("forms.sections.audit");
    }
    return groups;
  }, [fields.formFields, t]);

  const groups = useMemo(() => {
    const sortedGroups = Object.entries(fieldGroups).toSorted(([, a], [, b]) => {
      return a.sequenceNumber - b.sequenceNumber;
    });

    return sortedGroups;
  }, [fieldGroups]);

  return { fields, groups };
}

```

## Archivo: `packages/MainUI/hooks/useFormInitialState.ts`

```typescript
import { useTabContext } from "@/contexts/tab";
import type { EntityData, FormInitializationResponse } from "@workspaceui/api-client/src/api/types";
import { getFieldsByColumnName } from "@workspaceui/api-client/src/utils/metadata";
import { useMemo } from "react";
import { FieldName } from "./types";
import useFormParent from "./useFormParent";

export const useFormInitialState = (formInitialization?: FormInitializationResponse | null) => {
  const { tab } = useTabContext();
  const parentData = useFormParent(FieldName.HQL_NAME);
  const fieldsByColumnName = useMemo(() => getFieldsByColumnName(tab), [tab]);

  const initialState = useMemo(() => {
    if (!formInitialization) return null;

    const acc = { ...formInitialization.sessionAttributes } as EntityData;

    for (const [key, { value }] of Object.entries(formInitialization.auxiliaryInputValues)) {
      const newKey = fieldsByColumnName?.[key]?.hqlName ?? key;

      acc[newKey] = value;
    }

    for (const [key, { value, identifier }] of Object.entries(formInitialization.columnValues)) {
      const field = fieldsByColumnName?.[key];
      const newKey = field?.hqlName ?? key;

      acc[newKey] = value;

      if (identifier) {
        acc[`${newKey}$_identifier`] = identifier;
      } else if (value !== null && value !== undefined && value !== "") {
        acc[`${newKey}$_identifier`] = "";
      }
    }

    const processedParentData = { ...parentData };

    return { ...acc, ...processedParentData };
  }, [fieldsByColumnName, formInitialization, parentData]);

  return initialState;
};

```

## Archivo: `packages/MainUI/hooks/useFormInitialization.ts`

```typescript
import { useTabContext } from "@/contexts/tab";
import { logger } from "@/utils/logger";
import { getFieldsToAdd } from "@/utils/form/entityConfig";
import type { ClientOptions } from "@workspaceui/api-client/src/api/client";
import { Metadata } from "@workspaceui/api-client/src/api/metadata";
import {
  type FormInitializationParams,
  type FormInitializationResponse,
  FormMode,
  type Tab,
} from "@workspaceui/api-client/src/api/types";
import { useCallback, useMemo, useReducer } from "react";
import { FieldName } from "./types";
import useFormParent from "./useFormParent";
import { useUserContext } from "./useUserContext";

const getRowId = (mode: FormMode, recordId?: string | null): string => {
  return mode === FormMode.EDIT ? (recordId ?? "null") : "null";
};

export const buildFormInitializationParams = ({
  mode,
  tab,
  recordId,
  parentId,
}: {
  tab: Tab;
  mode: FormMode;
  recordId?: string | null;
  parentId?: string | null;
}): URLSearchParams =>
  new URLSearchParams({
    MODE: mode,
    PARENT_ID: parentId ?? "null",
    TAB_ID: tab.id,
    ROW_ID: getRowId(mode, recordId),
    _action: "org.openbravo.client.application.window.FormInitializationComponent",
  });

const fetchFormInitialization = async (
  params: URLSearchParams,
  payload: ClientOptions["body"]
): Promise<FormInitializationResponse> => {
  try {
    const { data } = await Metadata.kernelClient.post(`?${params}`, payload);

    return data;
  } catch (error) {
    logger.warn("Error fetching initial form data:", error);
    throw new Error("Failed to fetch initial data");
  }
};

type State =
  | {
      loading: true;
      error: null;
      formInitialization: null;
    }
  | {
      loading: false;
      error: null;
      formInitialization: FormInitializationResponse;
    }
  | {
      loading: false;
      error: Error;
      formInitialization: FormInitializationResponse | null;
    };

type Action =
  | { type: "FETCH_START" }
  | { type: "FETCH_SUCCESS"; payload: FormInitializationResponse }
  | { type: "FETCH_ERROR"; payload: Error };

const initialState: State = {
  loading: true,
  error: null,
  formInitialization: null,
};

const reducer = (state: State, action: Action): State => {
  switch (action.type) {
    case "FETCH_START":
      return { loading: true, error: null, formInitialization: null };
    case "FETCH_SUCCESS":
      return { loading: false, error: null, formInitialization: action.payload };
    case "FETCH_ERROR":
      return { loading: false, error: action.payload, formInitialization: state.formInitialization };
    default:
      return state;
  }
};

export type useFormInitialization = State & {
  refetch: () => Promise<void>;
};

export function useFormInitialization({ tab, mode, recordId }: FormInitializationParams): useFormInitialization {
  const { setSession } = useUserContext();
  const { parentRecord: parent } = useTabContext();
  const [state, dispatch] = useReducer<React.Reducer<State, Action>>(reducer, initialState);
  const { error, formInitialization, loading } = state;
  const parentData = useFormParent(FieldName.HQL_NAME);
  const parentId = parent?.id?.toString();
  const params = useMemo(
    () => (tab ? buildFormInitializationParams({ tab, mode, recordId, parentId }) : null),
    [tab, mode, recordId, parentId]
  );

  const fetch = useCallback(async () => {
    if (!params) return;

    try {
      const entityKeyColumn = Object.values(tab.fields).find((field) => field.column.keyColumn);
      if (!entityKeyColumn) {
        throw new Error("Missing key column");
      }

      const additionalFields = getFieldsToAdd(tab.entityName, mode);

      const payload = {
        ...parentData,
        inpKeyName: entityKeyColumn.inputName,
        inpTabId: tab.id,
        inpTableId: tab.table,
        inpkeyColumnId: entityKeyColumn.columnName,
        keyColumnName: entityKeyColumn.columnName,
        _entityName: tab.entityName,
        inpwindowId: tab.window,
        ...additionalFields,
      };

      const data = await fetchFormInitialization(params, payload);
      const storedInSessionAttributes = Object.entries(data.auxiliaryInputValues).reduce(
        (acc, [key, { value }]) => {
          acc[key] = value || "";

          return acc;
        },
        {} as Record<string, string>
      );

      setSession((prev) => ({ ...prev, ...storedInSessionAttributes, ...data.sessionAttributes }));
      dispatch({ type: "FETCH_SUCCESS", payload: data });
    } catch (err) {
      logger.warn(err);
      dispatch({ type: "FETCH_ERROR", payload: err instanceof Error ? err : new Error("Unknown error") });
    }
  }, [params, parentData, setSession, tab.entityName, tab.fields, tab.id, tab.table, tab.window]);

  const refetch = useCallback(async () => {
    if (!params) return;
    dispatch({ type: "FETCH_START" });
    await fetch();
  }, [params, fetch]);

  return useMemo(
    () => ({ error, formInitialization, loading, refetch }) as useFormInitialization,
    [error, formInitialization, loading, refetch]
  );
}

```

## Archivo: `packages/MainUI/hooks/useFormParent.ts`

```typescript
import { useTabContext } from "@/contexts/tab";
import type { EntityData } from "@workspaceui/api-client/src/api/types";
import { getFieldsByInputName } from "@workspaceui/api-client/src/utils/metadata";
import { useMemo } from "react";
import { FieldName } from "./types";

export default function useFormParent(nameToUse: FieldName = FieldName.HQL_NAME) {
  const { tab, parentTab, parentRecord } = useTabContext();

  return useMemo(() => {
    const result = {} as EntityData;

    if (tab && parentTab && parentRecord) {
      const parentColumns = tab.parentColumns.map((field) => tab.fields[field]);
      const parentFields = getFieldsByInputName(parentTab);

      for (const field of parentColumns) {
        const parentField = parentFields[field.inputName];
        const parentFieldName = parentField?.hqlName;

        result[field[nameToUse]] = parentRecord[parentFieldName];
      }
    }
    return result;
  }, [nameToUse, parentRecord, parentTab, tab]);
}

```

## Archivo: `packages/MainUI/hooks/useLocation.ts`

```typescript
// packages/MainUI/hooks/useLocation.ts
import { useCallback, useState } from "react";
import { Metadata } from "@workspaceui/api-client/src/api/metadata";
import type { CreateLocationRequest, LocationResponse } from "@workspaceui/api-client/src/api/types";

export interface UseLocationResult {
  createLocation: (locationData: CreateLocationRequest) => Promise<LocationResponse>;
  loading: boolean;
  error: string | null;
}

export const useLocation = (): UseLocationResult => {
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const createLocation = useCallback(async (locationData: CreateLocationRequest): Promise<LocationResponse> => {
    setLoading(true);
    setError(null);

    try {
      const result = await Metadata.locationClient.createLocation(locationData);
      return result;
    } catch (err) {
      const errorMessage = err instanceof Error ? err.message : "Unknown error occurred";
      setError(errorMessage);
      throw err;
    } finally {
      setLoading(false);
    }
  }, []);

  return {
    createLocation,
    loading,
    error,
  };
};

```

## Archivo: `packages/MainUI/hooks/useMenu.ts`

```typescript
import { useEffect, useState, useCallback } from "react";
import { useLoading } from "../contexts/loading";
import { Metadata } from "@workspaceui/api-client/src/api/metadata";
import type { CurrentRole, Menu } from "@workspaceui/api-client/src/api/types";

export const useMenu = (token: string | null, currentRole?: CurrentRole, language?: string | null) => {
  const [menu, setMenu] = useState<Menu[]>(Metadata.getCachedMenu());
  const { showLoading, hideLoading } = useLoading();

  const fetchMenu = useCallback(
    async (forceRefresh = false) => {
      showLoading();

      try {
        const newMenu = await Metadata.getMenu(forceRefresh);
        setMenu(newMenu);
      } catch (error) {
        console.error("Error fetching menu:", error);
      } finally {
        hideLoading();
      }
    },
    [showLoading, hideLoading]
  );

  useEffect(() => {
    if (token && currentRole) {
      fetchMenu(true);
    }
  }, [token, currentRole, fetchMenu, language]);

  return menu;
};

```

## Archivo: `packages/MainUI/hooks/useMenuTranslation.ts`

```typescript
import type { NestedKeyOf } from "@workspaceui/componentlibrary/src/locales/types";
import type { TranslationKeys } from "./types";
import { useTranslation } from "./useTranslation";
import type { Menu } from "@workspaceui/api-client/src/api/types";

export const useMenuTranslation = () => {
  const { t } = useTranslation();

  const translateMenuItem = (item: Menu): string => {
    if (!item.name) return item._identifier || "";

    try {
      return item._identifier || t(item.name as NestedKeyOf<TranslationKeys>) || item.name;
    } catch {
      return item._identifier || item.name;
    }
  };

  return { translateMenuItem };
};

```

## Archivo: `packages/MainUI/hooks/useMetadataContext.ts`

```typescript
import { useContext } from "react";
import { MetadataContext } from "../contexts/metadata";

export const useMetadataContext = () => {
  const context = useContext(MetadataContext);

  if (context === undefined) {
    throw new Error("useMetadataContext must be used within a MetadataProvider");
  }

  return context;
};

```

## Archivo: `packages/MainUI/hooks/usePrevious.ts`

```typescript
import { useRef, useEffect } from "react";

export const usePrevious = <T>(value: T, initialValue?: T) => {
  const ref = useRef(initialValue ?? value);

  useEffect(() => {
    ref.current = value;
  }, [value]);

  return ref.current;
};

```

## Archivo: `packages/MainUI/hooks/useProcessDefaults.ts`

```typescript
import { useCallback, useState, useRef } from "react";
import { Metadata } from "@workspaceui/api-client/src/api/metadata";
import { logger } from "@/utils/logger";
import type { EntityValue } from "@workspaceui/api-client/src/api/types";

export interface ProcessDefaultsResponse {
  processId: string;
  defaults: Record<string, EntityValue>;
  timestamp: number;
}

export interface ProcessDefaultsError {
  code: string;
  message: string;
  details?: any;
}

interface UseProcessDefaultsProps {
  processId: string;
  windowId: string;
  enabled?: boolean;
  cacheTimeout?: number; // Cache timeout in milliseconds (default: 300000 = 5 minutes)
}

interface CacheEntry {
  data: ProcessDefaultsResponse;
  timestamp: number;
  contextHash: string;
}

/**
 * Hook to fetch and manage process default values using DefaultsProcessActionHandler
 * 
 * Features:
 * - Smart caching with configurable timeout
 * - Context-aware cache invalidation
 * - Performance monitoring
 * - Comprehensive error handling
 * - Automatic retry on transient failures
 */
export const useProcessDefaults = ({ 
  processId, 
  windowId, 
  enabled = true,
  cacheTimeout = 300000 // 5 minutes default
}: UseProcessDefaultsProps) => {
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<ProcessDefaultsError | null>(null);
  const [data, setData] = useState<ProcessDefaultsResponse | null>(null);
  
  // Cache management
  const cacheRef = useRef<Map<string, CacheEntry>>(new Map());
  const abortControllerRef = useRef<AbortController | null>(null);

  /**
   * Generates a cache key based on processId, windowId, and context hash
   */
  const generateCacheKey = useCallback((contextData: Record<string, EntityValue>): string => {
    const contextHash = JSON.stringify(contextData, Object.keys(contextData).sort());
    return `${processId}:${windowId}:${btoa(contextHash).slice(0, 16)}`;
  }, [processId, windowId]);

  /**
   * Checks if cached data is still valid
   */
  const isCacheValid = useCallback((cacheEntry: CacheEntry): boolean => {
    const now = Date.now();
    return (now - cacheEntry.timestamp) < cacheTimeout;
  }, [cacheTimeout]);

  /**
   * Fetches process defaults with caching and error handling
   */
  const fetchDefaults = useCallback(async (
    contextData: Record<string, EntityValue> = {}
  ): Promise<ProcessDefaultsResponse | null> => {
    // Early return if not enabled or missing required params
    if (!enabled || !processId || !windowId) {
      return null;
    }

    const startTime = performance.now();
    const cacheKey = generateCacheKey(contextData);

    try {
      // Check cache first
      const cachedEntry = cacheRef.current.get(cacheKey);
      if (cachedEntry && isCacheValid(cachedEntry)) {
        logger.debug(`Using cached defaults for process ${processId}`);
        setData(cachedEntry.data);
        setError(null);
        return cachedEntry.data;
      }

      // Cancel any pending request
      if (abortControllerRef.current) {
        abortControllerRef.current.abort();
      }

      // Create new abort controller
      abortControllerRef.current = new AbortController();
      const { signal } = abortControllerRef.current;

      setLoading(true);
      setError(null);

      // Build request parameters
      const params = new URLSearchParams({
        processId,
        windowId,
        _action: "org.openbravo.client.application.process.DefaultsProcessActionHandler",
      });

      // Prepare request payload with context data
      const requestPayload = {
        ...contextData,
        _requestType: "defaults",
        _timestamp: Date.now().toString(),
      };

      logger.debug(`Fetching defaults for process ${processId}`, { 
        contextKeys: Object.keys(contextData),
        cacheKey 
      });

      // Make API request with timeout
      const timeoutPromise = new Promise((_, reject) => 
        setTimeout(() => reject(new Error("Request timeout")), 10000)
      );

      const requestPromise = Metadata.kernelClient.post(`?${params}`, requestPayload, {
        signal,
        headers: {
          "Content-Type": "application/json;charset=UTF-8",
          "X-Request-Type": "process-defaults",
        },
      });

      const { data: responseData } = await Promise.race([requestPromise, timeoutPromise]) as any;

      // Process response data
      const processedDefaults: ProcessDefaultsResponse = {
        processId,
        defaults: responseData || {},
        timestamp: Date.now(),
      };

      // Cache the result
      const cacheEntry: CacheEntry = {
        data: processedDefaults,
        timestamp: Date.now(),
        contextHash: JSON.stringify(contextData, Object.keys(contextData).sort()),
      };
      cacheRef.current.set(cacheKey, cacheEntry);

      // Log performance metrics
      const duration = performance.now() - startTime;
      logger.debug(`Process defaults fetched in ${duration.toFixed(2)}ms`, {
        processId,
        defaultsCount: Object.keys(processedDefaults.defaults).length,
        cached: false,
      });

      setData(processedDefaults);
      return processedDefaults;

    } catch (err) {
      // Handle different error types
      if (err instanceof Error) {
        if (err.name === 'AbortError') {
          logger.debug('Process defaults request was cancelled');
          return null;
        }

        const processError: ProcessDefaultsError = {
          code: err.message.includes('timeout') ? 'TIMEOUT' : 'API_ERROR',
          message: `Failed to fetch process defaults: ${err.message}`,
          details: { processId, windowId, originalError: err },
        };

        logger.error(`Error fetching defaults for process ${processId}:`, processError);
        setError(processError);
      } else {
        const unknownError: ProcessDefaultsError = {
          code: 'UNKNOWN_ERROR',
          message: 'An unknown error occurred while fetching process defaults',
          details: { processId, windowId, error: err },
        };

        logger.error('Unknown error fetching process defaults:', unknownError);
        setError(unknownError);
      }

      return null;
    } finally {
      setLoading(false);
      abortControllerRef.current = null;
    }
  }, [enabled, processId, windowId, generateCacheKey, isCacheValid]);

  /**
   * Clears cache for current process or all cache entries
   */
  const clearCache = useCallback((clearAll = false) => {
    if (clearAll) {
      cacheRef.current.clear();
    } else {
      // Clear only entries for current process
      const keysToDelete = Array.from(cacheRef.current.keys())
        .filter(key => key.startsWith(`${processId}:${windowId}:`));
      
      keysToDelete.forEach(key => cacheRef.current.delete(key));
    }
    
    logger.debug(`Cache cleared for process ${processId}`, { clearAll });
  }, [processId, windowId]);

  /**
   * Prefetches defaults with given context data
   */
  const prefetchDefaults = useCallback(async (
    contextData: Record<string, EntityValue> = {}
  ): Promise<void> => {
    if (!enabled) return;
    
    // Don't set loading state for prefetch
    try {
      await fetchDefaults(contextData);
    } catch (error) {
      // Silently handle prefetch errors
      logger.warn('Prefetch defaults failed:', error);
    }
  }, [enabled, fetchDefaults]);

  /**
   * Gets cache statistics for debugging
   */
  const getCacheStats = useCallback(() => {
    const entries = Array.from(cacheRef.current.entries());
    const processEntries = entries.filter(([key]) => key.startsWith(`${processId}:${windowId}:`));
    const validEntries = processEntries.filter(([, entry]) => isCacheValid(entry));

    return {
      totalEntries: cacheRef.current.size,
      processEntries: processEntries.length,
      validEntries: validEntries.length,
      oldestEntry: processEntries.reduce((oldest, [, entry]) => 
        !oldest || entry.timestamp < oldest.timestamp ? entry : oldest, 
        null as CacheEntry | null
      )?.timestamp,
    };
  }, [processId, windowId, isCacheValid]);

  // Cleanup on unmount
  const cleanup = useCallback(() => {
    if (abortControllerRef.current) {
      abortControllerRef.current.abort();
    }
  }, []);

  return {
    fetchDefaults,
    prefetchDefaults,
    clearCache,
    getCacheStats,
    cleanup,
    loading,
    error,
    data,
    // Utility flags
    hasData: !!data,
    isStale: data ? (Date.now() - data.timestamp) > cacheTimeout : false,
  };
};
```

## Archivo: `packages/MainUI/hooks/useProcessDefaultsInitialState.ts`

```typescript
import { useMemo } from "react";
import type { EntityData, ProcessParameter } from "@workspaceui/api-client/src/api/types";
import type { 
  ProcessDefaultsResponse
} from "@/components/ProcessModal/types/ProcessParameterExtensions";
import {
  isReferenceValue,
  isSimpleValue 
} from "@/components/ProcessModal/types/ProcessParameterExtensions";
import { logger } from "@/utils/logger";

/**
 * Hook to convert ProcessDefaultsResponse to form initial state
 * This adapts the DefaultsProcessActionHandler response structure to work with react-hook-form
 */
export const useProcessDefaultsInitialState = (
  processDefaults?: ProcessDefaultsResponse | null,
  parameters?: Record<string, ProcessParameter>
) => {
  const initialState = useMemo(() => {
    if (!processDefaults?.defaults) return {};

    const acc = {} as EntityData;
    const { defaults } = processDefaults;

    // Create parameter name mapping (field name to parameter mapping)
    const parameterNameMap = useMemo(() => {
      if (!parameters) return {};
      
      const map: Record<string, ProcessParameter> = {};
      Object.values(parameters).forEach(param => {
        // Map by name and dBColumnName
        map[param.name] = param;
        if (param.dBColumnName && param.dBColumnName !== param.name) {
          map[param.dBColumnName] = param;
        }
      });
      return map;
    }, [parameters]);

    // Process each default value
    for (const [fieldName, value] of Object.entries(defaults)) {
      try {
        // Skip logic fields (will be processed separately)
        if (fieldName.endsWith('_display_logic') || fieldName.endsWith('_readonly_logic')) {
          continue;
        }

        // Find corresponding parameter
        const parameter = parameterNameMap[fieldName];
        const formFieldName = parameter?.name || fieldName;

        if (isReferenceValue(value)) {
          // Handle reference objects with value/identifier
          acc[formFieldName] = value.value;
          acc[`${formFieldName}$_identifier`] = value.identifier;
          
          logger.debug(`Mapped reference field ${fieldName}:`, {
            formField: formFieldName,
            value: value.value,
            identifier: value.identifier
          });
        } else if (isSimpleValue(value)) {
          // Handle simple values (string, number, boolean)
          acc[formFieldName] = String(value);
          
          logger.debug(`Mapped simple field ${fieldName}:`, {
            formField: formFieldName,
            value: String(value)
          });
        } else {
          logger.warn(`Unexpected value type for field ${fieldName}:`, value);
          // Fallback to string conversion
          acc[formFieldName] = String(value);
        }
      } catch (error) {
        logger.error(`Error processing default value for field ${fieldName}:`, error);
        // Set fallback value to prevent form errors
        acc[fieldName] = "";
      }
    }

    logger.info("Process defaults initial state:", acc);
    return acc;
  }, [processDefaults, parameters]);

  return initialState;
};

/**
 * Hook to extract logic field values from process defaults
 * These control field visibility and readonly state
 */
export const useProcessLogicFields = (processDefaults?: ProcessDefaultsResponse | null) => {
  const logicFields = useMemo(() => {
    if (!processDefaults?.defaults) return {};

    const logic: Record<string, boolean> = {};
    const { defaults } = processDefaults;

    for (const [fieldName, value] of Object.entries(defaults)) {
      if (fieldName.endsWith('_display_logic')) {
        const baseFieldName = fieldName.replace('_display_logic', '');
        logic[`${baseFieldName}.display`] = value === "Y";
      } else if (fieldName.endsWith('_readonly_logic')) {
        const baseFieldName = fieldName.replace('_readonly_logic', '');
        logic[`${baseFieldName}.readonly`] = value === "Y";
      }
    }

    logger.debug("Process logic fields:", logic);
    return logic;
  }, [processDefaults]);

  return logicFields;
};

/**
 * Hook to extract filter expressions for dynamic selector behavior
 */
export const useProcessFilterExpressions = (processDefaults?: ProcessDefaultsResponse | null) => {
  const filterExpressions = useMemo(() => {
    if (!processDefaults?.filterExpressions) return {};

    logger.debug("Process filter expressions:", processDefaults.filterExpressions);
    return processDefaults.filterExpressions;
  }, [processDefaults]);

  return filterExpressions;
};

/**
 * Combined hook that provides all process defaults functionality
 */
export const useProcessDefaults = (
  processDefaults?: ProcessDefaultsResponse | null,
  parameters?: Record<string, ProcessParameter>
) => {
  const initialState = useProcessDefaultsInitialState(processDefaults, parameters);
  const logicFields = useProcessLogicFields(processDefaults);
  const filterExpressions = useProcessFilterExpressions(processDefaults);

  return {
    initialState,
    logicFields,
    filterExpressions,
    refreshParent: processDefaults?.refreshParent || false
  };
};
```

## Archivo: `packages/MainUI/hooks/useProcessInitialState.ts`

```typescript
import { useMemo } from "react";
import { logger } from "@/utils/logger";
import type { EntityData, ProcessParameter } from "@workspaceui/api-client/src/api/types";
import type { 
  ProcessDefaultsResponse, 
  ProcessDefaultValue
} from "@/components/ProcessModal/types/ProcessParameterExtensions";
import { 
  isReferenceValue, 
  isSimpleValue 
} from "@/components/ProcessModal/types/ProcessParameterExtensions";

/**
 * Hook to convert ProcessDefaultsResponse to form initial state
 * Adapts the FormInitialState pattern for ProcessModal usage
 */
export const useProcessInitialState = (
  processInitialization?: ProcessDefaultsResponse | null,
  parameters?: ProcessParameter[]
) => {
  // Create parameter name mapping for efficient lookups
  const parameterMap = useMemo(() => {
    if (!parameters) return new Map<string, ProcessParameter>();
    
    const map = new Map<string, ProcessParameter>();
    parameters.forEach(param => {
      // Map by name (primary)
      map.set(param.name, param);
      // Map by dBColumnName if different
      if (param.dBColumnName && param.dBColumnName !== param.name) {
        map.set(param.dBColumnName, param);
      }
      // Map by ID as fallback
      if (param.id && param.id !== param.name) {
        map.set(param.id, param);
      }
    });
    return map;
  }, [parameters]);

  const initialState = useMemo(() => {
    if (!processInitialization?.defaults) return null;
    
    // If defaults is empty object, return empty object (not null)
    if (Object.keys(processInitialization.defaults).length === 0) return {};

    const acc = {} as EntityData;
    const { defaults } = processInitialization;

    // Process each default value
    for (const [fieldName, value] of Object.entries(defaults)) {
      try {
        // Skip logic fields (will be processed separately)
        if (fieldName.endsWith('_display_logic') || fieldName.endsWith('_readonly_logic')) {
          continue;
        }

        // Find corresponding parameter
        const parameter = parameterMap.get(fieldName);
        // Use the original field name from server, not the parameter display name
        const formFieldName = fieldName; // parameter?.name causes mismatch with form field names

        if (isReferenceValue(value)) {
          // Handle reference objects with value/identifier pairs
          acc[formFieldName] = value.value;
          
          // Store identifier for display purposes
          if (value.identifier) {
            acc[`${formFieldName}$_identifier`] = value.identifier;
          }
          
          logger.debug(`Mapped reference field ${fieldName} to ${formFieldName}:`, {
            value: value.value,
            identifier: value.identifier
          });
        } else if (isSimpleValue(value)) {
          // Handle simple values (string, number, boolean)
          acc[formFieldName] = typeof value === 'boolean' ? value : String(value);
          
          logger.debug(`Mapped simple field ${fieldName} to ${formFieldName}:`, {
            value: String(value),
            type: typeof value
          });
        } else {
          // Fallback for unexpected value types
          logger.warn(`Unexpected value type for field ${fieldName}:`, value);
          // Handle objects that aren't reference values
          if (typeof value === 'object' && value !== null) {
            acc[formFieldName] = JSON.stringify(value);
          } else {
            acc[formFieldName] = String(value || "");
          }
        }
      } catch (error) {
        logger.error(`Error processing default value for field ${fieldName}:`, error);
        // Set fallback value to prevent form errors
        const parameter = parameterMap.get(fieldName);
        const formFieldName = parameter?.name || fieldName;
        acc[formFieldName] = "";
      }
    }

    logger.debug("Process initial state:", {
      originalFields: Object.keys(defaults).length,
      processedFields: Object.keys(acc).length,
      fieldNames: Object.keys(acc)
    });

    return acc;
  }, [processInitialization, parameterMap]);

  return initialState;
};

/**
 * Hook to extract logic field values from process defaults
 * These control field visibility and readonly state
 */
export const useProcessLogicFields = (processInitialization?: ProcessDefaultsResponse | null) => {
  const logicFields = useMemo(() => {
    if (!processInitialization?.defaults) return {};

    const logic: Record<string, boolean> = {};
    const { defaults } = processInitialization;

    for (const [fieldName, value] of Object.entries(defaults)) {
      if (fieldName.endsWith('_display_logic')) {
        const baseFieldName = fieldName.replace('_display_logic', '');
        logic[`${baseFieldName}.display`] = value === "Y";
      } else if (fieldName.endsWith('_readonly_logic')) {
        const baseFieldName = fieldName.replace('_readonly_logic', '');
        logic[`${baseFieldName}.readonly`] = value === "Y";
      }
    }

    logger.debug("Process logic fields:", logic);
    return logic;
  }, [processInitialization]);

  return logicFields;
};

/**
 * Hook to extract filter expressions for dynamic selector behavior
 */
export const useProcessFilterExpressions = (processInitialization?: ProcessDefaultsResponse | null) => {
  const filterExpressions = useMemo(() => {
    if (!processInitialization?.filterExpressions) return {};

    logger.debug("Process filter expressions:", processInitialization.filterExpressions);
    return processInitialization.filterExpressions;
  }, [processInitialization]);

  return filterExpressions;
};

/**
 * Combined hook that provides all process initialization functionality
 * Similar to useFormInitialState but adapted for ProcessModal
 */
export const useProcessInitializationState = (
  processInitialization?: ProcessDefaultsResponse | null,
  parameters?: ProcessParameter[]
) => {
  const initialState = useProcessInitialState(processInitialization, parameters);
  const logicFields = useProcessLogicFields(processInitialization);
  const filterExpressions = useProcessFilterExpressions(processInitialization);

  return {
    initialState,
    logicFields,
    filterExpressions,
    refreshParent: processInitialization?.refreshParent || false,
    hasData: !!initialState && Object.keys(initialState).length > 0
  };
};
```

## Archivo: `packages/MainUI/hooks/useProcessInitialization.ts`

```typescript
import { useCallback, useMemo, useReducer } from "react";
import { Metadata } from "@workspaceui/api-client/src/api/metadata";
import { logger } from "@/utils/logger";
import { buildProcessPayload } from "@/utils";
import type { EntityValue, Tab } from "@workspaceui/api-client/src/api/types";
import type { ProcessDefaultsResponse } from "@/components/ProcessModal/types/ProcessParameterExtensions";

export interface ProcessInitializationParams {
  processId: string;
  windowId?: string;
  recordId?: string;
  enabled?: boolean;
  // Add record and tab for complete payload building
  record?: Record<string, unknown>;
  tab?: Tab;
}

const buildProcessInitializationParams = ({
  processId,
  windowId,
}: {
  processId: string;
  windowId?: string;
}): URLSearchParams =>
  new URLSearchParams({
    processId,
    windowId: windowId ?? "",
    _action: "org.openbravo.client.application.process.DefaultsProcessActionHandler",
  });

const fetchProcessInitialization = async (
  params: URLSearchParams,
  payload: Record<string, EntityValue>
): Promise<ProcessDefaultsResponse> => {
  try {
    const { data } = await Metadata.kernelClient.post(`?${params}`, payload);

    // Transform the raw response to our expected structure
    return {
      defaults: data?.defaults || data || {},
      filterExpressions: data?.filterExpressions || {},
      refreshParent: !!data?.refreshParent,
    };
  } catch (error) {
    logger.warn("Error fetching process initialization data:", error);
    throw new Error("Failed to fetch process defaults");
  }
};

type State =
  | {
      loading: true;
      error: null;
      processInitialization: null;
    }
  | {
      loading: false;
      error: null;
      processInitialization: ProcessDefaultsResponse;
    }
  | {
      loading: false;
      error: Error;
      processInitialization: ProcessDefaultsResponse | null;
    };

type Action =
  | { type: "FETCH_START" }
  | { type: "FETCH_SUCCESS"; payload: ProcessDefaultsResponse }
  | { type: "FETCH_ERROR"; payload: Error };

const initialState: State = {
  loading: true,
  error: null,
  processInitialization: null,
};

const reducer = (state: State, action: Action): State => {
  switch (action.type) {
    case "FETCH_START":
      return { loading: true, error: null, processInitialization: null };
    case "FETCH_SUCCESS":
      return { loading: false, error: null, processInitialization: action.payload };
    case "FETCH_ERROR":
      return { loading: false, error: action.payload, processInitialization: state.processInitialization };
    default:
      return state;
  }
};

export type UseProcessInitialization = State & {
  refetch: (contextData?: Record<string, EntityValue>) => Promise<void>;
};

/**
 * Hook for fetching process default values using DefaultsProcessActionHandler
 * Adapts the FormInitialization pattern for ProcessModal usage
 */
export function useProcessInitialization({ 
  processId, 
  windowId, 
  recordId, 
  enabled = true,
  record,
  tab
}: ProcessInitializationParams): UseProcessInitialization {
  const [state, dispatch] = useReducer<React.Reducer<State, Action>>(reducer, initialState);
  const { error, processInitialization, loading } = state;

  const params = useMemo(
    () => (processId && enabled ? buildProcessInitializationParams({ processId, windowId }) : null),
    [processId, windowId, enabled]
  );

  const fetch = useCallback(async (contextData: Record<string, EntityValue> = {}) => {
    if (!params || !enabled) return;

    try {
      // Build complete payload with all system context fields
      let payload: Record<string, EntityValue>;

      if (record && tab) {
        // Use buildProcessPayload to include all system context fields
        const processPayload = buildProcessPayload(
          record,           // Complete record data
          tab,             // Tab metadata for context fields
          {},              // No process defaults yet (we're fetching them)
          contextData      // Additional context data
        );

        // Convert to EntityValue compatible format and add process initialization specific fields
        payload = {
          ...Object.fromEntries(
            Object.entries(processPayload).map(([key, value]) => [
              key,
              value === null ? null : String(value) // Convert to EntityValue compatible types
            ])
          ),
          processId,
          windowId: windowId || "",
          recordId: recordId || "",
          _requestType: "defaults",
          _timestamp: Date.now().toString(),
        };
      } else {
        // Fallback to basic payload if record/tab not available
        payload = {
          ...contextData,
          processId,
          windowId: windowId || "",
          recordId: recordId || "",
          _requestType: "defaults",
          _timestamp: Date.now().toString(),
        };
      }

      logger.debug(`Fetching process defaults for process ${processId}`, {
        windowId,
        recordId,
        contextKeys: Object.keys(contextData),
        hasCompletePayload: !!(record && tab),
        payloadFieldsCount: Object.keys(payload).length
      });

      const data = await fetchProcessInitialization(params, payload);
      
      logger.debug(`Process defaults fetched successfully`, {
        processId,
        defaultsCount: Object.keys(data.defaults).length,
        hasFilterExpressions: Object.keys(data.filterExpressions).length > 0,
        refreshParent: data.refreshParent,
      });

      dispatch({ type: "FETCH_SUCCESS", payload: data });
    } catch (err) {
      logger.error(`Error fetching process defaults for ${processId}:`, err);
      dispatch({ type: "FETCH_ERROR", payload: err instanceof Error ? err : new Error("Unknown error") });
    }
  }, [params, enabled, processId, windowId, recordId, record, tab]);

  const refetch = useCallback(async (contextData: Record<string, EntityValue> = {}) => {
    if (!params || !enabled) return;
    dispatch({ type: "FETCH_START" });
    await fetch(contextData);
  }, [params, enabled, fetch]);

  // Auto-fetch on mount if enabled
  useMemo(() => {
    if (enabled && params) {
      fetch();
    }
  }, [enabled, params, fetch]);

  return useMemo(
    () => ({ error, processInitialization, loading, refetch }) as UseProcessInitialization,
    [error, processInitialization, loading, refetch]
  );
}
```

## Archivo: `packages/MainUI/hooks/useProcessMessage.ts`

```typescript
import { ApiContext } from "@/contexts/api";
import { useTranslation } from "@/hooks/useTranslation";
import { logger } from "@/utils/logger";
import { useCallback, useContext } from "react";
import { useUserContext } from "./useUserContext";

export interface ProcessMessage {
  message: string;
  type: "error" | "success" | "info" | "warning";
  title: string;
}

const urlMessageParam = "/meta/message";

export function useProcessMessage(tabId: string) {
  const apiUrl = useContext(ApiContext);
  const { token } = useUserContext();
  const { t } = useTranslation();

  const normalizeMessageType = useCallback(
    (messageType: string, message: string): "success" | "error" | "warning" | "info" => {
      const normalizedType = messageType?.toLowerCase() || "info";

      if (normalizedType === "success" || messageType === "Success") {
        return "success";
      }

      if (message?.toUpperCase().includes("ERROR")) {
        return "error";
      }

      if (normalizedType.includes("success")) {
        return "success";
      }
      if (normalizedType.includes("error")) {
        return "error";
      }
      if (normalizedType.includes("warn")) {
        return "warning";
      }
      return "info";
    },
    []
  );

  const getMessageTitle = useCallback(
    (originalTitle: string | undefined, type: string): string => {
      if (originalTitle) {
        return originalTitle;
      }

      switch (type) {
        case "error":
          return t("errors.internalServerError.title");
        case "success":
          return t("process.completedSuccessfully");
        default:
          return t("process.messageTitle");
      }
    },
    [t]
  );

  const processResponseData = useCallback(
    (data: ProcessMessage): ProcessMessage | null => {
      if (!data) {
        return null;
      }

      if (data.message === "No message found") {
        return null;
      }

      const messageType = normalizeMessageType(data.type || "info", data.message || "");

      return {
        message: data.message || "",
        type: messageType,
        title: getMessageTitle(data.title, messageType),
      };
    },
    [normalizeMessageType, getMessageTitle]
  );

  const handleFetchError = useCallback((error: unknown): ProcessMessage | null => {
    if (error instanceof DOMException && error.name === "AbortError") {
      logger.warn(error);
    }

    logger.warn(error);
    return null;
  }, []);

  const fetchProcessMessage = useCallback(async (): Promise<ProcessMessage | null> => {
    if (!apiUrl) {
      logger.warn(apiUrl, "API-URL Error");
      return null;
    }

    try {
      const response = await fetch(`${apiUrl}${urlMessageParam}?tabId=${tabId}`, {
        method: "POST",
        credentials: "include",
        headers: {
          Authorization: `Bearer ${token}`,
          "Content-Type": "application/json",
        },
      });

      if (!response.ok) {
        logger.warn(response.status);
        return null;
      }

      const data = await response.json();

      return processResponseData(data);
    } catch (error) {
      return handleFetchError(error);
    }
  }, [apiUrl, tabId, token, processResponseData, handleFetchError]);

  return { fetchProcessMessage };
}

```

## Archivo: `packages/MainUI/hooks/useQueryParams.ts`

```typescript
"use client";

import { useSearchParams } from "next/navigation";
import { useMemo } from "react";
import { WINDOW_PREFIX, TAB_ACTIVE } from "@/utils/url/constants";

/**
 * Custom React hook that retrieves URL query parameters using Next.js's `useSearchParams`,
 * and returns them as a plain object with memoization.
 *
 * @template T - An optional generic type to enforce the expected shape of the query parameters.
 *
 * @returns {T} A plain object containing the current query parameters.
 *
 * @example
 * type Params = {
 *   userId?: string;
 *   filter?: string;
 * };
 *
 * const { userId, filter } = useQueryParams<Params>();
 */

export function useQueryParams<T extends Record<string, string | string[] | undefined>>(): T {
  const searchParams = useSearchParams();

  return useMemo<T>(() => {
    const entries = Array.from(searchParams.entries());
    const result: Record<string, string> = {};

    for (const [key, value] of entries) {
      result[key] = value;
    }

    if (!result.windowId) {
      for (const [key, value] of entries) {
        if (key.startsWith(WINDOW_PREFIX) && value === TAB_ACTIVE) {
          result.windowId = key.slice(WINDOW_PREFIX.length);
          break;
        }
      }
    }

    return result as T;
  }, [searchParams]);
}

```

## Archivo: `packages/MainUI/hooks/useRecentItems.ts`

```typescript
import type { RecentItem } from "@workspaceui/componentlibrary/src/components/Drawer/types";
import { useLocalStorage } from "@workspaceui/componentlibrary/src/hooks/useLocalStorage";
import { findItemByIdentifier } from "@workspaceui/componentlibrary/src/utils/menuUtils";
import type { Menu } from "@workspaceui/api-client/src/api/types";
import { useCallback, useEffect, useRef, useState } from "react";

const getItemName = (menuItem: Menu, getTranslatedName?: (item: Menu) => string): string => {
  return getTranslatedName?.(menuItem) ?? menuItem._identifier ?? menuItem.name ?? "";
};

const createRecentItem = (item: Menu, getTranslatedName?: (item: Menu) => string): RecentItem => ({
  id: item.id,
  name: getItemName(item, getTranslatedName),
  windowId: item.type === "Window" ? (item.windowId ?? item.id) : item.id,
  type: item.type ?? "Window",
});

const updateItemsWithTranslations = (
  items: RecentItem[],
  menuItems: Menu[],
  getTranslatedName?: (item: Menu) => string
): RecentItem[] => {
  return items.map((storedItem) => {
    const menuItem = findItemByIdentifier(menuItems, storedItem.windowId);
    if (!menuItem) return storedItem;

    return {
      ...storedItem,
      name: getItemName(menuItem, getTranslatedName),
    };
  });
};

export function useRecentItems(
  menuItems: Menu[],
  onClick: (item: Menu) => void,
  roleId: string,
  getTranslatedName?: (item: Menu) => string
) {
  const [localRecentItems, setLocalRecentItems] = useLocalStorage<Record<string, RecentItem[]>>(
    "recentlyViewedItems",
    {}
  );
  const [isExpanded, setIsExpanded] = useState(false);
  const hasManuallyToggled = useRef(false);
  const isFirstLoad = useRef(true);
  const previousItems = useRef<RecentItem[]>([]);

  const updateTranslations = useCallback(
    (items: Menu[]) => {
      if (!roleId) return;
      const currentItems = localRecentItems[roleId] || [];
      if (!currentItems.length) return;

      const updatedItems = updateItemsWithTranslations(currentItems, items, getTranslatedName);
      const hasChanges = JSON.stringify(updatedItems) !== JSON.stringify(currentItems);

      if (hasChanges) {
        setLocalRecentItems((prev) => ({ ...prev, [roleId]: updatedItems }));
      }
    },
    [roleId, localRecentItems, getTranslatedName, setLocalRecentItems]
  );

  const handleToggleExpand = useCallback(() => {
    hasManuallyToggled.current = true;
    setIsExpanded((prev) => !prev);
  }, []);

  const addRecentItem = useCallback(
    (item: Menu) => {
      const recentItem = createRecentItem(item, getTranslatedName);
      setLocalRecentItems((prev) => {
        const currentItems = prev[roleId] || [];
        const existing = currentItems.find((v) => v.id === item.id);

        if (existing) {
          const newItems = { ...prev };
          newItems[roleId] = [existing, ...newItems[roleId].filter((v) => v.id !== item.id)];

          return newItems;
        }

        const newItems = [recentItem, ...currentItems.filter((i) => i.id !== recentItem.id)].slice(0, 5);

        const hasChanges = JSON.stringify(newItems) !== JSON.stringify(currentItems);
        if (!hasChanges) return prev;

        return { ...prev, [roleId]: newItems };
      });

      return recentItem;
    },
    [roleId, getTranslatedName, setLocalRecentItems]
  );

  const handleRecentItemClick = useCallback(
    (item: Menu) => {
      onClick(item);

      const itemId = item.id;
      if (!itemId || !roleId) return;

      const menuItem = findItemByIdentifier(menuItems, itemId);
      if (!menuItem) return;

      addRecentItem(item);
      setIsExpanded(true);
    },
    [addRecentItem, menuItems, onClick, roleId]
  );

  useEffect(() => {
    if (!roleId) return;
    const currentItems = localRecentItems[roleId] || [];
    if (!currentItems.length) return;

    const hasNewItems = currentItems.some((item, index) => {
      const prevItem = previousItems.current[index];
      return !prevItem || item.windowId !== prevItem.windowId;
    });

    if (!hasNewItems) return;

    const updatedItems = updateItemsWithTranslations(currentItems, menuItems, getTranslatedName);
    previousItems.current = updatedItems;

    const hasChanges = JSON.stringify(updatedItems) !== JSON.stringify(currentItems);
    if (hasChanges) {
      setLocalRecentItems((prev) => ({ ...prev, [roleId]: updatedItems }));
    }
  }, [menuItems, roleId, getTranslatedName, localRecentItems, setLocalRecentItems]);

  useEffect(() => {
    if (isFirstLoad.current && roleId && localRecentItems[roleId]?.length) {
      setIsExpanded(true);
      isFirstLoad.current = false;
    }
  }, [roleId, localRecentItems]);

  return {
    localRecentItems: roleId ? localRecentItems[roleId] || [] : [],
    isExpanded,
    setIsExpanded,
    handleRecentItemClick,
    handleToggleExpand,
    hasItems: Boolean(roleId && localRecentItems[roleId]?.length),
    addRecentItem,
    updateTranslations,
  };
}

```

## Archivo: `packages/MainUI/hooks/useRecordContext.ts`

```typescript
import { useMemo } from "react";
import { useTabContext } from "@/contexts/tab";
import { useSelectedRecords } from "@/hooks/useSelectedRecords";
import { buildPayloadByInputName } from "@/utils";
import { buildContextString } from "@/utils/contextUtils";
import type { RecordContextData } from "./types";
import { useTranslation } from "./useTranslation";

export const useRecordContext = (): RecordContextData => {
  const { tab } = useTabContext();
  const selectedRecords = useSelectedRecords(tab);
  const { t } = useTranslation();

  const contextItems = useMemo(() => {
    if (!selectedRecords || selectedRecords.length === 0) {
      return [];
    }

    return selectedRecords.map((record) => {
      const payload = buildPayloadByInputName(record, tab.fields);
      const recordId = String(record.id);
      const tabIdentifier = tab.title || tab.name || "Tab";
      const recordIdentifier = record._identifier || recordId;

      return {
        id: `${String(tab.id)}-${recordId}`,
        label: `${tabIdentifier}-${String(recordIdentifier)}`,
        contextString: JSON.stringify(payload, null, 2),
        recordId,
      };
    });
  }, [selectedRecords, tab.fields, tab.id, tab.title, tab.name]);

  const contextString = useMemo(() => {
    return buildContextString({
      contextItems,
      registersText: t("copilot.contextPreview.selectedRegisters"),
    });
  }, [contextItems, t]);

  return {
    selectedRecords,
    hasSelectedRecords: selectedRecords.length > 0,
    contextString,
    contextItems,
  };
};

```

## Archivo: `packages/MainUI/hooks/useRecordValues.ts`

```typescript
import { useMemo } from "react";
import { useTabContext } from "@/contexts/tab";
import { buildPayloadByInputName } from "@/utils";

const FALLBACK_RESULT = {};

export default function useRecordValues() {
  const { tab, record } = useTabContext();

  return useMemo(() => (record ? buildPayloadByInputName(record, tab.fields) : FALLBACK_RESULT), [record, tab.fields]);
}

```

## Archivo: `packages/MainUI/hooks/useReport.ts`

```typescript
import { logger } from "@/utils/logger";
import type { ReportField, ReportMetadata } from "@workspaceui/api-client/src/hooks/types";
import { useState } from "react";

type ReportFields = {
  [K in ReportField["name"]]: unknown;
};

interface BaseReportParams extends ReportFields {
  format: string;
  reportId: string;
  metadata: ReportMetadata;
}

const processFields = (formData: URLSearchParams, data: BaseReportParams) => {
  const { metadata } = data;

  for (const section of metadata.sections) {
    for (const field of section.fields) {
      const value = data[field.name];

      if (field.type === "multiselect" && Array.isArray(value)) {
        for (const val of value) {
          if (val) {
            formData.append(field.name, val);
          }
          return;
        }
      }

      if (value !== undefined && value !== null) {
        formData.append(field.name, value.toString());
      }
    }
  }
};

const setupFormData = (data: BaseReportParams, format: string): URLSearchParams => {
  const formData = new URLSearchParams();
  const action = data.metadata.actions.find((a) => a.format === format);

  formData.append("Command", action?.command || "EDIT_HTML");
  formData.append("format", format);
  formData.append("reportId", data.reportId);

  processFields(formData, data);

  return formData;
};

const openReportWindow = (html: string) => {
  const newWindow = window.open("", "_blank", "width=700,height=700");
  if (newWindow) {
    newWindow.document.write(html);
    newWindow.document.close();
  }
};

export function useReport(url: string) {
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<Error | null>(null);

  const generateReport = async <T extends BaseReportParams>(format: string, data: T) => {
    setLoading(true);
    setError(null);

    try {
      const formData = setupFormData(data, format);

      const response = await fetch(`${url}/ad_reports/${data.metadata.sourcePath}.html`, {
        method: "POST",
        headers: {
          "Content-Type": "application/x-www-form-urlencoded",
        },
        body: formData.toString(),
        credentials: "include",
      });

      if (!response.ok) {
        throw new Error("Failed to generate report");
      }

      const html = await response.text();
      openReportWindow(html);
    } catch (err) {
      logger.warn(err);

      setError(err instanceof Error ? err : new Error("Unknown error"));
    } finally {
      setLoading(false);
    }
  };

  return { generateReport, loading, error };
}

```

## Archivo: `packages/MainUI/hooks/useReportMetadata.ts`

```typescript
import { logger } from "@/utils/logger";
import type { ReportMetadata } from "@workspaceui/api-client/src/hooks/types";
import { useCallback, useEffect, useState } from "react";

export interface ReportMetadataHook {
  metadata: ReportMetadata | null;
  loading: boolean;
  error: string | null;
}

const REPORT_ID_TO_FILE_MAP: Record<string, string> = {
  "800261": "sales-order",
  "800069": "sales-order-invoice",
};

export const useReportMetadata = (reportId?: string): ReportMetadataHook => {
  const [metadata, setMetadata] = useState<ReportMetadata | null>(null);
  const [loading, setLoading] = useState<boolean>(false);
  const [error, setError] = useState<string | null>(null);

  const fetchMetadata = useCallback(
    async (controller: AbortController) => {
      if (!reportId) {
        return;
      }

      setLoading(true);
      setError(null);

      try {
        const fileName = REPORT_ID_TO_FILE_MAP[reportId];
        if (!fileName) {
          throw new Error(`No report file found for ID: ${reportId}`);
        }

        const reportModule = await import(`../reports/${fileName}`);

        if (!controller.signal.aborted) {
          const reportMeta = Object.values(reportModule)[0] as ReportMetadata;
          if (reportMeta.id !== reportId) {
            throw new Error(`Report ID mismatch: expected ${reportId}, got ${reportMeta.id}`);
          }
          setMetadata(reportMeta);
        }
      } catch (err) {
        logger.warn(err);

        if (!controller.signal.aborted) {
          setError(`Failed to load report metadata: ${(err as Error).message}`);
        }
      } finally {
        if (!controller.signal.aborted) {
          setLoading(false);
        }
      }
    },
    [reportId]
  );

  useEffect(() => {
    const controller = new AbortController();
    fetchMetadata(controller);
    return () => {
      controller.abort();
    };
  }, [fetchMetadata]);

  return { metadata, loading, error };
};

```

## Archivo: `packages/MainUI/hooks/useSSEConnection.ts`

```typescript
import { useCallback, useRef, useState } from "react";
import { EventSourcePolyfill } from "event-source-polyfill";
import { type CopilotQuestionParams, CopilotClient } from "@workspaceui/api-client/src/api/copilot";

interface UseSSEConnectionProps {
  onMessage: (data: Record<string, unknown>) => void;
  onError: (error: string) => void;
  onComplete: () => void;
}

export const useSSEConnection = ({ onMessage, onError, onComplete }: UseSSEConnectionProps) => {
  const eventSourceRef = useRef<EventSourcePolyfill | null>(null);
  const [isConnected, setIsConnected] = useState(false);
  const [reconnectAttempts, setReconnectAttempts] = useState(0);
  const maxReconnectAttempts = 3;
  const isCompletedRef = useRef(false);
  const shouldReconnectRef = useRef(true);
  const hasReceivedMessageRef = useRef(false);

  const startSSEConnection = useCallback(
    async (params: CopilotQuestionParams, retryCount = 0) => {
      try {
        if (eventSourceRef.current) {
          eventSourceRef.current.close();
        }

        if (retryCount === 0) {
          isCompletedRef.current = false;
          shouldReconnectRef.current = true;
          hasReceivedMessageRef.current = false;
          setReconnectAttempts(0);
        }

        const sseUrl = CopilotClient.buildSSEUrl(params);
        const headers = CopilotClient.getSSEHeaders();

        const eventSource = new EventSourcePolyfill(sseUrl, {
          headers,
          heartbeatTimeout: 120000,
          withCredentials: true,
        });

        eventSourceRef.current = eventSource;

        eventSource.onmessage = (event) => {
          try {
            const data = JSON.parse(event.data);
            setIsConnected(true);
            setReconnectAttempts(0);
            hasReceivedMessageRef.current = true;
            onMessage(data);
          } catch (err) {
            console.error("Error parsing SSE message:", err, "Raw data:", event.data);
            onError("Error parsing server response");
          }
        };

        eventSource.onerror = (err) => {
          setIsConnected(false);

          if (eventSource.readyState === EventSourcePolyfill.CLOSED) {
            if (hasReceivedMessageRef.current && !isCompletedRef.current) {
              isCompletedRef.current = true;
              shouldReconnectRef.current = false;
              onComplete();
            } else if (!isCompletedRef.current && !hasReceivedMessageRef.current) {
              console.error("SSE connection closed without receiving messages:", err);
              if (retryCount < maxReconnectAttempts) {
                const delay = 2 ** retryCount * 1000;
                setTimeout(() => {
                  setReconnectAttempts(retryCount + 1);
                  startSSEConnection(params, retryCount + 1);
                }, delay);
              } else {
                onError("Connection error occurred");
              }
            }
          } else {
            console.error("SSE connection error:", err);

            if (retryCount < maxReconnectAttempts && shouldReconnectRef.current && !hasReceivedMessageRef.current) {
              const delay = 2 ** retryCount * 1000;
              setTimeout(() => {
                setReconnectAttempts(retryCount + 1);
                startSSEConnection(params, retryCount + 1);
              }, delay);
            } else {
              if (!isCompletedRef.current && !hasReceivedMessageRef.current) {
                onError("Connection error occurred");
              }
            }
          }

          eventSource.close();
        };

        eventSource.onopen = () => {
          setIsConnected(true);
          setReconnectAttempts(0);
        };

        const intervalId = setInterval(() => {
          if (eventSource.readyState === EventSourcePolyfill.CLOSED) {
            setIsConnected(false);
            if (hasReceivedMessageRef.current && !isCompletedRef.current) {
              isCompletedRef.current = true;
              shouldReconnectRef.current = false;
              onComplete();
            }
            clearInterval(intervalId);
          }
        }, 1000);

        return () => {
          clearInterval(intervalId);
          eventSource.close();
        };
      } catch (error) {
        console.error("Error starting SSE connection:", error);
        setIsConnected(false);

        if (retryCount < maxReconnectAttempts && !hasReceivedMessageRef.current) {
          const delay = 2 ** retryCount * 1000;
          setTimeout(() => {
            startSSEConnection(params, retryCount + 1);
          }, delay);
        } else {
          onError(error instanceof Error ? error.message : "Failed to start connection");
        }
      }
    },
    [onMessage, onError, onComplete, maxReconnectAttempts]
  );

  const closeConnection = useCallback(() => {
    if (eventSourceRef.current) {
      eventSourceRef.current.close();
      eventSourceRef.current = null;
    }
    setIsConnected(false);
    setReconnectAttempts(0);
    isCompletedRef.current = false;
    shouldReconnectRef.current = true;
    hasReceivedMessageRef.current = false;
  }, []);

  return {
    startSSEConnection,
    closeConnection,
    isConnected,
    reconnectAttempts,
  };
};

```

## Archivo: `packages/MainUI/hooks/useScreenSizes.ts`

```typescript
const defaultSizes = { clientWidth: 480, clientHeight: 240 };

export const useScreenSizes = () => {
  if (typeof window !== "undefined") {
    return {
      clientWidth: window.document.body.clientWidth,
      clientHeight: window.document.body.clientHeight,
    };
  }
  return defaultSizes;
};

```

## Archivo: `packages/MainUI/hooks/useSelectFieldOptions.ts`

```typescript
import type { SelectProps } from "@/components/Form/FormView/selectors/components/types";
import type { EntityData, Field } from "@workspaceui/api-client/src/api/types";
import { useMemo } from "react";
import { useFormContext } from "react-hook-form";

export const useSelectFieldOptions = (field: Field, records: EntityData[]) => {
  const { watch } = useFormContext();
  const idKey = (field.selector?.valueField ?? "") as string;
  const identifierKey = (field.selector?.displayField ?? "") as string;
  const [currentValue, currentIdentifier] = watch([field.hqlName, `${field.hqlName}$_identifier`]);

  return useMemo(() => {
    const result: SelectProps["options"] = [];

    for (const record of records) {
      const label = record[identifierKey] as string;
      const id = record[idKey] as string;

      if (id && label) {
        result.push({ id, label, data: record });
      }
    }

    const currentOption = result.find((record) => record.id === currentValue);

    if (!currentOption && currentValue && currentIdentifier) {
      result.push({ id: currentValue, label: currentIdentifier, data: {} });
    }

    return result;
  }, [currentIdentifier, currentValue, idKey, identifierKey, records]);
};

```

## Archivo: `packages/MainUI/hooks/useSelected.ts`

```typescript
import { useContext } from "react";
import { SelectContext } from "@/contexts/selected";

export const useSelected = () => {
  const graph = useContext(SelectContext);

  if (!graph) throw new Error("useSelected must be used within a SelectedProvider");

  return graph;
};

```

## Archivo: `packages/MainUI/hooks/useSelectedRecord.ts`

```typescript
import { useState, useEffect } from "react";
import type { Tab } from "@workspaceui/api-client/src/api/types";
import type { GraphEventListener } from "@/data/graph";
import { useSelected } from "./useSelected";

export const useSelectedRecord = (tab?: Tab) => {
  const { graph } = useSelected();
  const [selected, setSelected] = useState(graph.getSelected(tab));

  useEffect(() => {
    if (!tab) return;

    const handleSelect: GraphEventListener<"selected"> = (eventTab, record) => {
      if (tab.id === eventTab.id) {
        setSelected(record);
      }
    };

    const handleUnselect: GraphEventListener<"unselected"> = (eventTab) => {
      if (tab.id === eventTab.id) {
        setSelected(undefined);
      }
    };

    graph //
      .addListener("selected", handleSelect)
      .addListener("unselected", handleUnselect);

    return () => {
      graph //
        .removeListener("selected", handleSelect)
        .removeListener("unselected", handleUnselect);
    };
  }, [graph, tab]);

  return selected;
};

```

## Archivo: `packages/MainUI/hooks/useSelectedRecords.ts`

```typescript
import { useState, useEffect } from "react";
import type { Tab } from "@workspaceui/api-client/src/api/types";
import type { GraphEventListener } from "@/data/graph";
import { useSelected } from "@/hooks/useSelected";

export const useSelectedRecords = (tab?: Tab) => {
  const { graph } = useSelected();
  const [selected, setSelected] = useState(() => {
    const selected = graph.getSelectedMultiple(tab);

    return selected || [];
  });

  useEffect(() => {
    if (!tab) return;

    const handleSelectMultiple: GraphEventListener<"selectedMultiple"> = (eventTab, records) => {
      if (tab.id === eventTab.id) {
        setSelected(records);
      }
    };

    const handleUnselectMultiple: GraphEventListener<"unselectedMultiple"> = (eventTab) => {
      if (tab.id === eventTab.id) {
        setSelected([]);
      }
    };

    graph //
      .addListener("selectedMultiple", handleSelectMultiple)
      .addListener("unselectedMultiple", handleUnselectMultiple);

    return () => {
      graph //
        .removeListener("selectedMultiple", handleSelectMultiple)
        .removeListener("unselectedMultiple", handleUnselectMultiple);
    };
  }, [graph, tab]);

  return selected;
};

```

## Archivo: `packages/MainUI/hooks/useSetSession.ts`

```typescript
import { buildPayloadByInputName } from "@/utils";
import { logger } from "@/utils/logger";
import { Metadata } from "@workspaceui/api-client/src/api/metadata";
import type { EntityData, FormInitializationResponse, Tab } from "@workspaceui/api-client/src/api/types";
import { useCallback } from "react";
import { useUserContext } from "./useUserContext";

const ACTION = "org.openbravo.client.application.window.FormInitializationComponent";
const MODE = "SETSESSION";

export const useSetSession = () => {
  const { setSession } = useUserContext();

  return useCallback(
    async (record: EntityData, tab: Tab) => {
      if (!tab) return;

      const params = new URLSearchParams({
        _action: ACTION,
        MODE,
        TAB_ID: tab.id,
        ROW_ID: String(record.id),
        PARENT_ID: "null",
      });

      try {
        const payload = buildPayloadByInputName(record, tab.fields);
        const response = await Metadata.kernelClient.post(`?${params}`, payload);

        if (!response?.ok) {
          throw new Error(response.statusText);
        }

        const data = response.data as FormInitializationResponse;

        setSession((prev) => {
          const result = { ...prev, ...data.sessionAttributes };

          for (const [inputName, { value }] of Object.entries(data.auxiliaryInputValues)) {
            result[inputName] = value || "";
          }

          return result;
        });
      } catch (error) {
        logger.warn(error);
      }
    },
    [setSession]
  );
};

```

## Archivo: `packages/MainUI/hooks/useTab.ts`

```typescript
import { logger } from "@/utils/logger";
import { Metadata } from "@workspaceui/api-client/src/api/metadata";
import type { Tab } from "@workspaceui/api-client/src/api/types";
import { useCallback, useEffect, useMemo, useState } from "react";

export function useTab(tabId?: string) {
  const [loading, setLoading] = useState(!!tabId);
  const [error, setError] = useState<Error>();
  const [loaded, setLoaded] = useState(false);
  const [data, setData] = useState<Tab>();

  const load = useCallback(async () => {
    try {
      if (!tabId) {
        return;
      }

      setLoading(true);
      setError(undefined);

      const data = await Metadata.getTab(tabId);

      setData(data);
      setLoaded(true);
    } catch (e) {
      logger.warn(e);

      setError(e as Error);
    } finally {
      setLoading(false);
    }
  }, [tabId]);

  useEffect(() => {
    load();
  }, [load]);

  return useMemo(() => ({ loading, data, error, loaded, load }), [data, error, load, loaded, loading]);
}

```

## Archivo: `packages/MainUI/hooks/useTableSelection.ts`

```typescript
import { useSelected } from "@/hooks/useSelected";
import { mapBy } from "@/utils/structures";
import type { EntityData, Tab } from "@workspaceui/api-client/src/api/types";
import type { MRT_RowSelectionState } from "material-react-table";
import { useEffect, useRef } from "react";
import { useMultiWindowURL } from "@/hooks/navigation/useMultiWindowURL";

const compareArraysAlphabetically = (arr1: string[], arr2: string[]): boolean => {
  if (arr1.length !== arr2.length) return false;

  const sorted1 = [...arr1].sort((a, b) => a.localeCompare(b));
  const sorted2 = [...arr2].sort((a, b) => a.localeCompare(b));

  return sorted1.every((item, index) => item === sorted2[index]);
};

const compareArraysNumerically = (arr1: string[], arr2: string[]): boolean => {
  if (arr1.length !== arr2.length) return false;

  const sorted1 = [...arr1].sort((a, b) => Number(a) - Number(b));
  const sorted2 = [...arr2].sort((a, b) => Number(a) - Number(b));

  return sorted1.every((item, index) => item === sorted2[index]);
};

const processSelectedRecords = (
  rowSelection: MRT_RowSelectionState,
  recordsMap: Record<string, EntityData>
): { selectedRecords: EntityData[]; lastSelected: EntityData | null } => {
  const selectedIds = Object.keys(rowSelection).filter((id) => rowSelection[id]);
  const selectedRecords: EntityData[] = [];
  let lastSelected: EntityData | null = null;

  for (const recordId of selectedIds) {
    const record = recordsMap[recordId];
    if (record) {
      selectedRecords.push(record);
      lastSelected = record;
    }
  }

  return { selectedRecords, lastSelected };
};

const clearChildrenRecords = (
  windowId: string,
  graph: ReturnType<typeof useSelected>["graph"],
  tab: Tab,
  currentWindowId: string,
  clearSelectedRecord: (windowId: string, tabId: string) => void
): void => {
  const children = graph.getChildren(tab);
  if (!children || children.length === 0) return;

  for (const child of children) {
    if (child.window === currentWindowId) {
      clearSelectedRecord(windowId, child.id);
    }
  }
};

const updateGraphSelection = (
  graph: ReturnType<typeof useSelected>["graph"],
  tab: Tab,
  lastSelected: EntityData | null,
  selectedRecords: EntityData[],
  onSelectionChange?: (recordId: string) => void
): void => {
  if (lastSelected) {
    graph.setSelected(tab, lastSelected);
    onSelectionChange?.(String(lastSelected.id));
  } else if (graph.getSelected(tab)) {
    graph.clearSelected(tab);
    onSelectionChange?.("");
  }

  if (selectedRecords.length > 0) {
    graph.setSelectedMultiple(tab, selectedRecords);
  } else {
    graph.clearSelectedMultiple(tab);
  }
};

export default function useTableSelection(
  tab: Tab,
  records: EntityData[],
  rowSelection: MRT_RowSelectionState,
  onSelectionChange?: (recordId: string) => void
) {
  const { graph } = useSelected();
  const { activeWindow, clearSelectedRecord } = useMultiWindowURL();
  const previousSelectionRef = useRef<string[]>([]);

  const windowId = activeWindow?.windowId;
  const currentWindowId = tab.window;

  useEffect(() => {
    const isCorrectWindow = windowId === currentWindowId;
    if (!isCorrectWindow) {
      return;
    }

    const recordsMap = mapBy(records ?? [], "id");
    const { selectedRecords, lastSelected } = processSelectedRecords(rowSelection, recordsMap);

    const currentSelectionIds = selectedRecords.map((r) => String(r.id));
    const hasSelectionChanged = !compareArraysAlphabetically(currentSelectionIds, previousSelectionRef.current);

    if (!hasSelectionChanged) {
      return;
    }

    previousSelectionRef.current = currentSelectionIds;

    if (windowId) {
      clearChildrenRecords(windowId, graph, tab, currentWindowId, clearSelectedRecord);
    }

    updateGraphSelection(graph, tab, lastSelected, selectedRecords, onSelectionChange);
  }, [graph, records, rowSelection, tab, onSelectionChange, windowId, clearSelectedRecord, currentWindowId]);
}

export function useTableSelectionNumeric(
  tab: Tab,
  records: EntityData[],
  rowSelection: MRT_RowSelectionState,
  onSelectionChange?: (recordId: string) => void
) {
  const { graph } = useSelected();
  const { activeWindow, clearSelectedRecord } = useMultiWindowURL();
  const previousSelectionRef = useRef<string[]>([]);

  const windowId = activeWindow?.windowId;
  const currentWindowId = tab.window;

  useEffect(() => {
    const isCorrectWindow = windowId === currentWindowId;
    if (!isCorrectWindow) {
      return;
    }

    const recordsMap = mapBy(records ?? [], "id");
    const { selectedRecords, lastSelected } = processSelectedRecords(rowSelection, recordsMap);

    const currentSelectionIds = selectedRecords.map((r) => String(r.id));
    const hasSelectionChanged = !compareArraysNumerically(currentSelectionIds, previousSelectionRef.current);

    if (!hasSelectionChanged) {
      return;
    }

    previousSelectionRef.current = currentSelectionIds;

    if (windowId) {
      clearChildrenRecords(windowId, graph, tab, currentWindowId, clearSelectedRecord);
    }

    updateGraphSelection(graph, tab, lastSelected, selectedRecords, onSelectionChange);
  }, [graph, records, rowSelection, tab, onSelectionChange, windowId, clearSelectedRecord, currentWindowId]);
}

```

## Archivo: `packages/MainUI/hooks/useTranslation.ts`

```typescript
import type { TranslateFunction } from "./types";
import { useCallback } from "react";
import translations, { DEFAULT_LANGUAGE } from "@workspaceui/componentlibrary/src/locales";
import { useLanguage } from "../contexts/language";

export const useTranslation = (defaultLanguage = DEFAULT_LANGUAGE) => {
  const { language } = useLanguage();

  const t = useCallback<TranslateFunction>(
    (key) => {
      const keys = key.split(".");
      let value: unknown = translations[language ?? defaultLanguage ?? DEFAULT_LANGUAGE];

      for (const k of keys) {
        if (typeof value !== "object" || value === null || !(k in value)) {
          return key;
        }
        value = value[k as keyof typeof value];
      }

      if (typeof value !== "string") {
        return key;
      }

      return value;
    },
    [language, defaultLanguage]
  );

  return { t };
};

```

## Archivo: `packages/MainUI/hooks/useUserContext.ts`

```typescript
import { useContext } from "react";
import { UserContext } from "../contexts/user";

export const useUserContext = () => {
  const context = useContext(UserContext);

  if (!context) {
    throw new Error("useUserContext must be used within a UserProvider");
  }

  return context;
};

```

## Archivo: `packages/MainUI/hooks/useWindow.ts`

```typescript
import { useCallback, useEffect, useMemo, useState } from "react";
import { Metadata } from "@workspaceui/api-client/src/api/metadata";
import { logger } from "@/utils/logger";

export function useWindow(windowId: string) {
  const [loading, setLoading] = useState(!!windowId);
  const [error, setError] = useState<Error>();
  const [loaded, setLoaded] = useState(false);
  const [windowData, setWindowData] = useState(Metadata.getCachedWindow(windowId));

  const load = useCallback(async () => {
    try {
      if (!windowId) {
        return;
      }

      setLoading(true);
      setError(undefined);

      const data = await Metadata.getWindow(windowId);

      setWindowData(data);
      setLoaded(true);
    } catch (e) {
      logger.warn(e);

      setError(e as Error);
    } finally {
      setLoading(false);
    }
  }, [windowId]);

  useEffect(() => {
    load();
  }, [load]);

  return useMemo(() => ({ loading, windowData, error, loaded, load }), [error, load, loaded, loading, windowData]);
}

```

## Archivo: `packages/MainUI/mocks/Drawer/index.ts`

```typescript
import type { Menu } from "@workspaceui/api-client/src/api/types";

export const menuMock: Menu[] = [
  {
    _identifier: "Configuración General",
    _entityName: "ADMenu",
    $ref: "ADMenu/155",
    id: "155",
    name: "Configuración General",
    action: null,
    recordTime: 1726085852719,
    icon: "⚙️",
    children: [
      {
        _identifier: "Configuración de Adjuntos",
        _entityName: "ADMenu",
        $ref: "ADMenu/C4ADA28EF2794F9AA047339E153B3C11",
        id: "C4ADA28EF2794F9AA047339E153B3C11",
        name: "Configuración de Adjuntos",
        action: "W",
        recordTime: 1726085852722,
        window: {
          _identifier: "Configuración de Adjuntos",
          _entityName: "ADWindow",
          $ref: "ADWindow/7AE5333578E84E3CAEA6F1943ACF324F",
          id: "7AE5333578E84E3CAEA6F1943ACF324F",
          name: "Configuración de Adjuntos",
          windowType: "M",
          recordTime: 1726085852728,
        },
      },
      {
        _identifier: "Aplicación",
        _entityName: "ADMenu",
        $ref: "ADMenu/161",
        id: "161",
        name: "Aplicación",
        action: null,
        recordTime: 1726085852730,
        icon: "⚙️",
        children: [
          {
            _identifier: "Crear Secuencias",
            _entityName: "ADMenu",
            $ref: "ADMenu/D54DA58D08F742D4A153BD026F791605",
            id: "D54DA58D08F742D4A153BD026F791605",
            name: "Crear Secuencias",
            action: "OBUIAPP_Process",
            recordTime: 1726085852731,
          },
          {
            _identifier: "Moneda",
            _entityName: "ADMenu",
            $ref: "ADMenu/102",
            id: "102",
            name: "Moneda",
            action: "W",
            recordTime: 1726085852732,
            window: {
              _identifier: "Moneda",
              _entityName: "ADWindow",
              $ref: "ADWindow/115",
              id: "115",
              name: "Moneda",
              windowType: "M",
              recordTime: 1726085852734,
            },
          },
          {
            _identifier: "Rangos de conversión",
            _entityName: "ADMenu",
            $ref: "ADMenu/103",
            id: "103",
            name: "Rangos de conversión",
            action: "W",
            recordTime: 1726085852735,
            window: {
              _identifier: "Rangos de conversión",
              _entityName: "ADWindow",
              $ref: "ADWindow/116",
              id: "116",
              name: "Rangos de conversión",
              windowType: "M",
              recordTime: 1726085852738,
            },
          },
          {
            _identifier: "País, provincia y ciudad",
            _entityName: "ADMenu",
            $ref: "ADMenu/109",
            id: "109",
            name: "País, provincia y ciudad",
            action: "W",
            recordTime: 1726085852740,
            window: {
              _identifier: "País, provincia y ciudad",
              _entityName: "ADWindow",
              $ref: "ADWindow/122",
              id: "122",
              name: "País, provincia y ciudad",
              windowType: "M",
              recordTime: 1726085852741,
            },
          },
          {
            _identifier: "Preferencias",
            _entityName: "ADMenu",
            $ref: "ADMenu/115",
            id: "115",
            name: "Preferencias",
            action: "W",
            recordTime: 1726085852743,
            window: {
              _identifier: "Preferencias",
              _entityName: "ADWindow",
              $ref: "ADWindow/129",
              id: "129",
              name: "Preferencias",
              windowType: "M",
              recordTime: 1726085852745,
            },
          },
          {
            _identifier: "Preferencias Sesión",
            _entityName: "ADMenu",
            $ref: "ADMenu/1003100000",
            id: "1003100000",
            name: "Preferencias Sesión",
            action: "X",
            recordTime: 1726085852747,
          },
          {
            _identifier: "Conversor de números a letras",
            _entityName: "ADMenu",
            $ref: "ADMenu/3CC72318FA8C4DC7ADBA238BEE881AF5",
            id: "3CC72318FA8C4DC7ADBA238BEE881AF5",
            name: "Conversor de números a letras",
            action: "W",
            recordTime: 1726085852749,
            window: {
              _identifier: "Conversor de números a letras",
              _entityName: "ADWindow",
              $ref: "ADWindow/4FE878BFD2E643D0B83DCFC8B5558A9E",
              id: "4FE878BFD2E643D0B83DCFC8B5558A9E",
              name: "Conversor de números a letras",
              windowType: "M",
              recordTime: 1726085852753,
            },
          },
          {
            _identifier: "Gestión de Alertas",
            _entityName: "ADMenu",
            $ref: "ADMenu/FF8080812EB90459012EBA72B4E7004D",
            id: "FF8080812EB90459012EBA72B4E7004D",
            name: "Gestión de Alertas",
            action: "OBUIAPP_OpenView",
            recordTime: 1726085852755,
          },
          {
            _identifier: "Proceso Directo de Importación de Entradas",
            _entityName: "ADMenu",
            $ref: "ADMenu/2B900D4873984239A50C5BD18EA72E04",
            id: "2B900D4873984239A50C5BD18EA72E04",
            name: "Proceso Directo de Importación de Entradas",
            action: "OBUIAPP_Process",
            recordTime: 1726085852757,
          },
          {
            _identifier: "Entradas de Datos Importados",
            _entityName: "ADMenu",
            $ref: "ADMenu/6EEC8E0853CB432B886B8751A73F5E28",
            id: "6EEC8E0853CB432B886B8751A73F5E28",
            name: "Entradas de Datos Importados",
            action: "W",
            recordTime: 1726085852759,
            window: {
              _identifier: "Entradas de Datos Importados",
              _entityName: "ADWindow",
              $ref: "ADWindow/17F3B5BC762145B9AAD2F6483BC12CF4",
              id: "17F3B5BC762145B9AAD2F6483BC12CF4",
              name: "Entradas de Datos Importados",
              windowType: "M",
              recordTime: 1726085852762,
            },
          },
          {
            _identifier: "Archivo de Entradas de Datos Importados",
            _entityName: "ADMenu",
            $ref: "ADMenu/83558EB4D10D41C9980BF6518A0BA7F8",
            id: "83558EB4D10D41C9980BF6518A0BA7F8",
            name: "Archivo de Entradas de Datos Importados",
            action: "W",
            recordTime: 1726085852763,
            window: {
              _identifier: "Archivo de Entradas de Datos Importados",
              _entityName: "ADWindow",
              $ref: "ADWindow/F88B1280DE564BDBB1D80D159F0D2889",
              id: "F88B1280DE564BDBB1D80D159F0D2889",
              name: "Archivo de Entradas de Datos Importados",
              windowType: "M",
              recordTime: 1726085852767,
            },
          },
          {
            _identifier: "Personalización de Ventana",
            _entityName: "ADMenu",
            $ref: "ADMenu/FF8081813157AED2013157C149F40039",
            id: "FF8081813157AED2013157C149F40039",
            name: "Personalización de Ventana",
            action: "W",
            recordTime: 1726085852768,
            window: {
              _identifier: "Personalización de Ventana",
              _entityName: "ADWindow",
              $ref: "ADWindow/FF8081813157AED2013157BE93460020",
              id: "FF8081813157AED2013157BE93460020",
              name: "Personalización de Ventana",
              windowType: "M",
              recordTime: 1726085852769,
            },
          },
          {
            _identifier: "Alertas",
            _entityName: "ADMenu",
            $ref: "ADMenu/800228",
            id: "800228",
            name: "Alertas",
            action: "W",
            recordTime: 1726085852770,
            window: {
              _identifier: "Alertas",
              _entityName: "ADWindow",
              $ref: "ADWindow/276",
              id: "276",
              name: "Alertas",
              windowType: "M",
              recordTime: 1726085852771,
            },
          },
        ],
      },
      {
        _identifier: "Entidad",
        _entityName: "ADMenu",
        $ref: "ADMenu/156",
        id: "156",
        name: "Entidad",
        action: null,
        recordTime: 1726085852772,
        icon: "👨🏻‍💼",
        children: [
          {
            _identifier: "Entidad",
            _entityName: "ADMenu",
            $ref: "ADMenu/148",
            id: "148",
            name: "Entidad",
            action: "W",
            recordTime: 1726085852773,
            window: {
              _identifier: "Entidad",
              _entityName: "ADWindow",
              $ref: "ADWindow/109",
              id: "109",
              name: "Entidad",
              windowType: "M",
              recordTime: 1726085852775,
            },
          },
          {
            _identifier: "Exportar Entidad",
            _entityName: "ADMenu",
            $ref: "ADMenu/8BA14A552EA84AB19A33F3F2C3002790",
            id: "8BA14A552EA84AB19A33F3F2C3002790",
            name: "Exportar Entidad",
            action: "P",
            recordTime: 1726085852776,
          },
        ],
      },
      {
        _identifier: "Conector CRM",
        _entityName: "ADMenu",
        $ref: "ADMenu/5B13FC397F814D188EF8A2479511FED3",
        id: "5B13FC397F814D188EF8A2479511FED3",
        name: "Conector CRM",
        action: null,
        recordTime: 1726085852778,
        icon: "🔗",
        children: [
          {
            _identifier: "Configuración del Conector CRM",
            _entityName: "ADMenu",
            $ref: "ADMenu/140E9C8338C64B84B659B5D2FB49F8B5",
            id: "140E9C8338C64B84B659B5D2FB49F8B5",
            name: "Configuración del Conector CRM",
            action: "W",
            recordTime: 1726085852778,
            window: {
              _identifier: "Configuración del Conector CRM",
              _entityName: "ADWindow",
              $ref: "ADWindow/B282F5FA893E4339A548F2E224B15162",
              id: "B282F5FA893E4339A548F2E224B15162",
              name: "Configuración del Conector CRM",
              windowType: "M",
              recordTime: 1726085852779,
            },
          },
        ],
      },
      {
        _identifier: "Organización",
        _entityName: "ADMenu",
        $ref: "ADMenu/175",
        id: "175",
        name: "Organización",
        action: null,
        recordTime: 1726085852780,
        icon: "🏢",
        children: [
          {
            _identifier: "Crear organización",
            _entityName: "ADMenu",
            $ref: "ADMenu/241C75FEC4C243BC8E71A4F358157F2D",
            id: "241C75FEC4C243BC8E71A4F358157F2D",
            name: "Crear organización",
            action: "X",
            recordTime: 1726085852780,
          },
          {
            _identifier: "Gestión del módulo de Empresa",
            _entityName: "ADMenu",
            $ref: "ADMenu/5DFCDFE962144B12A6279E9A1E9DC0AC",
            id: "5DFCDFE962144B12A6279E9A1E9DC0AC",
            name: "Gestión del módulo de Empresa",
            action: "X",
            recordTime: 1726085852781,
          },
          {
            _identifier: "Tipo de Organización",
            _entityName: "ADMenu",
            $ref: "ADMenu/134C41C58C8945FAB0C18D88B33C08FE",
            id: "134C41C58C8945FAB0C18D88B33C08FE",
            name: "Tipo de Organización",
            action: "W",
            recordTime: 1726085852782,
            window: {
              _identifier: "Tipo de Organización",
              _entityName: "ADWindow",
              $ref: "ADWindow/11E11FE8445B4621A9989DD406C1B374",
              id: "11E11FE8445B4621A9989DD406C1B374",
              name: "Tipo de Organización",
              windowType: "M",
              recordTime: 1726085852783,
            },
          },
          {
            _identifier: "Organización",
            _entityName: "ADMenu",
            $ref: "ADMenu/149",
            id: "149",
            name: "Organización",
            action: "W",
            recordTime: 1726085852783,
            window: {
              _identifier: "Organización",
              _entityName: "ADWindow",
              $ref: "ADWindow/110",
              id: "110",
              name: "Organización",
              windowType: "M",
              recordTime: 1726085852784,
            },
          },
        ],
      },
      {
        _identifier: "Seguridad",
        _entityName: "ADMenu",
        $ref: "ADMenu/367",
        id: "367",
        name: "Seguridad",
        action: null,
        recordTime: 1726085852785,
        icon: "🔐",
        children: [
          {
            _identifier: "Usuario",
            _entityName: "ADMenu",
            $ref: "ADMenu/147",
            id: "147",
            name: "Usuario",
            action: "W",
            recordTime: 1726085852786,
            window: {
              _identifier: "Usuario",
              _entityName: "ADWindow",
              $ref: "ADWindow/108",
              id: "108",
              name: "Usuario",
              windowType: "M",
              recordTime: 1726085852787,
            },
          },
          {
            _identifier: "Rol",
            _entityName: "ADMenu",
            $ref: "ADMenu/150",
            id: "150",
            name: "Rol",
            action: "W",
            recordTime: 1726085852787,
            window: {
              _identifier: "Rol",
              _entityName: "ADWindow",
              $ref: "ADWindow/111",
              id: "111",
              name: "Rol",
              windowType: "M",
              recordTime: 1726085852791,
            },
          },
          {
            _identifier: "Rol permisos",
            _entityName: "ADMenu",
            $ref: "ADMenu/362",
            id: "362",
            name: "Rol permisos",
            action: "W",
            recordTime: 1726085852793,
            window: {
              _identifier: "Rol permisos",
              _entityName: "ADWindow",
              $ref: "ADWindow/268",
              id: "268",
              name: "Rol permisos",
              windowType: "M",
              recordTime: 1726085852794,
            },
          },
          {
            _identifier: "Histórico de auditoría",
            _entityName: "ADMenu",
            $ref: "ADMenu/3BADF832BEAE46DBAE7A2C370353050D",
            id: "3BADF832BEAE46DBAE7A2C370353050D",
            name: "Histórico de auditoría",
            action: "W",
            recordTime: 1726085852795,
            window: {
              _identifier: "Histórico de auditoría",
              _entityName: "ADWindow",
              $ref: "ADWindow/FEB8679CAA0D47E5978F10E22566FCEA",
              id: "FEB8679CAA0D47E5978F10E22566FCEA",
              name: "Histórico de auditoría",
              windowType: "M",
              recordTime: 1726085852796,
            },
          },
        ],
      },
      {
        _identifier: "Planificador de procesos",
        _entityName: "ADMenu",
        $ref: "ADMenu/D13B4DBDCBF747BB9A91B17CBC6D1AA5",
        id: "D13B4DBDCBF747BB9A91B17CBC6D1AA5",
        name: "Planificador de procesos",
        action: null,
        recordTime: 1726085852796,
        icon: "🕘",
        children: [
          {
            _identifier: "Procesamiento de Peticiones",
            _entityName: "ADMenu",
            $ref: "ADMenu/BE86736DF4AB4568A316A3922E6D6B7B",
            id: "BE86736DF4AB4568A316A3922E6D6B7B",
            name: "Procesamiento de Peticiones",
            action: "W",
            recordTime: 1726085852797,
            window: {
              _identifier: "Procesamiento de Peticiones",
              _entityName: "ADWindow",
              $ref: "ADWindow/48E7EDE7D1104A59B46FC7449D9FB267",
              id: "48E7EDE7D1104A59B46FC7449D9FB267",
              name: "Procesamiento de Peticiones",
              windowType: "M",
              recordTime: 1726085852798,
            },
          },
          {
            _identifier: "Monitor de Procesos",
            _entityName: "ADMenu",
            $ref: "ADMenu/B902D95D3F654C7096C428F50381E38A",
            id: "B902D95D3F654C7096C428F50381E38A",
            name: "Monitor de Procesos",
            action: "W",
            recordTime: 1726085852798,
            window: {
              _identifier: "Monitor de Procesos",
              _entityName: "ADWindow",
              $ref: "ADWindow/EF3E837705944F4DBF398D683D36ACE0",
              id: "EF3E837705944F4DBF398D683D36ACE0",
              name: "Monitor de Procesos",
              windowType: "M",
              recordTime: 1726085852799,
            },
          },
          {
            _identifier: "Grupo de Procesos",
            _entityName: "ADMenu",
            $ref: "ADMenu/B307FC5041D94B3FA57F830E90264EE4",
            id: "B307FC5041D94B3FA57F830E90264EE4",
            name: "Grupo de Procesos",
            action: "W",
            recordTime: 1726085852800,
            window: {
              _identifier: "Grupo de Procesos",
              _entityName: "ADWindow",
              $ref: "ADWindow/C846A9EFF5D741A693029D516432BF6C",
              id: "C846A9EFF5D741A693029D516432BF6C",
              name: "Grupo de Procesos",
              windowType: "M",
              recordTime: 1726085852802,
            },
          },
        ],
      },
      {
        _identifier: "Espacio de Trabajo",
        _entityName: "ADMenu",
        $ref: "ADMenu/06256C037E704AFAB11ACA3413B9C509",
        id: "06256C037E704AFAB11ACA3413B9C509",
        name: "Espacio de Trabajo",
        action: null,
        recordTime: 1726085852803,
        icon: "🗄️",
        children: [
          {
            _identifier: "Instancia de Widget",
            _entityName: "ADMenu",
            $ref: "ADMenu/08EEA66E75424372AF1BDF84DD230050",
            id: "08EEA66E75424372AF1BDF84DD230050",
            name: "Instancia de Widget",
            action: "W",
            recordTime: 1726085852804,
            window: {
              _identifier: "Instancia de Widget",
              _entityName: "ADWindow",
              $ref: "ADWindow/F222C5956BC84B538924F626DFC8DBBB",
              id: "F222C5956BC84B538924F626DFC8DBBB",
              name: "Instancia de Widget",
              windowType: "M",
              recordTime: 1726085852804,
            },
          },
          {
            _identifier: "Widget",
            _entityName: "ADMenu",
            $ref: "ADMenu/E2AACAB433C644A3858891306EEDA2D3",
            id: "E2AACAB433C644A3858891306EEDA2D3",
            name: "Widget",
            action: "W",
            recordTime: 1726085852805,
            window: {
              _identifier: "Widget",
              _entityName: "ADWindow",
              $ref: "ADWindow/519E5DF804FD4BC4B0FBE6DD51F3EDA8",
              id: "519E5DF804FD4BC4B0FBE6DD51F3EDA8",
              name: "Widget",
              windowType: "M",
              recordTime: 1726085852806,
            },
          },
        ],
      },
    ],
  },
  {
    _identifier: "Jobs",
    _entityName: "ADMenu",
    $ref: "ADMenu/3A59F70F148D4BE49D38E9935CDFE3C7",
    id: "3A59F70F148D4BE49D38E9935CDFE3C7",
    name: "Jobs",
    action: null,
    recordTime: 1726085852807,
    icon: "💼",
    children: [
      {
        _identifier: "Job",
        _entityName: "ADMenu",
        $ref: "ADMenu/B824226F78924797926C3833D789B7C8",
        id: "B824226F78924797926C3833D789B7C8",
        name: "Job",
        action: "W",
        recordTime: 1726085852808,
        window: {
          _identifier: "Job",
          _entityName: "ADWindow",
          $ref: "ADWindow/75BBE231421E4812B1691FF33D371CE0",
          id: "75BBE231421E4812B1691FF33D371CE0",
          name: "Job",
          windowType: "M",
          recordTime: 1726085852811,
        },
      },
      {
        _identifier: "Resultado de Job",
        _entityName: "ADMenu",
        $ref: "ADMenu/73AB1716D0EC4BB9BD7C5A791C47E128",
        id: "73AB1716D0EC4BB9BD7C5A791C47E128",
        name: "Resultado de Job",
        action: "W",
        recordTime: 1726085852812,
        window: {
          _identifier: "Resultado de Job",
          _entityName: "ADWindow",
          $ref: "ADWindow/FD5A74DAE9B84D42824F04C3EE1C40DB",
          id: "FD5A74DAE9B84D42824F04C3EE1C40DB",
          name: "Resultado de Job",
          windowType: "Q",
          recordTime: 1726085852813,
        },
      },
    ],
  },
  {
    _identifier: "Gestión de Datos Maestros",
    _entityName: "ADMenu",
    $ref: "ADMenu/800237",
    id: "800237",
    name: "Gestión de Datos Maestros",
    action: null,
    recordTime: 1726085852814,
    icon: "🗂️",
    children: [
      {
        _identifier: "Terceros",
        _entityName: "ADMenu",
        $ref: "ADMenu/110",
        id: "110",
        name: "Terceros",
        action: "W",
        recordTime: 1726085852815,
        window: {
          _identifier: "Terceros",
          _entityName: "ADWindow",
          $ref: "ADWindow/123",
          id: "123",
          name: "Terceros",
          windowType: "M",
          recordTime: 1726085852816,
        },
      },
      {
        _identifier: "Información de terceros",
        _entityName: "ADMenu",
        $ref: "ADMenu/394",
        id: "394",
        name: "Información de terceros",
        action: "W",
        recordTime: 1726085852816,
        window: {
          _identifier: "Información de terceros",
          _entityName: "ADWindow",
          $ref: "ADWindow/291",
          id: "291",
          name: "Información de terceros",
          windowType: "Q",
          recordTime: 1726085852817,
        },
      },
      {
        _identifier: "Producto",
        _entityName: "ADMenu",
        $ref: "ADMenu/126",
        id: "126",
        name: "Producto",
        action: "W",
        recordTime: 1726085852818,
        window: {
          _identifier: "Producto",
          _entityName: "ADWindow",
          $ref: "ADWindow/140",
          id: "140",
          name: "Producto",
          windowType: "M",
          recordTime: 1726085852819,
        },
      },
      {
        _identifier: "Configuración de terceros",
        _entityName: "ADMenu",
        $ref: "ADMenu/800238",
        id: "800238",
        name: "Configuración de terceros",
        action: null,
        recordTime: 1726085852820,
        icon: "🛠️",
        children: [
          {
            _identifier: "Conjunto de Terceros",
            _entityName: "ADMenu",
            $ref: "ADMenu/0D5AE7EBDC834972B8425113E784A1DE",
            id: "0D5AE7EBDC834972B8425113E784A1DE",
            name: "Conjunto de Terceros",
            action: "W",
            recordTime: 1726085852821,
            window: {
              _identifier: "Conjunto de Terceros",
              _entityName: "ADWindow",
              $ref: "ADWindow/3E459D89D8FE4E399E2183AE1A9E78FA",
              id: "3E459D89D8FE4E399E2183AE1A9E78FA",
              name: "Conjunto de Terceros",
              windowType: "M",
              recordTime: 1726085852822,
            },
          },
          {
            _identifier: "Grupos de Terceros",
            _entityName: "ADMenu",
            $ref: "ADMenu/232",
            id: "232",
            name: "Grupos de Terceros",
            action: "W",
            recordTime: 1726085852824,
            window: {
              _identifier: "Grupos de Terceros",
              _entityName: "ADWindow",
              $ref: "ADWindow/192",
              id: "192",
              name: "Grupos de Terceros",
              windowType: "M",
              recordTime: 1726085852825,
            },
          },
          {
            _identifier: "Calendario de facturación",
            _entityName: "ADMenu",
            $ref: "ADMenu/133",
            id: "133",
            name: "Calendario de facturación",
            action: "W",
            recordTime: 1726085852828,
            window: {
              _identifier: "Calendario de facturación",
              _entityName: "ADWindow",
              $ref: "ADWindow/147",
              id: "147",
              name: "Calendario de facturación",
              windowType: "M",
              recordTime: 1726085852829,
            },
          },
          {
            _identifier: "Tratamientos",
            _entityName: "ADMenu",
            $ref: "ADMenu/190",
            id: "190",
            name: "Tratamientos",
            action: "W",
            recordTime: 1726085852830,
            window: {
              _identifier: "Tratamientos",
              _entityName: "ADWindow",
              $ref: "ADWindow/178",
              id: "178",
              name: "Tratamientos",
              windowType: "M",
              recordTime: 1726085852831,
            },
          },
          {
            _identifier: "Condiciones de pago",
            _entityName: "ADMenu",
            $ref: "ADMenu/127",
            id: "127",
            name: "Condiciones de pago",
            action: "W",
            recordTime: 1726085852832,
            window: {
              _identifier: "Condiciones de pago",
              _entityName: "ADWindow",
              $ref: "ADWindow/141",
              id: "141",
              name: "Condiciones de pago",
              windowType: "M",
              recordTime: 1726085852833,
            },
          },
          {
            _identifier: "Motivos de devolución",
            _entityName: "ADMenu",
            $ref: "ADMenu/20FCC3606573406A9242358C3E4A3585",
            id: "20FCC3606573406A9242358C3E4A3585",
            name: "Motivos de devolución",
            action: "W",
            recordTime: 1726085852834,
            window: {
              _identifier: "Motivos de devolución",
              _entityName: "ADWindow",
              $ref: "ADWindow/0CFFACC0F91C4DFDA429CCF80EBF4BC4",
              id: "0CFFACC0F91C4DFDA429CCF80EBF4BC4",
              name: "Motivos de devolución",
              windowType: "M",
              recordTime: 1726085852835,
            },
          },
          {
            _identifier: "Rappels",
            _entityName: "ADMenu",
            $ref: "ADMenu/800024",
            id: "800024",
            name: "Rappels",
            action: "W",
            recordTime: 1726085852837,
            window: {
              _identifier: "Rappels",
              _entityName: "ADWindow",
              $ref: "ADWindow/800003",
              id: "800003",
              name: "Rappels",
              windowType: "M",
              recordTime: 1726085852838,
            },
          },
          {
            _identifier: "Descuentos",
            _entityName: "ADMenu",
            $ref: "ADMenu/800096",
            id: "800096",
            name: "Descuentos",
            action: "W",
            recordTime: 1726085852840,
            window: {
              _identifier: "Descuentos",
              _entityName: "ADWindow",
              $ref: "ADWindow/800017",
              id: "800017",
              name: "Descuentos",
              windowType: "M",
              recordTime: 1726085852842,
            },
          },
          {
            _identifier: "Categoría Salarial",
            _entityName: "ADMenu",
            $ref: "ADMenu/800203",
            id: "800203",
            name: "Categoría Salarial",
            action: "W",
            recordTime: 1726085852843,
            window: {
              _identifier: "Categoría Salarial",
              _entityName: "ADWindow",
              $ref: "ADWindow/800084",
              id: "800084",
              name: "Categoría Salarial",
              windowType: "M",
              recordTime: 1726085852845,
            },
          },
        ],
      },
      {
        _identifier: "Configuración de productos",
        _entityName: "ADMenu",
        $ref: "ADMenu/800239",
        id: "800239",
        name: "Configuración de productos",
        action: null,
        recordTime: 1726085852846,
        icon: "🛠️",
        children: [
          {
            _identifier: "Característica de producto",
            _entityName: "ADMenu",
            $ref: "ADMenu/648F02DE454D41CB90BBE4F66F5813A2",
            id: "648F02DE454D41CB90BBE4F66F5813A2",
            name: "Característica de producto",
            action: "W",
            recordTime: 1726085852846,
            window: {
              _identifier: "Característica de producto",
              _entityName: "ADWindow",
              $ref: "ADWindow/6FAD464D6C5C487F956B49E8B5EFC761",
              id: "6FAD464D6C5C487F956B49E8B5EFC761",
              name: "Característica de producto",
              windowType: "M",
              recordTime: 1726085852847,
            },
          },
          {
            _identifier: "Actualizar descripción de las características de producto",
            _entityName: "ADMenu",
            $ref: "ADMenu/BECE8640090B45A7B92AA8329742FB6B",
            id: "BECE8640090B45A7B92AA8329742FB6B",
            name: "Actualizar descripción de las características de producto",
            action: "P",
            recordTime: 1726085852848,
          },
          {
            _identifier: "Unidad de medida",
            _entityName: "ADMenu",
            $ref: "ADMenu/107",
            id: "107",
            name: "Unidad de medida",
            action: "W",
            recordTime: 1726085852849,
            window: {
              _identifier: "Unidad de medida",
              _entityName: "ADWindow",
              $ref: "ADWindow/120",
              id: "120",
              name: "Unidad de medida",
              windowType: "M",
              recordTime: 1726085852850,
            },
          },
          {
            _identifier: "Categoría del producto",
            _entityName: "ADMenu",
            $ref: "ADMenu/130",
            id: "130",
            name: "Categoría del producto",
            action: "W",
            recordTime: 1726085852850,
            window: {
              _identifier: "Categoría del producto",
              _entityName: "ADWindow",
              $ref: "ADWindow/144",
              id: "144",
              name: "Categoría del producto",
              windowType: "M",
              recordTime: 1726085852851,
            },
          },
          {
            _identifier: "Atributo",
            _entityName: "ADMenu",
            $ref: "ADMenu/359",
            id: "359",
            name: "Atributo",
            action: "W",
            recordTime: 1726085852852,
            window: {
              _identifier: "Atributo",
              _entityName: "ADWindow",
              $ref: "ADWindow/260",
              id: "260",
              name: "Atributo",
              windowType: "M",
              recordTime: 1726085852852,
            },
          },
          {
            _identifier: "Unidad Suplementaria de Medida de Intrastat",
            _entityName: "ADMenu",
            $ref: "ADMenu/80FAC0C25EBA41899AAC46B208D0B1CE",
            id: "80FAC0C25EBA41899AAC46B208D0B1CE",
            name: "Unidad Suplementaria de Medida de Intrastat",
            action: "W",
            recordTime: 1726085852853,
            window: {
              _identifier: "Unidad Suplementaria de Medida de Intrastat",
              _entityName: "ADWindow",
              $ref: "ADWindow/507B0C826B154D68B8A54079A75F182E",
              id: "507B0C826B154D68B8A54079A75F182E",
              name: "Unidad Suplementaria de Medida de Intrastat",
              windowType: "M",
              recordTime: 1726085852854,
            },
          },
          {
            _identifier: "Conjunto atributos",
            _entityName: "ADMenu",
            $ref: "ADMenu/353",
            id: "353",
            name: "Conjunto atributos",
            action: "W",
            recordTime: 1726085852855,
            window: {
              _identifier: "Conjunto atributos",
              _entityName: "ADWindow",
              $ref: "ADWindow/256",
              id: "256",
              name: "Conjunto atributos",
              windowType: "M",
              recordTime: 1726085852856,
            },
          },
          {
            _identifier: "Control lote",
            _entityName: "ADMenu",
            $ref: "ADMenu/355",
            id: "355",
            name: "Control lote",
            action: "W",
            recordTime: 1726085852857,
            window: {
              _identifier: "Control lote",
              _entityName: "ADWindow",
              $ref: "ADWindow/258",
              id: "258",
              name: "Control lote",
              windowType: "M",
              recordTime: 1726085852858,
            },
          },
          {
            _identifier: "Control nº serie",
            _entityName: "ADMenu",
            $ref: "ADMenu/354",
            id: "354",
            name: "Control nº serie",
            action: "W",
            recordTime: 1726085852859,
            window: {
              _identifier: "Control nº serie",
              _entityName: "ADWindow",
              $ref: "ADWindow/259",
              id: "259",
              name: "Control nº serie",
              windowType: "M",
              recordTime: 1726085852861,
            },
          },
          {
            _identifier: "Marca",
            _entityName: "ADMenu",
            $ref: "ADMenu/A89F0CBA7D174B0C83F51F2ED9801383",
            id: "A89F0CBA7D174B0C83F51F2ED9801383",
            name: "Marca",
            action: "W",
            recordTime: 1726085852862,
            window: {
              _identifier: "Marca",
              _entityName: "ADWindow",
              $ref: "ADWindow/11A2976F05D841EFAE654A8B83EB4204",
              id: "11A2976F05D841EFAE654A8B83EB4204",
              name: "Marca",
              windowType: "M",
              recordTime: 1726085852863,
            },
          },
        ],
      },
      {
        _identifier: "Tarifas",
        _entityName: "ADMenu",
        $ref: "ADMenu/800240",
        id: "800240",
        name: "Tarifas",
        action: null,
        recordTime: 1726085852864,
        icon: "💲",
        children: [
          {
            _identifier: "Esquema de tarificación",
            _entityName: "ADMenu",
            $ref: "ADMenu/310",
            id: "310",
            name: "Esquema de tarificación",
            action: "W",
            recordTime: 1726085852865,
            window: {
              _identifier: "Esquema de tarificación",
              _entityName: "ADWindow",
              $ref: "ADWindow/233",
              id: "233",
              name: "Esquema de tarificación",
              windowType: "M",
              recordTime: 1726085852867,
            },
          },
          {
            _identifier: "Tarifa",
            _entityName: "ADMenu",
            $ref: "ADMenu/132",
            id: "132",
            name: "Tarifa",
            action: "W",
            recordTime: 1726085852868,
            window: {
              _identifier: "Tarifa",
              _entityName: "ADWindow",
              $ref: "ADWindow/146",
              id: "146",
              name: "Tarifa",
              windowType: "M",
              recordTime: 1726085852868,
            },
          },
          {
            _identifier: "Actualizar tarifas",
            _entityName: "ADMenu",
            $ref: "ADMenu/800043",
            id: "800043",
            name: "Actualizar tarifas",
            action: "P",
            recordTime: 1726085852869,
          },
          {
            _identifier: "Modificación de precios",
            _entityName: "ADMenu",
            $ref: "ADMenu/800117",
            id: "800117",
            name: "Modificación de precios",
            action: "W",
            recordTime: 1726085852870,
            window: {
              _identifier: "Modificación de precios",
              _entityName: "ADWindow",
              $ref: "ADWindow/800028",
              id: "800028",
              name: "Modificación de precios",
              windowType: "M",
              recordTime: 1726085852870,
            },
          },
          {
            _identifier: "Regla de Precio de Servicio",
            _entityName: "ADMenu",
            $ref: "ADMenu/B362D98BEA924E0A9424546BBF7FF6C4",
            id: "B362D98BEA924E0A9424546BBF7FF6C4",
            name: "Regla de Precio de Servicio",
            action: "W",
            recordTime: 1726085852871,
            window: {
              _identifier: "Regla de Precio de Servicio",
              _entityName: "ADWindow",
              $ref: "ADWindow/B2C0C2AE3B7B49B1A68F864FA8FC603C",
              id: "B2C0C2AE3B7B49B1A68F864FA8FC603C",
              name: "Regla de Precio de Servicio",
              windowType: "M",
              recordTime: 1726085852873,
            },
          },
        ],
      },
    ],
  },
  {
    _identifier: "Gestión de Compras",
    _entityName: "ADMenu",
    $ref: "ADMenu/203",
    id: "203",
    name: "Gestión de Compras",
    action: null,
    recordTime: 1726085852874,
    icon: "💸",
    children: [
      {
        _identifier: "Transacciones",
        _entityName: "ADMenu",
        $ref: "ADMenu/800242",
        id: "800242",
        name: "Transacciones",
        action: null,
        recordTime: 1726085852875,
        icon: "💶",
        children: [
          {
            _identifier: "Necesidad de material",
            _entityName: "ADMenu",
            $ref: "ADMenu/800216",
            id: "800216",
            name: "Necesidad de material",
            action: "W",
            recordTime: 1726085852877,
            window: {
              _identifier: "Necesidad de material",
              _entityName: "ADWindow",
              $ref: "ADWindow/800092",
              id: "800092",
              name: "Necesidad de material",
              windowType: "T",
              recordTime: 1726085852878,
            },
          },
          {
            _identifier: "Administrar necesidades",
            _entityName: "ADMenu",
            $ref: "ADMenu/1004400000",
            id: "1004400000",
            name: "Administrar necesidades",
            action: "W",
            recordTime: 1726085852878,
            window: {
              _identifier: "Administrar necesidades",
              _entityName: "ADWindow",
              $ref: "ADWindow/1004400000",
              id: "1004400000",
              name: "Administrar necesidades",
              windowType: "T",
              recordTime: 1726085852880,
            },
          },
          {
            _identifier: "Necesidad a Pedido",
            _entityName: "ADMenu",
            $ref: "ADMenu/1004400001",
            id: "1004400001",
            name: "Necesidad a Pedido",
            action: "X",
            recordTime: 1726085852880,
          },
          {
            _identifier: "Pedido de compra",
            _entityName: "ADMenu",
            $ref: "ADMenu/205",
            id: "205",
            name: "Pedido de compra",
            action: "W",
            recordTime: 1726085852881,
            window: {
              _identifier: "Pedido de compra",
              _entityName: "ADWindow",
              $ref: "ADWindow/181",
              id: "181",
              name: "Pedido de compra",
              windowType: "T",
              recordTime: 1726085852882,
            },
          },
          {
            _identifier: "Albarán (Proveedor)",
            _entityName: "ADMenu",
            $ref: "ADMenu/204",
            id: "204",
            name: "Albarán (Proveedor)",
            action: "W",
            recordTime: 1726085852882,
            window: {
              _identifier: "Albarán (Proveedor)",
              _entityName: "ADWindow",
              $ref: "ADWindow/184",
              id: "184",
              name: "Albarán (Proveedor)",
              windowType: "T",
              recordTime: 1726085852883,
            },
          },
          {
            _identifier: "Albaranes pendientes de recibir",
            _entityName: "ADMenu",
            $ref: "ADMenu/800099",
            id: "800099",
            name: "Albaranes pendientes de recibir",
            action: "X",
            recordTime: 1726085852883,
          },
          {
            _identifier: "Factura (Proveedor)",
            _entityName: "ADMenu",
            $ref: "ADMenu/206",
            id: "206",
            name: "Factura (Proveedor)",
            action: "W",
            recordTime: 1726085852884,
            window: {
              _identifier: "Factura (Proveedor)",
              _entityName: "ADWindow",
              $ref: "ADWindow/183",
              id: "183",
              name: "Factura (Proveedor)",
              windowType: "T",
              recordTime: 1726085852884,
            },
          },
          {
            _identifier: "Facturas cuadradas",
            _entityName: "ADMenu",
            $ref: "ADMenu/315",
            id: "315",
            name: "Facturas cuadradas",
            action: "W",
            recordTime: 1726085852885,
            window: {
              _identifier: "Facturas cuadradas",
              _entityName: "ADWindow",
              $ref: "ADWindow/107",
              id: "107",
              name: "Facturas cuadradas",
              windowType: "Q",
              recordTime: 1726085852885,
            },
          },
          {
            _identifier: "Devolución a proveedor",
            _entityName: "ADMenu",
            $ref: "ADMenu/F5C274DEAE9048DCAD48473D2F622CEC",
            id: "F5C274DEAE9048DCAD48473D2F622CEC",
            name: "Devolución a proveedor",
            action: "W",
            recordTime: 1726085852886,
            window: {
              _identifier: "Devolución a proveedor",
              _entityName: "ADWindow",
              $ref: "ADWindow/C50A8AEE6F044825B5EF54FAAE76826F",
              id: "C50A8AEE6F044825B5EF54FAAE76826F",
              name: "Devolución a proveedor",
              windowType: "T",
              recordTime: 1726085852886,
            },
          },
          {
            _identifier: "Devolución a albarán de proveedor",
            _entityName: "ADMenu",
            $ref: "ADMenu/A5A76D4C0D084A80AFB9A2A8F4A0A8AE",
            id: "A5A76D4C0D084A80AFB9A2A8F4A0A8AE",
            name: "Devolución a albarán de proveedor",
            action: "W",
            recordTime: 1726085852887,
            window: {
              _identifier: "Devolución a albarán de proveedor",
              _entityName: "ADWindow",
              $ref: "ADWindow/273673D2ED914C399A6C51DB758BE0F9",
              id: "273673D2ED914C399A6C51DB758BE0F9",
              name: "Devolución a albarán de proveedor",
              windowType: "T",
              recordTime: 1726085852887,
            },
          },
          {
            _identifier: "Landed Cost",
            _entityName: "ADMenu",
            $ref: "ADMenu/D0EB635DAB004B16B636122FEA516898",
            id: "D0EB635DAB004B16B636122FEA516898",
            name: "Landed Cost",
            action: "W",
            recordTime: 1726085852888,
            window: {
              _identifier: "Landed Cost",
              _entityName: "ADWindow",
              $ref: "ADWindow/D1B11CBC0FEF4CA0B44D3BECEBA219BC",
              id: "D1B11CBC0FEF4CA0B44D3BECEBA219BC",
              name: "Landed Cost",
              windowType: "T",
              recordTime: 1726085852888,
            },
          },
        ],
      },
      {
        _identifier: "Herramientas de análisis",
        _entityName: "ADMenu",
        $ref: "ADMenu/800076",
        id: "800076",
        name: "Herramientas de análisis",
        action: null,
        recordTime: 1726085852889,
        icon: "📊",
        children: [
          {
            _identifier: "Informe pedidos de compra ",
            _entityName: "ADMenu",
            $ref: "ADMenu/800229",
            id: "800229",
            name: "Informe pedidos de compra ",
            action: "OBUIAPP_Process",
            recordTime: 1726085852890,
          },
          {
            _identifier: "Análisis dimensional pedidos compras",
            _entityName: "ADMenu",
            $ref: "ADMenu/800266",
            id: "800266",
            name: "Análisis dimensional pedidos compras",
            action: "R",
            recordTime: 1726085852890,
          },
          {
            _identifier: "Análisis dimensional albaranes compras",
            _entityName: "ADMenu",
            $ref: "ADMenu/800267",
            id: "800267",
            name: "Análisis dimensional albaranes compras",
            action: "R",
            recordTime: 1726085852891,
          },
          {
            _identifier: "Análisis dimensional facturas compras",
            _entityName: "ADMenu",
            $ref: "ADMenu/800268",
            id: "800268",
            name: "Análisis dimensional facturas compras",
            action: "R",
            recordTime: 1726085852891,
          },
          {
            _identifier: "Pedidos de compra cuadrados",
            _entityName: "ADMenu",
            $ref: "ADMenu/316",
            id: "316",
            name: "Pedidos de compra cuadrados",
            action: "W",
            recordTime: 1726085852892,
            window: {
              _identifier: "Pedidos de compra cuadrados",
              _entityName: "ADWindow",
              $ref: "ADWindow/228",
              id: "228",
              name: "Pedidos de compra cuadrados",
              windowType: "Q",
              recordTime: 1726085852893,
            },
          },
          {
            _identifier: "Facturas ",
            _entityName: "ADMenu",
            $ref: "ADMenu/800265",
            id: "800265",
            name: "Facturas ",
            action: "R",
            recordTime: 1726085852894,
          },
        ],
      },
    ],
  },
  {
    _identifier: "Gestión de Almacén",
    _entityName: "ADMenu",
    $ref: "ADMenu/800243",
    id: "800243",
    name: "Gestión de Almacén",
    action: null,
    recordTime: 1726085852894,
    icon: "📦",
    children: [
      {
        _identifier: "Transacciones",
        _entityName: "ADMenu",
        $ref: "ADMenu/800244",
        id: "800244",
        name: "Transacciones",
        action: null,
        recordTime: 1726085852895,
        icon: "💶",
        children: [
          {
            _identifier: "Inventario físico",
            _entityName: "ADMenu",
            $ref: "ADMenu/179",
            id: "179",
            name: "Inventario físico",
            action: "W",
            recordTime: 1726085852895,
            window: {
              _identifier: "Inventario físico",
              _entityName: "ADWindow",
              $ref: "ADWindow/168",
              id: "168",
              name: "Inventario físico",
              windowType: "T",
              recordTime: 1726085852896,
            },
          },
          {
            _identifier: "Movimiento entre almacenes",
            _entityName: "ADMenu",
            $ref: "ADMenu/181",
            id: "181",
            name: "Movimiento entre almacenes",
            action: "W",
            recordTime: 1726085852897,
            window: {
              _identifier: "Movimiento entre almacenes",
              _entityName: "ADWindow",
              $ref: "ADWindow/170",
              id: "170",
              name: "Movimiento entre almacenes",
              windowType: "T",
              recordTime: 1726085852897,
            },
          },
          {
            _identifier: "Producción LDM",
            _entityName: "ADMenu",
            $ref: "ADMenu/228",
            id: "228",
            name: "Producción LDM",
            action: "W",
            recordTime: 1726085852898,
            window: {
              _identifier: "Producción LDM",
              _entityName: "ADWindow",
              $ref: "ADWindow/191",
              id: "191",
              name: "Producción LDM",
              windowType: "T",
              recordTime: 1726085852898,
            },
          },
          {
            _identifier: "Operaciones de material (uso indirecto)",
            _entityName: "ADMenu",
            $ref: "ADMenu/292",
            id: "292",
            name: "Operaciones de material (uso indirecto)",
            action: "W",
            recordTime: 1726085852898,
            window: {
              _identifier: "Operaciones de material (uso indirecto)",
              _entityName: "ADWindow",
              $ref: "ADWindow/223",
              id: "223",
              name: "Operaciones de material (uso indirecto)",
              windowType: "Q",
              recordTime: 1726085852899,
            },
          },
          {
            _identifier: "Incoterms",
            _entityName: "ADMenu",
            $ref: "ADMenu/800008",
            id: "800008",
            name: "Incoterms",
            action: "W",
            recordTime: 1726085852899,
            window: {
              _identifier: "Incoterms",
              _entityName: "ADWindow",
              $ref: "ADWindow/800002",
              id: "800002",
              name: "Incoterms",
              windowType: "M",
              recordTime: 1726085852900,
            },
          },
          {
            _identifier: "Reserva de existencias",
            _entityName: "ADMenu",
            $ref: "ADMenu/383A3256E1CD4839A8AE36B3077FF071",
            id: "383A3256E1CD4839A8AE36B3077FF071",
            name: "Reserva de existencias",
            action: "W",
            recordTime: 1726085852900,
            window: {
              _identifier: "Reserva de existencias",
              _entityName: "ADWindow",
              $ref: "ADWindow/C85110C9334B4C26BA29BB3B91000689",
              id: "C85110C9334B4C26BA29BB3B91000689",
              name: "Reserva de existencias",
              windowType: "M",
              recordTime: 1726085852901,
            },
          },
          {
            _identifier: "Ajuste de Valor del Inventario",
            _entityName: "ADMenu",
            $ref: "ADMenu/369F385A56D4448191BCCDB6ABD900A1",
            id: "369F385A56D4448191BCCDB6ABD900A1",
            name: "Ajuste de Valor del Inventario",
            action: "W",
            recordTime: 1726085852901,
            window: {
              _identifier: "Ajuste de Valor del Inventario",
              _entityName: "ADWindow",
              $ref: "ADWindow/E7754848A0314B018B37C1428ECB4D21",
              id: "E7754848A0314B018B37C1428ECB4D21",
              name: "Ajuste de Valor del Inventario",
              windowType: "M",
              recordTime: 1726085852902,
            },
          },
          {
            _identifier: "Ajuste de Costes",
            _entityName: "ADMenu",
            $ref: "ADMenu/D3B15512AB244A9D88AAF4E63C42CEC6",
            id: "D3B15512AB244A9D88AAF4E63C42CEC6",
            name: "Ajuste de Costes",
            action: "W",
            recordTime: 1726085852902,
            window: {
              _identifier: "Ajuste de Costes",
              _entityName: "ADWindow",
              $ref: "ADWindow/1688A758BDA04C88A5C1D370EB979C53",
              id: "1688A758BDA04C88A5C1D370EB979C53",
              name: "Ajuste de Costes",
              windowType: "T",
              recordTime: 1726085852903,
            },
          },
          {
            _identifier: "Inventario Referenciado",
            _entityName: "ADMenu",
            $ref: "ADMenu/8BF3C57A58984F59B30B5855ED4E259A",
            id: "8BF3C57A58984F59B30B5855ED4E259A",
            name: "Inventario Referenciado",
            action: "W",
            recordTime: 1726085852903,
            window: {
              _identifier: "Inventario Referenciado",
              _entityName: "ADWindow",
              $ref: "ADWindow/6A5963EA222743ACB44F9C65DF7F658C",
              id: "6A5963EA222743ACB44F9C65DF7F658C",
              name: "Inventario Referenciado",
              windowType: "T",
              recordTime: 1726085852904,
            },
          },
        ],
      },
      {
        _identifier: "Herramientas de análisis",
        _entityName: "ADMenu",
        $ref: "ADMenu/800078",
        id: "800078",
        name: "Herramientas de análisis",
        action: null,
        recordTime: 1726085852905,
        icon: "📊",
        children: [
          {
            _identifier: "Informe Pareto de Productos",
            _entityName: "ADMenu",
            $ref: "ADMenu/8521FBEB13094CE1B80F1F9326C847E8",
            id: "8521FBEB13094CE1B80F1F9326C847E8",
            name: "Informe Pareto de Productos",
            action: "R",
            recordTime: 1726085852905,
          },
          {
            _identifier: "Informe Caducidades",
            _entityName: "ADMenu",
            $ref: "ADMenu/800264",
            id: "800264",
            name: "Informe Caducidades",
            action: "R",
            recordTime: 1726085852906,
          },
          {
            _identifier: "Informe ofertas",
            _entityName: "ADMenu",
            $ref: "ADMenu/800202",
            id: "800202",
            name: "Informe ofertas",
            action: "R",
            recordTime: 1726085852907,
          },
          {
            _identifier: "Informe transportista",
            _entityName: "ADMenu",
            $ref: "ADMenu/800197",
            id: "800197",
            name: "Informe transportista",
            action: "R",
            recordTime: 1726085852907,
          },
          {
            _identifier: "Informe Trazabilidad",
            _entityName: "ADMenu",
            $ref: "ADMenu/800089",
            id: "800089",
            name: "Informe Trazabilidad",
            action: "R",
            recordTime: 1726085852908,
          },
          {
            _identifier: "Informe Transacción de Material",
            _entityName: "ADMenu",
            $ref: "ADMenu/800020",
            id: "800020",
            name: "Informe Transacción de Material",
            action: "R",
            recordTime: 1726085852909,
          },
          {
            _identifier: "Informe Control Almacén",
            _entityName: "ADMenu",
            $ref: "ADMenu/800039",
            id: "800039",
            name: "Informe Control Almacén",
            action: "R",
            recordTime: 1726085852911,
          },
          {
            _identifier: "Informe Stock",
            _entityName: "ADMenu",
            $ref: "ADMenu/800270",
            id: "800270",
            name: "Informe Stock",
            action: "R",
            recordTime: 1726085852911,
          },
          {
            _identifier: "Informe Movimiento de Productos",
            _entityName: "ADMenu",
            $ref: "ADMenu/800052",
            id: "800052",
            name: "Informe Movimiento de Productos",
            action: "R",
            recordTime: 1726085852912,
          },
          {
            _identifier: "Informe de Valuación de Existencias",
            _entityName: "ADMenu",
            $ref: "ADMenu/203EFE8B46AD4F819BAF558BF4477AA7",
            id: "203EFE8B46AD4F819BAF558BF4477AA7",
            name: "Informe de Valuación de Existencias",
            action: "OBUIAPP_Process",
            recordTime: 1726085852912,
          },
          {
            _identifier: "Informe Producción",
            _entityName: "ADMenu",
            $ref: "ADMenu/800259",
            id: "800259",
            name: "Informe Producción",
            action: "R",
            recordTime: 1726085852913,
          },
        ],
      },
      {
        _identifier: "Configuración",
        _entityName: "ADMenu",
        $ref: "ADMenu/800256",
        id: "800256",
        name: "Configuración",
        action: null,
        recordTime: 1726085852913,
        icon: "⚙️",
        children: [
          {
            _identifier: "Reinicializar Coste Unitario",
            _entityName: "ADMenu",
            $ref: "ADMenu/308B984799CC4F5EBE5A5AC298EB260D",
            id: "308B984799CC4F5EBE5A5AC298EB260D",
            name: "Reinicializar Coste Unitario",
            action: "OBUIAPP_Process",
            recordTime: 1726085852914,
          },
          {
            _identifier: "Procesar Ajuste de Diferencias de Precio",
            _entityName: "ADMenu",
            $ref: "ADMenu/E6903C6E20814C82BF1CA9C92847A8A5",
            id: "E6903C6E20814C82BF1CA9C92847A8A5",
            name: "Procesar Ajuste de Diferencias de Precio",
            action: "OBUIAPP_Process",
            recordTime: 1726085852914,
          },
          {
            _identifier: "Almacén y huecos",
            _entityName: "ADMenu",
            $ref: "ADMenu/125",
            id: "125",
            name: "Almacén y huecos",
            action: "W",
            recordTime: 1726085852914,
            window: {
              _identifier: "Almacén y huecos",
              _entityName: "ADWindow",
              $ref: "ADWindow/139",
              id: "139",
              name: "Almacén y huecos",
              windowType: "M",
              recordTime: 1726085852915,
            },
          },
          {
            _identifier: "Transportista",
            _entityName: "ADMenu",
            $ref: "ADMenu/128",
            id: "128",
            name: "Transportista",
            action: "W",
            recordTime: 1726085852915,
            window: {
              _identifier: "Transportista",
              _entityName: "ADWindow",
              $ref: "ADWindow/142",
              id: "142",
              name: "Transportista",
              windowType: "M",
              recordTime: 1726085852916,
            },
          },
          {
            _identifier: "Categoría portes",
            _entityName: "ADMenu",
            $ref: "ADMenu/381",
            id: "381",
            name: "Categoría portes",
            action: "W",
            recordTime: 1726085852917,
            window: {
              _identifier: "Categoría portes",
              _entityName: "ADWindow",
              $ref: "ADWindow/282",
              id: "282",
              name: "Categoría portes",
              windowType: "M",
              recordTime: 1726085852917,
            },
          },
          {
            _identifier: "Reglas de cálculo de costes",
            _entityName: "ADMenu",
            $ref: "ADMenu/A519EEB1C1994CCF8208E5B73B5A04C6",
            id: "A519EEB1C1994CCF8208E5B73B5A04C6",
            name: "Reglas de cálculo de costes",
            action: "W",
            recordTime: 1726085852918,
            window: {
              _identifier: "Reglas de cálculo de costes",
              _entityName: "ADWindow",
              $ref: "ADWindow/3E945A9102144C16BD211D211089C2DF",
              id: "3E945A9102144C16BD211D211089C2DF",
              name: "Reglas de cálculo de costes",
              windowType: "M",
              recordTime: 1726085852919,
            },
          },
          {
            _identifier: "Algoritmo de cálculo de costes",
            _entityName: "ADMenu",
            $ref: "ADMenu/08B67705E5B44C5DB2196B9A1CD1ABD7",
            id: "08B67705E5B44C5DB2196B9A1CD1ABD7",
            name: "Algoritmo de cálculo de costes",
            action: "W",
            recordTime: 1726085852919,
            window: {
              _identifier: "Algoritmo de cálculo de costes",
              _entityName: "ADWindow",
              $ref: "ADWindow/6CB90FC76E2E4CD3A6AF472E39C042B6",
              id: "6CB90FC76E2E4CD3A6AF472E39C042B6",
              name: "Algoritmo de cálculo de costes",
              windowType: "M",
              recordTime: 1726085852920,
            },
          },
          {
            _identifier: "Tipo de Landed Cost",
            _entityName: "ADMenu",
            $ref: "ADMenu/70EA2A01CB2444FC9F2139FCEB9BA7D7",
            id: "70EA2A01CB2444FC9F2139FCEB9BA7D7",
            name: "Tipo de Landed Cost",
            action: "W",
            recordTime: 1726085852920,
            window: {
              _identifier: "Tipo de Landed Cost",
              _entityName: "ADWindow",
              $ref: "ADWindow/944C49CE80BE4F71B9917BD680A052A8",
              id: "944C49CE80BE4F71B9917BD680A052A8",
              name: "Tipo de Landed Cost",
              windowType: "M",
              recordTime: 1726085852921,
            },
          },
          {
            _identifier: "Reglas de almacén",
            _entityName: "ADMenu",
            $ref: "ADMenu/BC399BACA2F34B968C54555D79ED66A7",
            id: "BC399BACA2F34B968C54555D79ED66A7",
            name: "Reglas de almacén",
            action: "W",
            recordTime: 1726085852921,
            window: {
              _identifier: "Reglas de almacén",
              _entityName: "ADWindow",
              $ref: "ADWindow/FC404D2406A9491CBD905D0D38F04846",
              id: "FC404D2406A9491CBD905D0D38F04846",
              name: "Reglas de almacén",
              windowType: "M",
              recordTime: 1726085852921,
            },
          },
          {
            _identifier: "Tipo de Inventario Referenciado",
            _entityName: "ADMenu",
            $ref: "ADMenu/418B86D4BFFE468290A9C08C38600B09",
            id: "418B86D4BFFE468290A9C08C38600B09",
            name: "Tipo de Inventario Referenciado",
            action: "W",
            recordTime: 1726085852922,
            window: {
              _identifier: "Tipo de Inventario Referenciado",
              _entityName: "ADWindow",
              $ref: "ADWindow/3DA7267B2FEC42B287B4428DF658C7E5",
              id: "3DA7267B2FEC42B287B4428DF658C7E5",
              name: "Tipo de Inventario Referenciado",
              windowType: "M",
              recordTime: 1726085852922,
            },
          },
        ],
      },
    ],
  },
  {
    _identifier: "Gestión de Producción",
    _entityName: "ADMenu",
    $ref: "ADMenu/800121",
    id: "800121",
    name: "Gestión de Producción",
    action: null,
    recordTime: 1726085852923,
    icon: "🏭",
    children: [
      {
        _identifier: "Transacciones",
        _entityName: "ADMenu",
        $ref: "ADMenu/800245",
        id: "800245",
        name: "Transacciones",
        action: null,
        recordTime: 1726085852923,
        icon: "💶",
        children: [
          {
            _identifier: "Orden de Fabricación",
            _entityName: "ADMenu",
            $ref: "ADMenu/800138",
            id: "800138",
            name: "Orden de Fabricación",
            action: "W",
            recordTime: 1726085852923,
            window: {
              _identifier: "Orden de Fabricación",
              _entityName: "ADWindow",
              $ref: "ADWindow/800052",
              id: "800052",
              name: "Orden de Fabricación",
              windowType: "T",
              recordTime: 1726085852924,
            },
          },
          {
            _identifier: "Parte de Trabajo",
            _entityName: "ADMenu",
            $ref: "ADMenu/800139",
            id: "800139",
            name: "Parte de Trabajo",
            action: "W",
            recordTime: 1726085852924,
            window: {
              _identifier: "Parte de Trabajo",
              _entityName: "ADWindow",
              $ref: "ADWindow/800053",
              id: "800053",
              name: "Parte de Trabajo",
              windowType: "T",
              recordTime: 1726085852925,
            },
          },
          {
            _identifier: "Parte de Fabricación",
            _entityName: "ADMenu",
            $ref: "ADMenu/FF808181323E504701323E5E20F10063",
            id: "FF808181323E504701323E5E20F10063",
            name: "Parte de Fabricación",
            action: "W",
            recordTime: 1726085852925,
            window: {
              _identifier: "Parte de Fabricación",
              _entityName: "ADWindow",
              $ref: "ADWindow/FF808181323E504701323E57E08D0017",
              id: "FF808181323E504701323E57E08D0017",
              name: "Parte de Fabricación",
              windowType: "M",
              recordTime: 1726085852926,
            },
          },
          {
            _identifier: "Toma de Datos de PCC",
            _entityName: "ADMenu",
            $ref: "ADMenu/800169",
            id: "800169",
            name: "Toma de Datos de PCC",
            action: "W",
            recordTime: 1726085852927,
            window: {
              _identifier: "Toma de Datos de PCC",
              _entityName: "ADWindow",
              $ref: "ADWindow/800064",
              id: "800064",
              name: "Toma de Datos de PCC",
              windowType: "M",
              recordTime: 1726085852928,
            },
          },
          {
            _identifier: "Datos del control de calidad periódico",
            _entityName: "ADMenu",
            $ref: "ADMenu/800173",
            id: "800173",
            name: "Datos del control de calidad periódico",
            action: "W",
            recordTime: 1726085852929,
            window: {
              _identifier: "Datos del control de calidad periódico",
              _entityName: "ADWindow",
              $ref: "ADWindow/800067",
              id: "800067",
              name: "Datos del control de calidad periódico",
              windowType: "M",
              recordTime: 1726085852929,
            },
          },
          {
            _identifier: "Consumo interno",
            _entityName: "ADMenu",
            $ref: "ADMenu/800188",
            id: "800188",
            name: "Consumo interno",
            action: "W",
            recordTime: 1726085852930,
            window: {
              _identifier: "Consumo interno",
              _entityName: "ADWindow",
              $ref: "ADWindow/800076",
              id: "800076",
              name: "Consumo interno",
              windowType: "M",
              recordTime: 1726085852931,
            },
          },
          {
            _identifier: "Parte de Mantenimiento",
            _entityName: "ADMenu",
            $ref: "ADMenu/800185",
            id: "800185",
            name: "Parte de Mantenimiento",
            action: "W",
            recordTime: 1726085852931,
            window: {
              _identifier: "Parte de Mantenimiento",
              _entityName: "ADWindow",
              $ref: "ADWindow/800075",
              id: "800075",
              name: "Parte de Mantenimiento",
              windowType: "M",
              recordTime: 1726085852932,
            },
          },
          {
            _identifier: "Insertar Mantenimientos",
            _entityName: "ADMenu",
            $ref: "ADMenu/800186",
            id: "800186",
            name: "Insertar Mantenimientos",
            action: "P",
            recordTime: 1726085852933,
          },
          {
            _identifier: "Mantenimiento Programado",
            _entityName: "ADMenu",
            $ref: "ADMenu/800184",
            id: "800184",
            name: "Mantenimiento Programado",
            action: "W",
            recordTime: 1726085852933,
            window: {
              _identifier: "Mantenimiento Programado",
              _entityName: "ADWindow",
              $ref: "ADWindow/800074",
              id: "800074",
              name: "Mantenimiento Programado",
              windowType: "M",
              recordTime: 1726085852934,
            },
          },
          {
            _identifier: "Calcular costo estándar",
            _entityName: "ADMenu",
            $ref: "ADMenu/800160",
            id: "800160",
            name: "Calcular costo estándar",
            action: "P",
            recordTime: 1726085852936,
          },
        ],
      },
      {
        _identifier: "Herramientas de análisis",
        _entityName: "ADMenu",
        $ref: "ADMenu/800141",
        id: "800141",
        name: "Herramientas de análisis",
        action: null,
        recordTime: 1726085852938,
        icon: "📊",
        children: [
          {
            _identifier: "Costo estándar ",
            _entityName: "ADMenu",
            $ref: "ADMenu/800287",
            id: "800287",
            name: "Costo estándar ",
            action: "R",
            recordTime: 1726085852939,
          },
          {
            _identifier: "Informe Partes de Fabricación ",
            _entityName: "ADMenu",
            $ref: "ADMenu/800258",
            id: "800258",
            name: "Informe Partes de Fabricación ",
            action: "R",
            recordTime: 1726085852941,
          },
          {
            _identifier: "Fases de OF a realizar ",
            _entityName: "ADMenu",
            $ref: "ADMenu/800262",
            id: "800262",
            name: "Fases de OF a realizar ",
            action: "R",
            recordTime: 1726085852942,
          },
          {
            _identifier: "Costo de producción",
            _entityName: "ADMenu",
            $ref: "ADMenu/800210",
            id: "800210",
            name: "Costo de producción",
            action: "R",
            recordTime: 1726085852943,
          },
        ],
      },
      {
        _identifier: "Configuración",
        _entityName: "ADMenu",
        $ref: "ADMenu/800189",
        id: "800189",
        name: "Configuración",
        action: null,
        recordTime: 1726085852944,
        icon: "⚙️",
        children: [
          {
            _identifier: "Área",
            _entityName: "ADMenu",
            $ref: "ADMenu/800123",
            id: "800123",
            name: "Área",
            action: "W",
            recordTime: 1726085852945,
            window: {
              _identifier: "Área",
              _entityName: "ADWindow",
              $ref: "ADWindow/800029",
              id: "800029",
              name: "Área",
              windowType: "M",
              recordTime: 1726085852945,
            },
          },
          {
            _identifier: "Puesto Trabajo",
            _entityName: "ADMenu",
            $ref: "ADMenu/800126",
            id: "800126",
            name: "Puesto Trabajo",
            action: "W",
            recordTime: 1726085852946,
            window: {
              _identifier: "Puesto Trabajo",
              _entityName: "ADWindow",
              $ref: "ADWindow/800032",
              id: "800032",
              name: "Puesto Trabajo",
              windowType: "M",
              recordTime: 1726085852947,
            },
          },
          {
            _identifier: "Plan de Producción",
            _entityName: "ADMenu",
            $ref: "ADMenu/800137",
            id: "800137",
            name: "Plan de Producción",
            action: "W",
            recordTime: 1726085852947,
            window: {
              _identifier: "Plan de Producción",
              _entityName: "ADWindow",
              $ref: "ADWindow/800051",
              id: "800051",
              name: "Plan de Producción",
              windowType: "M",
              recordTime: 1726085852948,
            },
          },
          {
            _identifier: "Proceso",
            _entityName: "ADMenu",
            $ref: "ADMenu/800159",
            id: "800159",
            name: "Proceso",
            action: "W",
            recordTime: 1726085852948,
            window: {
              _identifier: "Proceso",
              _entityName: "ADWindow",
              $ref: "ADWindow/800060",
              id: "800060",
              name: "Proceso",
              windowType: "M",
              recordTime: 1726085852948,
            },
          },
          {
            _identifier: "Utillajes",
            _entityName: "ADMenu",
            $ref: "ADMenu/800128",
            id: "800128",
            name: "Utillajes",
            action: "W",
            recordTime: 1726085852949,
            window: {
              _identifier: "Utillajes",
              _entityName: "ADWindow",
              $ref: "ADWindow/800035",
              id: "800035",
              name: "Utillajes",
              windowType: "M",
              recordTime: 1726085852949,
            },
          },
          {
            _identifier: "Tipo de Máquina",
            _entityName: "ADMenu",
            $ref: "ADMenu/800182",
            id: "800182",
            name: "Tipo de Máquina",
            action: "W",
            recordTime: 1726085852950,
            window: {
              _identifier: "Tipo de Máquina",
              _entityName: "ADWindow",
              $ref: "ADWindow/800071",
              id: "800071",
              name: "Tipo de Máquina",
              windowType: "M",
              recordTime: 1726085852950,
            },
          },
          {
            _identifier: "Máquina",
            _entityName: "ADMenu",
            $ref: "ADMenu/800125",
            id: "800125",
            name: "Máquina",
            action: "W",
            recordTime: 1726085852951,
            window: {
              _identifier: "Máquina",
              _entityName: "ADWindow",
              $ref: "ADWindow/800031",
              id: "800031",
              name: "Máquina",
              windowType: "M",
              recordTime: 1726085852952,
            },
          },
          {
            _identifier: "Centro de Costos",
            _entityName: "ADMenu",
            $ref: "ADMenu/800124",
            id: "800124",
            name: "Centro de Costos",
            action: "W",
            recordTime: 1726085852952,
            window: {
              _identifier: "Centro de Costos",
              _entityName: "ADWindow",
              $ref: "ADWindow/800030",
              id: "800030",
              name: "Centro de Costos",
              windowType: "M",
              recordTime: 1726085852953,
            },
          },
          {
            _identifier: "Control Periódico",
            _entityName: "ADMenu",
            $ref: "ADMenu/800172",
            id: "800172",
            name: "Control Periódico",
            action: "W",
            recordTime: 1726085852953,
            window: {
              _identifier: "Control Periódico",
              _entityName: "ADWindow",
              $ref: "ADWindow/800066",
              id: "800066",
              name: "Control Periódico",
              windowType: "M",
              recordTime: 1726085852954,
            },
          },
          {
            _identifier: "Punto de Control Crítico",
            _entityName: "ADMenu",
            $ref: "ADMenu/800168",
            id: "800168",
            name: "Punto de Control Crítico",
            action: "W",
            recordTime: 1726085852954,
            window: {
              _identifier: "Punto de Control Crítico",
              _entityName: "ADWindow",
              $ref: "ADWindow/800063",
              id: "800063",
              name: "Punto de Control Crítico",
              windowType: "M",
              recordTime: 1726085852955,
            },
          },
          {
            _identifier: "Incidencia de Trabajo",
            _entityName: "ADMenu",
            $ref: "ADMenu/800133",
            id: "800133",
            name: "Incidencia de Trabajo",
            action: "W",
            recordTime: 1726085852955,
            window: {
              _identifier: "Incidencia de Trabajo",
              _entityName: "ADWindow",
              $ref: "ADWindow/800048",
              id: "800048",
              name: "Incidencia de Trabajo",
              windowType: "M",
              recordTime: 1726085852956,
            },
          },
          {
            _identifier: "Operación de Mantenimiento",
            _entityName: "ADMenu",
            $ref: "ADMenu/800183",
            id: "800183",
            name: "Operación de Mantenimiento",
            action: "W",
            recordTime: 1726085852957,
            window: {
              _identifier: "Operación de Mantenimiento",
              _entityName: "ADWindow",
              $ref: "ADWindow/800072",
              id: "800072",
              name: "Operación de Mantenimiento",
              windowType: "M",
              recordTime: 1726085852958,
            },
          },
          {
            _identifier: "Costo Indirecto",
            _entityName: "ADMenu",
            $ref: "ADMenu/800204",
            id: "800204",
            name: "Costo Indirecto",
            action: "W",
            recordTime: 1726085852959,
            window: {
              _identifier: "Costo Indirecto",
              _entityName: "ADWindow",
              $ref: "ADWindow/800085",
              id: "800085",
              name: "Costo Indirecto",
              windowType: "M",
              recordTime: 1726085852960,
            },
          },
        ],
      },
    ],
  },
  {
    _identifier: "Intrastat",
    _entityName: "ADMenu",
    $ref: "ADMenu/71E5519B3FFF43AEA187A0A8207DFF90",
    id: "71E5519B3FFF43AEA187A0A8207DFF90",
    name: "Intrastat",
    action: null,
    recordTime: 1726085852961,
    icon: "🇪🇺",
    children: [
      {
        _identifier: "Herramientas de análisis",
        _entityName: "ADMenu",
        $ref: "ADMenu/F11FC6C518B149AFAB4DAED58751119C",
        id: "F11FC6C518B149AFAB4DAED58751119C",
        name: "Herramientas de análisis",
        action: null,
        recordTime: 1726085852962,
        icon: "📊",
        children: [
          {
            _identifier: "Generador de Intrastat",
            _entityName: "ADMenu",
            $ref: "ADMenu/6BB21439445C4B04B451275A38D85273",
            id: "6BB21439445C4B04B451275A38D85273",
            name: "Generador de Intrastat",
            action: "R",
            recordTime: 1726085852962,
          },
          {
            _identifier: "Declaración de Intrastat",
            _entityName: "ADMenu",
            $ref: "ADMenu/11C1320B91BF4527A418F09CE98AD45D",
            id: "11C1320B91BF4527A418F09CE98AD45D",
            name: "Declaración de Intrastat",
            action: "W",
            recordTime: 1726085852963,
            window: {
              _identifier: "Declaración de Intrastat",
              _entityName: "ADWindow",
              $ref: "ADWindow/48ED3B9E5CE84A3C8A7A0BEE55528428",
              id: "48ED3B9E5CE84A3C8A7A0BEE55528428",
              name: "Declaración de Intrastat",
              windowType: "M",
              recordTime: 1726085852964,
            },
          },
        ],
      },
      {
        _identifier: "Configuración",
        _entityName: "ADMenu",
        $ref: "ADMenu/C3805F4FAB2E491B8B18D5F6CB4F1737",
        id: "C3805F4FAB2E491B8B18D5F6CB4F1737",
        name: "Configuración",
        action: null,
        recordTime: 1726085852964,
        icon: "⚙️",
        children: [
          {
            _identifier: "Configuración del Fichero Intrastat",
            _entityName: "ADMenu",
            $ref: "ADMenu/F9C8D14E7D1846109FF4E5B56B6B8775",
            id: "F9C8D14E7D1846109FF4E5B56B6B8775",
            name: "Configuración del Fichero Intrastat",
            action: "W",
            recordTime: 1726085852965,
            window: {
              _identifier: "Configuración del Fichero Intrastat",
              _entityName: "ADWindow",
              $ref: "ADWindow/8FD660267E104EDEA9BE5F2B10ACE35B",
              id: "8FD660267E104EDEA9BE5F2B10ACE35B",
              name: "Configuración del Fichero Intrastat",
              windowType: "M",
              recordTime: 1726085852965,
            },
          },
        ],
      },
    ],
  },
  {
    _identifier: "Gestión de MRP",
    _entityName: "ADMenu",
    $ref: "ADMenu/800212",
    id: "800212",
    name: "Gestión de MRP",
    action: null,
    recordTime: 1726085852966,
    icon: "📦",
    children: [
      {
        _identifier: "Transacciones",
        _entityName: "ADMenu",
        $ref: "ADMenu/800247",
        id: "800247",
        name: "Transacciones",
        action: null,
        recordTime: 1726085852966,
        icon: "💶",
        children: [
          {
            _identifier: "Planificación de la producción",
            _entityName: "ADMenu",
            $ref: "ADMenu/800220",
            id: "800220",
            name: "Planificación de la producción",
            action: "W",
            recordTime: 1726085852967,
            window: {
              _identifier: "Planificación de la producción",
              _entityName: "ADWindow",
              $ref: "ADWindow/800096",
              id: "800096",
              name: "Planificación de la producción",
              windowType: "M",
              recordTime: 1726085852967,
            },
          },
          {
            _identifier: "Planificación de compras",
            _entityName: "ADMenu",
            $ref: "ADMenu/800221",
            id: "800221",
            name: "Planificación de compras",
            action: "W",
            recordTime: 1726085852968,
            window: {
              _identifier: "Planificación de compras",
              _entityName: "ADWindow",
              $ref: "ADWindow/800097",
              id: "800097",
              name: "Planificación de compras",
              windowType: "M",
              recordTime: 1726085852968,
            },
          },
          {
            _identifier: "Previsión de ventas",
            _entityName: "ADMenu",
            $ref: "ADMenu/800214",
            id: "800214",
            name: "Previsión de ventas",
            action: "W",
            recordTime: 1726085852969,
            window: {
              _identifier: "Previsión de ventas",
              _entityName: "ADWindow",
              $ref: "ADWindow/800090",
              id: "800090",
              name: "Previsión de ventas",
              windowType: "M",
              recordTime: 1726085852969,
            },
          },
        ],
      },
      {
        _identifier: "Configuración",
        _entityName: "ADMenu",
        $ref: "ADMenu/800248",
        id: "800248",
        name: "Configuración",
        action: null,
        recordTime: 1726085852970,
        icon: "⚙️",
        children: [
          {
            _identifier: "Método de planificación",
            _entityName: "ADMenu",
            $ref: "ADMenu/800218",
            id: "800218",
            name: "Método de planificación",
            action: "W",
            recordTime: 1726085852970,
            window: {
              _identifier: "Método de planificación",
              _entityName: "ADWindow",
              $ref: "ADWindow/800094",
              id: "800094",
              name: "Método de planificación",
              windowType: "M",
              recordTime: 1726085852970,
            },
          },
          {
            _identifier: "Planificador",
            _entityName: "ADMenu",
            $ref: "ADMenu/800213",
            id: "800213",
            name: "Planificador",
            action: "W",
            recordTime: 1726085852971,
            window: {
              _identifier: "Planificador",
              _entityName: "ADWindow",
              $ref: "ADWindow/800088",
              id: "800088",
              name: "Planificador",
              windowType: "M",
              recordTime: 1726085852972,
            },
          },
        ],
      },
    ],
  },
  {
    _identifier: "Gestión de Ventas",
    _entityName: "ADMenu",
    $ref: "ADMenu/166",
    id: "166",
    name: "Gestión de Ventas",
    action: null,
    recordTime: 1726085852972,
    icon: "🧾",
    children: [
      {
        _identifier: "Transacciones",
        _entityName: "ADMenu",
        $ref: "ADMenu/800249",
        id: "800249",
        name: "Transacciones",
        action: null,
        recordTime: 1726085852973,
        icon: "💶",
        children: [
          {
            _identifier: "Presupuesto de ventas",
            _entityName: "ADMenu",
            $ref: "ADMenu/EFC616EE0EA04A9ABB47E793A0D8F671",
            id: "EFC616EE0EA04A9ABB47E793A0D8F671",
            name: "Presupuesto de ventas",
            action: "W",
            recordTime: 1726085852973,
            window: {
              _identifier: "Presupuesto de ventas",
              _entityName: "ADWindow",
              $ref: "ADWindow/6CB5B67ED33F47DFA334079D3EA2340E",
              id: "6CB5B67ED33F47DFA334079D3EA2340E",
              name: "Presupuesto de ventas",
              windowType: "T",
              recordTime: 1726085852974,
            },
          },
          {
            _identifier: "TBAI Facturas Enviadas",
            _entityName: "ADMenu",
            $ref: "ADMenu/C175AD1093E7460897FE2164D1AE7706",
            id: "C175AD1093E7460897FE2164D1AE7706",
            name: "TBAI Facturas Enviadas",
            action: "W",
            recordTime: 1726085852974,
            window: {
              _identifier: "TBAI Facturas Enviadas",
              _entityName: "ADWindow",
              $ref: "ADWindow/71F24BF89DE748B483BE87594747D6FB",
              id: "71F24BF89DE748B483BE87594747D6FB",
              name: "TBAI Facturas Enviadas",
              windowType: "M",
              recordTime: 1726085852975,
            },
          },
          {
            _identifier: "Pedido de venta",
            _entityName: "ADMenu",
            $ref: "ADMenu/129",
            id: "129",
            name: "Pedido de venta",
            action: "W",
            recordTime: 1726085852975,
            window: {
              _identifier: "Pedido de venta",
              _entityName: "ADWindow",
              $ref: "ADWindow/143",
              id: "143",
              name: "Pedido de venta",
              windowType: "T",
              recordTime: 1726085852976,
            },
          },
          {
            _identifier: "Albarán (Cliente)",
            _entityName: "ADMenu",
            $ref: "ADMenu/180",
            id: "180",
            name: "Albarán (Cliente)",
            action: "W",
            recordTime: 1726085852977,
            window: {
              _identifier: "Albarán (Cliente)",
              _entityName: "ADWindow",
              $ref: "ADWindow/169",
              id: "169",
              name: "Albarán (Cliente)",
              windowType: "T",
              recordTime: 1726085852978,
            },
          },
          {
            _identifier: "Devolución de cliente",
            _entityName: "ADMenu",
            $ref: "ADMenu/FF8080813302598D0133026072770003",
            id: "FF8080813302598D0133026072770003",
            name: "Devolución de cliente",
            action: "W",
            recordTime: 1726085852978,
            window: {
              _identifier: "Devolución de cliente",
              _entityName: "ADWindow",
              $ref: "ADWindow/FF808081330213E60133021822E40007",
              id: "FF808081330213E60133021822E40007",
              name: "Devolución de cliente",
              windowType: "T",
              recordTime: 1726085852978,
            },
          },
          {
            _identifier: "Recibo devolución de material",
            _entityName: "ADMenu",
            $ref: "ADMenu/53C26F9057764F6DA861E00B14758E53",
            id: "53C26F9057764F6DA861E00B14758E53",
            name: "Recibo devolución de material",
            action: "W",
            recordTime: 1726085852979,
            window: {
              _identifier: "Recibo devolución de material",
              _entityName: "ADWindow",
              $ref: "ADWindow/123271B9AD60469BAE8A924841456B63",
              id: "123271B9AD60469BAE8A924841456B63",
              name: "Recibo devolución de material",
              windowType: "T",
              recordTime: 1726085852979,
            },
          },
          {
            _identifier: "Generar albaranes (manualmente)",
            _entityName: "ADMenu",
            $ref: "ADMenu/346",
            id: "346",
            name: "Generar albaranes (manualmente)",
            action: "X",
            recordTime: 1726085852980,
          },
          {
            _identifier: "Factura (Cliente)",
            _entityName: "ADMenu",
            $ref: "ADMenu/178",
            id: "178",
            name: "Factura (Cliente)",
            action: "W",
            recordTime: 1726085852980,
            window: {
              _identifier: "Factura (Cliente)",
              _entityName: "ADWindow",
              $ref: "ADWindow/167",
              id: "167",
              name: "Factura (Cliente)",
              windowType: "T",
              recordTime: 1726085852980,
            },
          },
          {
            _identifier: "Crear facturas desde pedidos",
            _entityName: "ADMenu",
            $ref: "ADMenu/28D5CB59D59243FAA495AABD3775C692",
            id: "28D5CB59D59243FAA495AABD3775C692",
            name: "Crear facturas desde pedidos",
            action: "OBUIAPP_Process",
            recordTime: 1726085852981,
          },
          {
            _identifier: "Facturar",
            _entityName: "ADMenu",
            $ref: "ADMenu/192",
            id: "192",
            name: "Facturar",
            action: "P",
            recordTime: 1726085852981,
          },
          {
            _identifier: "Procesar comisión",
            _entityName: "ADMenu",
            $ref: "ADMenu/264",
            id: "264",
            name: "Procesar comisión",
            action: "W",
            recordTime: 1726085852981,
            window: {
              _identifier: "Procesar comisión",
              _entityName: "ADWindow",
              $ref: "ADWindow/210",
              id: "210",
              name: "Procesar comisión",
              windowType: "T",
              recordTime: 1726085852982,
            },
          },
        ],
      },
      {
        _identifier: "Herramientas de análisis",
        _entityName: "ADMenu",
        $ref: "ADMenu/800075",
        id: "800075",
        name: "Herramientas de análisis",
        action: null,
        recordTime: 1726085852982,
        icon: "📊",
        children: [
          {
            _identifier: "Análisis dimensional pedidos ventas",
            _entityName: "ADMenu",
            $ref: "ADMenu/800269",
            id: "800269",
            name: "Análisis dimensional pedidos ventas",
            action: "R",
            recordTime: 1726085852982,
          },
          {
            _identifier: "Análisis dimensional albaranes ventas",
            _entityName: "ADMenu",
            $ref: "ADMenu/800067",
            id: "800067",
            name: "Análisis dimensional albaranes ventas",
            action: "R",
            recordTime: 1726085852983,
          },
          {
            _identifier: "Descuentos ",
            _entityName: "ADMenu",
            $ref: "ADMenu/800279",
            id: "800279",
            name: "Descuentos ",
            action: "R",
            recordTime: 1726085852983,
          },
          {
            _identifier: "Pedidos ",
            _entityName: "ADMenu",
            $ref: "ADMenu/800261",
            id: "800261",
            name: "Pedidos ",
            action: "R",
            recordTime: 1726085852983,
          },
          {
            _identifier: "Informe pedidos pendientes y stock ",
            _entityName: "ADMenu",
            $ref: "ADMenu/800282",
            id: "800282",
            name: "Informe pedidos pendientes y stock ",
            action: "R",
            recordTime: 1726085852983,
          },
          {
            _identifier: "Pedidos facturados ",
            _entityName: "ADMenu",
            $ref: "ADMenu/800069",
            id: "800069",
            name: "Pedidos facturados ",
            action: "R",
            recordTime: 1726085852984,
          },
          {
            _identifier: "Pedidos no facturados ",
            _entityName: "ADMenu",
            $ref: "ADMenu/800263",
            id: "800263",
            name: "Pedidos no facturados ",
            action: "R",
            recordTime: 1726085852984,
          },
          {
            _identifier: "Pedidos suministrados ",
            _entityName: "ADMenu",
            $ref: "ADMenu/800031",
            id: "800031",
            name: "Pedidos suministrados ",
            action: "R",
            recordTime: 1726085852984,
          },
          {
            _identifier: "Albaranes ",
            _entityName: "ADMenu",
            $ref: "ADMenu/800015",
            id: "800015",
            name: "Albaranes ",
            action: "R",
            recordTime: 1726085852984,
          },
          {
            _identifier: "Informe de Pedidos a la Espera de Entrega",
            _entityName: "ADMenu",
            $ref: "ADMenu/1AC604AA78444D47BDA43F53DC050912",
            id: "1AC604AA78444D47BDA43F53DC050912",
            name: "Informe de Pedidos a la Espera de Entrega",
            action: "R",
            recordTime: 1726085852985,
          },
          {
            _identifier: "Detalle facturas ",
            _entityName: "ADMenu",
            $ref: "ADMenu/800285",
            id: "800285",
            name: "Detalle facturas ",
            action: "R",
            recordTime: 1726085852985,
          },
          {
            _identifier: "Facturas ",
            _entityName: "ADMenu",
            $ref: "ADMenu/800260",
            id: "800260",
            name: "Facturas ",
            action: "R",
            recordTime: 1726085852985,
          },
          {
            _identifier: "Análisis dimensional facturas ventas",
            _entityName: "ADMenu",
            $ref: "ADMenu/26BF4F6D476E4D0CAF5E62EBC63E440E",
            id: "26BF4F6D476E4D0CAF5E62EBC63E440E",
            name: "Análisis dimensional facturas ventas",
            action: "R",
            recordTime: 1726085852985,
          },
        ],
      },
      {
        _identifier: "Configuración",
        _entityName: "ADMenu",
        $ref: "ADMenu/272",
        id: "272",
        name: "Configuración",
        action: null,
        recordTime: 1726085852985,
        icon: "⚙️",
        children: [
          {
            _identifier: "Estado del producto",
            _entityName: "ADMenu",
            $ref: "ADMenu/C62EBC52C8DF463B9B720D52F250A8CF",
            id: "C62EBC52C8DF463B9B720D52F250A8CF",
            name: "Estado del producto",
            action: "W",
            recordTime: 1726085852986,
            window: {
              _identifier: "Estado del producto",
              _entityName: "ADWindow",
              $ref: "ADWindow/B43A89704D864A6995BD5AC32201DBD9",
              id: "B43A89704D864A6995BD5AC32201DBD9",
              name: "Estado del producto",
              windowType: "M",
              recordTime: 1726085852986,
            },
          },
          {
            _identifier: "Destinos TBAI",
            _entityName: "ADMenu",
            $ref: "ADMenu/B6E7D6883E1943788B212C4D581F6668",
            id: "B6E7D6883E1943788B212C4D581F6668",
            name: "Destinos TBAI",
            action: "W",
            recordTime: 1726085852986,
            window: {
              _identifier: "Destinos TBAI",
              _entityName: "ADWindow",
              $ref: "ADWindow/A8B31569CD0F44369F671CC900400F15",
              id: "A8B31569CD0F44369F671CC900400F15",
              name: "Destinos TBAI",
              windowType: "M",
              recordTime: 1726085852987,
            },
          },
          {
            _identifier: "Configuración TBAI",
            _entityName: "ADMenu",
            $ref: "ADMenu/46AB322574E9493AB509B10ACE31E105",
            id: "46AB322574E9493AB509B10ACE31E105",
            name: "Configuración TBAI",
            action: "W",
            recordTime: 1726085852987,
            window: {
              _identifier: "Configuración TBAI",
              _entityName: "ADWindow",
              $ref: "ADWindow/C327DE215AC945F69363905840118177",
              id: "C327DE215AC945F69363905840118177",
              name: "Configuración TBAI",
              windowType: "M",
              recordTime: 1726085852987,
            },
          },
          {
            _identifier: "Zona de venta",
            _entityName: "ADMenu",
            $ref: "ADMenu/137",
            id: "137",
            name: "Zona de venta",
            action: "W",
            recordTime: 1726085852987,
            window: {
              _identifier: "Zona de venta",
              _entityName: "ADWindow",
              $ref: "ADWindow/152",
              id: "152",
              name: "Zona de venta",
              windowType: "M",
              recordTime: 1726085852988,
            },
          },
          {
            _identifier: "Comisión",
            _entityName: "ADMenu",
            $ref: "ADMenu/257",
            id: "257",
            name: "Comisión",
            action: "W",
            recordTime: 1726085852988,
            window: {
              _identifier: "Comisión",
              _entityName: "ADWindow",
              $ref: "ADWindow/207",
              id: "207",
              name: "Comisión",
              windowType: "M",
              recordTime: 1726085852988,
            },
          },
          {
            _identifier: "Canal",
            _entityName: "ADMenu",
            $ref: "ADMenu/136",
            id: "136",
            name: "Canal",
            action: "W",
            recordTime: 1726085852989,
            window: {
              _identifier: "Canal",
              _entityName: "ADWindow",
              $ref: "ADWindow/150",
              id: "150",
              name: "Canal",
              windowType: "M",
              recordTime: 1726085852990,
            },
          },
          {
            _identifier: "Campaña de Marketing",
            _entityName: "ADMenu",
            $ref: "ADMenu/134",
            id: "134",
            name: "Campaña de Marketing",
            action: "W",
            recordTime: 1726085852990,
            window: {
              _identifier: "Campaña de Marketing",
              _entityName: "ADWindow",
              $ref: "ADWindow/149",
              id: "149",
              name: "Campaña de Marketing",
              windowType: "M",
              recordTime: 1726085852990,
            },
          },
          {
            _identifier: "Motivo del rechazo",
            _entityName: "ADMenu",
            $ref: "ADMenu/6787A809DB364371B797ECED5E9262BF",
            id: "6787A809DB364371B797ECED5E9262BF",
            name: "Motivo del rechazo",
            action: "W",
            recordTime: 1726085852991,
            window: {
              _identifier: "Motivo del rechazo",
              _entityName: "ADWindow",
              $ref: "ADWindow/AB30B4B4C94540849D221C4BC31A9816",
              id: "AB30B4B4C94540849D221C4BC31A9816",
              name: "Motivo del rechazo",
              windowType: "M",
              recordTime: 1726085852991,
            },
          },
        ],
      },
    ],
  },
  {
    _identifier: "Gestión de Proyectos y Servicios",
    _entityName: "ADMenu",
    $ref: "ADMenu/160",
    id: "160",
    name: "Gestión de Proyectos y Servicios",
    action: null,
    recordTime: 1726085852992,
    icon: "🗂️",
    children: [
      {
        _identifier: "Transacciones",
        _entityName: "ADMenu",
        $ref: "ADMenu/800250",
        id: "800250",
        name: "Transacciones",
        action: null,
        recordTime: 1726085852993,
        icon: "💶",
        children: [
          {
            _identifier: "Proyecto multifase",
            _entityName: "ADMenu",
            $ref: "ADMenu/116",
            id: "116",
            name: "Proyecto multifase",
            action: "W",
            recordTime: 1726085852994,
            window: {
              _identifier: "Proyecto multifase",
              _entityName: "ADWindow",
              $ref: "ADWindow/130",
              id: "130",
              name: "Proyecto multifase",
              windowType: "M",
              recordTime: 1726085852994,
            },
          },
          {
            _identifier: "Informe de gasto",
            _entityName: "ADMenu",
            $ref: "ADMenu/318",
            id: "318",
            name: "Informe de gasto",
            action: "W",
            recordTime: 1726085852995,
            window: {
              _identifier: "Informe de gasto",
              _entityName: "ADWindow",
              $ref: "ADWindow/235",
              id: "235",
              name: "Informe de gasto",
              windowType: "T",
              recordTime: 1726085852995,
            },
          },
          {
            _identifier: "Crear pedidos de venta según gastos",
            _entityName: "ADMenu",
            $ref: "ADMenu/328",
            id: "328",
            name: "Crear pedidos de venta según gastos",
            action: "P",
            recordTime: 1726085852996,
          },
          {
            _identifier: "Crear facturas de gastos AP ",
            _entityName: "ADMenu",
            $ref: "ADMenu/329",
            id: "329",
            name: "Crear facturas de gastos AP ",
            action: "P",
            recordTime: 1726085852996,
          },
        ],
      },
      {
        _identifier: "Herramientas de análisis",
        _entityName: "ADMenu",
        $ref: "ADMenu/800079",
        id: "800079",
        name: "Herramientas de análisis",
        action: null,
        recordTime: 1726085852997,
        icon: "📊",
        children: [
          {
            _identifier: "Progreso de Proyectos",
            _entityName: "ADMenu",
            $ref: "ADMenu/D4A88451E7F64130A1998567B5E0C68F",
            id: "D4A88451E7F64130A1998567B5E0C68F",
            name: "Progreso de Proyectos",
            action: "R",
            recordTime: 1726085852997,
          },
          {
            _identifier: "Rentabilidad de Proyectos",
            _entityName: "ADMenu",
            $ref: "ADMenu/800208",
            id: "800208",
            name: "Rentabilidad de Proyectos",
            action: "R",
            recordTime: 1726085852998,
          },
          {
            _identifier: "Informe de gastos",
            _entityName: "ADMenu",
            $ref: "ADMenu/800070",
            id: "800070",
            name: "Informe de gastos",
            action: "R",
            recordTime: 1726085852998,
          },
          {
            _identifier: "Gastos para facturar",
            _entityName: "ADMenu",
            $ref: "ADMenu/327",
            id: "327",
            name: "Gastos para facturar",
            action: "W",
            recordTime: 1726085852999,
            window: {
              _identifier: "Gastos para facturar",
              _entityName: "ADWindow",
              $ref: "ADWindow/242",
              id: "242",
              name: "Gastos para facturar",
              windowType: "M",
              recordTime: 1726085853000,
            },
          },
          {
            _identifier: "Gastos no reembolsados",
            _entityName: "ADMenu",
            $ref: "ADMenu/349",
            id: "349",
            name: "Gastos no reembolsados",
            action: "W",
            recordTime: 1726085853000,
            window: {
              _identifier: "Gastos no reembolsados",
              _entityName: "ADWindow",
              $ref: "ADWindow/254",
              id: "254",
              name: "Gastos no reembolsados",
              windowType: "M",
              recordTime: 1726085853001,
            },
          },
        ],
      },
      {
        _identifier: "Configuración",
        _entityName: "ADMenu",
        $ref: "ADMenu/800251",
        id: "800251",
        name: "Configuración",
        action: null,
        recordTime: 1726085853001,
        icon: "⚙️",
        children: [
          {
            _identifier: "Tipo de proyecto",
            _entityName: "ADMenu",
            $ref: "ADMenu/364",
            id: "364",
            name: "Tipo de proyecto",
            action: "W",
            recordTime: 1726085853001,
            window: {
              _identifier: "Tipo de proyecto",
              _entityName: "ADWindow",
              $ref: "ADWindow/265",
              id: "265",
              name: "Tipo de proyecto",
              windowType: "M",
              recordTime: 1726085853002,
            },
          },
        ],
      },
    ],
  },
  {
    _identifier: "Gestión Financiera",
    _entityName: "ADMenu",
    $ref: "ADMenu/278",
    id: "278",
    name: "Gestión Financiera",
    action: null,
    recordTime: 1726085853002,
    icon: "💰",
    children: [
      {
        _identifier: "Gestión de Cobros y Pagos",
        _entityName: "ADMenu",
        $ref: "ADMenu/236",
        id: "236",
        name: "Gestión de Cobros y Pagos",
        action: null,
        recordTime: 1726085853002,
        icon: "💳",
        children: [
          {
            _identifier: "Transacciones",
            _entityName: "ADMenu",
            $ref: "ADMenu/800253",
            id: "800253",
            name: "Transacciones",
            action: null,
            recordTime: 1726085853003,
            icon: "💶",
            children: [
              {
                _identifier: "Plan de pago de facturas de compra",
                _entityName: "ADMenu",
                $ref: "ADMenu/7C26B79DD2BF4F4AADCF088653740597",
                id: "7C26B79DD2BF4F4AADCF088653740597",
                name: "Plan de pago de facturas de compra",
                action: "W",
                recordTime: 1726085853003,
                window: {
                  _identifier: "Plan de pago de facturas de compra",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/6EFB8443A1C64F3D926CE42A0E40631C",
                  id: "6EFB8443A1C64F3D926CE42A0E40631C",
                  name: "Plan de pago de facturas de compra",
                  windowType: "T",
                  recordTime: 1726085853003,
                },
              },
              {
                _identifier: "Pago",
                _entityName: "ADMenu",
                $ref: "ADMenu/C3BEE7BF3F5B44C3A24D24E3DC4870EC",
                id: "C3BEE7BF3F5B44C3A24D24E3DC4870EC",
                name: "Pago",
                action: "W",
                recordTime: 1726085853004,
                window: {
                  _identifier: "Pago",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/6F8F913FA60F4CBD93DC1D3AA696E76E",
                  id: "6F8F913FA60F4CBD93DC1D3AA696E76E",
                  name: "Pago",
                  windowType: "T",
                  recordTime: 1726085853005,
                },
              },
              {
                _identifier: "Propuesta de Pago",
                _entityName: "ADMenu",
                $ref: "ADMenu/125E6EAD650841F69E2601C78F558AA1",
                id: "125E6EAD650841F69E2601C78F558AA1",
                name: "Propuesta de Pago",
                action: "W",
                recordTime: 1726085853007,
                window: {
                  _identifier: "Propuesta de Pago",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/1B7B3BB7FEAF41ED8D9727AB98779D3C",
                  id: "1B7B3BB7FEAF41ED8D9727AB98779D3C",
                  name: "Propuesta de Pago",
                  windowType: "M",
                  recordTime: 1726085853007,
                },
              },
              {
                _identifier: "Plan de pago de facturas de venta",
                _entityName: "ADMenu",
                $ref: "ADMenu/652E78DE779542D59B27179FE6E59C38",
                id: "652E78DE779542D59B27179FE6E59C38",
                name: "Plan de pago de facturas de venta",
                action: "W",
                recordTime: 1726085853008,
                window: {
                  _identifier: "Sales Invoice Payment Plan",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/FC6A51DF5F32451987C0C84D7B338B94",
                  id: "FC6A51DF5F32451987C0C84D7B338B94",
                  name: "Sales Invoice Payment Plan",
                  windowType: "T",
                  recordTime: 1726085853008,
                },
              },
              {
                _identifier: "Cobros",
                _entityName: "ADMenu",
                $ref: "ADMenu/DB84EB9507F34D9B802DDA0B1041B602",
                id: "DB84EB9507F34D9B802DDA0B1041B602",
                name: "Cobros",
                action: "W",
                recordTime: 1726085853009,
                window: {
                  _identifier: "Cobros",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/E547CE89D4C04429B6340FFA44E70716",
                  id: "E547CE89D4C04429B6340FFA44E70716",
                  name: "Cobros",
                  windowType: "T",
                  recordTime: 1726085853009,
                },
              },
              {
                _identifier: "Cuenta financiera",
                _entityName: "ADMenu",
                $ref: "ADMenu/65C70CA5BB3A4F67B6B456C90F907917",
                id: "65C70CA5BB3A4F67B6B456C90F907917",
                name: "Cuenta financiera",
                action: "W",
                recordTime: 1726085853010,
                window: {
                  _identifier: "Cuenta financiera",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/94EAA455D2644E04AB25D93BE5157B6D",
                  id: "94EAA455D2644E04AB25D93BE5157B6D",
                  name: "Cuenta financiera",
                  windowType: "M",
                  recordTime: 1726085853010,
                },
              },
              {
                _identifier: "Pago del impuesto",
                _entityName: "ADMenu",
                $ref: "ADMenu/1002100004",
                id: "1002100004",
                name: "Pago del impuesto",
                action: "W",
                recordTime: 1726085853011,
                window: {
                  _identifier: "Pago del impuesto",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/1002100004",
                  id: "1002100004",
                  name: "Pago del impuesto",
                  windowType: "T",
                  recordTime: 1726085853011,
                },
              },
              {
                _identifier: "Impresión de cheques",
                _entityName: "ADMenu",
                $ref: "ADMenu/60237A5A5B644457B8A9BDF80473A901",
                id: "60237A5A5B644457B8A9BDF80473A901",
                name: "Impresión de cheques",
                action: "W",
                recordTime: 1726085853011,
                window: {
                  _identifier: "Impresión de cheques",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/4DF4EB9416CA4C7E8013B39B3AC33236",
                  id: "4DF4EB9416CA4C7E8013B39B3AC33236",
                  name: "Impresión de cheques",
                  windowType: "M",
                  recordTime: 1726085853012,
                },
              },
              {
                _identifier: "Payment Execution",
                _entityName: "ADMenu",
                $ref: "ADMenu/5EAFFA3FB3464A8191E6C1CB2929197D",
                id: "5EAFFA3FB3464A8191E6C1CB2929197D",
                name: "Payment Execution",
                action: "OBUIAPP_Process",
                recordTime: 1726085853013,
              },
              {
                _identifier: "Dudoso cobro",
                _entityName: "ADMenu",
                $ref: "ADMenu/5FEA7B2F449D47D8A18769049D07034B",
                id: "5FEA7B2F449D47D8A18769049D07034B",
                name: "Dudoso cobro",
                action: "W",
                recordTime: 1726085853013,
                window: {
                  _identifier: "Dudoso cobro",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/4A35B1C57B4243F4A1E42D882C8DDA3D",
                  id: "4A35B1C57B4243F4A1E42D882C8DDA3D",
                  name: "Dudoso cobro",
                  windowType: "M",
                  recordTime: 1726085853014,
                },
              },
              {
                _identifier: "Procesado del dudoso cobro",
                _entityName: "ADMenu",
                $ref: "ADMenu/57DA6BAE74334B5B81A0AD05256C1B34",
                id: "57DA6BAE74334B5B81A0AD05256C1B34",
                name: "Procesado del dudoso cobro",
                action: "W",
                recordTime: 1726085853015,
                window: {
                  _identifier: "Procesado del dudoso cobro",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/681E982F747A48A6AF328A236A067559",
                  id: "681E982F747A48A6AF328A236A067559",
                  name: "Procesado del dudoso cobro",
                  windowType: "T",
                  recordTime: 1726085853016,
                },
              },
            ],
          },
          {
            _identifier: "Herramientas de análisis",
            _entityName: "ADMenu",
            $ref: "ADMenu/800077",
            id: "800077",
            name: "Herramientas de análisis",
            action: null,
            recordTime: 1726085853017,
            icon: "📊",
            children: [
              {
                _identifier: "Informe de previsión de tesorería",
                _entityName: "ADMenu",
                $ref: "ADMenu/17E054F552B443C5B3438B7E38FDD09D",
                id: "17E054F552B443C5B3438B7E38FDD09D",
                name: "Informe de previsión de tesorería",
                action: "OBUIAPP_Process",
                recordTime: 1726085853018,
              },
              {
                _identifier: "Informe dimensional de impuestos",
                _entityName: "ADMenu",
                $ref: "ADMenu/8C1331B9EC06CED7E040007F010119A0",
                id: "8C1331B9EC06CED7E040007F010119A0",
                name: "Informe dimensional de impuestos",
                action: "R",
                recordTime: 1726085853019,
              },
              {
                _identifier: "Listado de saldos a cobrar por antigüedad",
                _entityName: "ADMenu",
                $ref: "ADMenu/CC226771DE354AEEAA5D69F696F1A676",
                id: "CC226771DE354AEEAA5D69F696F1A676",
                name: "Listado de saldos a cobrar por antigüedad",
                action: "OBUIAPP_Process",
                recordTime: 1726085853020,
              },
              {
                _identifier: "Listado de saldos a pagar por antigüedad",
                _entityName: "ADMenu",
                $ref: "ADMenu/B6D984F9FEFB412D827A37BACF2F1D66",
                id: "B6D984F9FEFB412D827A37BACF2F1D66",
                name: "Listado de saldos a pagar por antigüedad",
                action: "OBUIAPP_Process",
                recordTime: 1726085853020,
              },
              {
                _identifier: "Informe de pagos y cobros",
                _entityName: "ADMenu",
                $ref: "ADMenu/C662C29A164243C18C71BE164899A71B",
                id: "C662C29A164243C18C71BE164899A71B",
                name: "Informe de pagos y cobros",
                action: "R",
                recordTime: 1726085853020,
              },
              {
                _identifier: "Histórico Ejecución de Pagos",
                _entityName: "ADMenu",
                $ref: "ADMenu/D0022AAFF0F44BBCA96AA7D007E65C7D",
                id: "D0022AAFF0F44BBCA96AA7D007E65C7D",
                name: "Histórico Ejecución de Pagos",
                action: "W",
                recordTime: 1726085853021,
                window: {
                  _identifier: "Histórico Ejecución de Pagos",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/AFE6BDF360C44B99ACA6FB5E9F51EA45",
                  id: "AFE6BDF360C44B99ACA6FB5E9F51EA45",
                  name: "Histórico Ejecución de Pagos",
                  windowType: "M",
                  recordTime: 1726085853021,
                },
              },
            ],
          },
          {
            _identifier: "Configuración",
            _entityName: "ADMenu",
            $ref: "ADMenu/800255",
            id: "800255",
            name: "Configuración",
            action: null,
            recordTime: 1726085853023,
            icon: "⚙️",
            children: [
              {
                _identifier: "Tipo de registro de impuesto",
                _entityName: "ADMenu",
                $ref: "ADMenu/1002100003",
                id: "1002100003",
                name: "Tipo de registro de impuesto",
                action: "W",
                recordTime: 1726085853024,
                window: {
                  _identifier: "Tipo de registro de impuesto",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/1002100003",
                  id: "1002100003",
                  name: "Tipo de registro de impuesto",
                  windowType: "M",
                  recordTime: 1726085853025,
                },
              },
              {
                _identifier: "Método de pago",
                _entityName: "ADMenu",
                $ref: "ADMenu/AA975B010CF8469DA84922534FB4AE6C",
                id: "AA975B010CF8469DA84922534FB4AE6C",
                name: "Método de pago",
                action: "W",
                recordTime: 1726085853027,
                window: {
                  _identifier: "Método de pago",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/3CAAC7D54593489384452416ACF356DD",
                  id: "3CAAC7D54593489384452416ACF356DD",
                  name: "Método de pago",
                  windowType: "M",
                  recordTime: 1726085853028,
                },
              },
              {
                _identifier: "Algoritmo de Reconciliación",
                _entityName: "ADMenu",
                $ref: "ADMenu/D40E8011F68B4E7DAF28F310455DF7C9",
                id: "D40E8011F68B4E7DAF28F310455DF7C9",
                name: "Algoritmo de Reconciliación",
                action: "W",
                recordTime: 1726085853028,
                window: {
                  _identifier: "Algoritmo de Reconciliación",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/D1D0C603DFC0423099D897A0DB388AC2",
                  id: "D1D0C603DFC0423099D897A0DB388AC2",
                  name: "Algoritmo de Reconciliación",
                  windowType: "M",
                  recordTime: 1726085853029,
                },
              },
              {
                _identifier: "Formato Fichero Banco",
                _entityName: "ADMenu",
                $ref: "ADMenu/9CE1B49B25274C2E98455FC7E4C7C64A",
                id: "9CE1B49B25274C2E98455FC7E4C7C64A",
                name: "Formato Fichero Banco",
                action: "W",
                recordTime: 1726085853029,
                window: {
                  _identifier: "Formato Fichero Banco",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/557A0AA1D0D745F9A61557C05483072C",
                  id: "557A0AA1D0D745F9A61557C05483072C",
                  name: "Formato Fichero Banco",
                  windowType: "M",
                  recordTime: 1726085853030,
                },
              },
              {
                _identifier: "Proceso de Ejecución",
                _entityName: "ADMenu",
                $ref: "ADMenu/DECF65B1A8CA4B7093E7A9DAB8AFBF26",
                id: "DECF65B1A8CA4B7093E7A9DAB8AFBF26",
                name: "Proceso de Ejecución",
                action: "W",
                recordTime: 1726085853031,
                window: {
                  _identifier: "Proceso de Ejecución",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/24DDE1DDF13942D78B6D6F216979E56A",
                  id: "24DDE1DDF13942D78B6D6F216979E56A",
                  name: "Proceso de Ejecución",
                  windowType: "M",
                  recordTime: 1726085853031,
                },
              },
              {
                _identifier: "Método de dudoso cobro",
                _entityName: "ADMenu",
                $ref: "ADMenu/91FCED01924C4BCE82A06CD2D894E971",
                id: "91FCED01924C4BCE82A06CD2D894E971",
                name: "Método de dudoso cobro",
                action: "W",
                recordTime: 1726085853031,
                window: {
                  _identifier: "Método de dudoso cobro",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/EB6621E5513F41449E77D68C58C3C409",
                  id: "EB6621E5513F41449E77D68C58C3C409",
                  name: "Método de dudoso cobro",
                  windowType: "M",
                  recordTime: 1726085853032,
                },
              },
            ],
          },
        ],
      },
      {
        _identifier: "Suministro Inmediato de Información (SII)",
        _entityName: "ADMenu",
        $ref: "ADMenu/5D501B7F2ED84F1ABCA21CF9D0409C4A",
        id: "5D501B7F2ED84F1ABCA21CF9D0409C4A",
        name: "Suministro Inmediato de Información (SII)",
        action: null,
        recordTime: 1726085853032,
        icon: "📑",
        children: [
          {
            _identifier: "Causa de Exención",
            _entityName: "ADMenu",
            $ref: "ADMenu/D6B02292A6384E4DAD47878D6AFCE449",
            id: "D6B02292A6384E4DAD47878D6AFCE449",
            name: "Causa de Exención",
            action: "W",
            recordTime: 1726085853032,
            window: {
              _identifier: "Causa de Exención",
              _entityName: "ADWindow",
              $ref: "ADWindow/96DABD97C2AC4D479F6997C6B350B0BE",
              id: "96DABD97C2AC4D479F6997C6B350B0BE",
              name: "Causa de Exención",
              windowType: "M",
              recordTime: 1726085853033,
            },
          },
          {
            _identifier: "Configuración SII",
            _entityName: "ADMenu",
            $ref: "ADMenu/35D1CD7D915B4E34836D0FBC83906E03",
            id: "35D1CD7D915B4E34836D0FBC83906E03",
            name: "Configuración SII",
            action: "W",
            recordTime: 1726085853033,
            window: {
              _identifier: "Configuración SII",
              _entityName: "ADWindow",
              $ref: "ADWindow/C1D3A2A017AC4B82B9FEE6F4D2A0C55A",
              id: "C1D3A2A017AC4B82B9FEE6F4D2A0C55A",
              name: "Configuración SII",
              windowType: "M",
              recordTime: 1726085853033,
            },
          },
          {
            _identifier: "Consulta Facturas SII",
            _entityName: "ADMenu",
            $ref: "ADMenu/7EDA5FAED6854F6999A93EE6FE28E242",
            id: "7EDA5FAED6854F6999A93EE6FE28E242",
            name: "Consulta Facturas SII",
            action: "W",
            recordTime: 1726085853034,
            window: {
              _identifier: "Consulta Facturas SII",
              _entityName: "ADWindow",
              $ref: "ADWindow/0FFAFE82D73C4009A09476A9C4F4CC9A",
              id: "0FFAFE82D73C4009A09476A9C4F4CC9A",
              name: "Consulta Facturas SII",
              windowType: "M",
              recordTime: 1726085853034,
            },
          },
          {
            _identifier: "Descripciones SII",
            _entityName: "ADMenu",
            $ref: "ADMenu/F832798C1BB84EF98C2EFEF2AF5BA8DA",
            id: "F832798C1BB84EF98C2EFEF2AF5BA8DA",
            name: "Descripciones SII",
            action: "W",
            recordTime: 1726085853034,
            window: {
              _identifier: "Descripciones SII",
              _entityName: "ADWindow",
              $ref: "ADWindow/B26E895FF7A04718A0AF1AE8EE7E5D4D",
              id: "B26E895FF7A04718A0AF1AE8EE7E5D4D",
              name: "Descripciones SII",
              windowType: "M",
              recordTime: 1726085853034,
            },
          },
          {
            _identifier: "Conexiones a SII",
            _entityName: "ADMenu",
            $ref: "ADMenu/336522AA5CED4A73B2E54786ACE05600",
            id: "336522AA5CED4A73B2E54786ACE05600",
            name: "Conexiones a SII",
            action: "W",
            recordTime: 1726085853035,
            window: {
              _identifier: "Conexiones a SII",
              _entityName: "ADWindow",
              $ref: "ADWindow/5A7BDFDF1A9A426DA82C6F4BE6B9FC4A",
              id: "5A7BDFDF1A9A426DA82C6F4BE6B9FC4A",
              name: "Conexiones a SII",
              windowType: "M",
              recordTime: 1726085853035,
            },
          },
          {
            _identifier: "SII Cobros en metálico",
            _entityName: "ADMenu",
            $ref: "ADMenu/AA9BBA1FDB2040A4801266095562687B",
            id: "AA9BBA1FDB2040A4801266095562687B",
            name: "SII Cobros en metálico",
            action: "W",
            recordTime: 1726085853036,
            window: {
              _identifier: "SII Cobros en metálico",
              _entityName: "ADWindow",
              $ref: "ADWindow/622A2204CD6844199D8C18F5E5230A3B",
              id: "622A2204CD6844199D8C18F5E5230A3B",
              name: "SII Cobros en metálico",
              windowType: "M",
              recordTime: 1726085853036,
            },
          },
          {
            _identifier: "Monitor SII",
            _entityName: "ADMenu",
            $ref: "ADMenu/DA8C78E6BE144F0A996C11C522421FA4",
            id: "DA8C78E6BE144F0A996C11C522421FA4",
            name: "Monitor SII",
            action: "W",
            recordTime: 1726085853036,
            window: {
              _identifier: "Monitor SII",
              _entityName: "ADWindow",
              $ref: "ADWindow/FEF76C3E0F104F06A89AAD15A4A4A35C",
              id: "FEF76C3E0F104F06A89AAD15A4A4A35C",
              name: "Monitor SII",
              windowType: "M",
              recordTime: 1726085853037,
            },
          },
        ],
      },
      {
        _identifier: "Contabilidad",
        _entityName: "ADMenu",
        $ref: "ADMenu/800252",
        id: "800252",
        name: "Contabilidad",
        action: null,
        recordTime: 1726085853037,
        icon: "📈",
        children: [
          {
            _identifier: "Transacciones",
            _entityName: "ADMenu",
            $ref: "ADMenu/800254",
            id: "800254",
            name: "Transacciones",
            action: null,
            recordTime: 1726085853038,
            icon: "💶",
            children: [
              {
                _identifier: "Asientos Manuales Simplificados",
                _entityName: "ADMenu",
                $ref: "ADMenu/ED7B60C9919F48C096F93B58128DE565",
                id: "ED7B60C9919F48C096F93B58128DE565",
                name: "Asientos Manuales Simplificados",
                action: "W",
                recordTime: 1726085853038,
                window: {
                  _identifier: "Asientos Manuales Simplificados",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/B917E8A7B0864ACEA9D941E3B7494E53",
                  id: "B917E8A7B0864ACEA9D941E3B7494E53",
                  name: "Asientos Manuales Simplificados",
                  windowType: "T",
                  recordTime: 1726085853039,
                },
              },
              {
                _identifier: "Asientos manuales",
                _entityName: "ADMenu",
                $ref: "ADMenu/118",
                id: "118",
                name: "Asientos manuales",
                action: "W",
                recordTime: 1726085853039,
                window: {
                  _identifier: "Asientos manuales",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/132",
                  id: "132",
                  name: "Asientos manuales",
                  windowType: "T",
                  recordTime: 1726085853040,
                },
              },
              {
                _identifier: "Cierre de año",
                _entityName: "ADMenu",
                $ref: "ADMenu/B98CC98DABEE409DB43A0A224CA140EA",
                id: "B98CC98DABEE409DB43A0A224CA140EA",
                name: "Cierre de año",
                action: "W",
                recordTime: 1726085853040,
                window: {
                  _identifier: "Cierre de año",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/B5673F73F613496C8BEA22FB55E4E1E4",
                  id: "B5673F73F613496C8BEA22FB55E4E1E4",
                  name: "Cierre de año",
                  windowType: "M",
                  recordTime: 1726085853041,
                },
              },
              {
                _identifier: "Proceso contable",
                _entityName: "ADMenu",
                $ref: "ADMenu/800038",
                id: "800038",
                name: "Proceso contable",
                action: "X",
                recordTime: 1726085853041,
              },
              {
                _identifier: "Presupuesto",
                _entityName: "ADMenu",
                $ref: "ADMenu/800190",
                id: "800190",
                name: "Presupuesto",
                action: "W",
                recordTime: 1726085853041,
                window: {
                  _identifier: "Presupuesto",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/800077",
                  id: "800077",
                  name: "Presupuesto",
                  windowType: "M",
                  recordTime: 1726085853042,
                },
              },
              {
                _identifier: "Generador excel de presupuestos",
                _entityName: "ADMenu",
                $ref: "ADMenu/800191",
                id: "800191",
                name: "Generador excel de presupuestos",
                action: "R",
                recordTime: 1726085853043,
              },
              {
                _identifier: "Documentos no contabilizados",
                _entityName: "ADMenu",
                $ref: "ADMenu/800225",
                id: "800225",
                name: "Documentos no contabilizados",
                action: "R",
                recordTime: 1726085853044,
              },
              {
                _identifier: "Reinicializar cuentas",
                _entityName: "ADMenu",
                $ref: "ADMenu/68516F327BFE4CDEB2DA255122089917",
                id: "68516F327BFE4CDEB2DA255122089917",
                name: "Reinicializar cuentas",
                action: "OBUIAPP_Process",
                recordTime: 1726085853044,
              },
            ],
          },
          {
            _identifier: "Herramientas de análisis",
            _entityName: "ADMenu",
            $ref: "ADMenu/280",
            id: "280",
            name: "Herramientas de análisis",
            action: null,
            recordTime: 1726085853045,
            icon: "📊",
            children: [
              {
                _identifier: "Datos de contabilidad",
                _entityName: "ADMenu",
                $ref: "ADMenu/169",
                id: "169",
                name: "Datos de contabilidad",
                action: "W",
                recordTime: 1726085853045,
                window: {
                  _identifier: "Datos de contabilidad",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/162",
                  id: "162",
                  name: "Datos de contabilidad",
                  windowType: "Q",
                  recordTime: 1726085853045,
                },
              },
              {
                _identifier: "Cuadros plan general contable",
                _entityName: "ADMenu",
                $ref: "ADMenu/800025",
                id: "800025",
                name: "Cuadros plan general contable",
                action: "R",
                recordTime: 1726085853046,
              },
              {
                _identifier: "Balance sumas y saldos",
                _entityName: "ADMenu",
                $ref: "ADMenu/800042",
                id: "800042",
                name: "Balance sumas y saldos",
                action: "R",
                recordTime: 1726085853046,
              },
              {
                _identifier: "Libro mayor",
                _entityName: "ADMenu",
                $ref: "ADMenu/800006",
                id: "800006",
                name: "Libro mayor",
                action: "R",
                recordTime: 1726085853046,
              },
              {
                _identifier: "Diario asientos",
                _entityName: "ADMenu",
                $ref: "ADMenu/800005",
                id: "800005",
                name: "Diario asientos",
                action: "R",
                recordTime: 1726085853047,
              },
              {
                _identifier: "Creación de informes contables",
                _entityName: "ADMenu",
                $ref: "ADMenu/800198",
                id: "800198",
                name: "Creación de informes contables",
                action: "P",
                recordTime: 1726085853047,
              },
              {
                _identifier: "Creación de informes de impuestos",
                _entityName: "ADMenu",
                $ref: "ADMenu/800227",
                id: "800227",
                name: "Creación de informes de impuestos",
                action: "P",
                recordTime: 1726085853047,
              },
              {
                _identifier: "Extracto de cuenta de Cliente",
                _entityName: "ADMenu",
                $ref: "ADMenu/C073633F0AFF4A93B17C13F239DE9613",
                id: "C073633F0AFF4A93B17C13F239DE9613",
                name: "Extracto de cuenta de Cliente",
                action: "P",
                recordTime: 1726085853047,
              },
              {
                _identifier: "Configuración Informes contables",
                _entityName: "ADMenu",
                $ref: "ADMenu/800194",
                id: "800194",
                name: "Configuración Informes contables",
                action: "W",
                recordTime: 1726085853047,
                window: {
                  _identifier: "Configuración Informes contables",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/800081",
                  id: "800081",
                  name: "Configuración Informes contables",
                  windowType: "M",
                  recordTime: 1726085853048,
                },
              },
              {
                _identifier: "Configuración informes de impuestos",
                _entityName: "ADMenu",
                $ref: "ADMenu/800226",
                id: "800226",
                name: "Configuración informes de impuestos",
                action: "W",
                recordTime: 1726085853048,
                window: {
                  _identifier: "Configuración informes de impuestos",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/800100",
                  id: "800100",
                  name: "Configuración informes de impuestos",
                  windowType: "M",
                  recordTime: 1726085853048,
                },
              },
              {
                _identifier: "Libro de Facturas",
                _entityName: "ADMenu",
                $ref: "ADMenu/ED8D9B496F224035A94D0BAD73C7BF7C",
                id: "ED8D9B496F224035A94D0BAD73C7BF7C",
                name: "Libro de Facturas",
                action: "W",
                recordTime: 1726085853049,
                window: {
                  _identifier: "Libro de Facturas",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/A3B75DF2642444AA81C4B68A8E99DFEC",
                  id: "A3B75DF2642444AA81C4B68A8E99DFEC",
                  name: "Libro de Facturas",
                  windowType: "M",
                  recordTime: 1726085853049,
                },
              },
              {
                _identifier: "Generador de declaraciones de impuestos",
                _entityName: "ADMenu",
                $ref: "ADMenu/6329D45D2FF84A0F8697535ED603A2A8",
                id: "6329D45D2FF84A0F8697535ED603A2A8",
                name: "Generador de declaraciones de impuestos",
                action: "R",
                recordTime: 1726085853049,
              },
            ],
          },
          {
            _identifier: "Configuración",
            _entityName: "ADMenu",
            $ref: "ADMenu/164",
            id: "164",
            name: "Configuración",
            action: null,
            recordTime: 1726085853049,
            icon: "⚙️",
            children: [
              {
                _identifier: "Abrir/Cerrar periodos",
                _entityName: "ADMenu",
                $ref: "ADMenu/75B726735EA7497C9DB06E35B1CBFD86",
                id: "75B726735EA7497C9DB06E35B1CBFD86",
                name: "Abrir/Cerrar periodos",
                action: "W",
                recordTime: 1726085853050,
                window: {
                  _identifier: "Abrir/Cerrar periodos",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/E66E701CCBA14B8BA480CBDE37C50D7A",
                  id: "E66E701CCBA14B8BA480CBDE37C50D7A",
                  name: "Abrir/Cerrar periodos",
                  windowType: "M",
                  recordTime: 1726085853050,
                },
              },
              {
                _identifier: "Histórico de Control de Periodos",
                _entityName: "ADMenu",
                $ref: "ADMenu/1C00140BAFA946E3A63F1AD557A35F45",
                id: "1C00140BAFA946E3A63F1AD557A35F45",
                name: "Histórico de Control de Periodos",
                action: "W",
                recordTime: 1726085853050,
                window: {
                  _identifier: "Histórico de Control de Periodos",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/E56E701CCBA14B8BA480CBDE37C50D7A",
                  id: "E56E701CCBA14B8BA480CBDE37C50D7A",
                  name: "Histórico de Control de Periodos",
                  windowType: "M",
                  recordTime: 1726085853051,
                },
              },
              {
                _identifier: "IAE Activity Type",
                _entityName: "ADMenu",
                $ref: "ADMenu/ECED4249C522408C8F8086B3E097408F",
                id: "ECED4249C522408C8F8086B3E097408F",
                name: "IAE Activity Type",
                action: "W",
                recordTime: 1726085853051,
                window: {
                  _identifier: "IAE Activity Type",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/3AAD514BDAD34D5BB03D63F0460302C8",
                  id: "3AAD514BDAD34D5BB03D63F0460302C8",
                  name: "IAE Activity Type",
                  windowType: "M",
                  recordTime: 1726085853051,
                },
              },
              {
                _identifier: "Árbol de cuentas",
                _entityName: "ADMenu",
                $ref: "ADMenu/105",
                id: "105",
                name: "Árbol de cuentas",
                action: "W",
                recordTime: 1726085853051,
                window: {
                  _identifier: "Árbol de cuentas",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/118",
                  id: "118",
                  name: "Árbol de cuentas",
                  windowType: "M",
                  recordTime: 1726085853052,
                },
              },
              {
                _identifier: "Esquema contable",
                _entityName: "ADMenu",
                $ref: "ADMenu/111",
                id: "111",
                name: "Esquema contable",
                action: "W",
                recordTime: 1726085853052,
                window: {
                  _identifier: "Esquema contable",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/125",
                  id: "125",
                  name: "Esquema contable",
                  windowType: "M",
                  recordTime: 1726085853052,
                },
              },
              {
                _identifier: "Calendario anual y periodos",
                _entityName: "ADMenu",
                $ref: "ADMenu/104",
                id: "104",
                name: "Calendario anual y periodos",
                action: "W",
                recordTime: 1726085853052,
                window: {
                  _identifier: "Calendario anual y periodos",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/117",
                  id: "117",
                  name: "Calendario anual y periodos",
                  windowType: "M",
                  recordTime: 1726085853053,
                },
              },
              {
                _identifier: "Combinación de cuentas",
                _entityName: "ADMenu",
                $ref: "ADMenu/106",
                id: "106",
                name: "Combinación de cuentas",
                action: "W",
                recordTime: 1726085853053,
                window: {
                  _identifier: "Combinación de cuentas",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/153",
                  id: "153",
                  name: "Combinación de cuentas",
                  windowType: "Q",
                  recordTime: 1726085853053,
                },
              },
              {
                _identifier: "Proceso Contable",
                _entityName: "ADMenu",
                $ref: "ADMenu/20C210B5BE7846819385A70F23F5118C",
                id: "20C210B5BE7846819385A70F23F5118C",
                name: "Proceso Contable",
                action: "W",
                recordTime: 1726085853054,
                window: {
                  _identifier: "Proceso Contable",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/A9FD6A5AED3546EC83DB567882646D2E",
                  id: "A9FD6A5AED3546EC83DB567882646D2E",
                  name: "Proceso Contable",
                  windowType: "M",
                  recordTime: 1726085853054,
                },
              },
              {
                _identifier: "Concepto contable",
                _entityName: "ADMenu",
                $ref: "ADMenu/800034",
                id: "800034",
                name: "Concepto contable",
                action: "W",
                recordTime: 1726085853054,
                window: {
                  _identifier: "Concepto contable",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/800007",
                  id: "800007",
                  name: "Concepto contable",
                  windowType: "M",
                  recordTime: 1726085853055,
                },
              },
              {
                _identifier: "Categoría de LM",
                _entityName: "ADMenu",
                $ref: "ADMenu/117",
                id: "117",
                name: "Categoría de LM",
                action: "W",
                recordTime: 1726085853055,
                window: {
                  _identifier: "Categoría de LM",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/131",
                  id: "131",
                  name: "Categoría de LM",
                  windowType: "M",
                  recordTime: 1726085853055,
                },
              },
              {
                _identifier: "Tipo de documento",
                _entityName: "ADMenu",
                $ref: "ADMenu/121",
                id: "121",
                name: "Tipo de documento",
                action: "W",
                recordTime: 1726085853056,
                window: {
                  _identifier: "Tipo de documento",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/135",
                  id: "135",
                  name: "Tipo de documento",
                  windowType: "M",
                  recordTime: 1726085853056,
                },
              },
              {
                _identifier: "Secuencia de documento (numeración)",
                _entityName: "ADMenu",
                $ref: "ADMenu/151",
                id: "151",
                name: "Secuencia de documento (numeración)",
                action: "W",
                recordTime: 1726085853057,
                window: {
                  _identifier: "Secuencia de documento (numeración)",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/112",
                  id: "112",
                  name: "Secuencia de documento (numeración)",
                  windowType: "M",
                  recordTime: 1726085853058,
                },
              },
              {
                _identifier: "Categoría de Impuesto",
                _entityName: "ADMenu",
                $ref: "ADMenu/124",
                id: "124",
                name: "Categoría de Impuesto",
                action: "W",
                recordTime: 1726085853058,
                window: {
                  _identifier: "Categoría de Impuesto",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/138",
                  id: "138",
                  name: "Categoría de Impuesto",
                  windowType: "M",
                  recordTime: 1726085853059,
                },
              },
              {
                _identifier: "Categoría de Impuestos de Terceros",
                _entityName: "ADMenu",
                $ref: "ADMenu/800206",
                id: "800206",
                name: "Categoría de Impuestos de Terceros",
                action: "W",
                recordTime: 1726085853060,
                window: {
                  _identifier: "Categoría de Impuestos de Terceros",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/800086",
                  id: "800086",
                  name: "Categoría de Impuestos de Terceros",
                  windowType: "M",
                  recordTime: 1726085853061,
                },
              },
              {
                _identifier: "Rango impuesto",
                _entityName: "ADMenu",
                $ref: "ADMenu/123",
                id: "123",
                name: "Rango impuesto",
                action: "W",
                recordTime: 1726085853061,
                window: {
                  _identifier: "Rango impuesto",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/137",
                  id: "137",
                  name: "Rango impuesto",
                  windowType: "M",
                  recordTime: 1726085853061,
                },
              },
              {
                _identifier: "Centro de costos",
                _entityName: "ADMenu",
                $ref: "ADMenu/F2F2F35AF85A456A98B59EAD137C1DB6",
                id: "F2F2F35AF85A456A98B59EAD137C1DB6",
                name: "Centro de costos",
                action: "W",
                recordTime: 1726085853062,
                window: {
                  _identifier: "Centro de costos",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/79FC23AB84F04384B4B7CCCADCDD2942",
                  id: "79FC23AB84F04384B4B7CCCADCDD2942",
                  name: "Centro de costos",
                  windowType: "M",
                  recordTime: 1726085853062,
                },
              },
              {
                _identifier: "Info.Conta.Impuestos",
                _entityName: "ADMenu",
                $ref: "ADMenu/B4E8B164F882446082F40931A11CC205",
                id: "B4E8B164F882446082F40931A11CC205",
                name: "Info.Conta.Impuestos",
                action: "P",
                recordTime: 1726085853063,
              },
              {
                _identifier: "Actividad (ABC)",
                _entityName: "ADMenu",
                $ref: "ADMenu/120",
                id: "120",
                name: "Actividad (ABC)",
                action: "W",
                recordTime: 1726085853063,
                window: {
                  _identifier: "Actividad (ABC)",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/134",
                  id: "134",
                  name: "Actividad (ABC)",
                  windowType: "M",
                  recordTime: 1726085853063,
                },
              },
              {
                _identifier: "Plantillas de Contabilidad",
                _entityName: "ADMenu",
                $ref: "ADMenu/C14426B2503546788BE2BAEBA2BE81DC",
                id: "C14426B2503546788BE2BAEBA2BE81DC",
                name: "Plantillas de Contabilidad",
                action: "W",
                recordTime: 1726085853064,
                window: {
                  _identifier: "Plantillas de Contabilidad",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/B15DDE526F724EBCB11439BDDB483FA6",
                  id: "B15DDE526F724EBCB11439BDDB483FA6",
                  name: "Plantillas de Contabilidad",
                  windowType: "M",
                  recordTime: 1726085853064,
                },
              },
              {
                _identifier: "Configuración de informes contables",
                _entityName: "ADMenu",
                $ref: "ADMenu/800224",
                id: "800224",
                name: "Configuración de informes contables",
                action: "W",
                recordTime: 1726085853065,
                window: {
                  _identifier: "Configuración de informes contables",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/800099",
                  id: "800099",
                  name: "Configuración de informes contables",
                  windowType: "M",
                  recordTime: 1726085853065,
                },
              },
              {
                _identifier: "Configuración de Libro de Facturas",
                _entityName: "ADMenu",
                $ref: "ADMenu/31A0F4A7EBE24FFA829E24AF0AB9A0DA",
                id: "31A0F4A7EBE24FFA829E24AF0AB9A0DA",
                name: "Configuración de Libro de Facturas",
                action: "W",
                recordTime: 1726085853065,
                window: {
                  _identifier: "Configuración de Libro de Facturas",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/F52BF879A8414C168767A597FA719FD1",
                  id: "F52BF879A8414C168767A597FA719FD1",
                  name: "Configuración de Libro de Facturas",
                  windowType: "M",
                  recordTime: 1726085853066,
                },
              },
              {
                _identifier: "Clave tributaria",
                _entityName: "ADMenu",
                $ref: "ADMenu/931A20C866F042B68FB549C1A34D74E1",
                id: "931A20C866F042B68FB549C1A34D74E1",
                name: "Clave tributaria",
                action: "W",
                recordTime: 1726085853066,
                window: {
                  _identifier: "Clave tributaria",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/7CB14C1ADBA34DBA8F29628FF476DB89",
                  id: "7CB14C1ADBA34DBA8F29628FF476DB89",
                  name: "Clave tributaria",
                  windowType: "M",
                  recordTime: 1726085853067,
                },
              },
              {
                _identifier: "Clave de operación (IVA)",
                _entityName: "ADMenu",
                $ref: "ADMenu/B489D091807B401DB63B5D9C0A0E4017",
                id: "B489D091807B401DB63B5D9C0A0E4017",
                name: "Clave de operación (IVA)",
                action: "W",
                recordTime: 1726085853067,
                window: {
                  _identifier: "Clave de operación (IVA)",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/FD7B2C4EBD6645218736B0B54A9072CD",
                  id: "FD7B2C4EBD6645218736B0B54A9072CD",
                  name: "Clave de operación (IVA)",
                  windowType: "M",
                  recordTime: 1726085853068,
                },
              },
              {
                _identifier: "Declaración de impuestos",
                _entityName: "ADMenu",
                $ref: "ADMenu/F04492673C3B403EBD61740D64C0502E",
                id: "F04492673C3B403EBD61740D64C0502E",
                name: "Declaración de impuestos",
                action: "W",
                recordTime: 1726085853068,
                window: {
                  _identifier: "Declaración de impuestos",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/3E8FEA1EA7404D979306C9EE7FD2E7E8",
                  id: "3E8FEA1EA7404D979306C9EE7FD2E7E8",
                  name: "Declaración de impuestos",
                  windowType: "M",
                  recordTime: 1726085853069,
                },
              },
              {
                _identifier: "AEAT 347 Tipo de documento",
                _entityName: "ADMenu",
                $ref: "ADMenu/5F79469CF1C2475BB7CEA895A275A51B",
                id: "5F79469CF1C2475BB7CEA895A275A51B",
                name: "AEAT 347 Tipo de documento",
                action: "W",
                recordTime: 1726085853069,
                window: {
                  _identifier: "AEAT 347 Tipo de documento",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/57D6A668F8174C34AA2B7187AC5F16A3",
                  id: "57D6A668F8174C34AA2B7187AC5F16A3",
                  name: "AEAT 347 Tipo de documento",
                  windowType: "M",
                  recordTime: 1726085853069,
                },
              },
              {
                _identifier: "Código de Actividad",
                _entityName: "ADMenu",
                $ref: "ADMenu/CFAEC46CE7184D898FC80B0102B20E28",
                id: "CFAEC46CE7184D898FC80B0102B20E28",
                name: "Código de Actividad",
                action: "W",
                recordTime: 1726085853070,
                window: {
                  _identifier: "Código de Actividad",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/568FD0B4FB7A44CCAAEF5FFBA5667A06",
                  id: "568FD0B4FB7A44CCAAEF5FFBA5667A06",
                  name: "Código de Actividad",
                  windowType: "M",
                  recordTime: 1726085853070,
                },
              },
              {
                _identifier: "Epígrafes IAE",
                _entityName: "ADMenu",
                $ref: "ADMenu/F49CCC884C2740AFAE1C0AEA6BC58469",
                id: "F49CCC884C2740AFAE1C0AEA6BC58469",
                name: "Epígrafes IAE",
                action: "W",
                recordTime: 1726085853070,
                window: {
                  _identifier: "Epígrafes IAE",
                  _entityName: "ADWindow",
                  $ref: "ADWindow/CE286A50C5084899AEDCBEDCF1BB03A8",
                  id: "CE286A50C5084899AEDCBEDCF1BB03A8",
                  name: "Epígrafes IAE",
                  windowType: "M",
                  recordTime: 1726085853070,
                },
              },
              {
                _identifier: "PYMEs Chart of Accounts Update",
                _entityName: "ADMenu",
                $ref: "ADMenu/D38F0233E0FB4EC2BFC7130A6199E6D0",
                id: "D38F0233E0FB4EC2BFC7130A6199E6D0",
                name: "PYMEs Chart of Accounts Update",
                action: "P",
                recordTime: 1726085853070,
              },
              {
                _identifier: "General Chart of Accounts Update",
                _entityName: "ADMenu",
                $ref: "ADMenu/407C4A700FF0409E92CF7876361AC48C",
                id: "407C4A700FF0409E92CF7876361AC48C",
                name: "General Chart of Accounts Update",
                action: "P",
                recordTime: 1726085853070,
              },
            ],
          },
        ],
      },
      {
        _identifier: "Activos",
        _entityName: "ADMenu",
        $ref: "ADMenu/345",
        id: "345",
        name: "Activos",
        action: null,
        recordTime: 1726085853071,
        icon: "🗃️",
        children: [
          {
            _identifier: "Activos",
            _entityName: "ADMenu",
            $ref: "ADMenu/800114",
            id: "800114",
            name: "Activos",
            action: "W",
            recordTime: 1726085853071,
            window: {
              _identifier: "Activos",
              _entityName: "ADWindow",
              $ref: "ADWindow/800027",
              id: "800027",
              name: "Activos",
              windowType: "M",
              recordTime: 1726085853071,
            },
          },
          {
            _identifier: "Categoría de Activos",
            _entityName: "ADMenu",
            $ref: "ADMenu/343",
            id: "343",
            name: "Categoría de Activos",
            action: "W",
            recordTime: 1726085853072,
            window: {
              _identifier: "Categoría de Activos",
              _entityName: "ADWindow",
              $ref: "ADWindow/252",
              id: "252",
              name: "Categoría de Activos",
              windowType: "M",
              recordTime: 1726085853072,
            },
          },
          {
            _identifier: "Amortización",
            _entityName: "ADMenu",
            $ref: "ADMenu/800115",
            id: "800115",
            name: "Amortización",
            action: "W",
            recordTime: 1726085853073,
            window: {
              _identifier: "Amortización",
              _entityName: "ADWindow",
              $ref: "ADWindow/800026",
              id: "800026",
              name: "Amortización",
              windowType: "M",
              recordTime: 1726085853073,
            },
          },
          {
            _identifier: "Herramientas de análisis",
            _entityName: "ADMenu",
            $ref: "ADMenu/800081",
            id: "800081",
            name: "Herramientas de análisis",
            action: null,
            recordTime: 1726085853073,
            icon: "📊",
            children: [
              {
                _identifier: "Informe del plan de amortización",
                _entityName: "ADMenu",
                $ref: "ADMenu/392A7B0601FA42F9AFC41FD8E576610D",
                id: "392A7B0601FA42F9AFC41FD8E576610D",
                name: "Informe del plan de amortización",
                action: "R",
                recordTime: 1726085853073,
              },
            ],
          },
        ],
      },
    ],
  },
];

```

## Archivo: `packages/MainUI/next-env.d.ts`

```typescript
/// <reference types="next" />
/// <reference types="next/image-types/global" />

// NOTE: This file should not be edited
// see https://nextjs.org/docs/app/api-reference/config/typescript for more information.

```

## Archivo: `packages/MainUI/next.config.ts`

```typescript
import analyzer from "@next/bundle-analyzer";
import type { NextConfig } from "next";

const DEBUG_MODE = process.env.DEBUG_MODE === "true" || process.env.NODE_ENV === "development";
const ANALYZE = process.env.ANALYZE === "true";

const nextConfig: NextConfig = {
  transpilePackages: ["@mui/material", "@mui/system", "@mui/icons-material", "@emotion/react", "@emotion/styled"],
  modularizeImports: {
    "@mui/material": {
      transform: "@mui/material/{{member}}",
    },
    "@mui/icons-material": {
      transform: "@mui/icons-material/{{member}}",
    },
  },
  reactStrictMode: false,
  cleanDistDir: false,
  output: "standalone",
  compiler: {
    removeConsole: !DEBUG_MODE,
  },
  compress: !DEBUG_MODE,
  webpack(config) {
    config.optimization = {
      ...config.optimization,
      minimize: !DEBUG_MODE,
    };

    const fileLoaderRule = config.module.rules.find((rule: { test: { toString: () => string | string[] } }) =>
      rule.test?.toString().includes("svg")
    );

    if (fileLoaderRule) {
      fileLoaderRule.exclude = /\.svg$/i;
    }

    config.module.rules.push(
      {
        test: /\.svg$/i,
        resourceQuery: /url/,
        type: "asset/resource",
        generator: {
          filename: "static/media/[name].[hash][ext]",
        },
      },
      {
        test: /\.svg$/i,
        resourceQuery: { not: [/url/] },
        use: [
          {
            loader: "@svgr/webpack",
            options: {
              icon: true,
            },
          },
        ],
      }
    );

    if (config.optimization?.minimizer) {
      for (const plugin of config.optimization.minimizer) {
        if (plugin.options?.terserOptions) {
          plugin.options.terserOptions.compress = {
            ...plugin.options.terserOptions.compress,
            drop_console: !DEBUG_MODE,
          };
        }
      }
    }

    return config;
  },
};

export default analyzer({ enabled: ANALYZE, logLevel: "info", openAnalyzer: ANALYZE })(nextConfig);

```

## Archivo: `packages/MainUI/reports/sales-order-invoice.ts`

```typescript
import type { ReportMetadata } from "@workspaceui/api-client/src/hooks/types";

export const INVOICED_SALES_ORDERS_REPORT_META: ReportMetadata = {
  id: "800069",
  title: "Invoiced sale orders report",
  sourcePath: "ReportSalesOrderInvoicedJasper",
  sections: [
    {
      id: "filter",
      title: "Filter",
      fields: [
        {
          id: "dateFrom",
          name: "inpDateFrom",
          label: "From Date",
          type: "date",
          required: true,
          validation: {
            lowerThan: "dateTo",
          },
        },
        {
          id: "dateTo",
          name: "inpDateTo",
          label: "To Date",
          type: "date",
          required: true,
          validation: {
            greaterThan: "dateFrom",
          },
        },
        {
          id: "currency",
          name: "inpCurrencyId",
          label: "Currency",
          type: "select",
          required: true,
          lookupConfig: {
            url: "/api/selector/currencies",
          },
        },
        {
          id: "businessPartner",
          name: "inpcBPartnerId",
          label: "Business Partner",
          type: "search",
          required: false,
          gridWidth: 2,
          lookupConfig: {
            selector: {
              icon: "BusinessPartner",
              title: "Business Partner",
            },
          },
        },
        {
          id: "project",
          name: "inpcProjectId",
          label: "Project",
          type: "search",
          required: false,
          gridWidth: 2,
          lookupConfig: {
            selector: {
              icon: "Project",
              title: "Project",
            },
          },
        },
        {
          id: "warehouse",
          name: "inpmWarehouseId",
          label: "Warehouse",
          type: "select",
          required: false,
          gridWidth: 2,
          lookupConfig: {
            url: "/api/selector/warehouses",
          },
        },
        {
          id: "region",
          name: "inpcRegionId",
          label: "Region",
          type: "select",
          required: false,
          gridWidth: 2,
          lookupConfig: {
            url: "/api/selector/regions",
          },
        },
        {
          id: "productCategory",
          name: "inpProductCategory",
          label: "Product Category",
          type: "select",
          required: false,
          gridWidth: 2,
          lookupConfig: {
            url: "/api/selector/productCategories",
          },
        },
        {
          id: "product",
          name: "inpmProductId",
          label: "Product",
          type: "search",
          required: false,
          gridWidth: 2,
          lookupConfig: {
            selector: {
              icon: "Product",
              title: "Product",
            },
          },
        },
        {
          id: "projectKind",
          name: "inpProjectkind",
          label: "Building Site Type",
          type: "select",
          required: false,
          gridWidth: 2,
          lookupConfig: {
            url: "/api/selector/projectKinds",
          },
        },
        {
          id: "projectPublic",
          name: "inpProjectpublic",
          label: "Initiative Type",
          type: "select",
          required: false,
          gridWidth: 2,
          lookupConfig: {
            url: "/api/selector/projectPublics",
          },
        },
      ],
    },
  ],
  actions: [
    {
      id: "html",
      name: "HTML Format",
      format: "html",
      command: "FIND",
    },
  ],
};

```

## Archivo: `packages/MainUI/reports/sales-order.ts`

```typescript
import type { ReportMetadata } from "@workspaceui/api-client/src/hooks/types";

export const SALES_ORDER_REPORT_META: ReportMetadata = {
  id: "800261",
  title: "Sales Order Report",
  sourcePath: "ReportSalesOrderFilterJR",
  sections: [
    {
      id: "filter",
      title: "Filter",
      fields: [
        {
          id: "dateFrom",
          name: "inpDateFrom",
          label: "From Date",
          type: "date",
          required: true,
          validation: {
            lowerThan: "dateTo",
          },
        },
        {
          id: "dateTo",
          name: "inpDateTo",
          label: "To Date",
          type: "date",
          required: true,
          validation: {
            greaterThan: "dateFrom",
          },
        },
        {
          id: "currency",
          name: "inpCurrencyId",
          label: "Currency",
          type: "select",
          required: true,
          entity: "Currency",
          lookupConfig: {
            url: "/api/selector/currencies",
          },
        },
        {
          id: "project",
          name: "inpcProjectId",
          label: "Project",
          type: "search",
          required: false,
          gridWidth: 2,
          lookupConfig: {
            selector: {
              icon: "Project",
              title: "Search Project",
            },
          },
        },
        {
          id: "warehouse",
          name: "inpmWarehouseId",
          label: "Warehouse",
          type: "select",
          required: false,
          gridWidth: 2,
          entity: "Warehouse",
          lookupConfig: {
            url: "/api/selector/warehouses",
          },
        },
        {
          id: "region",
          name: "inpcRegionId",
          label: "Region",
          type: "select",
          required: false,
          gridWidth: 2,
          lookupConfig: {
            url: "/api/selector/regions",
          },
        },
        {
          id: "businessPartner",
          name: "inpcBPartnerId_IN",
          label: "Business Partner",
          type: "multiselect",
          required: false,
          gridWidth: 2,
          entity: "BusinessPartner",
          columnName: "C_BPartner_ID",
          identifierField: "name",
          columns: [
            {
              header: "Key",
              accessorKey: "searchKey",
            },
            {
              header: "Name",
              accessorKey: "_identifier",
            },
            {
              header: "Credit Available",
              accessorKey: "creditStatus",
            },
            {
              header: "Credit Used",
              accessorKey: "creditUsed",
            },
            {
              header: "Sales Representative",
              accessorKey: "salesRepresentative",
            },
            {
              header: "URL",
              accessorKey: "url",
            },
            {
              header: "Email",
              accessorKey: "email",
            },
          ],
          lookupConfig: {
            multiple: true,
            selector: {
              title: "Select Business Partners",
            },
          },
        },
        {
          id: "product",
          name: "inpmProductId_IN",
          label: "Product",
          type: "multiselect",
          required: false,
          gridWidth: 2,
          entity: "Product",
          columnName: "M_Product_ID",
          identifierField: "name",
          columns: [
            {
              header: "Key",
              accessorKey: "searchKey",
            },
            {
              header: "Name",
              accessorKey: "name",
            },
            {
              header: "Category",
              accessorKey: "productCategory$_identifier",
            },
          ],
          lookupConfig: {
            multiple: true,
            selector: {
              title: "Select Products",
            },
          },
        },
        {
          id: "productCategory",
          name: "inpmProductCategoryId",
          label: "Product Category",
          type: "multiselect",
          required: false,
          gridWidth: 2,
          entity: "ProductCategory",
          columnName: "M_Product_Category_ID",
          identifierField: "name",
          lookupConfig: {
            url: "/api/selector/productCategories",
            multiple: true,
          },
        },
      ],
    },
  ],
  actions: [
    {
      id: "html",
      name: "HTML Format",
      format: "html",
      command: "EDIT_HTML",
    },
    {
      id: "pdf",
      name: "PDF Format",
      format: "pdf",
      command: "EDIT_PDF",
    },
  ],
};

```

## Archivo: `packages/MainUI/screens/Home/index.tsx`

```typescript
"use client";

import { Box, Grid, Typography, Container } from "@mui/material";
import { createWidgets } from "../../../storybook/src/stories/Components/Table/mockWidget";
import { useTranslation } from "@/hooks/useTranslation";
import useStyles from "./styles";

export default function Home() {
  const { t } = useTranslation();
  const styles = useStyles();

  const widgets = createWidgets(t);
  const dashboardWidgets = [widgets[1], widgets[2], widgets[4], widgets[5], widgets[7], widgets[8]];

  return (
    <Container maxWidth="lg" sx={styles.container}>
      <Box sx={styles.headerContainer}>
        <Typography variant="h4" component="h1" sx={styles.pageTitle} gutterBottom>
          {t("common.etendo")} {t("breadcrumb.home")}
        </Typography>
        <Typography variant="subtitle1" sx={styles.pageSubtitle}>
          {t("table.content.currentTitle")}
        </Typography>
      </Box>

      <Grid container spacing={3}>
        {dashboardWidgets.map((widget) => (
          <Grid item key={widget.id} xs={12} md={widget.size === "full" ? 12 : 6}>
            <Box
              sx={{
                ...styles.widgetContainer,
                bgcolor: widget.bgcolor,
                color: widget.color,
              }}>
              <Box sx={styles.widgetHeader}>
                <Box sx={styles.widgetTitleContainer}>
                  <Box
                    sx={{
                      ...styles.iconContainer,
                      bgcolor: widget.iconBgColor,
                    }}>
                    {widget.icon}
                  </Box>
                  <Typography variant="h6" sx={styles.widgetTitle}>
                    {widget.title}
                  </Typography>
                </Box>

                <Box
                  sx={{
                    ...styles.actionButton,
                    bgcolor: widget.iconButtonBgColor,
                    "&:hover": {
                      bgcolor: widget.iconButtonHoverBgColor,
                      "& svg": {
                        fill: widget.iconButtonHoverColor,
                      },
                    },
                  }}
                  onClick={widget.iconButtonAction}
                  title={widget.tooltip || t("table.tooltips.details")}>
                  {widget.icon}
                </Box>
              </Box>
              <Box sx={styles.widgetContent}>{widget.children}</Box>
            </Box>
          </Grid>
        ))}
      </Grid>
    </Container>
  );
}

```

## Archivo: `packages/MainUI/screens/Home/styles.ts`

```typescript
import { useMemo } from "react";

const useStyles = () => {
  return useMemo(
    () => ({
      container: {
        py: 4,
      },
      headerContainer: {
        mb: 4,
      },
      pageTitle: {
        fontWeight: "bold",
      },
      pageSubtitle: {
        color: "text.secondary",
      },
      widgetContainer: {
        p: 3,
        borderRadius: 2,
        height: "100%",
        display: "flex",
        flexDirection: "column",
        boxShadow: "0 4px 6px rgba(0,0,0,0.1)",
      },
      widgetHeader: {
        display: "flex",
        alignItems: "center",
        justifyContent: "space-between",
        mb: 2,
      },
      widgetTitleContainer: {
        display: "flex",
        alignItems: "center",
        gap: 1.5,
      },
      iconContainer: {
        width: 40,
        height: 40,
        borderRadius: "50%",
        display: "flex",
        alignItems: "center",
        justifyContent: "center",
      },
      widgetTitle: {
        fontWeight: "medium",
      },
      actionButton: {
        width: 32,
        height: 32,
        borderRadius: "50%",
        display: "flex",
        alignItems: "center",
        justifyContent: "center",
        cursor: "pointer",
        transition: "all 0.2s",
      },
      widgetContent: {
        flexGrow: 1,
        display: "flex",
        alignItems: "center",
        justifyContent: "center",
      },
    }),
    []
  );
};

export default useStyles;

```

## Archivo: `packages/MainUI/screens/Login/index.tsx`

```typescript
import { useCallback, useState } from "react";
import { useUserContext } from "../../hooks/useUserContext";
import { logger } from "../../utils/logger";
import Login from "../../components/Forms/Login";

export default function LoginScreen() {
  const [error, setError] = useState("");
  const { login } = useUserContext();

  const handleLogin = useCallback(
    async (username: string, password: string) => {
      try {
        await login(username, password);
      } catch (e) {
        logger.warn(e);

        setError(e instanceof Error ? e.message : String(e));
      }
    },
    [login]
  );

  return <Login title="Etendo" onSubmit={handleLogin} error={error} />;
}

```

## Archivo: `packages/MainUI/services/ProcessDefaultsService.ts`

```typescript
import { Metadata } from "@workspaceui/api-client/src/api/metadata";
import { logger } from "@/utils/logger";
import type { EntityValue } from "@workspaceui/api-client/src/api/types";

export interface ProcessDefaultsRequest {
  processId: string;
  windowId: string;
  contextData: Record<string, EntityValue>;
  requestId?: string;
}

export interface ProcessDefaultsServiceResponse {
  success: boolean;
  data?: Record<string, EntityValue>;
  error?: {
    code: string;
    message: string;
    details?: any;
  };
  requestId?: string;
  timestamp: number;
}

/**
 * Service class for handling DefaultsProcessActionHandler API calls
 * Provides centralized API communication with consistent error handling
 */
export class ProcessDefaultsService {
  private static readonly ENDPOINT_ACTION = "org.openbravo.client.application.process.DefaultsProcessActionHandler";
  private static readonly REQUEST_TIMEOUT = 10000; // 10 seconds
  private static readonly MAX_RETRIES = 2;

  /**
   * Fetches process defaults from the backend
   * @param request - The process defaults request parameters
   * @returns Promise with service response
   */
  static async fetchDefaults(request: ProcessDefaultsRequest): Promise<ProcessDefaultsServiceResponse> {
    const { processId, windowId, contextData, requestId } = request;
    const startTime = performance.now();

    try {
      // Validate required parameters
      if (!processId || !windowId) {
        throw new Error("ProcessId and WindowId are required");
      }

      // Build request parameters
      const params = new URLSearchParams({
        processId,
        windowId,
        _action: this.ENDPOINT_ACTION,
      });

      // Prepare request payload
      const requestPayload = {
        ...contextData,
        _requestType: "defaults",
        _requestId: requestId || this.generateRequestId(),
        _timestamp: Date.now().toString(),
      };

      logger.debug("ProcessDefaultsService: Making API request", {
        processId,
        windowId,
        requestId,
        contextKeys: Object.keys(contextData),
      });

      // Make the API call with retry logic
      const response = await this.makeRequestWithRetry(params, requestPayload);
      
      const duration = performance.now() - startTime;
      logger.debug("ProcessDefaultsService: Request completed", {
        processId,
        duration: `${duration.toFixed(2)}ms`,
        defaultsCount: Object.keys(response.data || {}).length,
      });

      return {
        success: true,
        data: response.data || {},
        requestId,
        timestamp: Date.now(),
      };

    } catch (error) {
      const duration = performance.now() - startTime;
      
      logger.error("ProcessDefaultsService: Request failed", {
        processId,
        windowId,
        requestId,
        duration: `${duration.toFixed(2)}ms`,
        error: error instanceof Error ? error.message : "Unknown error",
      });

      return {
        success: false,
        error: this.processError(error),
        requestId,
        timestamp: Date.now(),
      };
    }
  }

  /**
   * Makes API request with retry logic for transient failures
   */
  private static async makeRequestWithRetry(
    params: URLSearchParams, 
    payload: Record<string, any>,
    attempt = 1
  ): Promise<any> {
    try {
      // Create abort controller for timeout
      const abortController = new AbortController();
      const timeoutId = setTimeout(() => abortController.abort(), this.REQUEST_TIMEOUT);

      const response = await Metadata.kernelClient.post(`?${params}`, payload, {
        signal: abortController.signal,
        headers: {
          "Content-Type": "application/json;charset=UTF-8",
          "X-Request-Type": "process-defaults",
          "X-Attempt": attempt.toString(),
        },
      });

      clearTimeout(timeoutId);
      return response;

    } catch (error) {
      // Retry logic for transient failures
      if (attempt < this.MAX_RETRIES && this.isRetryableError(error)) {
        logger.warn(`ProcessDefaultsService: Retrying request (attempt ${attempt + 1}/${this.MAX_RETRIES})`);
        
        // Exponential backoff delay
        const delay = Math.min(1000 * Math.pow(2, attempt - 1), 5000);
        await new Promise(resolve => setTimeout(resolve, delay));
        
        return this.makeRequestWithRetry(params, payload, attempt + 1);
      }

      throw error;
    }
  }

  /**
   * Determines if an error is retryable
   */
  private static isRetryableError(error: any): boolean {
    if (error instanceof Error) {
      // Network errors are retryable
      if (error.name === 'NetworkError' || error.message.includes('fetch')) {
        return true;
      }
      
      // Timeout errors are retryable
      if (error.name === 'AbortError' || error.message.includes('timeout')) {
        return true;
      }
    }

    // HTTP 5xx errors are retryable
    if (error?.response?.status >= 500 && error?.response?.status < 600) {
      return true;
    }

    return false;
  }

  /**
   * Processes and normalizes error responses
   */
  private static processError(error: any): { code: string; message: string; details?: any } {
    if (error instanceof Error) {
      // Handle abort/timeout errors
      if (error.name === 'AbortError') {
        return {
          code: 'REQUEST_TIMEOUT',
          message: 'Request timed out while fetching process defaults',
          details: { timeout: this.REQUEST_TIMEOUT },
        };
      }

      // Handle network errors
      if (error.message.includes('fetch') || error.name === 'NetworkError') {
        return {
          code: 'NETWORK_ERROR',
          message: 'Network error while fetching process defaults',
          details: { originalError: error.message },
        };
      }

      // Handle validation errors
      if (error.message.includes('required')) {
        return {
          code: 'VALIDATION_ERROR',
          message: error.message,
          details: { type: 'parameter_validation' },
        };
      }

      return {
        code: 'API_ERROR',
        message: `API error: ${error.message}`,
        details: { originalError: error.message },
      };
    }

    // Handle HTTP response errors
    if (error?.response) {
      const status = error.response.status;
      const statusText = error.response.statusText || 'Unknown error';
      
      if (status === 400) {
        return {
          code: 'BAD_REQUEST',
          message: 'Invalid request parameters',
          details: { status, statusText, data: error.response.data },
        };
      }
      
      if (status === 401 || status === 403) {
        return {
          code: 'UNAUTHORIZED',
          message: 'Authentication failed or access denied',
          details: { status, statusText },
        };
      }
      
      if (status === 404) {
        return {
          code: 'NOT_FOUND',
          message: 'Process or endpoint not found',
          details: { status, statusText },
        };
      }
      
      if (status >= 500) {
        return {
          code: 'SERVER_ERROR',
          message: 'Internal server error',
          details: { status, statusText },
        };
      }
    }

    return {
      code: 'UNKNOWN_ERROR',
      message: 'An unknown error occurred',
      details: { error },
    };
  }

  /**
   * Generates a unique request ID for tracking
   */
  private static generateRequestId(): string {
    return `defaults_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
  }

  /**
   * Validates the response data structure
   */
  static validateResponse(data: any): boolean {
    if (!data || typeof data !== 'object') {
      return false;
    }

    // Check if response has expected structure for defaults
    return true; // Process defaults can have any structure
  }

  /**
   * Transforms backend response to normalized format
   */
  static normalizeDefaults(responseData: any): Record<string, EntityValue> {
    if (!responseData || typeof responseData !== 'object') {
      return {};
    }

    const normalized: Record<string, EntityValue> = {};

    // Handle different response formats from backend
    for (const [key, value] of Object.entries(responseData)) {
      if (value !== null && value !== undefined) {
        // Handle object values with identifier/value structure
        if (typeof value === 'object' && value !== null && 'identifier' in value) {
          normalized[key] = (value as any).identifier;
        } else {
          normalized[key] = value as EntityValue;
        }
      }
    }

    return normalized;
  }

  /**
   * Gets service configuration and statistics
   */
  static getServiceInfo() {
    return {
      endpointAction: this.ENDPOINT_ACTION,
      timeout: this.REQUEST_TIMEOUT,
      maxRetries: this.MAX_RETRIES,
      version: "1.0.0",
    };
  }
}
```

## Archivo: `packages/MainUI/services/callouts.ts`

```typescript
import { logger } from "@/utils/logger";

class GlobalCalloutManager {
  private isCalloutInProgress = false;
  private pendingCallouts = new Map<string, () => Promise<void>>();
  private calloutQueue: string[] = [];

  async executeCallout(fieldName: string, calloutFn: () => Promise<void>): Promise<void> {
    return new Promise((resolve, reject) => {
      const wrappedCallout = async () => {
        try {
          await calloutFn();
          resolve();
        } catch (error) {
          reject(error);
        }
      };

      this.pendingCallouts.set(fieldName, wrappedCallout);

      if (!this.calloutQueue.includes(fieldName)) {
        this.calloutQueue.push(fieldName);
      }

      if (!this.isCalloutInProgress) {
        this.processQueue();
      }
    });
  }

  private async processQueue(): Promise<void> {
    if (this.isCalloutInProgress || this.calloutQueue.length === 0) {
      return;
    }

    this.isCalloutInProgress = true;

    try {
      const fieldName = this.calloutQueue.shift();
      if (!fieldName) return;

      const callout = this.pendingCallouts.get(fieldName);
      if (!callout) return;

      await callout();

      this.pendingCallouts.delete(fieldName);

      await new Promise((resolve) => setTimeout(resolve, 100));
    } catch (error) {
      logger.error("Callout execution failed:", error);
    } finally {
      this.isCalloutInProgress = false;

      if (this.calloutQueue.length > 0) {
        setTimeout(() => this.processQueue(), 10);
      }
    }
  }

  isCalloutRunning(): boolean {
    return this.isCalloutInProgress;
  }

  clearPendingCallouts(): void {
    this.pendingCallouts.clear();
    this.calloutQueue.length = 0;
  }

  arePendingCalloutsEmpty(): boolean {
    return this.calloutQueue.length === 0 && this.pendingCallouts.size === 0;
  }
}

export const globalCalloutManager = new GlobalCalloutManager();

```

## Archivo: `packages/MainUI/types/svgr.d.ts`

```typescript
declare module "*.svg" {
  import type { FC, SVGProps } from "react";
  const content: FC<SVGProps<SVGSVGElement>>;
  export default content;
}

declare module "*.svg?url" {
  const content: string;
  export default content;
}

```

## Archivo: `packages/MainUI/types/theme.d.ts`

```typescript
import "@mui/material/styles";

declare module "@mui/material/styles" {
  interface BaselineColor {
    neutral: { [key: number]: string };
    transparentNeutral: { [key: number]: string };
    etendoPrimary: PaletteColor;
  }

  interface SpecificColor {
    success: PaletteColor;
    warning: PaletteColor;
    error: PaletteColor;
    draft: PaletteColor;
  }

  interface Palette {
    dynamicColor: PaletteColor;
    baselineColor: BaselineColor;
    specificColor: SpecificColor;
  }

  interface PaletteOptions {
    dynamicColor?: PaletteColorOptions;
    baselineColor?: {
      neutral?: { [key: number]: string };
      transparentNeutral?: { [key: number]: string };
      etendoPrimary?: PaletteColorOptions;
    };
    specificColor?: {
      success?: PaletteColorOptions;
      warning?: PaletteColorOptions;
      error?: PaletteColorOptions;
      draft?: PaletteColorOptions;
    };
    tertiary?: PaletteColorOptions;
  }

  interface ThemeOptions {
    palette?: PaletteOptions;
  }

  interface Theme {
    palette: Palette;
  }

  interface BaseTheme {
    palette: Palette;
  }
}

```

## Archivo: `packages/MainUI/utils/accessibility/constants.ts`

```typescript
export const DENSITY_KEY = "density";

```

## Archivo: `packages/MainUI/utils/columnsConstants.tsx`

```typescript
import type { TagType } from "@workspaceui/componentlibrary/src/components/Tag/types";
import InfoIcon from "../../ComponentLibrary/src/assets/icons/info.svg";
import CheckIcon from "../../ComponentLibrary/src/assets/icons/check-circle.svg";
import ErrorIcon from "../../ComponentLibrary/src/assets/icons/alert-octagon.svg";

const defaultColor = "var(--color-baseline-0)";

export const statusConfig: Record<string, { type: TagType; icon?: React.ReactElement }> = {
  AP: { type: "success" }, // Accepted
  CL: { type: "success" }, // Closed
  CO: { type: "success" }, // Booked
  PO: { type: "success" }, // Posted
  CA: { type: "success" }, // Closed - Order Created

  IP: { type: "warning" }, // Under Way
  CH: { type: "warning" }, // Modified
  PR: { type: "warning" }, // Printed
  XX: { type: "warning" }, // Procesando
  UE: { type: "warning" }, // Under Evaluation
  ME: { type: "warning" }, // Manual Evaluation
  AE: { type: "warning" }, // Automatic Evaluation

  NA: { type: "error" }, // Not Accepted
  VO: { type: "error" }, // Voided
  PE: { type: "error" }, // Accounting Error
  TE: { type: "error" }, // Transfer Error
  IN: { type: "error" }, // Inactive
  CJ: { type: "error" }, // Closed - Rejected
  NC: { type: "error" }, // Not Confirmed
  WP: { type: "error" }, // Not Paid

  TR: { type: "primary" }, // Transferred
  RE: { type: "primary" }, // Re-Opened

  DR: { type: "draft" }, // Draft
  TMP: { type: "draft" }, // Temporal
  "??": { type: "draft" }, // Unknown
};

export const DEFAULT_STATUS_CONFIG = {
  type: "draft" as TagType,
  icon: <InfoIcon fill={defaultColor} />,
};

export const yesNoConfig = {
  Y: {
    type: "success" as TagType,
    icon: <CheckIcon fill={defaultColor} />,
  },
  N: {
    type: "error" as TagType,
    icon: <ErrorIcon fill={defaultColor} />,
  },
};

export const IDENTIFIER_KEY = "_identifier";

```

## Archivo: `packages/MainUI/utils/commons.ts`

```typescript
/**
 * A collection of common utility functions for general use throughout the application.
 * @module utils/commons
 */

/**
 * Checks if an object is empty (has no own enumerable properties).
 *
 * @template T - A generic type that extends Record<string, unknown> to ensure type safety with object literals
 * @param {T} obj - The object to check
 * @returns {boolean} True if the object has no own enumerable properties, false otherwise
 *
 * @example
 * // Returns true
 * isEmptyObject({});
 *
 * @example
 * // Returns false
 * isEmptyObject({ key: 'value' });
 */
export const isEmptyObject = <T extends Record<string, unknown>>(obj: T): boolean => {
  return Object.keys(obj).length === 0;
};

/**
 * Extracts the first non-empty value from a list of keys in a given object.
 *
 * @template T - The type of the input object
 * @template K - A union of the object's keys as strings
 * @param {T} obj - The object to extract values from
 * @param {K[]} keys - An array of keys to check in order
 * @param {string} defaultValue - A fallback value returned when no key contains a non-empty value
 * @returns {string} The first non-empty value found (converted to string), or the default value
 *
 * A value is considered "non-empty" if it is not `undefined`, `null`, or an empty string (`""`).
 *
 * @example
 * const user = { name: '', username: 'jdoe', email: 'jdoe@example.com' };
 * // Returns 'jdoe'
 * extractValue(user, ['name', 'username', 'email'], 'N/A');
 *
 * @example
 * const data = { a: null, b: '', c: undefined };
 * // Returns 'default'
 * extractValue(data, ['a', 'b', 'c'], 'default');
 */
export const extractValue = <T extends Record<string, unknown>, K extends keyof T>(
  obj: T,
  keys: K[],
  defaultValue: string
): string => {
  for (const key of keys) {
    const value = obj[key];
    if (value !== undefined && value !== null && value !== "") {
      return String(value);
    }
  }
  return defaultValue;
};

```

## Archivo: `packages/MainUI/utils/constants.ts`

```typescript
export const FALLBACK_URL = "http://localhost:8080/etendo";

```

## Archivo: `packages/MainUI/utils/contextUtils.ts`

```typescript
import { CONTEXT_CONSTANTS } from "@workspaceui/api-client/src/api/copilot";

interface ContextItem {
  contextString: string;
}

interface BuildContextStringOptions {
  contextItems: ContextItem[];
  registersText: string;
}

export const buildContextString = ({ contextItems, registersText }: BuildContextStringOptions): string => {
  if (contextItems.length === 0) {
    return "";
  }

  const recordsData = contextItems.map((item) => item.contextString);
  const count = contextItems.length;

  return `${CONTEXT_CONSTANTS.TAG_START} (${count} ${registersText}):\n\n${recordsData.join("\n\n---\n\n")}${CONTEXT_CONSTANTS.TAG_END}`;
};

```

## Archivo: `packages/MainUI/utils/defaults.ts`

```typescript
export const EMPTY_ARRAY = [];
export const EMPTY_OBJECT = {};
export const EMPTY_STRING = "";

```

## Archivo: `packages/MainUI/utils/form/constants.ts`

```typescript
export const CUSTOM_SELECTORS_IDENTIFIERS = {
  LOCATION: "Location",
};

/**
 * Field reference codes used in form field type identification
 */
export const FIELD_REFERENCE_CODES = {
  // Password field reference
  PASSWORD: "C5C21C28B39E4683A91779F16C112E40",
  
  // Product reference to datasource
  PRODUCT: "95E2A8B50A254B2AAE6774B8C2F28120",
  
  // Window reference
  WINDOW: "FF80818132D8F0F30132D9BC395D0038",
  
  // Table directory references
  TABLE_DIR_19: "19",
  TABLE_DIR_18: "18",
  
  // Date and time references
  DATE: "15",
  DATETIME: "16",
  
  // Boolean reference
  BOOLEAN: "20",
  
  // Numeric references
  QUANTITY_29: "29",
  QUANTITY_22: "22",
  
  // List references
  LIST_17: "17",
  LIST_13: "13",
  
  // Select reference with location support
  SELECT_30: "30",
  LOCATION_21: "21",
  
  // Numeric types
  DECIMAL: "800008",
  INTEGER: "11",
} as const;

/**
 * Process execution related reference codes
 */
export const PROCESS_REFERENCE_CODES = {
  // Client reference
  CLIENT: "23C59575B9CF467C9620760EB255B389",
  
  // Process reference
  PROCESS: "7BABA5FF80494CAFA54DEBD22EC46F01",
} as const;

/**
 * Datasource reference codes
 */
export const DATASOURCE_REFERENCE_CODES = {
  // Product datasource
  PRODUCT: "95E2A8B50A254B2AAE6774B8C2F28120",
  
  // Fallback selector
  FALLBACK_SELECTOR_ID: "EB3C41F0973A4EDA91E475833792A6D4",
} as const;

```

## Archivo: `packages/MainUI/utils/form/entityConfig.ts`

```typescript
import type { FormMode } from "@workspaceui/api-client/src/api/types";

export interface EntityConfig {
  /** The entity name as it appears in tab.entityName */
  entityName: string;
  /** Remove ID fields when creating new records */
  removeIdOnCreate?: boolean;
  /** Remove ID fields when editing existing records */
  removeIdOnEdit?: boolean;
  /** Custom behaviors for different form modes */
  customBehaviors?: {
    [key in FormMode]?: {
      /** Fields to remove from the payload */
      removeFields?: string[];
      /** Fields to add to the payload */
      addFields?: Record<string, unknown>;
    };
  };
}

/**
 * Configuration for entities that require special handling during form operations
 *
 * @example
 * // To add a new entity configuration:
 * {
 *   entityName: 'YourEntity',
 *   removeIdOnCreate: true,
 *   customBehaviors: {
 *     NEW: {
 *       removeFields: ['someField'],
 *       addFields: { defaultField: 'defaultValue' }
 *     }
 *   }
 * }
 */
export const ENTITY_CONFIGURATIONS: EntityConfig[] = [
  {
    entityName: "UOM",
    removeIdOnCreate: true,
  },
  {
    entityName: "ADUser",
    customBehaviors: {
      EDIT: {
        addFields: {
          inppassword: "***",
          _gridVisibleProperties: [
            "id",
            "name",
            "username",
            "firstName",
            "lastName",
            "password",
            "description",
            "active",
            "businessPartner",
            "partnerAddress",
            "email",
            "locked",
            "position",
            "birthday",
            "phone",
            "alternativePhone",
            "fax",
            "emailServerUsername",
            "emailServerPassword",
            "supervisor",
            "defaultRole",
            "smfswsDefaultWsRole",
            "defaultLanguage",
            "defaultClient",
            "defaultOrganization",
            "defaultWarehouse",
            "etasEnableMultSession",
          ],
        },
      },
    },
  },
  // Add more entity configurations here as needed
];

/**
 * Get configuration for a specific entity
 */
export const getEntityConfig = (entityName: string): EntityConfig | undefined => {
  return ENTITY_CONFIGURATIONS.find((config) => config.entityName === entityName);
};

/**
 * Check if an entity should have ID fields removed for a specific mode
 */
export const shouldRemoveIdFields = (entityName: string, mode: FormMode): boolean => {
  const config = getEntityConfig(entityName);
  if (!config) return false;

  return (mode === "NEW" && Boolean(config.removeIdOnCreate)) || (mode === "EDIT" && Boolean(config.removeIdOnEdit));
};

/**
 * Get custom fields to remove for a specific entity and mode
 */
export const getFieldsToRemove = (entityName: string, mode: FormMode): string[] => {
  const config = getEntityConfig(entityName);
  return config?.customBehaviors?.[mode]?.removeFields || [];
};

/**
 * Get custom fields to add for a specific entity and mode
 */
export const getFieldsToAdd = (entityName: string, mode: FormMode): Record<string, unknown> => {
  const config = getEntityConfig(entityName);
  return config?.customBehaviors?.[mode]?.addFields || {};
};

```

## Archivo: `packages/MainUI/utils/formUtils.ts`

```typescript
export {};

```

## Archivo: `packages/MainUI/utils/functions.ts`

```typescript
export async function executeStringFunction(code: string, context = {}, ...args: unknown[]) {
  const contextKeys = Object.keys(context);
  const contextValues = Object.values(context);
  const fn = new Function(...contextKeys, `return ${code}`);
  const evaluatedFn = fn(...contextValues);

  return await evaluatedFn(...args);
}

```

## Archivo: `packages/MainUI/utils/health-check.ts`

```typescript
import { delay } from "@/utils";
import { logger } from "@/utils/logger";
import { API_LOGIN_URL } from "@workspaceui/api-client/src/api/constants";

export async function performHealthCheck(
  url: string,
  signal: AbortSignal,
  maxAttempts: number,
  delayMs: number,
  onSuccess: () => void,
  onError: () => void
) {
  for (let attempt = 1; attempt <= maxAttempts; attempt++) {
    try {
      const response = await fetch(url + API_LOGIN_URL, {
        method: "OPTIONS",
        signal,
        keepalive: false,
        credentials: "include",
      });

      if (response.ok && !signal.aborted) {
        onSuccess();

        break;
      }
      throw new Error(response.statusText);
    } catch (error) {
      if (signal.aborted) return;

      logger.warn(`Health check attempt ${attempt} failed:`, error);

      if (attempt === maxAttempts && !signal.aborted) {
        onError();
      }

      await delay(delayMs);
    }
  }
}

export async function performCopilotHealthCheck(baseUrl: string, token: string, signal?: AbortSignal) {
  const assistantsUrl = `${baseUrl}assistants`;

  logger.info("Copilot Health Check:", {
    baseUrl,
    assistantsUrl,
    hasToken: !!token,
    tokenLength: token?.length || 0,
  });

  try {
    const headers: HeadersInit = {
      "Content-Type": "application/json",
    };

    if (process.env.NODE_ENV === "production") {
      headers.Authorization = `Bearer ${token}`;
    } else {
      headers.Authorization = `Basic ${btoa("admin:admin")}`;
    }

    const response = await fetch(assistantsUrl, {
      method: "GET",
      headers,
      signal,
      credentials: "include",
    });

    logger.info("Copilot Health Check Response:", {
      status: response.status,
      statusText: response.statusText,
      ok: response.ok,
      url: response.url,
      headers: Object.fromEntries(response.headers.entries()),
    });

    if (response.ok) {
      const data = await response.text();
      logger.info("Copilot Health Check Data:", data.substring(0, 200));
      return { success: true, data, status: response.status };
    }
    const errorText = await response.text();
    logger.error("Copilot Health Check Failed:", errorText.substring(0, 200));
    return { success: false, error: errorText, status: response.status };
  } catch (error) {
    logger.error("Copilot Health Check Error:", error);
    return { success: false, error: error instanceof Error ? error.message : "Unknown error" };
  }
}

```

## Archivo: `packages/MainUI/utils/index.ts`

```typescript
import {
  type EntityData,
  type Field,
  FieldType,
  FormMode,
  type Tab,
  type WindowMetadata,
} from "@workspaceui/api-client/src/api/types";
import { FIELD_REFERENCE_CODES } from "./form/constants";

export const delay = (ms: number) => new Promise((resolve) => setTimeout(resolve, ms));

export const getFieldReference = (reference?: string): FieldType => {
  switch (reference) {
    case "10":
      return FieldType.DATETIME;
    case FIELD_REFERENCE_CODES.TABLE_DIR_19:
    case FIELD_REFERENCE_CODES.PRODUCT:
    case FIELD_REFERENCE_CODES.TABLE_DIR_18:
      return FieldType.TABLEDIR;
    case FIELD_REFERENCE_CODES.DATE:
    case FIELD_REFERENCE_CODES.DATETIME:
      return FieldType.DATE;
    case FIELD_REFERENCE_CODES.BOOLEAN:
      return FieldType.BOOLEAN;
    case FIELD_REFERENCE_CODES.QUANTITY_29:
      return FieldType.QUANTITY;
    case FIELD_REFERENCE_CODES.LIST_17:
    case FIELD_REFERENCE_CODES.LIST_13:
      return FieldType.LIST;
    case "28":
      return FieldType.BUTTON;
    case FIELD_REFERENCE_CODES.SELECT_30:
      return FieldType.SELECT;
    case FIELD_REFERENCE_CODES.WINDOW:
      return FieldType.WINDOW;
    default:
      return FieldType.TEXT;
  }
};

export const sanitizeValue = (value: unknown, field?: Field) => {
  const reference = getFieldReference(field?.column?.reference);

  if (reference === FieldType.DATE) {
    return value ? String(value).split("-").toReversed().join("-") : null;
  }

  const stringValue = String(value);

  const valueMap = {
    true: "Y",
    false: "N",
    null: null,
  } as const;

  const safeValue = Object.prototype.hasOwnProperty.call(valueMap, stringValue)
    ? valueMap[stringValue as keyof typeof valueMap]
    : value;

  return safeValue;
};

export const buildPayloadByInputName = (values?: Record<string, unknown> | null, fields?: Record<string, Field>) => {
  if (!values) return null;

  return Object.entries(values).reduce(
    (acc, [key, value]) => {
      const field = fields?.[key];
      const newKey = field?.inputName ?? key;

      acc[newKey] = sanitizeValue(value, field);

      return acc;
    },
    {} as Record<string, unknown>
  );
};

export const parseDynamicExpression = (expr: string) => {
  // Transform @field_name@ syntax to valid JavaScript references
  const expr0 = expr.replace(/@([a-zA-Z_][a-zA-Z0-9_]*)@/g, (_, fieldName) => {
    return `(currentValues["${fieldName}"] || context["${fieldName}"])`;
  });

  // Transform Etendo comparison operators to JavaScript
  // Convert single = to == for comparison (avoiding conflicts with assignment)
  const expr1 = expr0.replace(/([^=!<>])=([^=])/g, '$1==$2');

  const expr2 = expr1.replace(/OB\.Utilities\.getValue\((\w+),\s*["']([^"']+)["']\)/g, (_, obj, prop) => {
    return `${obj}["${prop}"]`;
  });

  const expr3 = expr2.replace(/context\.(\$?\w+)/g, (_, prop) => {
    return `context.${prop}`;
  });

  const expr4 = expr3.replace(/context\[\s*(['"])([^"'\]]+)\1\s*\]/g, (_, quote, prop) => {
    return `context[${quote}${prop}${quote}]`;
  });

  const expr5 = expr4.replace(/context\[\s*(['"])(.*?)\1\s*\]/g, (_, quote, key) => {
    return `context[${quote}${key}${quote}]`;
  });

  return expr5;
};

export const buildQueryString = ({
  mode,
  windowMetadata,
  tab,
}: {
  windowMetadata?: WindowMetadata;
  tab: Tab;
  mode: FormMode;
}) =>
  new URLSearchParams({
    windowId: String(windowMetadata?.id || ""),
    tabId: String(tab.id),
    moduleId: String(tab.module),
    _operationType: mode === FormMode.NEW ? "add" : "update",
    _noActiveFilter: String(true),
    sendOriginalIDBack: String(true),
    _extraProperties: "",
    Constants_FIELDSEPARATOR: "$",
    _className: "OBViewDataSource",
    Constants_IDENTIFIER: "_identifier",
    isc_dataFormat: "json",
  });

export const buildFormPayload = ({
  values,
  oldValues,
  mode,
  csrfToken,
}: {
  values: EntityData;
  oldValues?: EntityData;
  mode: FormMode;
  csrfToken: string;
}) => ({
  dataSource: "isc_OBViewDataSource_0",
  operationType: mode === FormMode.NEW ? "add" : "update",
  componentId: "isc_OBViewForm_0",
  data: {
    accountingDate: new Date(),
    ...values,
  },
  oldValues,
  csrfToken,
});

export const buildRequestOptions = (
  values: EntityData,
  initialState: EntityData,
  mode: FormMode,
  userId: string,
  signal: AbortSignal
) => ({
  signal,
  method: "POST",
  body: buildFormPayload({ values, oldValues: initialState, mode, csrfToken: userId }),
});

export const formatNumber = (value: number) => new Intl.NumberFormat(navigator.language).format(value);

export const formatTime = (input: string | Date): string => {
  const date = typeof input === "string" ? new Date(input) : input;
  const hours = date.getHours();
  const minutes = date.getMinutes();
  const hoursStr = hours < 10 ? `0${hours}` : hours.toString();
  const minutesStr = minutes < 10 ? `0${minutes}` : minutes.toString();

  return `${hoursStr}:${minutesStr}`;
};

export const getMessageType = (sender: string) => {
  if (sender === "error") {
    return "error";
  }
  if (sender === "user") {
    return "right-user";
  }
  return "left-user";
};

export const formatLabel = (label: string, count?: number): string | undefined => {
  if (label.includes("%s") && count !== undefined) {
    return label.replace("%s", String(count));
  }
  return undefined;
};

export const buildProcessPayload = (
  record: Record<string, unknown>,
  tab: Tab,
  processDefaults: Record<string, unknown> = {},
  userInput: Record<string, unknown> = {}
) => {
  // Base record values with input name mapping
  const recordValues = buildPayloadByInputName(record, tab.fields);

  // System context fields that are needed for process execution
  const systemContext = {
    // Window/Tab metadata
    [`inp${tab.entityName?.replace(/^C_/, '')?.toLowerCase() || 'record'}Id`]: record.id,
    inpTabId: String(tab.id),
    inpwindowId: String(tab.window),
    inpTableId: String(tab.table),
    inpkeyColumnId: `${tab.entityName}_ID`, // Use entityName + "_ID" pattern instead of keyColumn
    keyProperty: "id",
    inpKeyName: `inp${tab.entityName}_ID`, // Use entityName + "_ID" pattern
    keyColumnName: `${tab.entityName}_ID`, // Use entityName + "_ID" pattern
    keyPropertyType: "_id_13",

    // Process execution fields
    PromotionsDefined: "N",
    IsReversalDocument: "N",
    DOCBASETYPE: record.docBaseType || "",
    VoidAutomaticallyCreated: 0,
    FinancialManagement: "Y",
    _ShowAcct: "Y",

    // Accounting dimension display logic
    ACCT_DIMENSION_DISPLAY: "",
    "$IsAcctDimCentrally": "Y",

    // Element context fields (these come from accounting configuration)
    $Element_BP: record.cBpartnerId ? "Y" : "",
    $Element_OO: record.adOrgId ? "Y" : "",
    $Element_PJ: record.cProjectId ? "Y" : "",
    $Element_CC: record.cCostcenterId ? "Y" : "",
    $Element_MC: record.mCostcenterId ? "Y" : "",
    $Element_U1: record.user1Id ? "Y" : "",
    $Element_U2: record.user2Id ? "Y" : "",

    // Document-specific element visibility
    "$Element_BP_ARI_H": "Y",
    "$Element_OO_ARI_H": "Y",
    "$Element_PJ_ARI_H": "Y",
    "$Element_CC_ARI_H": "",
    "$Element_U1_ARI_H": "N",
    "$Element_U2_ARI_H": "N",
  };

  // Combine all payload parts
  return {
    ...recordValues,      // Record data with proper input names
    ...systemContext,     // System context and metadata
    ...processDefaults,   // Process defaults from server
    ...userInput,         // User input from form
  };
};

export { shouldShowTab, type TabWithParentInfo } from "./tabUtils";

```

## Archivo: `packages/MainUI/utils/language.ts`

```typescript
import { DEFAULT_LANGUAGE, translations, type Language } from "@workspaceui/componentlibrary/src/locales";

export const t = (
  language: Language,
  key: string,
  value: unknown = translations[language] ?? translations[DEFAULT_LANGUAGE]
): string => {
  if (!language) {
    language = DEFAULT_LANGUAGE;
  }

  const keys = key.split(".");
  const [currentKey, ...remainingKeys] = keys;

  if (typeof value !== "object" || value === null || !(currentKey in value)) {
    return key;
  }

  const nextValue = value[currentKey as keyof typeof value];

  if (remainingKeys.length === 0) {
    return typeof nextValue === "string" ? nextValue : key;
  }

  return t(language, remainingKeys.join("."), nextValue);
};

export const getLanguage = (): Language => {
  if (typeof window !== "undefined") {
    const savedLanguage = localStorage.getItem("currentLanguage");

    return (savedLanguage as Language) || DEFAULT_LANGUAGE;
  }

  return DEFAULT_LANGUAGE;
};

```

## Archivo: `packages/MainUI/utils/languageFlags.ts`

```typescript
export const languageFlags: Record<string, string> = {
  es_AR: "🇦🇷",
  es_BO: "🇧🇴",
  es_CL: "🇨🇱",
  es_CO: "🇨🇴",
  es_CR: "🇨🇷",
  es_DO: "🇩🇴",
  es_EC: "🇪🇨",
  es_SV: "🇸🇻",
  es_GT: "🇬🇹",
  es_HN: "🇭🇳",
  es_MX: "🇲🇽",
  es_NI: "🇳🇮",
  es_PA: "🇵🇦",
  es_PY: "🇵🇾",
  es_PE: "🇵🇪",
  es_PR: "🇵🇷",
  es_UY: "🇺🇾",
  es_VE: "🇻🇪",
  es_ES: "🇪🇸",
  en_US: "🇺🇸",
  en_GB: "🇬🇧",
  en_CA: "🇨🇦",
  en_AU: "🇦🇺",
  en_NZ: "🇳🇿",
  fr_FR: "🇫🇷",
  fr_CA: "🇨🇦",
  de_DE: "🇩🇪",
  it_IT: "🇮🇹",
  pt_PT: "🇵🇹",
  pt_BR: "🇧🇷",
  ru_RU: "🇷🇺",
  zh_CN: "🇨🇳",
  ja_JP: "🇯🇵",
  ko_KR: "🇰🇷",
  ar_SA: "🇸🇦",
  ar_EG: "🇪🇬",
  ar_AE: "🇦🇪",
  hi_IN: "🇮🇳",
  en_IN: "🇮🇳",
  nl_NL: "🇳🇱",
  pl_PL: "🇵🇱",
  tr_TR: "🇹🇷",
  sv_SE: "🇸🇪",
  da_DK: "🇩🇰",
  fi_FI: "🇫🇮",
  no_NO: "🇳🇴",
  is_IS: "🇮🇸",
  cs_CZ: "🇨🇿",
  sk_SK: "🇸🇰",
  hu_HU: "🇭🇺",
  ro_RO: "🇷🇴",
  bg_BG: "🇧🇬",
  hr_HR: "🇭🇷",
  sr_RS: "🇷🇸",
  mk_MK: "🇲🇰",
  sq_AL: "🇦🇱",
  et_EE: "🇪🇪",
  lv_LV: "🇱🇻",
  lt_LT: "🇱🇹",
  iw_IL: "🇮🇱",
  ar_LB: "🇱🇧",
  ms_MY: "🇲🇾",
  id_ID: "🇮🇩",
  th_TH: "🇹🇭",
  vi_VN: "🇻🇳",
  km_KH: "🇰🇭",
  la_LA: "🇱🇦",
  my_MM: "🇲🇲",
  ne_NP: "🇳🇵",
  si_LK: "🇱🇰",
  mn_MN: "🇲🇳",
  tl_PH: "🇵🇭",
  en_SG: "🇸🇬",
  ka_GE: "🇬🇪",
  hy_AM: "🇦🇲",
  bn_IN: "🇮🇳",
  cy_GB: "🇬🇧",
  af_ZA: "🇿🇦",
  sw_KE: "🇰🇪",
  zu_ZA: "🇿🇦",
  ig_NG: "🇳🇬",
  yo_NG: "🇳🇬",
  ha_NG: "🇳🇬",
  am_ET: "🇪🇹",
  or_IN: "🇮🇳",
  gu_IN: "🇮🇳",
  pa_IN: "🇮🇳",
  mr_IN: "🇮🇳",
  ta_IN: "🇮🇳",
  te_IN: "🇮🇳",
  ml_IN: "🇮🇳",
  kn_IN: "🇮🇳",
  zh_TW: "🇹🇼",
  zh_HK: "🇭🇰",
  en_ZA: "🇿🇦",
  fr_BF: "🇧🇫",
  en_PH: "🇵🇭",
  de_AT: "🇦🇹",
  de_CH: "🇨🇭",
  fr_BE: "🇧🇪",
  fr_LU: "🇱🇺",
  en_KW: "🇰🇼",
};

const FALLBACK_FLAG = "🌐";

export const getLanguageFlag = (languageCode: string | null): string => {
  return languageCode ? languageFlags[languageCode] || FALLBACK_FLAG : FALLBACK_FLAG;
};

```

## Archivo: `packages/MainUI/utils/logger.ts`

```typescript
export interface ILogger {
  debug(...data: unknown[]): void;
  info(...data: unknown[]): void;
  log(...data: unknown[]): void;
  warn(...data: unknown[]): void;
  error(...data: unknown[]): void;
}

export class Logger implements ILogger {
  private implementation: ILogger;

  constructor(implementation: ILogger) {
    this.implementation = implementation;
  }

  public debug(...data: unknown[]) {
    this.implementation.debug(...data);
  }
  public info(...data: unknown[]) {
    this.implementation.info(...data);
  }
  public log(...data: unknown[]) {
    this.implementation.log(...data);
  }
  public warn(...data: unknown[]) {
    this.implementation.warn(...data);
  }
  public error(...data: unknown[]) {
    this.implementation.error(...data);
  }
}

export const logger = new Logger(console);

```

## Archivo: `packages/MainUI/utils/processes/definition/constants.ts`

```typescript
export const COPY_FROM_ORDER_PROCESS_ID = "8B81D80B06364566B87853FEECAB5DE0";
export const CREATE_LINES_FROM_ORDER_PROCESS_ID = "AB2EFCAABB7B4EC0A9B30CFB82963FB6";

export const PROCESS_DEFINITION_DATA = {
  [COPY_FROM_ORDER_PROCESS_ID]: {
    inpColumnId: "C_Order_ID",
    inpPrimaryKeyColumnId: "inpcOrderId",
    defaultKeys: {
      ad_org_id: "org",
    },
    dynamicKeys: {},
    staticOptions: {},
  },
  [CREATE_LINES_FROM_ORDER_PROCESS_ID]: {
    inpColumnId: "C_Invoice_ID",
    inpPrimaryKeyColumnId: "inpcInvoiceId",
    defaultKeys: {},
    dynamicKeys: {
      invoiceClient: "@Invoice.client@",
      invoiceBusinessPartner: "@Invoice.businessPartner@",
      invoicePriceList: "@Invoice.priceList@",
      invoiceCurrency: "@Invoice.currency@",
    },
    staticOptions: {
      "@Invoice.salesTransaction@": true,
    },
  },
};

```

## Archivo: `packages/MainUI/utils/processes/manual/constants.ts`

```typescript
export const DEFAULT_DOC_STATUS = "DR";
export const DEFAULT_IS_PROCESSING = "N";
export const DEFAULT_AD_CLIENT_ID = "23C59575B9CF467C9620760EB255B389";
export const DEFAULT_AD_ORG_ID = "7BABA5FF80494CAFA54DEBD22EC46F01";
export const DEFAULT_BUSINESS_PARTNER_ID = "";

export const DEFAULT_DOCUMENTS_KEYS = ["documentStatus", "docstatus", "docStatus", "DOCSTATUS", "DocStatus"];
export const DEFAULT_PROCESS_KEYS = ["processing", "isprocessing", "isProcessing", "PROCESSING", "Processing"];
export const DEFAULT_AD_CLIENT_ID_KEYS = [
  "adClientId",
  "AD_Client_ID",
  "aD_Client_ID",
  "adclientid",
  "AdClientId",
  "client",
];
export const DEFAULT_AD_ORG_ID_KEYS = ["adOrgId", "AD_Org_ID", "aD_Org_ID", "adorgid", "AdOrgId", "organization"];
export const DEFAULT_BUSINESS_PARTNER_ID_KEYS = ["businessPartner", "cBpartnerId", "CBPartnerId", "c_bpartner_id"];

export const REQUIRED_PARAMS_KEYS = {
  isPopUpCall: "IsPopUpCall",
  command: "Command",
  inpcOrderId: "inpcOrderId",
  inpKey: "inpKey",
  inpwindowId: "inpwindowId",
  inpWindowId: "inpWindowId",
  inpTabId: "inpTabId",
  inpTableId: "inpTableId",
  inpcBpartnerId: "inpcBpartnerId",
  inpadClientId: "inpadClientId",
  inpadOrgId: "inpadOrgId",
  inpkeyColumnId: "inpkeyColumnId",
  keyColumnName: "keyColumnName",
  inpdocstatus: "inpdocstatus",
  inpprocessing: "inpprocessing",
  inpdocaction: "inpdocaction",
  token: "token",
};

export const DEFAULT_REQUIRED_PARAMS_KEYS = {
  isPopUpCall: "1",
  inpdocStatus: "CO",
  inpodcStatusPosted: "P",
};

```

## Archivo: `packages/MainUI/utils/processes/manual/types.ts`

```typescript
export interface GetParamsProps {
  currentButtonId: string;
  record: Record<string, unknown>;
  recordId: string;
  windowId: string;
  tabId: string;
  tableId: string;
  token: string | null;
  isPostedProcess: boolean;
}

```

## Archivo: `packages/MainUI/utils/processes/manual/utils.ts`

```typescript
import { extractValue } from "@/utils/commons";
import {
  DEFAULT_DOCUMENTS_KEYS,
  DEFAULT_PROCESS_KEYS,
  DEFAULT_AD_CLIENT_ID_KEYS,
  DEFAULT_AD_ORG_ID_KEYS,
  DEFAULT_DOC_STATUS,
  DEFAULT_IS_PROCESSING,
  DEFAULT_AD_CLIENT_ID,
  DEFAULT_AD_ORG_ID,
  REQUIRED_PARAMS_KEYS,
  DEFAULT_REQUIRED_PARAMS_KEYS,
  DEFAULT_BUSINESS_PARTNER_ID_KEYS,
  DEFAULT_BUSINESS_PARTNER_ID,
} from "@/utils/processes/manual/constants";
import type { GetParamsProps } from "@/utils/processes/manual/types";
import data from "@/utils/processes/manual/data.json";

export const getDocumentStatus = (record: Record<string, unknown>) => {
  return extractValue(record, DEFAULT_DOCUMENTS_KEYS, DEFAULT_DOC_STATUS);
};

export const getProcessing = (record: Record<string, unknown>) => {
  return extractValue(record, DEFAULT_PROCESS_KEYS, DEFAULT_IS_PROCESSING);
};

export const getAdClientId = (record: Record<string, unknown>) => {
  return extractValue(record, DEFAULT_AD_CLIENT_ID_KEYS, DEFAULT_AD_CLIENT_ID);
};

export const getAdOrgId = (record: Record<string, unknown>) => {
  return extractValue(record, DEFAULT_AD_ORG_ID_KEYS, DEFAULT_AD_ORG_ID);
};

export const getBusinessPartnerId = (record: Record<string, unknown>) => {
  return extractValue(record, DEFAULT_BUSINESS_PARTNER_ID_KEYS, DEFAULT_BUSINESS_PARTNER_ID);
};

export const getParams = ({
  currentButtonId,
  record,
  recordId,
  windowId,
  tabId,
  tableId,
  token,
  isPostedProcess,
}: GetParamsProps): URLSearchParams => {
  const processActionData = data[currentButtonId as keyof typeof data];
  const commandAction = processActionData.command;

  const docStatus = getDocumentStatus(record);
  const isProcessing = getProcessing(record);
  const adClientId = getAdClientId(record);
  const adOrgId = getAdOrgId(record);
  const businessPartnerId = getBusinessPartnerId(record);

  const params = new URLSearchParams();

  params.append(REQUIRED_PARAMS_KEYS.isPopUpCall, DEFAULT_REQUIRED_PARAMS_KEYS.isPopUpCall);
  params.append(REQUIRED_PARAMS_KEYS.command, commandAction);
  params.append(REQUIRED_PARAMS_KEYS.inpcOrderId, recordId);
  params.append(REQUIRED_PARAMS_KEYS.inpKey, recordId);
  params.append(REQUIRED_PARAMS_KEYS.inpWindowId, windowId);
  params.append(REQUIRED_PARAMS_KEYS.inpwindowId, windowId);
  params.append(REQUIRED_PARAMS_KEYS.inpTabId, tabId);
  params.append(REQUIRED_PARAMS_KEYS.inpTableId, tableId);
  params.append(REQUIRED_PARAMS_KEYS.inpcBpartnerId, businessPartnerId);
  params.append(REQUIRED_PARAMS_KEYS.inpadClientId, adClientId);
  params.append(REQUIRED_PARAMS_KEYS.inpadOrgId, adOrgId);
  params.append(REQUIRED_PARAMS_KEYS.inpkeyColumnId, processActionData.inpkeyColumnId);
  params.append(REQUIRED_PARAMS_KEYS.keyColumnName, processActionData.keyColumnName);
  params.append(REQUIRED_PARAMS_KEYS.inpdocstatus, docStatus);
  params.append(REQUIRED_PARAMS_KEYS.inpprocessing, isProcessing);

  if (isPostedProcess) {
    params.append(REQUIRED_PARAMS_KEYS.inpdocaction, DEFAULT_REQUIRED_PARAMS_KEYS.inpodcStatusPosted);
  } else {
    params.append(REQUIRED_PARAMS_KEYS.inpdocaction, DEFAULT_REQUIRED_PARAMS_KEYS.inpdocStatus);
  }

  if (token) {
    params.append(REQUIRED_PARAMS_KEYS.token, token);
  }

  return params;
};

```

## Archivo: `packages/MainUI/utils/structures.ts`

```typescript
import type { EntityData } from "@workspaceui/api-client/src/api/types";

export const mapBy = <T = EntityData>(records: T[], key: keyof T) => {
  return records.reduce(
    (acum, current) => {
      acum[current[key] as string] = current;

      return acum;
    },
    {} as Record<string, T>
  );
};

```

## Archivo: `packages/MainUI/utils/tabUtils.ts`

```typescript
import type { Tab } from "@workspaceui/api-client/src/api/types";

export interface TabWithParentInfo extends Tab {
  parentTabId?: string;
  column?: string;
  active?: boolean;
}

export function shouldShowTab(tab: TabWithParentInfo, activeParentTab: Tab | null): boolean {
  if (tab.tabLevel === 0) {
    return true;
  }

  if (!activeParentTab) {
    return false;
  }

  if (tab.active === false) {
    return false;
  }

  if (tab.parentTabId) {
    return tab.parentTabId === activeParentTab.id;
  }

  if (tab.parentColumns && tab.parentColumns.length > 0) {
    const parentEntityLower = activeParentTab.entityName?.toLowerCase() || "";
    const parentTableName = activeParentTab.table$_identifier?.toLowerCase() || "";

    return tab.parentColumns.some((parentColumn) => {
      const columnLower = parentColumn.toLowerCase();

      const normalizedColumn = columnLower.replace(/_id$/, "").replace(/[_-]/g, "");

      const normalizedEntity = parentEntityLower
        .replace(/^(fin|mgmt|financial|management)/gi, "")
        .replace(/([A-Z])/g, (p1, offset) => (offset > 0 ? `_${p1}` : p1))
        .toLowerCase()
        .replace(/[_-]/g, "");

      const normalizedTable = parentTableName.replace(/^c_/, "").replace(/[_-]/g, "");

      return (
        normalizedColumn.includes(normalizedEntity) ||
        normalizedEntity.includes(normalizedColumn) ||
        normalizedColumn.includes(normalizedTable) ||
        normalizedTable.includes(normalizedColumn)
      );
    });
  }

  return false;
}
```

## Archivo: `packages/MainUI/utils/tableColumns.tsx`

```typescript
import type { TranslateFunction } from "@/hooks/types";
import { getFieldReference } from "@/utils";
import Tag from "@workspaceui/componentlibrary/src/components/Tag";
import { type Column, type Field, FieldType } from "@workspaceui/api-client/src/api/types";
import { DEFAULT_STATUS_CONFIG, IDENTIFIER_KEY, statusConfig, yesNoConfig } from "./columnsConstants";

export const parseColumns = (columns?: Field[], t?: TranslateFunction): Column[] => {
  const result: Column[] = [];

  try {
    if (!columns) return result;

    for (const column of columns) {
      if (column.showInGridView) {
        let columnType = "";

        if (column.column?.reference$_identifier) {
          columnType = column.column.reference$_identifier;
        }

        result.push({
          header: column.name ?? column.hqlName,
          id: column.name,
          columnName: column.hqlName,
          isMandatory: column.isMandatory,
          _identifier: column.name,
          column: {
            _identifier: columnType,
            reference: column.column?.reference,
          },
          name: column.name,
          type: columnType,
          referencedWindowId: column.referencedWindowId,
          accessorFn: (v: Record<string, unknown>) => {
            const reference = getFieldReference(column.column?.reference);

            if (reference === FieldType.BOOLEAN) {
              const yesText = t ? t("common.trueText") : "Yes";
              const noText = t ? t("common.falseText") : "No";

              const config = v[column.hqlName] ? yesNoConfig.Y : yesNoConfig.N;

              return <Tag type={config.type} icon={config.icon} label={v[column.hqlName] ? yesText : noText} />;
            }

            if (reference === FieldType.LIST && column.refList && Array.isArray(column.refList)) {
              const codeValue = v[column.hqlName];

              if (codeValue === null || codeValue === undefined) {
                return v[`${column.hqlName}$${IDENTIFIER_KEY}`] ?? "";
              }

              const refItem = column.refList.find((item) => item.value === codeValue);

              if (refItem) {
                const config = statusConfig[refItem.value as string] || DEFAULT_STATUS_CONFIG;

                return <Tag type={config.type} icon={config.icon} label={refItem.label} />;
              }
            }
            const columnHqlName = column.hqlName;
            const columnNameKey = column.columnName;
            const columnIdentifier = `${columnHqlName}$${IDENTIFIER_KEY}`;
            const columnHqlIdentifierValue = v[columnIdentifier];
            const columnHqlNameValue = v[columnHqlName];
            const columnNameValue = v[columnNameKey];

            const value = columnHqlIdentifierValue ?? columnHqlNameValue ?? columnNameValue;
            return value;
          },
        });
      }
    }
  } catch (e) {
    console.warn(e);
  }

  return result;
};

```

## Archivo: `packages/MainUI/utils/toolbar/constants.ts`

```typescript
export const TOOLBAR_BUTTONS_ACTIONS = {
  NEW: "NEW",
  SAVE: "SAVE",
  REFRESH: "REFRESH",
  CANCEL: "CANCEL",
  DELETE: "DELETE",
  FIND: "FIND",
  FILTER: "FILTER",
  COPILOT: "COPILOT",
  COLUMN_FILTERS: "COLUMN_FILTERS",
};

export const TOOLBAR_BUTTONS_TYPES = {
  ACTION: "ACTION",
  DROPDOWN: "DROPDOWN",
  MODAL: "MODAL",
  TOGGLE: "TOGGLE",
  CUSTOM: "CUSTOM",
};

```

## Archivo: `packages/MainUI/utils/toolbar/process-button/utils.tsx`

```typescript
import ProcessIcon from "@workspaceui/componentlibrary/src/assets/icons/close-record.svg";
import ChevronDownIcon from "@workspaceui/componentlibrary/src/assets/icons/chevron-down.svg";
import type { TranslateFunction } from "@/hooks/types";
import type { ProcessAvailableButton } from "@/components/Toolbar/types";

const getProcessButtonStyles = (anchorEl: HTMLElement | null): string => {
  const baseClasses =
    "hover:bg-[var(--color-dynamic-main)] hover:text-[var(--color-dynamic-contrast-text)] disabled:bg-[var(--color-baseline-70)] disabled:opacity-20 h-8 py-1 px-4";

  const conditionalClasses = anchorEl
    ? "!bg-[var(--color-dynamic-main)] !border-none !text-[var(--color-dynamic-contrast-text)]"
    : "bg-[var(--color-transparent-neutral-0)]";

  return `${conditionalClasses} ${baseClasses}`;
};

export const createProcessMenuButton = (
  processCount: number,
  hasSelectedRecord: boolean,
  onMenuOpen: (event: React.MouseEvent<HTMLButtonElement>) => void,
  t: TranslateFunction,
  anchorEl: HTMLElement | null
): ProcessAvailableButton => ({
  key: "process-menu",
  leftIcon: <ProcessIcon width="1rem" height="1rem" />,
  rightIcon: <ChevronDownIcon width="1rem" height="1rem" />,
  text: t("common.processes"),
  anchorEl: anchorEl,
  disabled: !hasSelectedRecord,
  customContainerStyles: getProcessButtonStyles(anchorEl),
  onClick: (event: React.MouseEvent<HTMLButtonElement>) => {
    if (hasSelectedRecord && event && processCount > 0) {
      onMenuOpen(event);
    }
  },
});

```

## Archivo: `packages/MainUI/utils/toolbar/utils.tsx`

```typescript
import type { OrganizedSections, ToolbarButtonMetadata } from "@/hooks/Toolbar/types";
import type React from "react";
import Base64Icon from "@workspaceui/componentlibrary/src/components/Base64Icon";
import { IconSize, type ToolbarButton } from "@/components/Toolbar/types";
import { TOOLBAR_BUTTONS_ACTIONS, TOOLBAR_BUTTONS_TYPES } from "@/utils/toolbar/constants";

const isBase64Image = (str: string): boolean => {
  try {
    const base64Regex = /^[A-Za-z0-9+/]+=*$/;
    const isValidLength = str.length > 20 && str.length % 4 === 0;
    const isValidFormat = base64Regex.test(str);
    return isValidLength && isValidFormat;
  } catch {
    return false;
  }
};

const BUTTON_STYLES = {
  [TOOLBAR_BUTTONS_ACTIONS.NEW]:
    "toolbar-button-new bg-[var(--color-baseline-100)] text-[var(--color-baseline-0)] h-8 w-8 py-1 pl-3 pr-5 disabled:bg-[var(--color-baseline-100)] disabled:opacity-20 disabled:text-[var(--color-baseline-0)]",
  [TOOLBAR_BUTTONS_ACTIONS.SAVE]:
    "toolbar-button-save bg-[var(--color-baseline-100)] text-[var(--color-baseline-0)] h-8 w-8 py-1 pl-3 pr-5 disabled:bg-[var(--color-baseline-100)] disabled:opacity-20 disabled:text-[var(--color-baseline-0)]",
  [TOOLBAR_BUTTONS_ACTIONS.REFRESH]:
    "toolbar-button-refresh border-1 border-[var(--color-transparent-neutral-20)] h-8 w-8 hover:border-none hover:bg-[var(--color-etendo-dark)] hover:text-[var(--color-baseline-80)]",
  [TOOLBAR_BUTTONS_ACTIONS.CANCEL]: "toolbar-button-cancel",
  [TOOLBAR_BUTTONS_ACTIONS.DELETE]: "toolbar-button-delete",
  [TOOLBAR_BUTTONS_ACTIONS.FIND]: "toolbar-button-find",
  [TOOLBAR_BUTTONS_ACTIONS.FILTER]: "toolbar-button-filter",
  [TOOLBAR_BUTTONS_ACTIONS.COPILOT]: "toolbar-button-copilot",
  [TOOLBAR_BUTTONS_ACTIONS.COLUMN_FILTERS]: "toolbar-button-column-filters",
} as const;

export const DefaultIcon = () => <span style={{ fontSize: "1rem" }}>✣</span>;

export const IconComponent: React.FC<{ iconKey?: string | null }> = ({ iconKey }) => {
  if (!iconKey) return <DefaultIcon />;

  if (iconKey.startsWith("data:image/")) {
    return <Base64Icon src={iconKey} />;
  }

  if (isBase64Image(iconKey)) {
    return <Base64Icon src={`data:image/png;base64,${iconKey}`} />;
  }

  return <span style={{ fontSize: "0.75rem", fontWeight: "bold" }}>{iconKey}</span>;
};

const sortButtonsBySeqno = (buttons: ToolbarButtonMetadata[]): ToolbarButtonMetadata[] => {
  return [...buttons].sort((a, b) => {
    const seqnoA = a.seqno ?? Number.MAX_SAFE_INTEGER;
    const seqnoB = b.seqno ?? Number.MAX_SAFE_INTEGER;

    if (seqnoA !== seqnoB) {
      return seqnoA - seqnoB;
    }

    return a.name.localeCompare(b.name);
  });
};

const isVisibleButton = (button: ToolbarButtonMetadata, isFormView: boolean) => {
  if (!button.active) return false;

  const isFindButtonInFormView = isFormView && button.action === TOOLBAR_BUTTONS_ACTIONS.FIND;
  const isSaveButtonInNonFormView = !isFormView && button.action === TOOLBAR_BUTTONS_ACTIONS.SAVE;
  const isCreateButtonInFormView = isFormView && button.action === TOOLBAR_BUTTONS_ACTIONS.NEW;
  const isFilterButtonInFormView = isFormView && button.action === TOOLBAR_BUTTONS_ACTIONS.FILTER;

  return (
    !isFindButtonInFormView && !isSaveButtonInNonFormView && !isCreateButtonInFormView && !isFilterButtonInFormView
  );
};

export const organizeButtonsBySection = (buttons: ToolbarButtonMetadata[], isFormView: boolean): OrganizedSections => {
  const sections: OrganizedSections = { left: [], center: [], right: [] };

  const visibleButtons = buttons.filter((button) => isVisibleButton(button, isFormView));

  for (const button of visibleButtons) {
    if (button.section && sections[button.section]) {
      sections[button.section].push(button);
    }
  }

  return {
    left: sortButtonsBySeqno(sections.left),
    center: sortButtonsBySeqno(sections.center),
    right: sortButtonsBySeqno(sections.right),
  };
};

export const createButtonByType = ({
  button,
  onAction,
  isFormView,
  hasFormChanges,
  hasSelectedRecord,
  hasParentRecordSelected,
}: {
  button: ToolbarButtonMetadata;
  onAction: (action: string, button: ToolbarButtonMetadata, event?: React.MouseEvent<HTMLElement>) => void;
  isFormView: boolean;
  hasFormChanges: boolean;
  hasSelectedRecord: boolean;
  hasParentRecordSelected: boolean;
}): ToolbarButton => {
  const buttonKey = button.id || `${button.action}-${button.name}`;

  const baseConfig: ToolbarButton = {
    key: buttonKey,
    icon: <IconComponent iconKey={button.icon} />,
    tooltip: button.name,
    disabled: !button.active,
    height: IconSize,
    width: IconSize,
    onClick: () => onAction(button.action, button),
  };

  const getIconTextConfig = (): Partial<ToolbarButton> => {
    const showIconTextFor = [TOOLBAR_BUTTONS_ACTIONS.NEW, TOOLBAR_BUTTONS_ACTIONS.SAVE];

    if (showIconTextFor.includes(button.action)) {
      return { iconText: button.name };
    }

    if (button.buttonType === TOOLBAR_BUTTONS_TYPES.DROPDOWN) {
      return { iconText: `${button.name} ▼` };
    }

    if (button.buttonType === TOOLBAR_BUTTONS_TYPES.MODAL && button.modalConfig?.title) {
      return { iconText: button.modalConfig.title };
    }

    return {};
  };

  const getDisableConfig = (): Partial<ToolbarButton> => {
    switch (button.action) {
      case TOOLBAR_BUTTONS_ACTIONS.CANCEL: {
        const isDisabledCancel = !(isFormView || hasSelectedRecord);
        return { disabled: isDisabledCancel, tooltip: isDisabledCancel ? "" : button.name };
      }
      case TOOLBAR_BUTTONS_ACTIONS.DELETE:
      case TOOLBAR_BUTTONS_ACTIONS.COPILOT: {
        const isDisabledDelete = !hasSelectedRecord;
        return { disabled: isDisabledDelete, tooltip: isDisabledDelete ? "" : button.name };
      }
      case TOOLBAR_BUTTONS_ACTIONS.NEW: {
        const isDisabledNew = !hasParentRecordSelected;
        return { disabled: isDisabledNew, tooltip: isDisabledNew ? "" : button.name };
      }
      case TOOLBAR_BUTTONS_ACTIONS.REFRESH: {
        const isDisabledRefresh = !hasParentRecordSelected;
        return { disabled: isDisabledRefresh, tooltip: isDisabledRefresh ? "" : button.name };
      }
      case TOOLBAR_BUTTONS_ACTIONS.SAVE: {
        const isDisabledSave = !isFormView || !hasFormChanges || !hasParentRecordSelected;
        return { disabled: isDisabledSave, tooltip: isDisabledSave ? "" : button.name };
      }
      default: {
        const isDisabledDefault = !button.active;
        return { disabled: isDisabledDefault, tooltip: isDisabledDefault ? "" : button.name };
      }
    }
  };

  const getClickConfig = (): Partial<ToolbarButton> => {
    switch (button.buttonType) {
      case TOOLBAR_BUTTONS_TYPES.DROPDOWN:
        return {
          onClick: (event?: React.MouseEvent<HTMLElement>) => {
            onAction("OPEN_DROPDOWN", button, event);
          },
        };
      case TOOLBAR_BUTTONS_TYPES.MODAL:
        return {
          onClick: () => onAction("OPEN_MODAL", button),
        };
      case TOOLBAR_BUTTONS_TYPES.TOGGLE:
        return {
          onClick: () => onAction("TOGGLE", button),
        };
      case TOOLBAR_BUTTONS_TYPES.CUSTOM:
        return {
          onClick: (event?: React.MouseEvent<HTMLElement>) => {
            onAction("CUSTOM_ACTION", button, event);
          },
        };
      default:
        return {
          onClick: (event?: React.MouseEvent<HTMLElement>) => onAction(button.action, button, event),
        };
    }
  };

  return {
    ...baseConfig,
    ...getIconTextConfig(),
    ...getDisableConfig(),
    ...getClickConfig(),
  };
};

export const getButtonStyles = (button: ToolbarButtonMetadata) => {
  return BUTTON_STYLES[button.action as keyof typeof BUTTON_STYLES];
};

```

## Archivo: `packages/MainUI/utils/url/constants.ts`

```typescript
export const WINDOW_PREFIX = "w_";
export const ORDER_PREFIX = "o_";
export const WINDOW_IDENTIFIER_PREFIX = "wi_";
export const FORM_RECORD_ID_PREFIX = "r_";
export const FORM_MODE_PREFIX = "fm_";
export const TITLE_PREFIX = "t_";
export const SELECTED_RECORD_PREFIX = "s_";

// Tab parameters
export const TAB_FORM_RECORD_ID_PREFIX = "tf_";
export const TAB_MODE_PREFIX = "tm_";
export const TAB_FORM_MODE_PREFIX = "tfm_";

// Tab states
export const TAB_ACTIVE = "active";
export const TAB_INACTIVE = "inactive";

export const NEW_RECORD_ID = "new";

export const FORM_MODES = {
  NEW: "new",
  EDIT: "edit",
  VIEW: "view",
} as const;

export const TAB_MODES = {
  TABLE: "table",
  FORM: "form",
} as const;

export type FormMode = (typeof FORM_MODES)[keyof typeof FORM_MODES];
export type TabMode = (typeof TAB_MODES)[keyof typeof TAB_MODES];

```

## Archivo: `packages/api-client/src/api/authentication.ts`

```typescript
import { API_LOGIN_URL } from "./constants";
import { Metadata } from "./metadata";
import type { LoginResponse } from "./types";

export const login = async (username: string, password: string): Promise<LoginResponse> => {
  try {
    const result = await Metadata.loginClient.request(API_LOGIN_URL, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        username,
        password,
      }),
    });

    if (!result.ok) {
      throw new Error(`HTTP error! status: ${result.status}`);
    }

    const data = result.data;

    if (data.token) {
      return data;
    }
    throw new Error("Invalid");
  } catch (error) {
    console.error("Login error:", error);
    throw error;
  }
};

```

## Archivo: `packages/api-client/src/api/cache.ts`

```typescript
export class CacheStore {
  private duration: number;
  private storage: Storage | undefined;

  constructor(duration: number) {
    if (duration <= 0) {
      throw new Error("Duration must be a positive number.");
    }

    // if (![localStorage, sessionStorage].includes(storage)) {
    //   throw new Error('Invalid storage type. Expected localStorage or sessionStorage.');
    // }

    this.duration = duration;
    this.storage = typeof window !== "undefined" ? window.localStorage : undefined;
  }

  /**
   * Retrieves a value from storage.
   * Returns null if the value has expired or if an error occurs.
   * @param id - The identifier of the value to retrieve.
   */
  public get<T = unknown>(id: string): T | null {
    try {
      const item = this.storage?.getItem(id);

      if (!item) return null;

      const data = this.parseStoredItem(item);

      if (this.isExpired(data.updatedAt)) {
        this.delete(id);

        return null;
      }

      return data.value as T;
    } catch (e) {
      this.handleError(e);

      return null;
    }
  }

  /**
   * Stores a value in the storage.
   * @param id - The identifier for the value to store.
   * @param value - The value to store.
   */
  public set(id: string, value: unknown): this {
    try {
      this.storage?.setItem(id, JSON.stringify(this.createStoredItem(value)));
    } catch (e) {
      if (e instanceof DOMException && e.name === "QuotaExceededError") {
        this.handleStorageQuotaError();
      } else {
        this.handleError(e);
      }
    }

    return this;
  }

  /**
   * Deletes a value from the storage.
   * @param id - The identifier of the value to delete.
   */
  public delete(id: string): void {
    this.storage?.removeItem(id);
  }

  /**
   * Checks if a value has expired by comparing the last updated timestamp.
   * @param updatedAt - The last update timestamp of the stored item.
   * @returns true if the value has expired, false otherwise.
   */
  private isExpired(updatedAt: number): boolean {
    return Date.now() > updatedAt + this.duration;
  }

  /**
   * Creates an object to store, including the value and the timestamp.
   * @param value - The value to store.
   * @returns The object with the value and timestamp.
   */
  private createStoredItem(value: unknown): { updatedAt: number; value: unknown } {
    return {
      updatedAt: Date.now(),
      value,
    };
  }

  /**
   * Parses a stored item from its JSON format.
   * @param item - The stored item in JSON format.
   * @returns The parsed object.
   */
  private parseStoredItem(item: string): { updatedAt: number; value: unknown } {
    try {
      return JSON.parse(item);
    } catch (error) {
      this.handleError(error);

      throw new Error("Failed to parse stored item.");
    }
  }

  /**
   * Handles general errors in a centralized manner.
   * @param error - The error that occurred.
   */
  private handleError(error: unknown): void {
    console.warn("Error in CacheStore:", error);
  }

  /**
   * Handles storage quota errors when the storage limit is exceeded.
   */
  private handleStorageQuotaError(): void {
    console.warn("Storage quota exceeded.");
  }
}

```

## Archivo: `packages/api-client/src/api/changeProfile.ts`

```typescript
import { API_LOGIN_URL } from "./constants";
import { Metadata } from "./metadata";
import type { LoginResponse } from "./types";

interface ChangeProfilePayload {
  role?: string;
  warehouse?: string;
}

/**
 * Function to handle the profile change, including role and warehouse updates.
 *
 * @param params - The profile change parameters, which may include a role and/or warehouse.
 * @returns A promise that resolves to a LoginResponse object if successful.
 */
export const changeProfile = async (params: ChangeProfilePayload): Promise<LoginResponse> => {
  try {
    const response = await Metadata.loginClient.request(API_LOGIN_URL, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify(params),
    });

    if (!response.ok) {
      throw new Error(`HTTP error! Status: ${response.status}`);
    }

    const data: LoginResponse = response.data;

    if (!data.token) {
      throw new Error("Invalid server response");
    }

    return data;
  } catch (error) {
    console.error("Profile change error:", error);
    throw error;
  }
};

// biome-ignore lint/suspicious/noExplicitAny: <explanation>
export default async function handler(req: any, res: any) {
  if (req.method !== "POST") {
    res.setHeader("Allow", ["POST"]);
    return res.status(405).json({ message: `Method ${req.method} Not Allowed` });
  }

  try {
    const token = req.headers.authorization?.replace("Bearer ", "");
    if (!token) {
      return res.status(401).json({ message: "Unauthorized: No token provided" });
    }

    const { role, warehouse } = req.body;
    const data = await changeProfile({ role, warehouse });

    return res.status(200).json(data);
  } catch (error) {
    console.error("Error in changeProfile API:", error);
    return res.status(500).json({ message: "Internal Server Error" });
  }
}

```

## Archivo: `packages/api-client/src/api/client.ts`

```typescript
import { AUTH_HEADER_NAME } from "./constants";
import { getDecodedJsonResponse } from "./utils";

export interface ClientOptions extends Omit<RequestInit, "body"> {
  headers?: Record<string, string>;
  body?: RequestInit["body"] | Record<string, unknown>;
}

export type Interceptor = (response: Response) => Promise<Response> | Response;

export class UnauthorizedError extends Error {
  public response: Response;

  constructor(message: string, response: Response) {
    super(message);
    this.response = response;
  }
}

export class Client {
  private baseHeaders: HeadersInit;
  private baseQueryParams: URLSearchParams;
  private baseUrl: string;
  private interceptor: Interceptor | null;
  private readonly JSON_CONTENT_TYPE = "application/json";
  private readonly FORM_CONTENT_TYPE = "application/x-www-form-urlencoded";

  constructor(url?: string) {
    this.baseUrl = url || "";
    this.baseHeaders = {};
    this.interceptor = null;
    this.baseQueryParams = new URLSearchParams();
  }

  public getAuthHeader(): string | undefined {
    return (this.baseHeaders as Record<string, string>)[AUTH_HEADER_NAME];
  }

  public setBaseUrl(url: string) {
    this.baseUrl = url;
  }

  private cleanUrl(url: string) {
    return url.startsWith("/") ? url.substring(1) : url;
  }

  private isJson(response: Response) {
    return response.headers.get("Content-Type")?.includes("application/json") ?? false;
  }

  private setContentType(options: ClientOptions) {
    const { headers = {}, body } = options;

    if (!headers["Content-Type"]) {
      headers["Content-Type"] =
        body instanceof URLSearchParams || typeof body === "string" || body instanceof FormData
          ? this.FORM_CONTENT_TYPE
          : this.JSON_CONTENT_TYPE;
    }

    options.headers = headers;
  }

  public setAuthHeader(header: string, type: "Basic" | "Bearer" = "Basic") {
    this.baseHeaders = {
      ...this.baseHeaders,
      [AUTH_HEADER_NAME]: `${type} ${header}`,
    };

    return this;
  }

  public setLanguageHeader(value: string) {
    this.baseQueryParams.set("language", value);

    return this;
  }

  public addQueryParam(key: string, value: string) {
    this.baseQueryParams.set(key, value);

    return this;
  }

  public async request(url: string, options: ClientOptions = {}) {
    try {
      if (options.method !== "GET") {
        this.setContentType(options);
      }

      options.credentials = "include";

      const destination = new URL(`${this.baseUrl}${this.cleanUrl(url)}`);
      this.baseQueryParams.forEach((value, key) => destination.searchParams.append(key, value));

      // biome-ignore lint/suspicious/noExplicitAny: <explanation>
      let response: Response & { data?: any } = await fetch(destination, {
        ...options,
        credentials: "include",
        body:
          typeof options.body === "string" ||
          options.body instanceof URLSearchParams ||
          options.body instanceof FormData
            ? options.body
            : options.body
              ? JSON.stringify(options.body)
              : undefined,
        headers: {
          ...this.baseHeaders,
          ...options.headers,
        },
      });

      if (typeof this.interceptor === "function") {
        response = await this.interceptor(response);
      }

      response.data = await (this.isJson(response) ? getDecodedJsonResponse(response) : response.text());

      return response;
    } catch (error) {
      console.warn("API client request failed", {
        url,
        options,
        error: (error as Error).message,
      });

      throw error;
    }
  }

  public registerInterceptor(interceptor: Interceptor) {
    this.interceptor = interceptor;

    return () => {
      this.interceptor = null;
    };
  }

  public async post(url: string, payload: ClientOptions["body"] = null, options: ClientOptions = {}) {
    return this.request(url, { ...options, body: payload, method: "POST" });
  }

  public run(js: string) {
    const script = document.createElement("script");

    script.type = "text/javascript";
    script.textContent = js;
    document.head.appendChild(script);
    document.head.removeChild(script);
  }
}

```

## Archivo: `packages/api-client/src/api/constants.ts`

```typescript
const getDefaultCacheDuration = () => {
  if (process.env.NEXT_PUBLIC_CACHE_DURATION) {
    return Math.abs(Number.parseInt(process.env.NEXT_PUBLIC_CACHE_DURATION));
  }
  return 3600000;
};

const getAuthHeaderName = () => {
  if (process.env.NEXT_PUBLIC_AUTH_HEADER_NAME) {
    return process.env.NEXT_PUBLIC_AUTH_HEADER_NAME;
  }
  return "Authorization";
};

export const API_LOGIN_URL = "/meta/login";
export const DEFAULT_LOGIN_CHARSET = "ISO-8859-1";
export const API_METADATA_URL = "/meta/";
export const API_DEFAULT_CACHE_DURATION = getDefaultCacheDuration();
export const AUTH_HEADER_NAME = getAuthHeaderName();
export const API_FORWARD_PATH = `${API_METADATA_URL}forward`; //"/meta/forward";
export const API_KERNEL_SERVLET = `${API_FORWARD_PATH}/org.openbravo.client.kernel`;
export const API_DATASOURCE_SERVLET = `${API_FORWARD_PATH}/org.openbravo.service.datasource/`;

export enum HTTP_CODES {
  UNAUTHORIZED = 401,
  NOT_FOUND = 404,
}

```

## Archivo: `packages/api-client/src/api/copilot/client.ts`

```typescript
import { Client, type Interceptor, type ClientOptions } from "../client";
import { COPILOT_ENDPOINTS, COPILOT_METHODS, isProduction, COPILOT_BASE_PATH } from "./constants";
import type { IAssistant, ILabels, CopilotQuestionParams, CopilotUploadResponse } from "./types";

export class CopilotUnauthorizedError extends Error {
  public response: Response;

  constructor(message: string, response: Response) {
    super(`Copilot: ${message}`);
    this.response = response;
  }
}

export class CopilotClient {
  public static client = new Client();
  private static currentBaseUrl = "";
  private static isInitialized = false;

  /**
   * Initializes the CopilotClient with base URL
   * Follows the pattern from Metadata class
   */
  public static setBaseUrl(etendoUrl: string) {
    const copilotUrl = `${etendoUrl.replace(/\/$/, "")}${COPILOT_BASE_PATH}`;
    CopilotClient.currentBaseUrl = copilotUrl;
    CopilotClient.client.setBaseUrl(copilotUrl);
    CopilotClient.isInitialized = true;
  }

  /**
   * Sets authentication token for all requests
   */
  public static setToken(token: string) {
    if (!isProduction()) {
      CopilotClient.client.setAuthHeader(btoa("admin:admin"), "Basic");
    } else {
      CopilotClient.client.setAuthHeader(token, "Bearer");
    }

    return CopilotClient;
  }

  /**
   * Generic request method - consistent with Client class
   */
  private static async request(endpoint: string, options: ClientOptions = {}) {
    if (!CopilotClient.isInitialized) {
      throw new Error("CopilotClient must be initialized with setBaseUrl() before making requests");
    }

    try {
      const response = await CopilotClient.client.request(endpoint, options);

      if (!response.ok && response.status === 401) {
        throw new CopilotUnauthorizedError("Unauthorized access to Copilot service", response);
      }

      return response;
    } catch (error) {
      if (error instanceof CopilotUnauthorizedError) {
        throw error;
      }
      console.error(`CopilotClient request failed for ${endpoint}:`, error);
      throw error;
    }
  }

  /**
   * Sets language header for all requests
   * Follows the pattern from Metadata class
   */
  public static setLanguage(language: string) {
    CopilotClient.client.setLanguageHeader(language);
    return CopilotClient;
  }

  /**
   * Registers an interceptor for response handling
   * Follows the pattern from Metadata class
   */
  public static registerInterceptor(interceptor: Interceptor) {
    return CopilotClient.client.registerInterceptor(interceptor);
  }

  /**
   * Fetches localization labels
   * Includes proper error handling and response parsing
   */
  public static async getLabels(): Promise<ILabels> {
    try {
      const { data, ok } = await CopilotClient.request(COPILOT_ENDPOINTS.GET_LABELS, {
        method: COPILOT_METHODS.GET,
      });

      if (!ok) {
        throw new Error("Failed to fetch labels");
      }

      if (typeof data === "string") {
        try {
          return JSON.parse(data);
        } catch (parseError) {
          console.error("Error parsing labels response:", parseError);
          throw new Error("Invalid labels response format");
        }
      }

      return data as ILabels;
    } catch (error) {
      console.error("Error fetching labels:", error);
      throw error;
    }
  }

  /**
   * Fetches available assistants
   * Includes robust response parsing and error handling
   */
  public static async getAssistants(): Promise<IAssistant[]> {
    try {
      const { data, ok } = await CopilotClient.request(COPILOT_ENDPOINTS.GET_ASSISTANTS, {
        method: COPILOT_METHODS.GET,
      });

      if (!ok) {
        throw new Error("Failed to fetch assistants");
      }

      if (typeof data === "string") {
        try {
          const parsed = JSON.parse(data);
          return Array.isArray(parsed) ? parsed : [];
        } catch (parseError) {
          console.error("Error parsing assistants response:", parseError);
          return [];
        }
      }

      return Array.isArray(data) ? data : [];
    } catch (error) {
      console.error("Error fetching assistants:", error);
      throw error;
    }
  }

  /**
   * Uploads a single file to the copilot service
   * Follows the pattern from similar upload methods in the project
   */
  public static async uploadFile(file: File): Promise<CopilotUploadResponse> {
    try {
      const formData = new FormData();
      formData.append("file", file);

      const { data, ok } = await CopilotClient.request(COPILOT_ENDPOINTS.UPLOAD_FILE, {
        method: COPILOT_METHODS.POST,
        body: formData,
      });

      if (!ok) {
        throw new Error("Failed to upload file");
      }

      return data as CopilotUploadResponse;
    } catch (error) {
      console.error(`Error uploading file ${file.name}:`, error);
      throw error;
    }
  }

  /**
   * Uploads multiple files to the copilot service
   * Provides batch upload functionality
   */
  public static async uploadFiles(files: File[]): Promise<CopilotUploadResponse> {
    try {
      const formData = new FormData();

      for (const file of files) {
        formData.append("file", file);
      }

      const { data, ok } = await CopilotClient.request(COPILOT_ENDPOINTS.UPLOAD_FILE, {
        method: COPILOT_METHODS.POST,
        body: formData,
      });

      if (!ok) {
        throw new Error("Failed to upload files");
      }

      return data as CopilotUploadResponse;
    } catch (error) {
      console.error("Error uploading files:", error);
      throw error;
    }
  }

  /**
   * Caches a question for large payloads
   * Follows the pattern from similar caching methods in the project
   */
  public static async cacheQuestion(question: string): Promise<Record<string, unknown>> {
    try {
      const { data, ok } = await CopilotClient.request(COPILOT_ENDPOINTS.CACHE_QUESTION, {
        method: COPILOT_METHODS.POST,
        body: { question },
      });

      if (!ok) {
        throw new Error("Failed to cache question");
      }

      return data;
    } catch (error) {
      console.error("Error caching question:", error);
      throw error;
    }
  }

  /**
   * Sends a regular question to the copilot service
   * For non-streaming responses
   */
  public static async sendQuestion(params: CopilotQuestionParams): Promise<Record<string, unknown>> {
    try {
      const { data, ok } = await CopilotClient.request(COPILOT_ENDPOINTS.SEND_QUESTION, {
        method: COPILOT_METHODS.POST,
        body: params as unknown as Record<string, unknown>,
      });

      if (!ok) {
        throw new Error("Failed to send question");
      }

      return data;
    } catch (error) {
      console.error("Error sending question:", error);
      throw error;
    }
  }

  /**
   * Builds SSE URL for streaming responses
   * Uses the stored base URL for consistency
   */
  public static buildSSEUrl(params: CopilotQuestionParams): string {
    if (!CopilotClient.currentBaseUrl) {
      throw new Error("CopilotClient must be initialized with setBaseUrl() before building SSE URLs");
    }

    const queryParams = Object.keys(params)
      .filter((key) => params[key as keyof CopilotQuestionParams] !== undefined)
      .map((key) => {
        const value = params[key as keyof CopilotQuestionParams];
        return `${encodeURIComponent(key)}=${encodeURIComponent(String(value))}`;
      })
      .join("&");

    const baseUrl = CopilotClient.currentBaseUrl.endsWith("/")
      ? CopilotClient.currentBaseUrl
      : `${CopilotClient.currentBaseUrl}/`;

    const endpoint = COPILOT_ENDPOINTS.SEND_AQUESTION.startsWith("/")
      ? COPILOT_ENDPOINTS.SEND_AQUESTION.slice(1)
      : COPILOT_ENDPOINTS.SEND_AQUESTION;

    const fullUrl = `${baseUrl}${endpoint}?${queryParams}`;

    return fullUrl;
  }

  /**
   * Gets headers for SSE connections
   * Handles environment-specific authentication
   */
  public static getSSEHeaders(): Record<string, string> {
    const headers: Record<string, string> = {};

    if (!isProduction()) {
      headers.Authorization = `Basic ${btoa("admin:admin")}`;
      headers.Accept = "text/event-stream";
    } else {
      const authHeader = CopilotClient.client.getAuthHeader();
      if (authHeader) {
        headers.Authorization = authHeader;
      }
      headers.Accept = "text/event-stream";
    }

    return headers;
  }

  /**
   * Helper method to determine if request should be cached
   * Follows the caching threshold pattern from the original code
   */
  public static shouldCacheQuestion(question: string): boolean {
    return encodeURIComponent(question).length > 7000;
  }

  /**
   * Helper method to handle large questions automatically
   * Provides transparent caching for large payloads
   */
  public static async handleLargeQuestion(params: CopilotQuestionParams): Promise<CopilotQuestionParams> {
    if (CopilotClient.shouldCacheQuestion(params.question)) {
      await CopilotClient.cacheQuestion(params.question);
      const { question, ...restParams } = params;
      return restParams as CopilotQuestionParams;
    }
    return params;
  }

  /**
   * Utility method to get current base URL
   * Useful for debugging and testing
   */
  public static getCurrentBaseUrl(): string {
    return CopilotClient.currentBaseUrl;
  }

  /**
   * Utility method to check if client is in production mode
   * Useful for debugging and conditional logic
   */
  public static isProductionMode(): boolean {
    return isProduction();
  }

  /**
   * Initializes the CopilotClient with common configuration
   */
  public static initialize(config?: {
    baseUrl?: string;
    token?: string;
    language?: string;
    interceptor?: Interceptor;
  }) {
    if (config?.baseUrl) {
      CopilotClient.setBaseUrl(config.baseUrl);
    }

    if (config?.token) {
      CopilotClient.setToken(config.token);
    }

    if (config?.language) {
      CopilotClient.setLanguage(config.language);
    }

    if (config?.interceptor) {
      CopilotClient.registerInterceptor(config.interceptor);
    }

    return CopilotClient;
  }
}

```

## Archivo: `packages/api-client/src/api/copilot/constants.ts`

```typescript
export const COPILOT_ENDPOINTS = {
  UPLOAD_FILE: "file",
  GET_LABELS: "labels",
  SEND_QUESTION: "question",
  SEND_AQUESTION: "aquestion",
  CACHE_QUESTION: "cacheQuestion",
  GET_ASSISTANTS: "assistants",
} as const;

export const COPILOT_METHODS = {
  DELETE: "DELETE",
  GET: "GET",
  PATCH: "PATCH",
  POST: "POST",
} as const;

/**
 * Base path for copilot API endpoints
 * This will be appended to the forwarder servlet path
 */
export const COPILOT_BASE_PATH = "/copilot/";

/**
 * Message roles for copilot interactions
 */
export const MESSAGE_ROLES = {
  USER: "user",
  BOT: "bot",
  ASSISTANT: "assistant",
  ERROR: "error",
  TOOL: "tool",
  NODE: "node",
  WAIT: "wait",
} as const;

/**
 * Context-related constants
 */
export const CONTEXT_CONSTANTS = {
  TAG_START: "<Context>",
  TAG_END: "</Context>",
  MAX_ITEMS_DISPLAY: 10,
} as const;

/**
 * SSE connection configuration
 */
export const SSE_CONFIG = {
  HEARTBEAT_TIMEOUT: 12000000,
  RETRY_INTERVAL: 1000,
} as const;

/**
 * File upload configuration
 */
export const UPLOAD_CONFIG = {
  MAX_FILE_SIZE: 10 * 1024 * 1024, // 10MB
  ALLOWED_TYPES: [
    "text/plain",
    "text/csv",
    "application/json",
    "application/pdf",
    "application/vnd.openxmlformats-officedocument.wordprocessingml.document",
    "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
  ],
} as const;

/**
 * Question caching threshold
 */
export const CACHE_THRESHOLD = 7000;

/**
 * Environment detection
 */
export const isDevelopment = () => process.env.NODE_ENV === "development";
export const isProduction = () => process.env.NODE_ENV === "production";

```

## Archivo: `packages/api-client/src/api/copilot/index.ts`

```typescript
export * from "./client";
export * from "./types";
export * from "./constants";

```

## Archivo: `packages/api-client/src/api/copilot/types.ts`

```typescript
import type { MESSAGE_ROLES } from "./constants";

/**
 * Assistant configuration
 */
export interface IAssistant {
  app_id: string;
  name: string;
  description?: string;
  isActive?: boolean;
  createdAt?: string;
  updatedAt?: string;
}

/**
 * Message structure for copilot interactions
 */
export interface IMessage {
  message_id?: string;
  text: string;
  response?: string;
  sender: string;
  timestamp: string;
  file?: string;
  files?: IMessageFile[];
  context?: string;
  role?: string;
  isLoading?: boolean;
  error?: string;
}

/**
 * File information in messages
 */
export interface IMessageFile {
  name: string;
  size?: number;
  type?: string;
  uploadId?: string;
}

/**
 * Localization labels
 */
export interface ILabels {
  [key: string]: string;
}

/**
 * Parameters for copilot questions
 */
export interface CopilotQuestionParams extends Record<string, unknown> {
  question: string;
  app_id?: string;
  conversation_id?: string;
  file?: string[];
  context?: string;
  metadata?: Record<string, unknown>;
}

/**
 * File upload configuration
 */
export interface CopilotUploadConfig {
  file: (string | File)[] | null;
  url: string;
  method: string;
  headers?: Record<string, string>;
  onProgress?: (progress: number) => void;
  onSuccess?: (response: Record<string, unknown>) => void;
  onError?: (error: Error | Record<string, unknown>) => void;
}

/**
 * Response from copilot API
 */
export interface CopilotResponse {
  answer?: {
    response?: string;
    conversation_id?: string;
    role?: string;
    error?: string;
    metadata?: Record<string, unknown>;
  };
  error?: string;
  success?: boolean;
  data?: Record<string, unknown>;
}

/**
 * SSE Event data structure
 */
export interface SSEEventData {
  answer?: {
    response?: string;
    conversation_id?: string;
    role?: string;
    error?: string;
    metadata?: Record<string, unknown>;
  };
  type?: string;
  id?: string;
  retry?: number;
}

/**
 * Context information for copilot
 */
export interface CopilotContext {
  contextTitle?: string;
  contextData?: Record<string, unknown>;
  windowId?: string;
  tabId?: string;
  recordId?: string;
  userId?: string;
  roleId?: string;
  organizationId?: string;
  clientId?: string;
}

/**
 * Conversation state
 */
export interface CopilotConversation {
  id: string;
  assistantId: string;
  messages: IMessage[];
  createdAt: string;
  updatedAt: string;
  isActive: boolean;
  context?: CopilotContext;
}

/**
 * Error response structure
 */
export interface CopilotErrorResponse {
  error: string;
  code?: string;
  details?: Record<string, unknown>;
  timestamp?: string;
}

/**
 * Upload response structure
 */
export interface CopilotUploadResponse {
  [key: string]: string | undefined;
  success?: string;
  error?: string;
}

/**
 * Message role type
 */
export type MessageRole = (typeof MESSAGE_ROLES)[keyof typeof MESSAGE_ROLES];

/**
 * Event handlers for copilot interactions
 */
export interface CopilotEventHandlers {
  onMessage?: (message: IMessage) => void;
  onError?: (error: CopilotErrorResponse) => void;
  onConnect?: () => void;
  onDisconnect?: () => void;
  onTyping?: (isTyping: boolean) => void;
}

/**
 * Configuration for copilot client initialization
 */
export interface CopilotClientConfig {
  baseUrl?: string;
  token?: string;
  language?: string;
  timeout?: number;
  retryAttempts?: number;
  enableSSE?: boolean;
  enableFileUpload?: boolean;
  interceptor?: import("../client").Interceptor;
}

```

## Archivo: `packages/api-client/src/api/datasource.ts`

```typescript
import { Client, type Interceptor } from "./client";
import { API_DATASOURCE_SERVLET } from "./constants";
import type { DatasourceParams } from "./types";
import { isWrappedWithAt } from "../utils/datasource/utils";

export class Datasource {
  private static instance: Datasource;
  public client: Client;

  private constructor(url: string) {
    this.client = new Client(url);
  }

  public static getInstance(url = "") {
    if (!Datasource.instance) {
      Datasource.instance = new Datasource(url);
    }

    return Datasource.instance;
  }

  public setBaseUrl(url: string) {
    this.client.setBaseUrl(url + API_DATASOURCE_SERVLET);
  }

  public setToken(token: string) {
    this.client.setAuthHeader(token, "Bearer");
  }

  public registerInterceptor(interceptor: Interceptor) {
    return this.client.registerInterceptor(interceptor);
  }

  public get(entity: string, options: Record<string, unknown> = {}) {
    try {
      return this.client.post(entity, this.buildParams(options));
    } catch (error) {
      console.error(`Error fetching from datasource for entity ${entity}: ${error}`);

      throw error;
    }
  }

  public async getSingleRecord(entity: string, id: string) {
    try {
      const { data } = await this.client.request(`${entity}/${id}`);

      return Array.isArray(data) ? data[0] : data;
    } catch (error) {
      console.error(`Error fetching from datasource for entity ${entity} with ID ${id} - ${error}`);

      throw error;
    }
  }

  private buildParams(options: DatasourceParams) {
    const params = new URLSearchParams({
      _noCount: "true",
      _operationType: "fetch",
      isImplicitFilterApplied: options.isImplicitFilterApplied ? "true" : "false",
    });

    if (options.windowId) {
      params.set("windowId", options.windowId);
    }

    if (options.tabId) {
      params.set("tabId", options.tabId);
    }

    for (const [key, value] of Object.entries(options)) {
      if (typeof value !== "undefined") {
        if (key === "criteria" && Array.isArray(value)) {
          for (const criteria of value) {
            params.append(key, JSON.stringify(criteria));
          }
        } else {
          const formattedKey = isWrappedWithAt(key) ? key : `_${key}`;
          const formattedValue = Array.isArray(value) ? value.join(",") : String(value);
          params.append(formattedKey, formattedValue);
        }
      }
    }

    return params;
  }
}

export const datasource = Datasource.getInstance();

```

## Archivo: `packages/api-client/src/api/defaultConfig.ts`

```typescript
import { Metadata } from "./metadata";
import type { DefaultConfiguration } from "./types";

const DEFAULT_CONFIG = {
  language: "192",
  role: "0",
  client: "System",
  organization: "0",
  warehouse: "0",
  default: "true",
};

export const setDefaultConfiguration = async (config: DefaultConfiguration): Promise<void> => {
  const client = Metadata.kernelClient;

  const params = {
    language: (config.language || DEFAULT_CONFIG.language).toString(),
    role: (config.defaultRole || DEFAULT_CONFIG.role).toString(),
    client: (config.client || DEFAULT_CONFIG.client).toString(),
    organization: (config.organization || DEFAULT_CONFIG.organization).toString(),
    warehouse: (config.defaultWarehouse || DEFAULT_CONFIG.warehouse).toString(),
    default: DEFAULT_CONFIG.default,
  };

  try {
    const response = await client.post(
      "?command=save&_action=org.openbravo.client.application.navigationbarcomponents.UserInfoWidgetActionHandler&stateless=true",
      params
    );

    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }

    if (typeof response.data === "string" && response.data.includes("throw")) {
      throw new Error("Server returned an error in JavaScript");
    }

    return response.data;
  } catch (error) {
    console.error("Error setting default configuration:", error);

    throw error;
  }
};

```

## Archivo: `packages/api-client/src/api/getSession.ts`

```typescript
import { Metadata } from "./metadata";
import type { SessionResponse } from "./types";

export const getSession = async (): Promise<SessionResponse> => {
  const response = await Metadata.client.request("/session");

  if (!response.ok) {
    throw new Error(`HTTP error! status: ${response.status}`);
  }

  return response.data;
};

```

## Archivo: `packages/api-client/src/api/location.ts`

```typescript
import { Client } from "./client";
import type { CreateLocationRequest, LocationResponse, LocationApiResponse, LocationErrorResponse } from "./types";

export class LocationClient extends Client {
  /**
   * Create a new address
   */
  public async createLocation(locationData: CreateLocationRequest): Promise<LocationResponse> {
    try {
      const response = await this.post("/location/create", locationData);
      const data = response.data as LocationApiResponse;

      if (!data.success) {
        const errorData = data as unknown as LocationErrorResponse;
        throw new Error(errorData.error || "Error creating location");
      }

      return data.data;
    } catch (error) {
      console.error("Error creating location:", error);
      throw error;
    }
  }

  /**
   * Get an identifier of an existent location
   */
  public async getLocationIdentifier(locationId: string): Promise<string> {
    try {
      const response = await this.post("/location/identifier", { locationId });
      const data = response.data as { identifier: string };
      return data.identifier;
    } catch (error) {
      console.error("Error getting location identifier:", error);
      throw error;
    }
  }
}

export const locationClient = new LocationClient();

```

## Archivo: `packages/api-client/src/api/metadata.ts`

```typescript
import { CacheStore } from "./cache";
import { Client, type Interceptor } from "./client";
import { API_DATASOURCE_SERVLET, API_DEFAULT_CACHE_DURATION, API_KERNEL_SERVLET, API_METADATA_URL } from "./constants";
import { LocationClient } from "./location";
import type * as Etendo from "./types";
import type { Menu } from "./types";

export type { Etendo };

export class Metadata {
  public static client = new Client();
  public static kernelClient = new Client();
  public static datasourceServletClient = new Client();
  private static cache = new CacheStore(API_DEFAULT_CACHE_DURATION);
  private static currentRoleId: string | null = null;
  public static loginClient = new Client();
  private static language: string | null = null;
  public static locationClient = new LocationClient();

  public static setBaseUrl(url: string) {
    Metadata.client.setBaseUrl(url + API_METADATA_URL);
    Metadata.kernelClient.setBaseUrl(url + API_KERNEL_SERVLET);
    Metadata.datasourceServletClient.setBaseUrl(url + API_DATASOURCE_SERVLET);
    Metadata.loginClient.setBaseUrl(`${url}/`);
    Metadata.locationClient.setBaseUrl(url + API_METADATA_URL);
  }

  public static setLanguage(value: string) {
    Metadata.language = value;

    for (const client of [Metadata.client, Metadata.kernelClient, Metadata.datasourceServletClient]) {
      client.setLanguageHeader(value);
    }

    return Metadata;
  }

  public static setToken(token: string) {
    for (const client of [
      Metadata.client,
      Metadata.kernelClient,
      Metadata.datasourceServletClient,
      Metadata.loginClient,
      Metadata.locationClient,
    ]) {
      client.setAuthHeader(token, "Bearer");
    }

    return Metadata;
  }

  public static registerInterceptor(interceptor: Interceptor) {
    const listener1 = Metadata.client.registerInterceptor(interceptor);
    const listener2 = Metadata.kernelClient.registerInterceptor(interceptor);
    const listener3 = Metadata.datasourceServletClient.registerInterceptor(interceptor);
    const listener4 = Metadata.locationClient.registerInterceptor(interceptor);

    return () => {
      listener1();
      listener2();
      listener3();
      listener4();
    };
  }

  public static getDatasource(id: string, body: BodyInit | Record<string, unknown> | null | undefined) {
    return Metadata.datasourceServletClient.post(id, body);
  }

  private static async _getWindow(windowId: Etendo.WindowId): Promise<Etendo.WindowMetadata> {
    const { data, ok } = await Metadata.client.post(`window/${windowId}`);

    if (!ok) {
      throw new Error("Window not found");
    }

    Metadata.cache.set(`window-${windowId}`, data);
    for (const tab of data.tabs) {
      Metadata.cache.set(`tab-${tab.id}`, tab);
    }

    return data;
  }

  public static async getWindow(windowId: Etendo.WindowId): Promise<Etendo.WindowMetadata> {
    const cached = Metadata.cache.get<Etendo.WindowMetadata>(`window-${windowId}`);

    if (cached) {
      return cached;
    }
    return Metadata._getWindow(windowId);
  }

  private static async _getTab(tabId?: Etendo.Tab["id"]): Promise<Etendo.Tab> {
    const { data } = await Metadata.client.post(`tab/${tabId}`);

    Metadata.cache.set(`tab-${tabId}`, data);

    return data;
  }

  public static async getTab(tabId: Etendo.Tab["id"]): Promise<Etendo.Tab> {
    const cached = Metadata.cache.get<Etendo.Tab>(`tab-${tabId}`);

    if (cached) {
      return cached;
    }
    return Metadata._getTab(tabId);
  }

  private static async _getLabels(): Promise<Etendo.Labels> {
    const { data } = await Metadata.client.request("labels");

    Metadata.cache.set(`labels-${Metadata.language}`, data);

    return data;
  }

  public static async getLabels(): Promise<Etendo.Labels> {
    const cached = Metadata.cache.get<Etendo.Labels>(`labels-${Metadata.language}`);

    if (cached) {
      return cached;
    }
    return Metadata._getLabels();
  }

  public static getColumns(tabId: string): Etendo.Column[] {
    return Metadata.cache.get<{ fields: Etendo.Column[] }>(`tab-${tabId}`)?.fields ?? [];
  }

  public static async getMenu(forceRefresh = false): Promise<Menu[]> {
    const cached = Metadata.cache.get<Menu[]>("OBMenu");
    const currentRoleId = localStorage.getItem("currentRoleId");

    if (!forceRefresh && cached && cached.length && currentRoleId === Metadata.currentRoleId) {
      return cached;
    }
    try {
      const { data } = await Metadata.client.post("menu", { role: currentRoleId });
      const menu = data.menu;
      Metadata.cache.set("OBMenu", menu);
      Metadata.currentRoleId = currentRoleId;

      return menu;
    } catch (error) {
      console.error("Error fetching menu:", error);
      throw error;
    }
  }

  public static async refreshMenuOnLogin(): Promise<void> {
    Metadata.clearMenuCache();
    await Metadata.getMenu(true);
  }

  public static getCachedMenu(): Menu[] {
    return Metadata.cache.get<Menu[]>("OBMenu") ?? [];
  }

  public static getCachedWindow(windowId: string): Etendo.WindowMetadata {
    return Metadata.cache.get<Etendo.WindowMetadata>(`window-${windowId}`) || ({} as Etendo.WindowMetadata);
  }

  public static clearMenuCache() {
    Metadata.cache.delete("OBMenu");
    Metadata.currentRoleId = null;
  }

  public static clearWindowCache(windowId: string) {
    Metadata.cache.delete(`window-${windowId}`);
  }

  public static forceWindowReload(windowId: string) {
    return Metadata._getWindow(windowId);
  }

  public static getTabsColumns(tabs?: Etendo.Tab[]) {
    return (tabs || []).reduce(
      (cols, tab) => {
        cols[tab.id] = Metadata.getColumns(tab.id);

        return cols;
      },
      {} as Record<string, Etendo.Column[]>
    );
  }

  public static evaluateExpression(expr: string, values: Record<string, unknown>) {
    const conditions = expr.split("||").map((c) => c.trim());

    return conditions.some((condition) => {
      const matches = condition.match(/OB\.Utilities\.getValue\(currentValues,['"](.+)['"]\)\s*===\s*(.+)/);
      if (!matches) return false;

      const [, property, expectedValueStr] = matches;
      const actualValue = values[property];

      if (expectedValueStr.startsWith("'") || expectedValueStr.startsWith('"')) {
        return actualValue === expectedValueStr.slice(1, -1);
      }

      return actualValue === JSON.parse(expectedValueStr);
    });
  }
}

```

## Archivo: `packages/api-client/src/api/types.ts`

```typescript
export type WindowId = string;

export interface CachedData<T> {
  updatedAt: number;
  value: T;
}

export interface CacheStore<T> extends Map<string, CachedData<T>> {}

export interface BaseCriteria {
  fieldName: string;
  operator: string;
  value: string | number | undefined;
}

export interface CompositeCriteria {
  operator: "and" | "or";
  criteria: BaseCriteria[];
}

export type Criteria = BaseCriteria | CompositeCriteria;

export type MRT_ColumnFiltersState = {
  id: string;
  value: unknown;
}[];
export interface DatasourceParams {
  windowId?: string;
  tabId?: string;
  columns?: string[];
  startRow?: number;
  endRow?: number;
  sortBy?: string;
  criteria?: Criteria[];
  operationType?: "fetch" | "add" | "update" | "remove";
  isSorting?: boolean;
  isImplicitFilterApplied?: boolean;
  operator?: "and" | "or";
}

export interface DatasourceOptions {
  columns?: string[];
  sortBy?: string;
  criteria?: Criteria[];
  operationType?: "fetch" | "add" | "update" | "remove";
  isSorting?: boolean;
  isImplicitFilterApplied?: boolean;
  operator?: "and" | "or";
  pageSize?: number;
  headers?: Record<string, string>;
  tabId?: string;
  windowId?: string;
  language?: string;
}

export interface ProcessAction extends Record<string, unknown> {
  id: string;
  name: string;
}

export interface GridProps {
  sort: number;
  autoExpand: boolean;
  editorProps: {
    displayField: string;
    valueField: string;
  };
  displaylength: number;
  fkField: boolean;
  selectOnClick: boolean;
  canSort: boolean;
  canFilter: boolean;
  showHover: boolean;
  filterEditorProperties: {
    keyProperty: string;
  };
  showIf: string;
}

export interface ReadOnlyState {
  readOnly: boolean;
  readOnlyLogicExpr?: string;
  readOnlyReason?: "FIELD_READONLY" | "READONLY_LOGIC" | "ACCESS_LEVEL";
}
export interface Field {
  hqlName: string;
  inputName: string;
  columnName: string;
  readOnlyState?: ReadOnlyState;
  process: string;
  shownInStatusBar: boolean;
  tab: string;
  displayed: boolean;
  startnewline: boolean;
  showInGridView: boolean;
  fieldGroup$_identifier: string;
  fieldGroup: string;
  isMandatory: boolean;
  column: Record<string, string>;
  name: string;
  id: string;
  module: string;
  hasDefaultValue: boolean;
  refColumnName: string;
  targetEntity: string;
  gridProps: GridProps;
  type: string;
  field: unknown[];
  selector?: Record<string, string>;
  refList: { id: string; label: string; value: string }[];
  referencedEntity: string;
  referencedWindowId: string;
  referencedTabId: string;
  displayLogicExpression?: string;
  readOnlyLogicExpression?: string;
  isReadOnly: boolean;
  isDisplayed: boolean;
  sequenceNumber: number;
  isUpdatable: boolean;
  description: string;
  helpComment: string;
  processDefinition?: ProcessDefinition;
  processAction?: ProcessAction;
}

export interface Option<T extends string = string> {
  title: string;
  value: T;
  id: string;
}

export interface ValueWithIdentifier {
  value: unknown;
  identifier: string;
}

export interface Column {
  fieldGroup?: string;
  header: string;
  id: string;
  accessorFn: (v: Record<string, unknown>) => unknown;
  columnName: string;
  isMandatory?: boolean;
  name: string;
  reference?: string;
  _identifier: string;
  displayType?: string;
  column?: Record<string, string>;
  referencedWindowId?: string;
  [key: string]: unknown;
}

export interface MappedField {
  name: string;
  label: string;
  type: FieldType;
  referencedTable?: string;
  required?: boolean;
}

export enum FieldType {
  TEXT = "text",
  NUMBER = "number",
  DATE = "date",
  BOOLEAN = "boolean",
  SELECT = "select",
  SEARCH = "search",
  TABLEDIR = "tabledir",
  QUANTITY = "quantity",
  LIST = "list",
  BUTTON = "button",
  WINDOW = "window",
  DATETIME = "datetime",
}

export interface MappedTab {
  id: string;
  name: string;
  fields: Record<string, MappedField>;
}

export interface MappedData {
  id: string;
  name: string;
  tabs: MappedTab[];
  fields?: MappedField[];
}

export interface ViewStandardProperties extends Record<string, unknown> {}

export interface WindowMetadataProperties {
  windowId: string;
  multiDocumentEnabled: boolean;
  viewProperties: {
    fields: Field[];
    tabTitle: string;
    entity: string;
    statusBarFields: unknown[];
    iconToolbarButtons: unknown[];
    actionToolbarButtons: unknown[];
    isDeleteableTable: boolean;
    tabId: string;
    moduleId: string;
    showCloneButton: boolean;
    askToCloneChildren: boolean;
    standardProperties: ViewStandardProperties;
    showParentButtons: boolean;
    buttonsHaveSessionLogic: boolean;
    initialPropertyToColumns: unknown[]; // Define if known
  };
}

export interface Tab {
  uIPattern: "STD" | "SR";
  window: string;
  name: string;
  title: string;
  parentColumns: string[];
  id: string;
  table: string;
  entityName: string;
  fields: Record<string, Field>;
  tabLevel: number;
  _identifier: string;
  records: Record<string, never>;
  hqlfilterclause: string;
  hqlwhereclause: string;
  sQLWhereClause: string;
  module: string;
  parentTabId?: string;
  table$_identifier?: string;
}

export interface WindowMetadata {
  id: string;
  name: string;
  superClass?: string;
  properties: WindowMetadataProperties;
  tabs: Tab[];
  window$_identifier: string;
}

export interface RecordPayload extends Record<string, string> {
  _entity_name: string;
}

export interface Menu {
  _identifier?: string;
  _entityName?: string;
  $ref?: string;
  recordTime?: number;
  children?: Menu[];
  icon?: string | null;
  id: string;
  name: string;
  windowId?: string;
  recordId?: string;
  tableId?: string;
  window?: Window | null;
  type?: string;
  action?: Action[keyof Action] | null;
  isSearchResult?: boolean;
  path?: string[];
  fullPath?: string;
}

export enum Action {
  OBUIAPPOpenView = "OBUIAPP_OpenView",
  OBUIAPPProcess = "OBUIAPP_Process",
  P = "P",
  R = "R",
  W = "W",
  X = "X",
}

export interface Window {
  _identifier: string;
  _entityName: string;
  $ref: string;
  recordTime: number;
  id: string;
  name: string;
  windowType: keyof typeof WindowType;
}

export enum WindowType {
  M = "M",
  Q = "Q",
  T = "T",
}

export interface LoginResponse {
  token: string;
}

export interface ISession extends Record<string, string | number | boolean | null> {}

export interface User {
  id: string;
  name: string;
  username: string;
  image: string;
  defaultRole: string;
  defaultWarehouse: string;
  defaultWarehouse$_identifier: string;
  defaultClient: string;
  client$_identifier: string;
  defaultLanguage: string;
  defaultLanguage$_identifier: string;
  defaultOrganization: string;
  defaultOrganization$_identifier: string;
  defaultRole$_identifier: string;
}

export interface SessionResponse {
  user: User;
  currentRole: CurrentRole;
  currentOrganization: CurrentOrganization;
  currentClient: CurrentClient;
  currentWarehouse?: CurrentWarehouse;
  roles: RoleList;
  languages: Languages;
  attributes: { [key: string]: null | string };
}

export type RoleList = {
  id: string;
  name: string;
  organizations: Organization[];
  client: string;
}[];

export interface Organization {
  id: string;
  name: string;
  warehouses: Warehouse[];
}

export interface Warehouse {
  id: string;
  name: string;
}

export interface CurrentClient {
  _identifier: string;
  _entityName: string;
  $ref: string;
  id: string;
  organization: string;
  organization$_identifier: string;
  active: boolean;
  creationDate: Date;
  createdBy: string;
  createdBy$_identifier: string;
  updated: Date;
  updatedBy: string;
  updatedBy$_identifier: string;
  searchKey: string;
  name: string;
  description: string;
  mailHost: null;
  requestEmail: null;
  requestUser: null;
  requestUserPassword: null;
  requestFolder: null;
  language: null;
  multilingualDocuments: boolean;
  sMTPAuthentification: boolean;
  currency: string;
  currency$_identifier: string;
  acctdimCentrallyMaintained: boolean;
  projectAcctdimIsenable: boolean;
  projectAcctdimHeader: boolean;
  projectAcctdimLines: boolean;
  projectAcctdimBreakdown: boolean;
  bpartnerAcctdimIsenable: boolean;
  bpartnerAcctdimHeader: boolean;
  bpartnerAcctdimLines: boolean;
  bpartnerAcctdimBreakdown: boolean;
  productAcctdimIsenable: boolean;
  productAcctdimHeader: boolean;
  productAcctdimLines: boolean;
  productAcctdimBreakdown: boolean;
  costcenterAcctdimHeader: boolean;
  costcenterAcctdimLines: boolean;
  costcenterAcctdimBreakdown: boolean;
  user1AcctdimIsenable: boolean;
  user1AcctdimHeader: boolean;
  user1AcctdimLines: boolean;
  user1AcctdimBreakdown: boolean;
  user2AcctdimIsenable: boolean;
  user2AcctdimHeader: boolean;
  user2AcctdimLines: boolean;
  user2AcctdimBreakdown: boolean;
  costcenterAcctdimIsenable: boolean;
  orgAcctdimIsenable: boolean;
  orgAcctdimHeader: boolean;
  orgAcctdimLines: boolean;
  orgAcctdimBreakdown: boolean;
  daysToPasswordExpiration: number;
  recordTime: number;
}

export interface CurrentOrganization {
  _identifier: string;
  _entityName: string;
  $ref: string;
  id: string;
  client: string;
  client$_identifier: string;
  active: boolean;
  creationDate: Date;
  createdBy: string;
  createdBy$_identifier: string;
  updated: Date;
  updatedBy: string;
  updatedBy$_identifier: string;
  searchKey: string;
  name: string;
  description: null;
  summaryLevel: boolean;
  organizationType: string;
  organizationType$_identifier: string;
  allowPeriodControl: boolean;
  calendar: null;
  ready: boolean;
  socialName: null;
  currency: null;
  generalLedger: null;
  aPRMGlitem: null;
  periodControlAllowedOrganization: string;
  periodControlAllowedOrganization$_identifier: string;
  calendarOwnerOrganization: string;
  calendarOwnerOrganization$_identifier: string;
  legalEntityOrganization: string;
  legalEntityOrganization$_identifier: string;
  inheritedCalendar: string;
  inheritedCalendar$_identifier: string;
  businessUnitOrganization: null;
  extbpEnabled: boolean;
  extbpConfig: null;
  recordTime: number;
}

export interface CurrentRole {
  _identifier: string;
  _entityName: string;
  $ref: string;
  id: string;
  client: string;
  client$_identifier: string;
  organization: string;
  organization$_identifier: string;
  active: boolean;
  creationDate: Date;
  createdBy: string;
  createdBy$_identifier: string;
  updated: Date;
  name: string;
  updatedBy: string;
  updatedBy$_identifier: string;
  description: string;
  userLevel: string;
  currency: null;
  approvalAmount: number;
  primaryTreeMenu: null;
  manual: boolean;
  processNow: boolean;
  clientAdmin: boolean;
  advanced: boolean;
  isrestrictbackend: boolean;
  forPortalUsers: boolean;
  portalAdmin: boolean;
  isWebServiceEnabled: boolean;
  template: boolean;
  recalculatePermissions: null;
  recordTime: number;
}

export interface CurrentWarehouse {
  _identifier: string;
  _entityName: string;
  $ref: string;
  id: string;
  client: string;
  client$_identifier: string;
  organization: string;
  organization$_identifier: string;
  active: boolean;
  creationDate: Date;
  createdBy: string;
  createdBy$_identifier: string;
  updated: Date;
  updatedBy: string;
  updatedBy$_identifier: string;
  searchKey: string;
  name: string;
  description: null;
  locationAddress: string;
  locationAddress$_identifier: string;
  storageBinSeparator: string;
  shipmentVehicle: boolean;
  shipperCode: null;
  fromDocumentNo: null;
  toDocumentNo: null;
  returnlocator: string;
  returnlocator$_identifier: string;
  warehouseRule: null;
  allocated: boolean;
  recordTime: number;
}

export interface Languages {
  [key: string]: {
    id: string;
    name: string;
    language: string;
  };
}

export interface User {
  _identifier: string;
  _entityName: string;
  $ref: string;
  id: string;
  client: string;
  client$_identifier: string;
  organization: string;
  organization$_identifier: string;
  active: boolean;
  creationDate: Date;
  createdBy: string;
  createdBy$_identifier: string;
  updated: Date;
  updatedBy: string;
  updatedBy$_identifier: string;
  name: string;
  description: null;
  password: string;
  email: null;
  supervisor: null;
  businessPartner: null;
  processNow: null;
  emailServerUsername: string;
  emailServerPassword: null;
  partnerAddress: null;
  greeting: null;
  position: null;
  comments: null;
  phone: null;
  alternativePhone: null;
  fax: null;
  lastContactDate: null;
  lastContactResult: null;
  birthday: null;
  trxOrganization: null;
  firstName: string;
  lastName: null;
  username: string;
  defaultClient: string;
  defaultLanguage: string;
  defaultOrganization: string;
  defaultRole: string;
  defaultRole$_identifier: string;
  defaultWarehouse: string;
  locked: boolean;
  image: string;
  grantPortalAccess: boolean;
  lastPasswordUpdate: Date;
  isPasswordExpired: boolean;
  commercialauth: boolean;
  viasms: boolean;
  viaemail: boolean;
  smfswsDefaultWsRole: null;
  recordTime: number;
}

export interface DefaultConfiguration {
  language?: string;
  client?: string;
  organization?: string;
  defaultRole?: string;
  defaultWarehouse?: string;
}

export interface Role {
  id: string;
  name: string;
  orgList: Array<{
    id: string;
    name: string;
    warehouseList: Array<{
      id: string;
      name: string;
    }>;
  }>;
}

export interface ProfileInfo {
  name: string;
  email: string;
  image: string;
}

export interface Warehouse {
  id: string;
  name: string;
}

export interface ToolbarButton {
  id: string;
  name: string;
  action: string;
  enabled: boolean;
  visible: boolean;
}

export interface ToolbarMetadata {
  buttons: ToolbarButton[];
  isNew: boolean;
  gridId: string | null;
  action: string;
}

export interface FieldInfo {
  fieldGroup$_identifier?: string;
}

export interface BaseFieldDefinition<T> {
  value: T;
  type: FieldType;
  label: string;
  name: string;
  section?: string;
  required?: boolean;
  initialValue?: T;
  readOnlyState?: ReadOnlyState;
  original: {
    referencedEntity: string;
    referencedWindowId: string;
    referencedTabId: string;
    fieldName: string;
  } & Field;
}

export type SelectOption = { id: string; title: string; value: string };
export type FieldDefinition =
  | BaseFieldDefinition<string>
  | BaseFieldDefinition<number>
  | BaseFieldDefinition<boolean>
  | BaseFieldDefinition<Date>
  | BaseFieldDefinition<string[]>
  | BaseFieldDefinition<SelectOption>;

type EntityKey = string;
export type EntityValue = string | number | boolean | symbol | null;

export interface EntityData {
  [key: EntityKey]: EntityValue;
}

export enum FormMode {
  NEW = "NEW",
  EDIT = "EDIT",
}

export interface FormInitializationParams {
  tab: Tab;
  mode: FormMode;
  recordId?: string;
}

export interface FormInitializationResponse {
  columnValues: Record<
    string,
    {
      value: string;
      classicValue?: string;
      identifier?: string;
      entries?: Array<{ id: string; _identifier: string }>;
    }
  >;
  auxiliaryInputValues: Record<string, { value: string; classicValue?: string }>;
  sessionAttributes: Record<string, string>;
  dynamicCols: string[];
  attachmentExists: boolean;
  _readOnly?: boolean;
}

export interface ProcessBindings {
  onLoad: (
    process: ProcessDefinition,
    context: { selectedRecords: Record<string, EntityData>; tabId: string }
    // biome-ignore lint/suspicious/noExplicitAny: <explanation>
  ) => Promise<any>;
  onProcess: (
    process: ProcessDefinition,
    // biome-ignore lint/suspicious/noExplicitAny: <explanation>
    params: { recordIds: string[]; windowId: string; entityName: string; buttonValue: any; [param: string]: unknown }
    // biome-ignore lint/suspicious/noExplicitAny: <explanation>
  ) => Promise<any>;
  metadata: Record<string, unknown>;
}

export interface ProcessInfo {
  loadFunction: string;
  searchKey: string;
  clientSideValidation: string;
  _entityName: string;
  id: string;
  name: string;
  javaClassName: string;
  parameters: Array<{
    defaultValue: string;
    id: string;
    name: string;
  }>;
}

export type ListOption = { id: string; label: string; value: string };

export type ProcessParameter = {
  defaultValue: string;
  mandatory: boolean;
  id: string;
  name: string;
  refList: Array<ListOption>;
  readOnlyLogicExpression?: string;
  reference: string;
  window?: WindowMetadata; // This type is for process that have defined a window reference
} & Record<string, string>;

export type ProcessParameters = Record<string, ProcessParameter>;

export interface ProcessDefinition extends Record<string, unknown> {
  id: string;
  name: string;
  javaClassName: string;
  parameters: ProcessParameters;
  onLoad: string;
  onProcess: string;
}

export interface Labels {
  [key: string]: string;
}

export interface CreateLocationRequest {
  address1: string;
  address2?: string;
  postal?: string;
  city: string;
  countryId: string;
  regionId?: string;
  [key: string]: unknown;
}

export interface LocationResponse {
  id: string;
  _identifier: string;
  address1: string;
  address2?: string;
  postal?: string;
  city: string;
  countryId: string;
  regionId?: string;
}

export interface LocationApiResponse {
  success: boolean;
  data: LocationResponse;
}

export interface LocationErrorResponse {
  success: false;
  error: string;
  status: number;
}

```

## Archivo: `packages/api-client/src/api/utils.ts`

```typescript
import { DEFAULT_LOGIN_CHARSET } from "./constants";
import type { LoginResponse } from "./types";

const getCharset = (result: Response) =>
  result.headers.get("content-type")?.split("charset=")?.pop() || DEFAULT_LOGIN_CHARSET;

export const getDecodedJsonResponse = async (result: Response): Promise<LoginResponse> => {
  const charset = getCharset(result);
  const buffer = await result.arrayBuffer();
  const decoder = new TextDecoder(charset);
  const decodedText = decoder.decode(buffer);

  return JSON.parse(decodedText);
};

```

## Archivo: `packages/api-client/src/hooks/types.ts`

```typescript
export interface ReportColumn {
  header: string;
  accessorKey: string;
}

export interface ReportField {
  id: string;
  name: string;
  label: string;
  type: "date" | "select" | "multiselect" | "search" | "string";
  required: boolean;
  gridWidth?: 1 | 2 | 3;
  entity?: string;
  columnName?: string;
  identifierField?: string;
  columns?: ReportColumn[];
  original?: {
    referencedEntity?: string;
    referencedWindowId?: string;
    referencedTabId?: string;
    column?: {
      callout$_identifier?: string;
    };
  };
  lookupConfig?: {
    url?: string;
    values?: Array<{ id: string; name: string }>;
    multiple?: boolean;
    selector?: {
      icon?: string;
      title?: string;
    };
  };
  validation?: {
    lowerThan?: string;
    greaterThan?: string;
  };
}

export interface ReportResponse {
  url?: string;
  blob?: Blob;
}

export interface ReportMetadata {
  id: string;
  title: string;
  sourcePath: string;
  sections: Array<{
    id: string;
    title: string;
    fields: ReportField[];
  }>;
  actions: Array<{
    id: string;
    name: string;
    format: string;
    command: string;
  }>;
}

export interface ReportMetadataHook {
  metadata: ReportMetadata | null;
  loading: boolean;
  error: string | null;
}

```

## Archivo: `packages/api-client/src/index.ts`

```typescript
export * from "./api/metadata";
export * from "./api/client";
export * from "./api/copilot/index";

```

## Archivo: `packages/api-client/src/tests/metadata.test.ts`

```typescript
import { Metadata } from "../api/metadata";

describe("Metadata module", () => {
  it("initializes correctly", () => {
    expect(Metadata.client).toBeTruthy();
  });
});

```

## Archivo: `packages/api-client/src/utils/datasource/utils.ts`

```typescript
/**
 * Checks whether a given string is wrapped with '@' characters.
 *
 * In the context of Etendo (or Openbravo), parameters enclosed in '@...@'
 * are treated as dynamic context variables. These variables are resolved at runtime
 * using the user's session context, for example in SQL queries, HQL, callouts, or process definitions.
 *
 * @param str - The string to check
 * @returns true if the string starts and ends with '@', and has at least one character in between
 */
export const isWrappedWithAt = (str: string): boolean => {
  return /^@[^@]+@$/.test(str);
};

```

## Archivo: `packages/api-client/src/utils/metadata.ts`

```typescript
import type { Etendo } from "../api/metadata";
import { type Field, FieldType, type Tab } from "../api/types";

export const groupTabsByLevel = (windowData?: Etendo.WindowMetadata) => {
  const tabs: Etendo.Tab[][] = [];

  try {
    if (!windowData?.tabs) {
      return tabs;
    }

    for (const tab of windowData.tabs) {
      if (tabs[tab.tabLevel]) {
        tabs[tab.tabLevel].push(tab);
      } else {
        tabs[tab.tabLevel] = [tab];
      }
    }
  } catch (e) {
    console.warn(e);
  }

  return tabs;
};

export const buildFormState = (
  fields: Tab["fields"],
  record: Record<string, unknown>,
  formState: Record<string, Record<string, never>>
) => {
  try {
    const result = Object.entries(fields).reduce(
      (state, [, field]) => {
        const inputName = field.inputName;

        if (inputName?.length) {
          state[inputName] = record[field.hqlName];
        } else {
          console.warn("Missing field input name for", JSON.stringify(field, null, 2));
        }

        return state;
      },
      {} as Record<string, unknown>
    );

    const auxiliaryInputValues = formState?.auxiliaryInputValues;

    if (auxiliaryInputValues) {
      for (const [inputName, { value }] of Object.entries(auxiliaryInputValues)) {
        result[inputName] = value;
      }
    }

    return result;
  } catch (e) {
    console.warn(e);

    return {};
  }
};

export const isEntityReference = (type: FieldType) => [FieldType.SELECT, FieldType.TABLEDIR].includes(type);

export const getFieldsByColumnName = (tab?: Tab) => {
  try {
    if (!tab) {
      return {};
    }

    return Object.entries(tab.fields).reduce(
      (acc, [, field]) => {
        acc[field.columnName] = field;

        return acc;
      },
      {} as Record<string, Field>
    );
  } catch (e) {
    console.warn(e);

    return {};
  }
};

export const getFieldsByInputName = (tab?: Tab) => {
  try {
    if (!tab) {
      return {};
    }

    return Object.entries(tab.fields).reduce(
      (acc, [, field]) => {
        acc[field.inputName] = field;

        return acc;
      },
      {} as Record<string, Field>
    );
  } catch (e) {
    console.warn(e);

    return {};
  }
};

export const getFieldsByHqlName = (tab?: Tab) => {
  try {
    if (!tab) {
      return {};
    }

    return Object.entries(tab.fields).reduce(
      (acc, [, field]) => {
        acc[field.hqlName] = field;

        return acc;
      },
      {} as Record<string, Field>
    );
  } catch (e) {
    console.warn(e);

    return {};
  }
};

```

## Archivo: `packages/api-client/src/utils/search-utils.ts`

```typescript
import type { BaseCriteria, Column, CompositeCriteria, MRT_ColumnFiltersState } from "../api/types";

type FormattedValue = string | number | null;

interface ColumnsByType {
  string?: Column[];
  date?: Column[];
  reference?: Column[];
}

const REFERENCE_FIELDS = [
  "organization",
  "transactionDocument",
  "businessPartner",
  "partnerAddress",
  "currency",
  "warehouse",
];

const EXCLUDED_NUMERIC_FIELDS = [
  "amount",
  "price",
  "quantity",
  "total",
  "paid",
  "percentage",
  "outstanding",
  "days",
  "grandTotalAmount",
];

const STATUS_FIELDS = ["documentStatus"];

export class SearchUtils {
  private static readonly FULL_DATE_PATTERN = /^\d{4}-\d{2}-\d{2}$/;
  private static readonly YEAR_PATTERN = /^\d{4}$/;
  private static readonly YEAR_MONTH_PATTERN = /^\d{4}-\d{2}$/;
  private static readonly YEAR_PARTIAL_PATTERN = /^\d{4}-$/;

  private static detectValueType(value: string): keyof ColumnsByType {
    if (
      SearchUtils.FULL_DATE_PATTERN.test(value) ||
      SearchUtils.YEAR_PATTERN.test(value) ||
      SearchUtils.YEAR_MONTH_PATTERN.test(value) ||
      SearchUtils.YEAR_PARTIAL_PATTERN.test(value)
    ) {
      return "date";
    }
    return "string";
  }

  private static getColumnType(column: Column): keyof ColumnsByType {
    const columnName = column.columnName.toLowerCase();

    if (EXCLUDED_NUMERIC_FIELDS.includes(columnName)) {
      return "string";
    }

    if (REFERENCE_FIELDS.includes(column.columnName)) {
      return "reference";
    }

    if (columnName.includes("date")) {
      return "date";
    }

    return "string";
  }

  public static getDateCriteria(fieldName: string, searchQuery: string): BaseCriteria[] {
    const criteria: BaseCriteria[] = [];

    if (SearchUtils.FULL_DATE_PATTERN.test(searchQuery)) {
      criteria.push({
        fieldName,
        operator: "equals",
        value: searchQuery,
      });
    } else if (SearchUtils.YEAR_MONTH_PATTERN.test(searchQuery)) {
      criteria.push({
        fieldName,
        operator: "greaterOrEqual",
        value: `${searchQuery}-01`,
      });
      criteria.push({
        fieldName,
        operator: "lessOrEqual",
        value: `${searchQuery}-31`,
      });
    } else if (SearchUtils.YEAR_PATTERN.test(searchQuery)) {
      criteria.push({
        fieldName,
        operator: "greaterOrEqual",
        value: `${searchQuery}-01-01`,
      });
      criteria.push({
        fieldName,
        operator: "lessOrEqual",
        value: `${searchQuery}-12-31`,
      });
    } else if (SearchUtils.YEAR_PARTIAL_PATTERN.test(searchQuery)) {
      const year = searchQuery.slice(0, -1);
      criteria.push({
        fieldName,
        operator: "greaterOrEqual",
        value: `${year}-01-01`,
      });
      criteria.push({
        fieldName,
        operator: "lessOrEqual",
        value: `${year}-12-31`,
      });
    }

    return criteria;
  }

  static createSearchCriteria(columns: Column[], searchQuery: string): CompositeCriteria[] {
    if (!searchQuery || !columns.length) return [];

    const queryType = SearchUtils.detectValueType(searchQuery);
    const compositeCriteria: CompositeCriteria[] = [];

    const columnsByType = columns.reduce<ColumnsByType>((acc, column) => {
      const type = SearchUtils.getColumnType(column);
      if (!acc[type]) {
        acc[type] = [];
      }
      acc[type]?.push(column);
      return acc;
    }, {});

    if (queryType === "date" && columnsByType.date?.length) {
      const dateCriteria: BaseCriteria[] = [];

      for (const column of columnsByType.date) {
        dateCriteria.push(...SearchUtils.getDateCriteria(column.columnName, searchQuery));
      }

      if (dateCriteria.length) {
        compositeCriteria.push({
          operator: "or",
          criteria: dateCriteria,
        });
      }
      return compositeCriteria;
    }

    const textSearchCriteria: BaseCriteria[] = [];

    textSearchCriteria.push({
      fieldName: "documentNo",
      operator: "iContains",
      value: searchQuery,
    });

    for (const field of REFERENCE_FIELDS) {
      if (columnsByType.reference?.some((col) => col.columnName === field)) {
        textSearchCriteria.push({
          fieldName: `${field}$_identifier`,
          operator: "iContains",
          value: searchQuery,
        });
      }
    }

    for (const field of STATUS_FIELDS) {
      if (columns.some((col) => col.columnName === field)) {
        textSearchCriteria.push({
          fieldName: field,
          operator: "iContains",
          value: searchQuery,
        });
      }
    }

    if (textSearchCriteria.length) {
      compositeCriteria.push({
        operator: "or",
        criteria: textSearchCriteria,
      });
    }

    return compositeCriteria;
  }
}

export class ColumnFilterUtils {
  static isNumericField(column: Column): boolean {
    if (column.type && typeof column.type === "string") {
      const lowerType = column.type.toLowerCase();

      if (
        lowerType.includes("amount") ||
        lowerType.includes("price") ||
        lowerType.includes("quantity") ||
        lowerType === "number" ||
        lowerType === "costnumber" ||
        lowerType === "numeric" ||
        lowerType === "float" ||
        lowerType === "integer" ||
        lowerType === "decimal" ||
        lowerType === "long" ||
        lowerType === "bigdecimal"
      ) {
        return true;
      }
    }

    return false;
  }

  static formatValueForType(value: unknown, column: Column): FormattedValue {
    if (value === null || value === undefined || value === "") {
      return null;
    }

    if (ColumnFilterUtils.isNumericField(column)) {
      const numValue = Number.parseFloat(String(value).replace(",", "."));
      if (!Number.isNaN(numValue)) {
        return numValue;
      }
      return null;
    }

    return String(value);
  }

  private static handleRangeFilter(
    fieldName: string,
    rangeFilter: { from: FormattedValue; to: FormattedValue },
    column: Column
  ): BaseCriteria[] {
    const result: BaseCriteria[] = [];

    if (rangeFilter.from !== null && rangeFilter.from !== undefined) {
      const formattedValue = ColumnFilterUtils.formatValueForType(rangeFilter.from, column);
      if (formattedValue !== null) {
        result.push({
          fieldName,
          operator: "greaterOrEqual",
          value: formattedValue,
        });
      }
    }

    if (rangeFilter.to !== null && rangeFilter.to !== undefined) {
      const formattedValue = ColumnFilterUtils.formatValueForType(rangeFilter.to, column);
      if (formattedValue !== null) {
        result.push({
          fieldName,
          operator: "lessOrEqual",
          value: formattedValue,
        });
      }
    }

    return result;
  }

  private static handleArrayFilter(fieldName: string, values: unknown[], column: Column): BaseCriteria[] {
    if (values.length === 0) return [];

    const validCriteria: BaseCriteria[] = [];

    for (const val of values) {
      const formattedValue = ColumnFilterUtils.formatValueForType(val, column);
      if (formattedValue === null) continue;

      validCriteria.push({
        fieldName,
        operator: "equals",
        value: String(formattedValue),
      });
    }

    if (validCriteria.length === 0) return [];

    return [
      {
        operator: "or",
        criteria: validCriteria,
      } as unknown as BaseCriteria,
    ];
  }

  private static handleSingleValueFilter(fieldName: string, value: unknown, column: Column): BaseCriteria[] {
    const formattedValue = ColumnFilterUtils.formatValueForType(value, column);
    if (formattedValue === null) return [];

    if (REFERENCE_FIELDS.includes(fieldName)) {
      return [
        {
          fieldName: `${fieldName}$_identifier`,
          operator: "iContains",
          value: String(formattedValue),
        },
      ];
    }

    if (fieldName.toLowerCase().includes("date")) {
      return SearchUtils.getDateCriteria(fieldName, String(formattedValue));
    }

    if (ColumnFilterUtils.isNumericField(column)) {
      return [
        {
          fieldName,
          operator: "equals",
          value: formattedValue,
        },
      ];
    }

    return [
      {
        fieldName,
        operator: "iContains",
        value: String(formattedValue),
      },
    ];
  }

  static createColumnFilterCriteria(columnFilters: MRT_ColumnFiltersState, columns: Column[]): BaseCriteria[] {
    if (!columnFilters.length) return [];

    const allCriteria: BaseCriteria[] = [];

    for (const filter of columnFilters) {
      const column = columns.find((col) => col.id === filter.id || col.columnName === filter.id);
      if (!column) continue;

      const fieldName = column.columnName;
      if (filter.value === undefined || filter.value === null) continue;

      let filterCriteria: BaseCriteria[] = [];

      if (typeof filter.value === "object" && filter.value !== null && "from" in filter.value && "to" in filter.value) {
        filterCriteria = ColumnFilterUtils.handleRangeFilter(
          fieldName,
          filter.value as { from: FormattedValue; to: FormattedValue },
          column
        );
      } else if (Array.isArray(filter.value)) {
        filterCriteria = ColumnFilterUtils.handleArrayFilter(fieldName, filter.value, column);
      } else {
        filterCriteria = ColumnFilterUtils.handleSingleValueFilter(fieldName, filter.value, column);
      }

      allCriteria.push(...filterCriteria);
    }

    return allCriteria;
  }
}

```

## Archivo: `packages/api-client/src/utils/types.ts`

```typescript
export type ColumnType = "string" | "date" | "numeric" | "reference";

export interface Column {
  columnName: string;
  type: ColumnType;
  referenceId?: string;
}

export interface SearchCriteria {
  fieldName: string;
  operator: string;
  value: unknown;
}

export interface CompositeCriteria {
  operator: "and" | "or";
  criteria: SearchCriteria[];
}

```

## Archivo: `packages/storybook/.storybook/main.ts`

```typescript
const { mergeConfig } = require('vite');

/** @type {import('@storybook/react-vite').StorybookConfig} */
module.exports = {
  stories: ['../src/**/*.mdx', '../src/**/*.stories.@(js|jsx|mjs|ts|tsx)'],
  addons: [
    '@storybook/addon-essentials',
    '@storybook/addon-links',
    '@storybook/addon-interactions',
    '@chromatic-com/storybook',
  ],
  framework: {
    name: '@storybook/react-vite',
    options: {},
  },
  viteFinal: async (config) => {
    return mergeConfig(config, {
      build: {
        rollupOptions: {
          output: {
            manualChunks: (id) => {
              if (id.includes('node_modules')) {
                if (id.includes('react')) return 'vendor-react';
                if (id.includes('@storybook')) return 'vendor-storybook';
                return 'vendors';
              }
              if (id.includes('.stories.')) return 'stories';
              if (id.includes('.svg')) return 'assets';
            },
          },
        },
        minify: 'esbuild',
        sourcemap: false,
        chunkSizeWarningLimit: 2000,
        target: 'esnext',
        treeshake: true,
        external: ['@emotion/react', '@emotion/styled'],
      },
      optimizeDeps: {
        include: ['react', 'react-dom'],
      },
    });
  },
};

```

## Archivo: `packages/storybook/.storybook/preview.tsx`

```typescript
import React, { Suspense } from 'react';
import { ThemeProvider } from '@mui/material/styles';
import CssBaseline from '@mui/material/CssBaseline';
import { theme } from '@workspaceui/componentlibrary/src/theme';

const LanguageProvider = React.lazy(() =>
  import('../../MainUI/contexts/languageProvider').then((mod) => ({
    default: mod.LanguageProvider,
  })),
);

const withThemeProvider = (Story) => (
  <Suspense fallback={<div>Loading...</div>}>
    <ThemeProvider theme={theme}>
      <CssBaseline />
      <LanguageProvider>
        <Story />
      </LanguageProvider>
    </ThemeProvider>
  </Suspense>
);

export default {
  parameters: {
    actions: { argTypesRegex: '^on[A-Z].*' },
    controls: {
      matchers: {
        color: /(background|color)$/i,
        date: /Date$/i,
      },
    },
  },
  decorators: [withThemeProvider],
};

```

## Archivo: `packages/storybook/src/App.tsx`

```typescript
import './App.css';

function App() {
  return <></>;
}

export default App;

```

## Archivo: `packages/storybook/src/custom.d.ts`

```typescript
import { PaletteOptions, Palette, type PaletteColor } from '@mui/material/styles';

declare module '@mui/material/styles' {
  interface Palette {
    dynamicColor: PaletteColor;
    baselineColor: {
      neutral: {
        [key: string]: string;
      };
      transparentNeutral: {
        [key: string]: string;
      };
      etendoPrimary: PaletteColor;
    };
    specificColor: {
      success: PaletteColor;
      warning: PaletteColor;
      error: PaletteColor;
      draft: PaletteColor;
    };
  }
  interface PaletteOptions {
    dynamicColor?: PaletteColorOptions;
    baselineColor?: {
      neutral?: {
        [key: string]: string;
      };
      transparentNeutral?: {
        [key: string]: string;
      };
      etendoPrimary?: PaletteColorOptions;
    };
    specificColor?: {
      success?: PaletteColorOptions;
      warning?: PaletteColorOptions;
      error?: PaletteColorOptions;
      draft?: PaletteColorOptions;
    };
  }
}

interface PaletteColorOptions {
  main: string;
  dark?: string;
  light?: string;
  contrastText?: string;
}

interface PaletteColor {
  main: string;
  dark?: string;
  light?: string;
  contrastText?: string;
}

```

## Archivo: `packages/storybook/src/declarations.d.ts`

```typescript
import type { PaletteColor } from '@mui/material';

declare module '@mui/material/styles' {
  interface PaletteOptions {
    tertiary?: PaletteColor;
  }
}

declare module '@mui/material/Button' {
  interface ButtonPropsColorOverrides {
    tertiary: true;
  }
  interface ButtonClasses {
    containedTertiary: string;
  }
}

```

## Archivo: `packages/storybook/src/index.ts`

```typescript
export * from './mocks';

```

## Archivo: `packages/storybook/src/main.tsx`

```typescript
import React from 'react';
import ReactDOM from 'react-dom/client';
import App from './App';
import './index.css';

ReactDOM.createRoot(document.getElementById('root')!).render(
  <React.StrictMode>
    <App />
  </React.StrictMode>,
);

```

## Archivo: `packages/storybook/src/mocks/index.ts`

```typescript
export * from '../stories/Components/ConfigurationModal/mock';
export * from '../stories/Components/mock';
export * from '../stories/Components/Table/mock';
export * from '../stories/Components/ProfileModal/mock';
export * from '../stories/Components/notifications.mock';

```

## Archivo: `packages/storybook/src/stories/Components/BasicModal/Modal.stories.tsx`

```typescript
import type { ReactNode } from 'react';
import type React from 'react';
import Modal from '@workspaceui/componentlibrary/src/components//BasicModal';
import { List, MenuItem, Button } from '@mui/material';
import { Position, Container } from '@workspaceui/componentlibrary/src/components//enums';
import HeaderIcon from '@workspaceui/componentlibrary/src/assets/icons/activity.svg';
import SaveIcon from '@workspaceui/componentlibrary/src/assets/icons/save.svg';
import { styles, sx } from '../../../styles/Modal.stories.styles';
import { menuItems } from '../mock';
import type { Meta, StoryObj } from '@storybook/react';

interface MenuItem {
  emoji: string;
  label: string;
  key: string;
}

interface ModalStoryProps {
  menuItems: MenuItem[];
  width?: Container | number;
  height?: Container | number;
  posX?: Position;
  posY?: Position;
  showHeader?: boolean;
  backgroundGradient?: string;
  saveButtonLabel?: string;
  secondaryButtonLabel?: string;
  buttons?: ReactNode;
  isFullScreenEnabled?: boolean;
  customTrigger?: React.ReactNode;
}

const meta: Meta<typeof Modal> = {
  title: 'Components/Modal',
  component: Modal,
  argTypes: {
    height: {
      control: 'select',
      options: [...Object.values(Container), 'custom'],
      mapping: {
        custom: 400,
        [Container.Auto]: Container.Auto,
      },
    },
    width: {
      control: 'select',
      options: [...Object.values(Container), 'custom'],
      mapping: {
        custom: 500,
        [Container.Auto]: Container.Auto,
      },
    },
    posX: { control: 'select', options: Object.values(Position) },
    posY: { control: 'select', options: Object.values(Position) },
    showHeader: { control: 'boolean' },
    backgroundGradient: { control: 'text' },
    saveButtonLabel: { control: 'text' },
    secondaryButtonLabel: { control: 'text' },
    isFullScreenEnabled: { control: 'boolean' },
  },
};

export default meta;

type Story = StoryObj<ModalStoryProps>;

const ModalTemplate: Story = {
  render: (args) => (
    <Modal
      tittleHeader={'Header Title'}
      descriptionText={'This is a generic description'}
      HeaderIcon={HeaderIcon}
      SaveIcon={SaveIcon}
      isFullScreenEnabled={args.isFullScreenEnabled}
      customTrigger={args.customTrigger}
      {...args}>
      <List>
        {args.menuItems.map((item: MenuItem) => (
          <MenuItem key={item.key} sx={sx.menuStyles}>
            <span style={styles.spanStyles}>{item.emoji}</span>
            <span>{item.label}</span>
          </MenuItem>
        ))}
      </List>
    </Modal>
  ),
};

export const DefaultModalAndDivider: Story = {
  ...ModalTemplate,
  args: {
    menuItems: menuItems,
    showHeader: true,
    saveButtonLabel: 'Save',
    secondaryButtonLabel: 'Cancel',
  },
};

export const WithBackgroundGradient: Story = {
  ...ModalTemplate,
  args: {
    menuItems: menuItems,
    showHeader: true,
    backgroundGradient: 'linear-gradient(to bottom, #4CAF50, transparent)',
    saveButtonLabel: 'Save',
    secondaryButtonLabel: 'Cancel',
  },
};

export const WithoutHeader: Story = {
  ...ModalTemplate,
  args: {
    menuItems: menuItems,
    showHeader: false,
    saveButtonLabel: 'Save',
    secondaryButtonLabel: 'Cancel',
  },
};

export const CustomPositionAndSize: Story = {
  ...ModalTemplate,
  args: {
    menuItems: menuItems,
    showHeader: true,
    posX: Position.Left,
    posY: Position.Top,
    width: 400,
    height: 500,
    saveButtonLabel: 'Save',
    secondaryButtonLabel: 'Cancel',
  },
};

export const WithCustomButtons: Story = {
  ...ModalTemplate,
  args: {
    menuItems: menuItems,
    showHeader: true,
    buttons: (
      <>
        <Button variant='outlined'>Custom Cancel</Button>
        <Button variant='contained'>Custom Save</Button>
      </>
    ),
  },
};

export const CenterPosition: Story = {
  ...ModalTemplate,
  args: {
    posX: Position.Center,
    posY: Position.Center,
    menuItems: menuItems,
    showHeader: true,
    saveButtonLabel: 'Save',
    secondaryButtonLabel: 'Cancel',
  },
};

export const FullScreenEnabled: Story = {
  ...ModalTemplate,
  args: {
    isFullScreenEnabled: true,
    menuItems: menuItems,
  },
};

export const WithCustomTrigger: Story = {
  ...ModalTemplate,
  args: {
    customTrigger: <Button variant='contained'>Open Custom Modal</Button>,
    menuItems: menuItems,
  },
};

```

## Archivo: `packages/storybook/src/stories/Components/Breadcrums/Breadcrums.stories.tsx`

```typescript
import type { Meta, StoryObj } from '@storybook/react';
import Breadcrumb from '@workspaceui/componentlibrary/src/components/Breadcrums';
import { mockDefaultActions, mockDefaultArgs } from './mock';

const meta: Meta<typeof Breadcrumb> = {
  title: 'Components/Breadcrumb',
  component: Breadcrumb,
  argTypes: {
    onHomeClick: { action: 'Home clicked' },
    homeIcon: { control: 'text' },
    homeText: { control: 'text' },
    separator: { control: 'text' },
  },
};

export default meta;

type Story = StoryObj<typeof Breadcrumb>;

export const Default: Story = {
  args: mockDefaultArgs,
};

export const CustomHomeIcon: Story = {
  args: {
    ...mockDefaultArgs,
    homeIcon: '🏠',
  },
};

export const CustomHomeText: Story = {
  args: {
    ...mockDefaultArgs,
    homeText: 'Custom text',
  },
};

export const SingleLevel: Story = {
  args: {
    ...mockDefaultArgs,
    items: [{ id: '1', label: 'Single Item', actions: mockDefaultActions }],
  },
};

export const TwoLevels: Story = {
  args: {
    ...mockDefaultArgs,
    items: [
      { id: '1', label: 'Two' },
      { id: '2', label: 'Items', actions: mockDefaultActions },
    ],
  },
};

export const Empty: Story = {
  args: {
    ...mockDefaultArgs,
    items: [],
  },
};

```

## Archivo: `packages/storybook/src/stories/Components/Breadcrums/mock.tsx`

```typescript
import type { BreadcrumbProps, BreadcrumbAction } from '@workspaceui/componentlibrary/src/components/Breadcrums/types';
import FavoriteIcon from '@workspaceui/componentlibrary/src/assets/icons/star.svg';
import ContentCopyIcon from '@workspaceui/componentlibrary/src/assets/icons/copy.svg';
import HelpIcon from '@workspaceui/componentlibrary/src/assets/icons/help-circle.svg';
import SettingsIcon from '@workspaceui/componentlibrary/src/assets/icons/settings.svg';
import { theme } from '@workspaceui/componentlibrary/src/theme';

export const mockDefaultActions: BreadcrumbAction[] = [
  {
    id: 'favorite',
    label: 'Add to favorites',
    icon: <FavoriteIcon fill={theme.palette.baselineColor.neutral[60]} />,
    toggle: true,
  },
  {
    id: 'duplicate',
    label: 'Copy window',
    icon: <ContentCopyIcon fill={theme.palette.baselineColor.neutral[60]} />,
    onClick: () => {},
  },
  {
    id: 'help',
    label: 'Help',
    icon: <HelpIcon fill={theme.palette.baselineColor.neutral[60]} />,
    onClick: () => {},
  },
  {
    id: 'settings',
    label: 'Settings',
    icon: <SettingsIcon fill={theme.palette.baselineColor.neutral[60]} />,
    onClick: () => {},
  },
];

export const mockDefaultArgs: BreadcrumbProps = {
  onHomeClick: () => console.log('Home clicked'),
  items: [
    { id: '1', label: 'Super long item text name' },
    { id: '2', label: 'Super long item text name 2' },
    { id: '3', label: 'Super long item text name 3' },
    {
      id: '4',
      label: 'Super long item text name 4',
      actions: mockDefaultActions,
    },
  ],
};

```

## Archivo: `packages/storybook/src/stories/Components/ConfigurationModal/ConfigurationModal.stories.tsx`

```typescript
import ConfigurationModal from '@workspaceui/componentlibrary/src/components//ConfigurationModal';
import { modalConfig } from './mock';

export default {
  title: 'Components/ConfigurationModal',
  component: ConfigurationModal,
};

const Template = () => <ConfigurationModal {...modalConfig} />;

export const Default = Template.bind({});

```

## Archivo: `packages/storybook/src/stories/Components/ConfigurationModal/mock.tsx`

```typescript
import SettingIcon from '@workspaceui/componentlibrary/src/assets/icons/settings.svg';
import {
  SECTION_THEME_ID,
  SECTION_TABLE_DENSITY_ID,
  SECTION_COMMON_TOOLBAR_BUTTONS_ID,
  SECTION_SPECIFIC_TOOLBAR_BUTTONS_ID,
  SECTION_DENSITY_ID,
  INTERFACE_SCALE_ITEMS,
  THEME_ITEMS,
  TABLE_DENSITY_ITEMS,
  COMMON_TOOLBAR_BUTTONS_ITEMS,
  SPECIFIC_TOOLBAR_BUTTONS_ITEMS,
} from "@workspaceui/componentlibrary/src/components/ConfigurationModal/constants";

export const modalConfig = {
  icon: <SettingIcon />,
  title: {
    icon: <SettingIcon fill='var(--color-dynamic-main)' />,
    label: 'Quick Setup',
  },
  linkTitle: { label: 'View all settings', url: '/settings' },
  sections: [
    {
      id: SECTION_THEME_ID,
      name: 'Theme',
      items: THEME_ITEMS,
      selectedItem: 0,
      isDisabled: true,
    },
    {
      id: SECTION_TABLE_DENSITY_ID,
      name: 'Table Density',
      items: TABLE_DENSITY_ITEMS,
      selectedItem: 0,
      isDisabled: true,
    },
    {
      id: SECTION_COMMON_TOOLBAR_BUTTONS_ID,
      name: 'Common Toolbar Buttons',
      items: COMMON_TOOLBAR_BUTTONS_ITEMS,
      selectedItem: 0,
      isDisabled: true,
    },
    {
      id: SECTION_SPECIFIC_TOOLBAR_BUTTONS_ID,
      name: 'Specific Toolbar Buttons',
      items: SPECIFIC_TOOLBAR_BUTTONS_ITEMS,
      selectedItem: 0,
      isDisabled: true,
    },
    {
      id: SECTION_DENSITY_ID,
      name: "Interface scale",
      items: INTERFACE_SCALE_ITEMS,
      selectedItem: 1,
      isDisabled: false,
    },
  ],
  onChangeSelect: console.log,
};

```

## Archivo: `packages/storybook/src/stories/Components/DragAndDrop/DragModal.stories.tsx`

```typescript
import DragModal from '@workspaceui/componentlibrary/src/components/DragModal/DragModal';
import { initialPeople } from '../mock';
import type { Meta, StoryObj } from '@storybook/react';

const meta: Meta<typeof DragModal> = {
  title: 'Components/DragModal',
  component: DragModal,
  argTypes: {
    backButtonText: { control: 'text' },
    activateAllText: { control: 'text' },
    deactivateAllText: { control: 'text' },
    buttonText: { control: 'text' },
  },
};

export default meta;

type Story = StoryObj<typeof DragModal>;

export const Default: Story = {
  args: {
    initialPeople,
    onBack: () => console.log('Back clicked'),
    onClose: () => console.log('Close clicked'),
    backButtonText: 'Back',
    activateAllText: 'Activate all',
    deactivateAllText: 'Deactivate all',
    buttonText: 'Buttons',
  },
};

```

## Archivo: `packages/storybook/src/stories/Components/GeneralDrawer/Drawer.stories.tsx`

```typescript
import type { Meta, StoryObj } from '@storybook/react';
import DrawerComponent from '@workspaceui/componentlibrary/src/components/Drawer';
import { menuMock } from '../../../../../MainUI/mocks/Drawer/index';
import logoUrl from '@workspaceui/componentlibrary/src/assets/images/logo.svg?url';

const meta: Meta<typeof DrawerComponent> = {
  title: 'Components/Drawer',
  component: DrawerComponent,
  argTypes: {
    logo: { control: 'text' },
    title: { control: 'text' },
  },
};

export default meta;
type Story = StoryObj<typeof DrawerComponent>;

export const Default: Story = {
  args: {
    items: menuMock,
    logo: logoUrl,
    title: 'Etendo',
    onClick: (pathname: string) => console.log(`Navigating to: ${pathname}`),
  },
};

```

## Archivo: `packages/storybook/src/stories/Components/IconButton/IconButton.stories.tsx`

```typescript
import type React from 'react';
import IconButton from '@workspaceui/componentlibrary/src/components/IconButton';
import NotificationIcon from '@workspaceui/componentlibrary/src/assets/icons/heart.svg';
import type { Meta, StoryObj } from '@storybook/react';
import { useTheme } from '@mui/material';
import type { IIconComponentProps } from '@workspaceui/componentlibrary/src/components/IconButton/types';

interface IconButtonWrapperProps {
  args: IIconComponentProps;
}

const IconButtonWrapper: React.FC<IconButtonWrapperProps> = ({ args }) => {
  const theme = useTheme();

  const baseStyles = {
    borderRadius: '6.25rem',
    display: 'flex',
    alignItems: 'center',
    justifyContent: 'center',
    transition: 'all 0.3s ease',
    background: theme.palette.baselineColor.neutral[0],
    '&:hover': {
      backgroundColor: theme.palette.dynamicColor.main,
    },
  };

  const combinedStyles = {
    ...baseStyles,
    ...args.sx,
  };

  return <IconButton {...args} sx={combinedStyles} />;
};

const meta: Meta<typeof IconButton> = {
  title: 'Components/IconButton',
  component: IconButton,
  argTypes: {
    tooltip: { control: 'text' },
    fill: { control: 'color' },
    hoverFill: { control: 'color' },
    iconText: { control: 'text' },
  },
};

export default meta;

type Story = StoryObj<typeof IconButton>;

export const Default: Story = {
  render: (args) => <IconButtonWrapper args={args} />,
  args: {
    tooltip: 'Default IconButton',
    children: <NotificationIcon />,
  },
};

export const CustomFill: Story = {
  render: (args) => <IconButtonWrapper args={args} />,
  args: {
    tooltip: 'Custom Fill IconButton',
    children: <NotificationIcon />,
    fill: '#1976d2',
    hoverFill: '#fff',
    sx: {
      '&:hover': {
        backgroundColor: '#1976d2',
      },
    },
  },
};

export const Disabled: Story = {
  render: (args) => <IconButtonWrapper args={args} />,
  args: {
    tooltip: 'Disabled IconButton',
    children: <NotificationIcon />,
    disabled: true,
  },
};

```

## Archivo: `packages/storybook/src/stories/Components/Input/Select/Select.stories.tsx`

```typescript
import { Grid } from '@mui/material';
import { SearchOutlined } from '@mui/icons-material';
import CheckCircleIcon from '@mui/icons-material/CheckCircle';
import Select from '@workspaceui/componentlibrary/src/components/Input/Select';
import { topFilms } from './mock';

export default {
  title: 'Components/Input/Select',
  component: Select,
};

const Template = () => (
  <Grid container spacing={2} style={{ background: 'white', padding: 20, width: 300 }}>
    <Grid item xs={12}>
      <Select
        iconLeft={<SearchOutlined sx={{ width: 24, height: 24 }} />}
        title='Películas'
        helperText={{
          label: 'Top 15',
          icon: <CheckCircleIcon sx={{ width: "1rem", height: "1rem" }} />,
        }}
        options={topFilms}
        getOptionLabel={(option) => option.title}
      />
    </Grid>
  </Grid>
);

export const Default = Template.bind({});

```

## Archivo: `packages/storybook/src/stories/Components/Input/Select/mock.ts`

```typescript
import type { Option } from '@workspaceui/componentlibrary/src/components/Input/Select/types';

export const topFilms: Option[] = [
  { id: 'film001', title: 'The Shawshank Redemption', value: '1994' },
  { id: 'film002', title: 'The Godfather', value: '1972' },
  { id: 'film003', title: 'The Godfather: Part II', value: '1974' },
  { id: 'film004', title: 'The Dark Knight', value: '2008' },
  { id: 'film005', title: '12 Angry Men', value: '1957' },
  { id: 'film006', title: "Schindler's List", value: '1993' },
  { id: 'film007', title: 'Pulp Fiction', value: '1994' },
  {
    id: 'film008',
    title: 'The Lord of the Rings: The Return of the King',
    value: '2003',
  },
  { id: 'film009', title: 'The Good, the Bad and the Ugly', value: '1966' },
  { id: 'film010', title: 'Fight Club', value: '1999' },
  {
    id: 'film011',
    title: 'The Lord of the Rings: The Fellowship of the Ring',
    value: '2001',
  },
  {
    id: 'film012',
    title: 'Star Wars: Episode V - The Empire Strikes Back',
    value: '1980',
  },
  { id: 'film013', title: 'Forrest Gump', value: '1994' },
  { id: 'film014', title: 'Inception', value: '2010' },
  {
    id: 'film015',
    title: 'The Lord of the Rings: The Two Towers',
    value: '2002',
  },
];

```

## Archivo: `packages/storybook/src/stories/Components/Input/TextInput/TextInputAutocomplete/SearchInputWithVoice/SearchInputWithVoice.stories.tsx`

```typescript
import { useState } from 'react';
import { Grid } from '@mui/material';
import SearchInputWithVoice from '@workspaceui/componentlibrary/src/components/Input/TextInput/TextInputAutocomplete/SearchInputWithVoice';

export default {
  title: 'Components/Input/TextInput/SearchInputWithVoice',
  component: SearchInputWithVoice,
};

const TemplateVoice = () => {
  const [value, setValue] = useState('');
  return (
    <Grid container spacing={2}>
      <Grid item xs={12}>
        <SearchInputWithVoice
          value={value}
          setValue={setValue}
          placeholder='Search'
          onVoiceClick={() => alert('Voice activated')}
        />
      </Grid>
    </Grid>
  );
};

export const Default = TemplateVoice.bind({});

```

## Archivo: `packages/storybook/src/stories/Components/Input/TextInput/TextInputAutocomplete/TextInputAutocomplete.stories.tsx`

```typescript
import { useState } from 'react';
import { Grid } from '@mui/material';
import { MOCK_AUTO_COMPLETE_TEXTS } from './mock';
import TextInputAutocomplete from '@workspaceui/componentlibrary/src/components/Input/TextInput/TextInputAutocomplete';

export default {
  title: 'Components/Input/TextInput/TextInputAutocomplete',
  component: TextInputAutocomplete,
};

const Template = () => {
  const [value, setValue] = useState('');
  return (
    <Grid container spacing={2}>
      <Grid item xs={12}>
        <TextInputAutocomplete
          value={value}
          setValue={setValue}
          placeholder='Search'
          autoCompleteTexts={MOCK_AUTO_COMPLETE_TEXTS}
        />
      </Grid>
      <Grid item xs={12}>
        <TextInputAutocomplete
          value={value}
          setValue={setValue}
          placeholder='Search'
          disabled
          autoCompleteTexts={MOCK_AUTO_COMPLETE_TEXTS}
        />
      </Grid>
    </Grid>
  );
};

export const Default = Template.bind({});

```

## Archivo: `packages/storybook/src/stories/Components/Input/TextInput/TextInputAutocomplete/mock.ts`

```typescript
export const MOCK_AUTO_COMPLETE_TEXTS: string[] | undefined = [
  'module',
  'sales order',
  'sales invoice',
  'dependency management',
  'window, tabs and fields',
];

```

## Archivo: `packages/storybook/src/stories/Components/Input/TextInput/TextInputBase/InputPassword/InputPassword.stories.tsx`

```typescript
import { useState } from 'react';
import { Grid } from '@mui/material';
import { LockOutlined } from '@mui/icons-material';
import InputPassword from '@workspaceui/componentlibrary/src/components/Input/TextInput/TextInputBase/InputPassword';

export default {
  title: 'Components/Input/TextInput/TextInputBase/InputPassword',
  component: InputPassword,
};

const TemplatePassword = () => {
  const [value, setValue] = useState('');
  return (
    <Grid container spacing={2}>
      <Grid item xs={12}>
        <InputPassword leftIcon={<LockOutlined />} value={value} setValue={setValue} label='Password' />
      </Grid>
    </Grid>
  );
};

export const Default = TemplatePassword.bind({});

```

## Archivo: `packages/storybook/src/stories/Components/Input/TextInput/TextInputBase/TextInputBase.stories.tsx`

```typescript
import { useState } from 'react';
import { Grid } from '@mui/material';
import { Search, LockOutlined } from '@mui/icons-material';
import TextInputBase from '@workspaceui/componentlibrary/src/components/Input/TextInput/TextInputBase';

export default {
  title: 'Components/Input/TextInput/TextInputBase',
  component: TextInputBase,
};

const TemplateBase = () => {
  const [value, setValue] = useState('');
  return (
    <Grid container spacing={2}>
      <Grid item xs={12}>
        <TextInputBase
          leftIcon={<LockOutlined />}
          rightIcon={<Search />}
          onRightIconClick={() => alert('Icon clicked')}
          value={value}
          setValue={setValue}
          placeholder='Search'
        />
      </Grid>
    </Grid>
  );
};

export const Default = TemplateBase.bind({});

```

## Archivo: `packages/storybook/src/stories/Components/Nav/Nav.stories.tsx`

```typescript
import Nav from '@workspaceui/componentlibrary/src/components/Nav/Nav';
import NotificationModal from '@workspaceui/componentlibrary/src/components/NotificationsModal';
import NotificationButton from '@workspaceui/componentlibrary/src/components/NotificationsButton';
import ProfileModal from '@workspaceui/componentlibrary/src/components/ProfileModal/ProfileModal';
import WaterfallModal from '@workspaceui/componentlibrary/src/components/Waterfall/WaterfallModal';
import ConfigurationModal from '@workspaceui/componentlibrary/src/components/ConfigurationModal';
import { NOTIFICATIONS } from '../notifications.mock';
import { modalConfig } from '../ConfigurationModal/mock';
import { menuItems, initialPeople } from '../mock';
import type { NavArgs } from './types';
import ActivityIcon from '@workspaceui/componentlibrary/src/assets/icons/activity.svg';
import profilePicture from '@workspaceui/componentlibrary/src/assets/images/profile_picture_mock.png';
import PersonIcon from '@workspaceui/componentlibrary/src/assets/icons/user.svg';
import IconButton from '@workspaceui/componentlibrary/src/components/IconButton';
import NotificationIcon from '@workspaceui/componentlibrary/src/assets/icons/bell.svg';
import AddIcon from '@workspaceui/componentlibrary/src/assets/icons/plus.svg';
import { sections } from '../ProfileModal/mock';
import type { Meta, StoryObj } from '@storybook/react';

const meta: Meta<typeof Nav> = {
  title: 'Components/Nav',
  component: Nav,
};

export default meta;

type Story = StoryObj<NavArgs>;

export const DefaultNav: Story = {
  render: (args: NavArgs) => (
    <Nav>
      <div style={{ gap: '4px', display: 'flex' }}>
        <WaterfallModal
          menuItems={menuItems}
          initialPeople={initialPeople}
          backButtonText={args.backButtonText}
          activateAllText={args.activateAllText}
          deactivateAllText={args.deactivateAllText}
          tooltipWaterfallButton={args.tooltipWaterfallButton}
          buttonText={args.buttonText}
          customizeText={args.customizeText}
          people={[]}
          icon={<AddIcon />}
        />
        <ConfigurationModal {...modalConfig} />
        <IconButton tooltip='Activity'>
          <ActivityIcon />
        </IconButton>
        <NotificationButton notifications={args.notifications} icon={<NotificationIcon />}>
          <NotificationModal
            notifications={args.notifications}
            anchorEl={args.anchorEl}
            onClose={args.onClose}
            title={args.title}
            linkTitle={args.linkTitle}
            emptyStateImageAlt={args.emptyStateImageAlt}
            emptyStateMessage={args.emptyStateMessage}
            emptyStateDescription={args.emptyStateDescription}
            actionButtonLabel={args.actionButtonLabel}
          />
        </NotificationButton>
        <ProfileModal
          cancelButtonText={args.cancelButtonText}
          saveButtonText={args.saveButtonText}
          tooltipButtonProfile={args.tooltipButtonProfile}
          section={args.section}
          passwordLabel={args.passwordLabel}
          newPasswordLabel={args.newPasswordLabel}
          confirmPasswordLabel={args.confirmPasswordLabel}
          userPhotoUrl={args.userPhotoUrl}
          userName={args.userName}
          userEmail={args.userEmail}
          sectionTooltip={args.sectionTooltip}
          icon={<PersonIcon fill='#2E365C' />}
          sections={args.sections}
          onRoleChange={() => {}}
          onWarehouseChange={() => {}}
          roles={[]}
          selectedRole={null}
          selectedWarehouse={null}
          saveAsDefault={false}
          onSaveAsDefaultChange={() => {}}
        />
      </div>
    </Nav>
  ),
  args: {
    notifications: NOTIFICATIONS,
    anchorEl: null,
    open: true,
    onClose: () => console.log('Modal closed'),
    title: {
      icon: <NotificationIcon fill='#2E365C' />,
      label: 'Notifications',
    },
    linkTitle: { label: 'Mark all as read', url: '/home' },
    emptyStateImageAlt: 'No Notifications',
    emptyStateMessage: 'You have no notifications',
    emptyStateDescription:
      'Great! You are up to date with everything. We will notify you here if there is anything new.',
    actionButtonLabel: 'Configure notifications',
    backButtonText: 'Back',
    activateAllText: 'Activate all',
    deactivateAllText: 'Deactivate all',
    buttonText: 'Buttons',
    customizeText: 'Customize',
    tooltipWaterfallButton: 'Waterfall',
    cancelButtonText: 'Cancel',
    saveButtonText: 'Save',
    tooltipButtonProfile: 'Account Settings',
    passwordLabel: 'Password',
    newPasswordLabel: 'New Password',
    confirmPasswordLabel: 'Confirm New Password',
    section: 'profile',
    userPhotoUrl: profilePicture,
    userName: 'Ayelén García',
    userEmail: 'ayelen.garcia@etendo.software',
    sectionTooltip: 'Sign off',
    sections: sections,
  },
};

```

## Archivo: `packages/storybook/src/stories/Components/Nav/types.ts`

```typescript
import type { ReactElement } from 'react';
import type { Inotifications } from '@workspaceui/componentlibrary/src/commons';
import type { Section } from '@workspaceui/componentlibrary/src/components/ProfileModal/ToggleButton/types';
import type { WaterfallModalProps } from '@workspaceui/componentlibrary/src/components/Waterfall/types';

export interface NavArgs extends WaterfallModalProps {
  cancelButtonText: string;
  saveButtonText: string;
  notifications: Inotifications[];
  anchorEl: HTMLElement | null;
  open: boolean;
  onClose: () => void;
  title: { icon: string | ReactElement; label: string };
  linkTitle: { label: string; url: string };
  emptyStateImageAlt: string;
  emptyStateMessage: string;
  emptyStateDescription: string;
  actionButtonLabel: string;
  backButtonText: string;
  activateAllText: string;
  deactivateAllText: string;
  buttonText: string;
  customizeText: string;
  passwordLabel: string;
  newPasswordLabel: string;
  confirmPasswordLabel: string;
  tooltipButtonProfile: string;
  tooltipWaterfallButton: string;
  section: string;
  userPhotoUrl: string;
  userName: string;
  userEmail: string;
  sectionTooltip: string;
  sections: Section[];
}

```

## Archivo: `packages/storybook/src/stories/Components/NotificationButton/NotificationButton.stories.tsx`

```typescript
import type { ReactElement } from 'react';
import NotificationButton from '@workspaceui/componentlibrary/src/components/NotificationsButton';
import NotificationIcon from '@workspaceui/componentlibrary/src/assets/icons/bell.svg';
import type { Meta, StoryObj } from '@storybook/react';
import type { Inotifications } from '@workspaceui/componentlibrary/src/commons';

interface NotificationButtonProps {
  notifications: Inotifications[];
  tooltipTitle: string;
  icon: ReactElement;
}

const meta: Meta<typeof NotificationButton> = {
  title: 'Components/NotificationButton',
  component: NotificationButton,
  argTypes: {
    tooltipTitle: { control: 'text' },
  },
};

export default meta;

type Story = StoryObj<NotificationButtonProps>;

const generateMockNotifications = (count: number): Inotifications[] =>
  Array.from({ length: count }, (_, index) => ({
    id: `${index + 1}`,
    description: `Notification ${index + 1}`,
    date: new Date().toLocaleString(),
    icon: NotificationIcon,
  }));

export const NotificationButtonDefault: Story = {
  render: (args) => <NotificationButton {...args} />,
  args: {
    notifications: [],
    tooltipTitle: 'Empty Notifications',
    icon: <NotificationIcon />,
  },
};

export const NotificationButtonSome: Story = {
  render: (args) => <NotificationButton {...args} />,
  args: {
    notifications: generateMockNotifications(5),
    tooltipTitle: 'Notifications',
    icon: <NotificationIcon />,
  },
};

export const NotificationButtonMany: Story = {
  render: (args) => <NotificationButton {...args} />,
  args: {
    notifications: generateMockNotifications(100),
    tooltipTitle: 'Many Notifications',
    icon: <NotificationIcon />,
  },
};

```

## Archivo: `packages/storybook/src/stories/Components/NotificationModal/NotificationModal.stories.tsx`

```typescript
import type React from 'react';
import NotificationModal from '@workspaceui/componentlibrary/src/components/NotificationsModal';
import NotificationButton from '@workspaceui/componentlibrary/src/components/NotificationsButton';
import { NOTIFICATIONS } from '../notifications.mock';
import NotificationIcon from '@workspaceui/componentlibrary/src/assets/icons/bell.svg';
import type { Meta, StoryObj } from '@storybook/react';
import type { Inotifications } from '@workspaceui/componentlibrary/src/commons';

interface NotificationModalProps {
  notifications: Inotifications[];
  icon: React.ReactElement;
  linkTitle: { label: string; url: string };
  emptyStateImageAlt: string;
  emptyStateMessage: string;
  emptyStateDescription: string;
  actionButtonLabel: string;
}

const meta: Meta<typeof NotificationButton> = {
  title: 'Components/NotificationModal',
  component: NotificationButton,
  argTypes: {},
};

export default meta;

type Story = StoryObj<NotificationModalProps>;

const NotificationModalTemplate: React.FC<NotificationModalProps> = (args) => (
  <NotificationButton notifications={args.notifications} icon={args.icon}>
    <NotificationModal
      notifications={args.notifications}
      title={{
        icon: args.icon,
        label: 'Notifications',
      }}
      linkTitle={args.linkTitle}
      emptyStateImageAlt={args.emptyStateImageAlt}
      emptyStateMessage={args.emptyStateMessage}
      emptyStateDescription={args.emptyStateDescription}
      actionButtonLabel={args.actionButtonLabel}
    />
  </NotificationButton>
);

export const NotificationModalDefault: Story = {
  render: (args) => <NotificationModalTemplate {...args} />,
  args: {
    notifications: NOTIFICATIONS,
    icon: <NotificationIcon fill='#2E365C' />,
    linkTitle: { label: 'Mark all as read', url: '/home' },
    emptyStateImageAlt: 'No Notifications',
    emptyStateMessage: 'You have no notifications',
    emptyStateDescription:
      'Great! You are up to date with everything. We will notify you here if there is anything new.',
    actionButtonLabel: 'Configure notifications',
  },
};

export const NotificationModalEmpty: Story = {
  render: (args) => <NotificationModalTemplate {...args} />,
  args: {
    notifications: [],
    icon: <NotificationIcon fill='#2E365C' />,
    linkTitle: { label: 'Mark all as read', url: '/home' },
    emptyStateImageAlt: 'No Notifications',
    emptyStateMessage: 'You have no notifications',
    emptyStateDescription:
      'Great! You are up to date with everything. We will notify you here if there is anything new.',
    actionButtonLabel: 'Configure notifications',
  },
};

```

## Archivo: `packages/storybook/src/stories/Components/NotificationStates/NotificationItemStates.mock.ts`

```typescript
import {
  Description,
  Lightbulb as LightbulbCircle,
  CloudDownloadOutlined,
  WarningAmberOutlined,
  Person,
  AutoAwesome,
  NoteAltOutlined,
  FileDownloadOutlined,
} from '@mui/icons-material';
import type { Theme } from '@mui/material';
import type { IallNotifications } from '@workspaceui/componentlibrary/src/components/NotificationItemAllStates/types';

const getButtonStyles = (theme: Theme) => ({
  leftButton: {
    background: theme.palette.baselineColor.transparentNeutral[10],
    color: theme.palette.baselineColor.transparentNeutral[70],
    height: '2rem',
    borderRadius: '6.25rem',
    padding: '0.5rem 1rem',
    border: `1px solid ${theme.palette.baselineColor.transparentNeutral[10]}`,
    '&:hover': {
      border: '1px solid transparent',
      background: theme.palette.dynamicColor.main,
      color: theme.palette.baselineColor.neutral[10],
    },
  },
  rightButton: {
    background: theme.palette.baselineColor.neutral[100],
    color: theme.palette.baselineColor.neutral[0],
    height: '2rem',
    borderRadius: '6.25rem',
    padding: '0.5rem 1rem',
    '&:hover': {
      background: theme.palette.dynamicColor.main,
      color: theme.palette.baselineColor.neutral[10],
    },
  },
});

export const createNotificationStates = (theme: Theme): IallNotifications[] => {
  const buttonStyles = getButtonStyles(theme);

  return [
    {
      type: 'informatives',
      data: {
        id: '1',
        description: 'The costs have been calculated for July 30, 2024.',
        priority: 'High',
        date: '1m ago',
        icon: Description,
      },
    },
    {
      type: 'withButtons',
      data: {
        id: '2',
        description:
          'Copilot recommends purchasing [📦 Long Fine Cruise Rice 1 K](https://example.com) as it is running out of stock.',
        priority: 'Medium',
        date: '1m ago',
        icon: LightbulbCircle,
        ctaButtons: [
          {
            key: 'retry',
            label: 'do it myself',
            action: () => console.log('Retry clicked'),
            sx: buttonStyles.leftButton,
          },
          {
            key: 'contact-support',
            label: 'Copilot is in charge',
            action: () => console.log('Contact Support clicked'),
            icon: AutoAwesome,
            sx: buttonStyles.rightButton,
          },
        ],
      },
    },
    {
      type: 'withButtonsAndTags',
      data: {
        id: '3',
        description: 'A new version of Etendo has come out; it **is necessary to update** the system.',
        priority: 'medium priority',
        date: '2023-01-03',
        tagType: 'warning',
        icon: CloudDownloadOutlined,
        ctaButtons: [
          {
            key: 'view-details',
            label: 'Release note',
            action: () => console.log('View Details clicked'),
            icon: NoteAltOutlined,
            sx: buttonStyles.leftButton,
          },
          {
            key: 'update',
            label: 'Update',
            action: () => console.log('Dismiss clicked'),
            icon: FileDownloadOutlined,
            sx: buttonStyles.rightButton,
          },
        ],
      },
    },
    {
      type: 'tags',
      data: {
        id: '4',
        description: 'There was an **error** in database',
        priority: 'High Priority',
        date: '2023-01-04',
        tagType: 'error',
        icon: WarningAmberOutlined,
      },
    },
    {
      type: 'avatar',
      data: {
        id: '5',
        description: '[Alexandra Asto](https://example.com) te menciono [💳 946240](https://example.com)',
        priority: 'Draft',
        date: '2023-01-05',
        tagType: 'draft',
        icon: Person,
      },
    },
  ];
};

```

## Archivo: `packages/storybook/src/stories/Components/NotificationStates/NotificationStates.stories.tsx`

```typescript
import type React from 'react';
import NotificationItemStates from '@workspaceui/componentlibrary/src/components/NotificationItemAllStates';
import { createNotificationStates } from './NotificationItemStates.mock';
import { Grid, useTheme } from '@mui/material';
import type { Meta, StoryObj } from '@storybook/react';
import type { IallNotifications } from '@workspaceui/componentlibrary/src/components/NotificationItemAllStates/types';

interface NotificationItemStatesProps {
  notifications: IallNotifications[];
  type: 'informatives' | 'withButtons' | 'withButtonsAndTags' | 'tags' | 'avatar';
}

const meta: Meta<typeof NotificationItemStates> = {
  title: 'Components/NotificationItemStates',
  component: NotificationItemStates,
  argTypes: {
    notifications: { control: undefined },
    type: {
      control: 'select',
      options: ['informatives', 'withButtons', 'withButtonsAndTags', 'tags', 'avatar'],
    },
  },
};

export default meta;

type Story = StoryObj<NotificationItemStatesProps>;

const NotificationItemStatesTemplate: React.FC<NotificationItemStatesProps> = (args) => {
  const theme = useTheme();
  const notifications = createNotificationStates(theme);

  return <NotificationItemStates {...args} notifications={notifications} />;
};

export const Informatives: Story = {
  render: () => <NotificationItemStatesTemplate type='informatives' notifications={[]} />,
};

export const WithButtons: Story = {
  render: () => <NotificationItemStatesTemplate type='withButtons' notifications={[]} />,
};

export const WithButtonsAndTags: Story = {
  render: () => <NotificationItemStatesTemplate type='withButtonsAndTags' notifications={[]} />,
};

export const Tags: Story = {
  render: () => <NotificationItemStatesTemplate type='tags' notifications={[]} />,
};

export const Avatar: Story = {
  render: () => <NotificationItemStatesTemplate type='avatar' notifications={[]} />,
};

const GridTemplate: React.FC = () => {
  const theme = useTheme();
  const notifications = createNotificationStates(theme);

  return (
    <Grid container spacing={1}>
      <Grid item>
        <NotificationItemStates notifications={notifications} type='informatives' />
      </Grid>
      <Grid item>
        <NotificationItemStates notifications={notifications} type='withButtons' />
      </Grid>
      <Grid item>
        <NotificationItemStates notifications={notifications} type='withButtonsAndTags' />
      </Grid>
      <Grid item>
        <NotificationItemStates notifications={notifications} type='tags' />
      </Grid>
      <Grid item>
        <NotificationItemStates notifications={notifications} type='avatar' />
      </Grid>
    </Grid>
  );
};

export const GridNotifications: Story = {
  render: () => <GridTemplate />,
};

```

## Archivo: `packages/storybook/src/stories/Components/PrimaryTab/PrimaryTab.stories.tsx`

```typescript
import type { Meta, StoryObj } from '@storybook/react';
import PrimaryTabs from '@workspaceui/componentlibrary/src/components/PrimaryTab';
import { defaultTabs, onlyIconsTabs, onlyLabelsTabs, defaultIcon } from './mock';

const meta: Meta<typeof PrimaryTabs> = {
  title: 'Components/PrimaryTabs',
  component: PrimaryTabs,
};

export default meta;

type Story = StoryObj<typeof PrimaryTabs>;

export const Default: Story = {
  args: {
    tabs: defaultTabs,
    icon: defaultIcon,
  },
};

export const OnlyIcons: Story = {
  args: {
    tabs: onlyIconsTabs,
    icon: defaultIcon,
  },
};

export const OnlyLabels: Story = {
  args: {
    tabs: onlyLabelsTabs,
    icon: defaultIcon,
  },
};

```

## Archivo: `packages/storybook/src/stories/Components/PrimaryTab/mock.tsx`

```typescript
import type { TabItem } from '@workspaceui/componentlibrary/src/components/PrimaryTab/types';
import { theme } from '@workspaceui/componentlibrary/src/theme';
import Home from '@workspaceui/componentlibrary/src/assets/icons/home.svg';
import Person from '@workspaceui/componentlibrary/src/assets/icons/user.svg';
import Settings from '@workspaceui/componentlibrary/src/assets/icons/settings.svg';
import Info from '@workspaceui/componentlibrary/src/assets/icons/info.svg';
import Related from '@workspaceui/componentlibrary/src/assets/icons/grid.svg';
import Clip from '@workspaceui/componentlibrary/src/assets/icons/paperclip.svg';
import Tag from '@workspaceui/componentlibrary/src/assets/icons/tag.svg';
import Smile from '@workspaceui/componentlibrary/src/assets/icons/smile.svg';
import Chevrons from '@workspaceui/componentlibrary/src/assets/icons/chevrons-right.svg';

export const defaultTabs: TabItem[] = [
  {
    id: 'details',
    icon: <Home fill={theme.palette.baselineColor.neutral[60]} />,
    label: 'Details',
    fill: theme.palette.baselineColor.neutral[60],
    hoverFill: theme.palette.baselineColor.neutral[0],
    showInTab: 'both',
  },
  {
    id: 'more-info',
    icon: <Person fill={theme.palette.baselineColor.neutral[60]} />,
    label: 'More Information about',
    fill: theme.palette.baselineColor.neutral[60],
    hoverFill: theme.palette.baselineColor.neutral[0],
    showInTab: 'both',
  },
  {
    id: 'settings',
    icon: <Settings fill={theme.palette.baselineColor.neutral[60]} />,
    label: 'Settings',
    fill: theme.palette.baselineColor.neutral[60],
    hoverFill: theme.palette.baselineColor.neutral[0],
    showInTab: 'both',
  },
  {
    id: 'notes',
    icon: <Info fill={theme.palette.baselineColor.neutral[60]} />,
    label: 'Notes',
    fill: theme.palette.baselineColor.neutral[60],
    hoverFill: theme.palette.baselineColor.neutral[0],
    showInTab: 'both',
  },
  {
    id: 'related-items',
    icon: <Related fill={theme.palette.baselineColor.neutral[60]} />,
    label: 'Related Items',
    fill: theme.palette.baselineColor.neutral[60],
    hoverFill: theme.palette.baselineColor.neutral[0],
    showInTab: 'both',
  },
  {
    id: 'attached-files',
    icon: <Clip fill={theme.palette.baselineColor.neutral[60]} />,
    label: 'Attached Files',
    fill: theme.palette.baselineColor.neutral[60],
    hoverFill: theme.palette.baselineColor.neutral[0],
    showInTab: 'icon',
  },
  {
    id: 'tags',
    icon: <Tag fill={theme.palette.baselineColor.neutral[60]} />,
    label: 'Tags',
    fill: theme.palette.baselineColor.neutral[60],
    hoverFill: theme.palette.baselineColor.neutral[0],
    showInTab: 'icon',
  },
  {
    id: 'reactions',
    icon: <Smile fill={theme.palette.baselineColor.neutral[60]} />,
    label: 'Reactions',
    fill: theme.palette.baselineColor.neutral[60],
    hoverFill: theme.palette.baselineColor.neutral[0],
    showInTab: 'icon',
  },
];

export const onlyIconsTabs: TabItem[] = [
  {
    id: 'home',
    icon: <Home fill={theme.palette.baselineColor.neutral[60]} />,
    label: 'Home',
    fill: theme.palette.baselineColor.neutral[60],
    hoverFill: theme.palette.baselineColor.neutral[0],
    showInTab: 'icon',
  },
  {
    id: 'profile',
    icon: <Person fill={theme.palette.baselineColor.neutral[60]} />,
    label: 'Profile',
    fill: theme.palette.baselineColor.neutral[60],
    hoverFill: theme.palette.baselineColor.neutral[0],
    showInTab: 'icon',
  },
  {
    id: 'settings',
    icon: <Settings fill={theme.palette.baselineColor.neutral[60]} />,
    label: 'Settings',
    fill: theme.palette.baselineColor.neutral[60],
    hoverFill: theme.palette.baselineColor.neutral[0],
    showInTab: 'icon',
  },
  {
    id: 'about',
    icon: <Info fill={theme.palette.baselineColor.neutral[60]} />,
    label: 'About',
    fill: theme.palette.baselineColor.neutral[60],
    hoverFill: theme.palette.baselineColor.neutral[0],
    showInTab: 'icon',
  },
];

export const onlyLabelsTabs: TabItem[] = [
  {
    id: 'home',
    icon: <Home />,
    label: 'Home',
    fill: theme.palette.baselineColor.neutral[60],
    hoverFill: theme.palette.baselineColor.neutral[0],
    showInTab: 'label',
  },
  {
    id: 'profile',
    icon: <Person />,
    label: 'Profile',
    fill: theme.palette.baselineColor.neutral[60],
    hoverFill: theme.palette.baselineColor.neutral[0],
    showInTab: 'label',
  },
  {
    id: 'settings',
    icon: <Settings />,
    label: 'Settings',
    fill: theme.palette.baselineColor.neutral[60],
    hoverFill: theme.palette.baselineColor.neutral[0],
    showInTab: 'label',
  },
  {
    id: 'about',
    icon: <Info />,
    label: 'About',
    fill: theme.palette.baselineColor.neutral[60],
    hoverFill: theme.palette.baselineColor.neutral[0],
    showInTab: 'label',
  },
];

export const defaultIcon = <Chevrons fill={theme.palette.baselineColor.neutral[80]} />;

```

## Archivo: `packages/storybook/src/stories/Components/ProfileModal/ProfileModal.stories.tsx`

```typescript
import { Profile as ProfileModal } from '@workspaceui/componentlibrary/src/components';
import profilePicture from '@workspaceui/componentlibrary/src/assets/images/profile_picture_mock.png';
import PersonIcon from '@workspaceui/componentlibrary/src/assets/icons/user.svg';
import { sections } from './mock';
import type { Meta, StoryObj } from '@storybook/react';
import type { ProfileModalProps } from '@workspaceui/componentlibrary/src/components/ProfileModal/types';

const meta: Meta<typeof ProfileModal> = {
  title: 'Components/ProfileModal',
  component: ProfileModal,
  argTypes: {
    cancelButtonText: { control: 'text' },
    saveButtonText: { control: 'text' },
    passwordLabel: { control: 'text' },
    newPasswordLabel: { control: 'text' },
    confirmPasswordLabel: { control: 'text' },
    section: { control: 'text' },
    tooltipButtonProfile: { control: 'text' },
    userPhotoUrl: { control: 'text' },
    userName: { control: 'text' },
    userEmail: { control: 'text' },
    icon: { control: 'object' },
  },
};

export default meta;

type Story = StoryObj<ProfileModalProps>;

export const ProfileDefault: Story = {
  render: (args) => <ProfileModal {...args} />,
  args: {
    section: 'profile',
    cancelButtonText: 'Cancel',
    saveButtonText: 'Save',
    passwordLabel: 'Password',
    newPasswordLabel: 'New Password',
    confirmPasswordLabel: 'Confirm New Password',
    tooltipButtonProfile: 'Account Settings',
    userPhotoUrl: profilePicture,
    userName: 'Ayelén García',
    userEmail: 'ayelen.garcia@etendo.software',
    sectionTooltip: 'Close Session',
    icon: <PersonIcon fill='#2E365C' />,
    sections: sections,
  },
};

```

## Archivo: `packages/storybook/src/stories/Components/ProfileModal/mock.tsx`

```typescript
import PersonOutlineIcon from '@workspaceui/componentlibrary/src/assets/icons/check-circle.svg';
import LockIcon from '@workspaceui/componentlibrary/src/assets/icons/lock.svg';
import type { Section } from '@workspaceui/mainui/components/ProfileModal/ToggleButton/types';

const defaultFill = '#6B7280';

export const sections: Section[] = [
  {
    id: 'profile',
    label: 'Perfil',
    icon: <PersonOutlineIcon fill={defaultFill} />,
  },
  {
    id: 'password',
    label: 'Contraseña',
    icon: <LockIcon fill={defaultFill} />,
  },
];

export const mockRoles = [
  { id: '1', name: 'Admin', orgList: [{ id: '1', name: '1', warehouseList: [{ id: 'w1', name: 'Warehouse 1' }] }] },
  { id: '2', name: 'User', orgList: [{ id: '2', name: '2', warehouseList: [{ id: 'w2', name: 'Warehouse 2' }] }] },
];

```

## Archivo: `packages/storybook/src/stories/Components/RegisterModal/RegisterModal.stories.tsx`

```typescript
import type { Meta, StoryObj } from '@storybook/react';
import RegisterModal from '@workspaceui/componentlibrary/src/components/RegisterModal';

const meta: Meta<typeof RegisterModal> = {
  title: 'Components/RegisterModal',
  component: RegisterModal,
  argTypes: {
    registerText: { control: 'text' },
  },
};

export default meta;
type Story = StoryObj<typeof RegisterModal>;

export const Default: Story = {
  args: {
    registerText: 'Register',
  },
};

export const WithCustomLabels: Story = {
  args: {
    ...Default.args,
    registerText: 'Registration',
  },
};

```

## Archivo: `packages/storybook/src/stories/Components/RegisterModal/registerMock.ts`

```typescript
export const processMock = [
  {
    id: 1,
    title: 'Annular',
    description: 'Cancel and stop the process of the record',
  },
  {
    id: 2,
    title: 'Process',
    description: 'Verify and approve the record for its shipment',
  },
  {
    id: 3,
    title: 'Register',
    description: 'Formalize the record in the system',
  },
];

```

## Archivo: `packages/storybook/src/stories/Components/SearchModal/SearchModal.stories.tsx`

```typescript
import { Typography, Box } from '@mui/material';
import SearchModal from '@workspaceui/componentlibrary/src/components/SearchModal';
import { typographyTitleStyles } from '../../Styles/Typography/styles';
import { TABS_CONTENT, DEFAULT_CONTENT } from './mock';

export default {
  title: 'Components/SearchModal',
  component: SearchModal,
};

export const DefaultVariant = () => <SearchModal defaultContent={DEFAULT_CONTENT} variant='default' />;

export const TabsVariant = () => <SearchModal tabsContent={TABS_CONTENT} variant='tabs' />;

export const BothVariants = () => (
  <Box sx={{ display: 'flex', gap: '20px' }}>
    <Box>
      <Typography variant='h6' style={typographyTitleStyles}>
        Default Variant
      </Typography>
      <SearchModal defaultContent={DEFAULT_CONTENT} variant='default' />
    </Box>
    <Box>
      <Typography variant='h6' style={typographyTitleStyles}>
        Tabs Variant
      </Typography>
      <SearchModal tabsContent={TABS_CONTENT} variant='tabs' />
    </Box>
  </Box>
);

```

## Archivo: `packages/storybook/src/stories/Components/SearchModal/mock.tsx`

```typescript
import {
  AppsOutlined,
  ShoppingCartOutlined,
  Inventory2Outlined,
  PersonOutlineOutlined,
  LayersOutlined,
} from '@mui/icons-material';

export const TABS_CONTENT = [
  {
    icon: <LayersOutlined />,
    label: 'Todo',
    onClick: () => console.log('Navigating to Todo'),
    items: [],
    numberOfItems: 8,
  },
  {
    icon: <AppsOutlined />,
    label: 'Aplicaciones',
    onClick: () => console.log('Navigating to Aplicaciones'),
    items: [
      { name: 'Pedido de venta', icon: '💳' },
      { name: 'Pedido de venta por albaranes', icon: '💳' },
    ],
    numberOfItems: 2,
  },
  {
    icon: <ShoppingCartOutlined />,
    label: 'Pedidos de venta',
    onClick: () => console.log('Navigating to Pedidos de venta'),
    items: [
      { name: '192456 Pedido de venta', icon: '💳', isNew: true, newLabel: 'Nuevo' },
      { name: 'pedido de venta de isa', icon: '💳' },
      { name: '1219 pedido de venta argentina', icon: '💳' },
    ],
    numberOfItems: 3,
  },
  {
    icon: <Inventory2Outlined />,
    label: 'Productos',
    onClick: () => console.log('Navigating to Productos'),
    items: [
      { name: 'Esmalte Semipermanente 8ml Pedido de venta #192', icon: '📦' },
      { name: 'Dermaroller pedido de ventas de Julian de 192 agujas', icon: '📦' },
    ],
    numberOfItems: 2,
  },
  {
    icon: <PersonOutlineOutlined />,
    label: 'Terceros',
    onClick: () => console.log('Navigating to Terceros'),
    items: [{ name: 'Aliwin Pedido de venta IS192 SL', icon: '👤' }],
    numberOfItems: 1,
  },
];

export const DEFAULT_CONTENT = {
  headerTitle: 'Búsquedas recientes',
  sections: [
    {
      title: 'Aplicaciones',
      items: [
        { name: 'MRP', icon: '✅' },
        { name: 'Proyectos y servicios', icon: '📊' },
      ],
    },
    {
      title: 'Otros',
      items: [
        { name: 'Esmalte Semipermanente 8ml Pedido de vent...', icon: '📦' },
        { name: 'Dermaroller pedido de ventas de Julian de 19...', icon: '📦' },
      ],
    },
  ],
};

```

## Archivo: `packages/storybook/src/stories/Components/SecondaryTab/SecondaryTab.stories.tsx`

```typescript
import type React from 'react';
import { useState, useEffect } from 'react';
import { TABS_CONFIG } from './mock';
import SecondaryTabs from '@workspaceui/componentlibrary/src/components/SecondaryTabs';
import type { Meta, StoryObj } from '@storybook/react';
import type { TabContent } from '@workspaceui/componentlibrary/src/components/SecondaryTabs/types';

const meta: Meta<typeof SecondaryTabs> = {
  title: 'Components/SecondaryTabs',
  component: SecondaryTabs,
};

export default meta;

const noop = () => {};

type Story = StoryObj<typeof SecondaryTabs>;

const SecondaryTabsTemplate: React.FC = () => {
  const [tabsContent, setTabsContent] = useState<TabContent[]>(TABS_CONFIG);

  useEffect(() => {
    const timer = setTimeout(() => {
      const updatedTabs = tabsContent.map((tab) => ({
        ...tab,
        isLoading: false,
      }));
      setTabsContent(updatedTabs);
    }, 5000);
    return () => clearTimeout(timer);
  }, [tabsContent]);

  return <SecondaryTabs content={tabsContent} selectedTab={0} onChange={noop} />;
};

export const Default: Story = {
  render: () => <SecondaryTabsTemplate />,
};

```

## Archivo: `packages/storybook/src/stories/Components/SecondaryTab/mock.tsx`

```typescript
import { Typography } from '@mui/material';
import {
  AttachMoneyOutlined,
  BarChartOutlined,
  LineStyleOutlined,
  LocalOfferOutlined,
  ReceiptOutlined,
  StackedBarChartOutlined,
} from '@mui/icons-material';

export const TABS_CONFIG = [
  {
    icon: <LineStyleOutlined />,
    label: 'Lines',
    numberOfItems: 20,
    isLoading: true,
    onClick: () => console.log('Navigating to Lines'),
    content: <Typography>Lines Content</Typography>,
    items: [],
  },
  {
    icon: '🏬',
    label: 'Discounts',
    numberOfItems: 0,
    onClick: () => console.log('Navigating to Discounts'),
    content: <Typography>Discounts Content</Typography>,
    items: [],
  },
  {
    icon: <StackedBarChartOutlined />,
    label: 'Tax',
    numberOfItems: 2,
    isLoading: true,
    onClick: () => console.log('Navigating to Tax'),
    content: <Typography>Tax Content</Typography>,
    items: [],
  },
  {
    icon: '🇦🇷',
    label: 'Payment Plan',
    numberOfItems: 0,
    onClick: () => console.log('Navigating to Payment Plan'),
    content: <Typography>Payment Plan Content</Typography>,
    items: [],
  },
  {
    icon: <ReceiptOutlined />,
    label: 'Sales Order',
    numberOfItems: 12,
    isLoading: true,
    onClick: () => console.log('Navigating to Sales Order'),
    content: <Typography>Sales Order Content</Typography>,
    items: [],
  },
  {
    icon: '📦',
    label: 'Purchases',
    numberOfItems: 3,
    onClick: () => console.log('Navigating to Purchases'),
    content: <Typography>Purchases Content</Typography>,
    items: [],
  },
  {
    icon: <BarChartOutlined />,
    label: 'Reports',
    numberOfItems: 8,
    onClick: () => console.log('Navigating to Reports'),
    content: <Typography>Reports Content</Typography>,
    items: [],
  },
  {
    icon: <AttachMoneyOutlined />,
    label: 'Finance',
    numberOfItems: 6,
    onClick: () => console.log('Navigating to Finance'),
    content: <Typography>Finance Content</Typography>,
    items: [],
  },
  {
    icon: <LineStyleOutlined />,
    label: 'Projects',
    numberOfItems: 5,
    onClick: () => console.log('Navigating to Projects'),
    content: <Typography>Projects Content</Typography>,
    items: [],
  },
  {
    icon: <LocalOfferOutlined />,
    label: 'Marketing',
    numberOfItems: 4,
    onClick: () => console.log('Navigating to Marketing'),
    content: <Typography>Marketing Content</Typography>,
    items: [],
  },
  {
    icon: <StackedBarChartOutlined />,
    label: 'Analysis',
    numberOfItems: 7,
    onClick: () => console.log('Navigating to Analysis'),
    content: <Typography>Analysis Content</Typography>,
    items: [],
  },
  {
    icon: '🇪🇸',
    label: 'World',
    numberOfItems: 9,
    onClick: () => console.log('Navigating to World'),
    content: <Typography>Portfolio Content</Typography>,
    items: [],
  },
  {
    icon: <ReceiptOutlined />,
    label: 'Billing',
    numberOfItems: 11,
    onClick: () => console.log('Navigating to Billing'),
    content: <Typography>Billing Content</Typography>,
    items: [],
  },
];

```

## Archivo: `packages/storybook/src/stories/Components/StatusModal/StatusModal.stories.tsx`

```typescript
import StatusModal from '@workspaceui/componentlibrary/src/components/StatusModal';
import type { StatusType } from '@workspaceui/componentlibrary/src/components/StatusModal/types';
import type { Meta, StoryObj } from '@storybook/react';

interface StatusModalStoryProps {
  statusText: string;
  statusType: StatusType;
  errorMessage?: string;
  saveLabel: string;
  secondaryButtonLabel: string;
}

const meta: Meta<typeof StatusModal> = {
  title: 'Components/StatusModal',
  component: StatusModal,
  argTypes: {
    statusText: { control: 'text' },
    statusType: {
      control: 'select',
      options: ['success', 'error', 'warning'],
    },
    saveLabel: { control: 'text' },
    secondaryButtonLabel: { control: 'text' },
    errorMessage: { control: 'text' },
  },
};

export default meta;

type Story = StoryObj<StatusModalStoryProps>;

const StatusModalTemplate: Story = {
  render: (args) => <StatusModal {...args} />,
};

export const SuccessStatus: Story = {
  ...StatusModalTemplate,
  args: {
    statusText: 'Operation completed successfully',
    statusType: 'success',
    saveLabel: 'Save',
    secondaryButtonLabel: 'Cancel',
  },
};

export const ErrorStatus: Story = {
  ...StatusModalTemplate,
  args: {
    statusText: 'An error occurred',
    statusType: 'error',
    errorMessage: 'Unable to complete the operation. Please try again later.',
  },
};

export const WarningStatus: Story = {
  ...StatusModalTemplate,
  args: {
    statusText: 'Warning: Action required',
    statusType: 'warning',
  },
};

export const CustomErrorMessage: Story = {
  ...StatusModalTemplate,
  args: {
    statusText: 'Custom Error',
    statusType: 'error',
    errorMessage: 'This is a custom error message that can be quite long and detailed if needed.',
  },
};

export const LongStatusText: Story = {
  ...StatusModalTemplate,
  args: {
    statusText:
      'This is a very long status text to demonstrate how the modal handles extensive content in the status message area.',
    statusType: 'success',
  },
};

```

## Archivo: `packages/storybook/src/stories/Components/Table/columns.tsx`

```typescript
import type { MRT_ColumnDef } from 'material-react-table';
import type { Organization, OrganizationLabels } from './types';

export const getColumns = (labels: Partial<OrganizationLabels> = {}): MRT_ColumnDef<Organization>[] => [
  {
    accessorKey: 'organization',
    header: labels.organization ?? 'Organization',
  },
  {
    accessorKey: 'transactionDocument',
    header: labels.transactionDocument ?? 'Transaction Document',
  },
  {
    accessorKey: 'documentNo',
    header: labels.documentNo ?? 'Document No.',
  },
  {
    accessorKey: 'orderDate',
    header: labels.orderDate ?? 'Order Date',
  },
  {
    accessorKey: 'businessPartner',
    header: labels.businessPartner ?? 'Business Partner',
  },
  {
    accessorKey: 'partnerAddress',
    header: labels.partnerAddress ?? 'Partner Address',
  },
  {
    accessorKey: 'priceList',
    header: labels.priceList ?? 'Price List',
  },
  {
    accessorKey: 'scheduledDeliveryDate',
    header: labels.scheduledDeliveryDate ?? 'Scheduled Delivery Date',
  },
  {
    accessorKey: 'paymentMethod',
    header: labels.paymentMethod ?? 'Payment Method',
  },
  {
    accessorKey: 'paymentTerms',
    header: labels.paymentTerms ?? 'Payment Terms',
  },
  {
    accessorKey: 'warehouse',
    header: labels.warehouse ?? 'Warehouse',
  },
  {
    accessorKey: 'invoiceTerms',
    header: labels.invoiceTerms ?? 'Invoice Terms',
  },
  {
    accessorKey: 'orderReference',
    header: labels.orderReference ?? 'Order Reference',
  },
  {
    accessorKey: 'salesRepresentative',
    header: labels.salesRepresentative ?? 'Sales Representative',
  },
  {
    accessorKey: 'description',
    header: labels.description ?? 'Description',
  },
  {
    accessorKey: 'invoiceAddress',
    header: labels.invoiceAddress ?? 'Invoice Address',
  },
  {
    accessorKey: 'deliveryLocation',
    header: labels.deliveryLocation ?? 'Delivery Location',
  },
  {
    accessorKey: 'quotation',
    header: labels.quotation ?? 'Quotation',
  },
  {
    accessorKey: 'cancelledorder',
    header: labels.cancelledorder ?? 'Cancelled Order',
  },
  {
    accessorKey: 'replacedorder',
    header: labels.replacedorder ?? 'Replaced Order',
  },
  {
    accessorKey: 'iscancelled',
    header: labels.iscancelled ?? 'Is Cancelled',
    Cell: ({ cell }) => (cell.getValue<boolean>() ? 'Yes' : 'No'),
  },
  {
    accessorKey: 'externalBusinessPartnerReference',
    header: labels.externalBusinessPartnerReference ?? 'External Business Partner Reference',
  },
  {
    accessorKey: 'project',
    header: labels.project ?? 'Project',
  },
  {
    accessorKey: 'costcenter',
    header: labels.costcenter ?? 'Cost Center',
  },
  {
    accessorKey: 'asset',
    header: labels.asset ?? 'Asset',
  },
  {
    accessorKey: 'stDimension',
    header: labels.stDimension ?? '1st Dimension',
  },
  {
    accessorKey: 'ndDimension',
    header: labels.ndDimension ?? '2nd Dimension',
  },
  {
    accessorKey: 'creationDate',
    header: labels.creationDate ?? 'Creation Date',
  },
  {
    accessorKey: 'createdBy',
    header: labels.createdBy ?? 'Created By',
  },
  {
    accessorKey: 'updated',
    header: labels.updated ?? 'Updated',
  },
  {
    accessorKey: 'updatedBy',
    header: labels.updatedBy ?? 'Updated By',
  },
  {
    accessorKey: 'documentStatus',
    header: labels.documentStatus ?? 'Document Status',
  },
  {
    accessorKey: 'grandTotalAmount',
    header: labels.grandTotalAmount ?? 'Grand Total Amount',
  },
  {
    accessorKey: 'summedLineAmount',
    header: labels.summedLineAmount ?? 'Summed Line Amount',
  },
  {
    accessorKey: 'currency',
    header: labels.currency ?? 'Currency',
  },
  {
    accessorKey: 'reservationStatus',
    header: labels.reservationStatus ?? 'Reservation Status',
  },
  {
    accessorKey: 'deliveryStatus',
    header: labels.deliveryStatus ?? 'Delivery Status',
  },
  {
    accessorKey: 'invoiceStatus',
    header: labels.invoiceStatus ?? 'Invoice Status',
  },
  {
    accessorKey: 'delivered',
    header: labels.delivered ?? 'Delivered',
    Cell: ({ cell }) => (cell.getValue<boolean>() ? 'Yes' : 'No'),
  },
  {
    accessorKey: 'id',
    header: labels.id ?? 'ID',
  },
];

```

## Archivo: `packages/storybook/src/stories/Components/Table/mock.tsx`

```typescript
import type { Organization } from './types';
import InfoIcon from '@workspaceui/componentlibrary/src/assets/icons/note.svg';
import LinkIcon from '@workspaceui/componentlibrary/src/assets/icons/link.svg';
import AttachmentIcon from '@workspaceui/componentlibrary/src/assets/icons/file.svg';
import InformationIcon from '@workspaceui/componentlibrary/src/assets/icons/info.svg';
import NoteIcon from '@workspaceui/componentlibrary/src/assets/icons/note.svg';
import { theme } from '@workspaceui/componentlibrary/src/theme';
import { FieldType } from '@workspaceui/api-client/src/api/types';

export const mockOrganizations: Organization[] = [
  {
    _mainSection: {
      name: '_mainSection',
      label: 'Main Information',
      type: 'section',
      personalizable: false,
      icon: <InfoIcon />,
      id: 'main',
      fill: theme.palette.baselineColor.neutral[60],
      hoverFill: theme.palette.baselineColor.neutral[0],
      showInTab: 'both',
    },
    organization: {
      name: 'organization',
      value: 'Global Enterprises',
      type: FieldType.SELECT,
      label: 'Organization',
      section: '_mainSection',
      required: true,
      original: {} as never,
    },
    transactionDocument: {
      value: 'Sales Order',
      type: FieldType.TEXT,
      label: 'Transaction Document',
      section: '_mainSection',
      required: true,
      name: '',
      original: {} as never,
    },
    documentNo: {
      value: 'SO-001',
      type: FieldType.TEXT,
      label: 'Document No.',
      section: '_mainSection',
      required: true,
      name: '',
      original: {} as never,
    },
    orderDate: {
      value: '2023-08-15',
      type: FieldType.DATE,
      label: 'Order Date',
      section: '_mainSection',
      required: true,
      name: '',
      original: {} as never,
    },
    iscancelled: {
      value: false,
      type: FieldType.BOOLEAN,
      label: 'Is Cancelled',
      section: '_mainSection',
      required: true,
      name: '',
      original: {} as never,
    },
    businessPartner: {
      value: 'TechCorp Inc.',
      type: FieldType.TEXT,
      label: 'Business Partner',
      section: '_mainSection',
      required: true,
      name: '',
      original: {} as never,
    },
    partnerAddress: {
      value: '123 Tech St, Silicon Valley, CA',
      type: FieldType.TEXT,
      label: 'Partner Address',
      section: '_mainSection',
      name: '',
      original: {} as never,
    },
    priceList: {
      value: 'Standard Price List',
      type: FieldType.TEXT,
      label: 'Price List',
      section: '_mainSection',
      name: '',
      original: {} as never,
    },
    scheduledDeliveryDate: {
      value: '2023-08-30',
      type: FieldType.DATE,
      label: 'Scheduled Delivery Date',
      section: '_mainSection',
      name: '',
      original: {} as never,
    },
    paymentMethod: {
      value: 'Credit Card',
      type: FieldType.TEXT,
      label: 'Payment Method',
      section: '_mainSection',
      name: '',
      original: {} as never,
    },
    paymentTerms: {
      value: 'Net 30',
      type: FieldType.TEXT,
      label: 'Payment Terms',
      section: '_mainSection',
      name: '',
      original: {} as never,
    },
    _linkedItems: {
      name: '_linkedItems',
      label: 'Linked Items',
      type: 'section',
      personalizable: false,
      icon: <LinkIcon />,
      id: 'linked',
      fill: theme.palette.baselineColor.neutral[60],
      hoverFill: theme.palette.baselineColor.neutral[0],
      showInTab: 'both',
    },
    warehouse: {
      value: 'Main Warehouse',
      type: FieldType.TEXT,
      label: 'Warehouse',
      section: '_linkedItems',
      name: '',
      original: {} as never,
    },
    invoiceTerms: {
      value: 'Standard Terms',
      type: FieldType.TEXT,
      label: 'Invoice Terms',
      section: '_linkedItems',
      name: '',
      original: {} as never,
    },
    orderReference: {
      value: 'REF-001',
      type: FieldType.TEXT,
      label: 'Order Reference',
      section: '_linkedItems',

      name: '',
      original: {} as never,
    },
    _moreInformation: {
      name: '_moreInformation',
      label: 'More Information',
      type: 'section',
      personalizable: false,
      icon: <InformationIcon />,
      id: 'information',
      fill: theme.palette.baselineColor.neutral[60],
      hoverFill: theme.palette.baselineColor.neutral[0],
      showInTab: 'both',
    },
    salesRepresentative: {
      value: 'John Doe',
      type: FieldType.TEXT,
      label: 'Sales Representative',
      section: '_moreInformation',
      name: '',
      original: {} as never,
    },
    description: {
      value: 'Order for Q3 supplies',
      type: FieldType.TEXT,
      label: 'Description',
      section: '_moreInformation',
      name: '',
      original: {} as never,
    },
    invoiceAddress: {
      value: '456 Finance Ave, New York, NY',
      type: FieldType.TEXT,
      label: 'Invoice Address',
      section: '_moreInformation',
      name: '',
      original: {} as never,
    },
    _attachments: {
      name: '_attachments',
      label: 'Attachments',
      type: 'section',
      personalizable: false,
      icon: <AttachmentIcon />,
      id: 'attachments',
      fill: theme.palette.baselineColor.neutral[60],
      hoverFill: theme.palette.baselineColor.neutral[0],
      showInTab: 'both',
    },
    deliveryLocation: {
      value: '789 Delivery Rd, Los Angeles, CA',
      type: FieldType.TEXT,
      label: 'Delivery Location',
      section: '_attachments',
      name: '',
      original: {} as never,
    },
    quotation: {
      value: 'Q-001',
      type: FieldType.TEXT,
      label: 'Quotation',
      section: '_attachments',
      name: '',
      original: {} as never,
    },
    cancelledorder: {
      value: 'ASD',
      type: FieldType.TEXT,
      label: 'Cancelled Order',
      section: '_attachments',
      name: '',
      original: {} as never,
    },
    project: {
      value: 'Q3 Expansion',
      type: FieldType.TEXT,
      label: 'Project',
      section: '_attachments',
      name: '',
      original: {} as never,
    },
    id: {
      value: '1',
      type: FieldType.TEXT,
      label: 'ID',
      name: '',
      original: {} as never,
    },
    _noteSection: {
      name: '_noteSection',
      label: 'Notes',
      type: 'section',
      personalizable: false,
      icon: <NoteIcon />,
      id: 'notes',
      fill: theme.palette.baselineColor.neutral[60],
      hoverFill: theme.palette.baselineColor.neutral[0],
      showInTab: 'both',
    },
    note: {
      value: 'Q3 Expansion',
      type: FieldType.TEXT,
      label: 'Project',
      section: '_noteSection',
      name: '',
      original: {} as never,
    },
  },
  {
    _mainSection: {
      name: '_mainSection',
      label: 'Main Information',
      type: 'section',
      personalizable: false,
      icon: <InfoIcon />,
      id: 'main',
      fill: theme.palette.baselineColor.neutral[60],
      hoverFill: theme.palette.baselineColor.neutral[0],
      showInTab: 'both',
    },
    organization: {
      value: 'Global X',
      type: FieldType.TEXT,
      label: 'Organization',
      section: '_mainSection',
      name: '',
      original: {} as never,
    },
    transactionDocument: {
      value: 'Sales Order',
      type: FieldType.TEXT,
      label: 'Transaction Document',
      section: '_mainSection',
      name: '',
      original: {} as never,
    },
    documentNo: {
      value: 'SO-002',
      type: FieldType.TEXT,
      label: 'Document No.',
      section: '_mainSection',
      name: '',
      original: {} as never,
    },
    orderDate: {
      value: '2023-08-15',
      type: FieldType.DATE,
      label: 'Order Date',
      section: '_mainSection',
      name: '',
      original: {} as never,
    },
    iscancelled: {
      value: false,
      type: FieldType.BOOLEAN,
      label: 'Is Cancelled',
      section: '_mainSection',
      name: '',
      original: {} as never,
    },
    businessPartner: {
      value: 'Etendo.',
      type: FieldType.TEXT,
      label: 'Business Partner',
      section: '_mainSection',
      name: '',
      original: {} as never,
    },
    partnerAddress: {
      value: '123 Tech St, Silicon Valley, CA',
      type: FieldType.TEXT,
      label: 'Partner Address',
      section: '_mainSection',
      name: '',
      original: {} as never,
    },
    priceList: {
      value: 'Standard Price List',
      type: FieldType.TEXT,
      label: 'Price List',
      section: '_mainSection',
      name: '',
      original: {} as never,
    },
    scheduledDeliveryDate: {
      value: '2023-08-30',
      type: FieldType.DATE,
      label: 'Scheduled Delivery Date',
      section: '_mainSection',
      name: '',
      original: {} as never,
    },
    paymentMethod: {
      value: 'Credit Card',
      type: FieldType.TEXT,
      label: 'Payment Method',
      section: '_mainSection',
      name: '',
      original: {} as never,
    },
    paymentTerms: {
      value: 'Net 30',
      type: FieldType.TEXT,
      label: 'Payment Terms',
      section: '_mainSection',
      name: '',
      original: {} as never,
    },
    _linkedItems: {
      name: '_linkedItems',
      label: 'Linked Items',
      type: 'section',
      personalizable: false,
      icon: <LinkIcon />,
      id: 'linked',
      fill: theme.palette.baselineColor.neutral[60],
      hoverFill: theme.palette.baselineColor.neutral[0],
      showInTab: 'both',
    },
    warehouse: {
      value: 'Main Warehouse',
      type: FieldType.TEXT,
      label: 'Warehouse',
      section: '_linkedItems',
      name: '',
      original: {} as never,
    },
    invoiceTerms: {
      value: 'Standard Terms',
      type: FieldType.TEXT,
      label: 'Invoice Terms',
      section: '_linkedItems',
      name: '',
      original: {} as never,
    },
    orderReference: {
      value: 'REF-001',
      type: FieldType.TEXT,
      label: 'Order Reference',
      section: '_linkedItems',
      name: '',
      original: {} as never,
    },
    _moreInformation: {
      name: '_moreInformation',
      label: 'More Information',
      type: 'section',
      personalizable: false,
      icon: <InformationIcon />,
      id: 'information',
      fill: theme.palette.baselineColor.neutral[60],
      hoverFill: theme.palette.baselineColor.neutral[0],
      showInTab: 'both',
    },
    salesRepresentative: {
      value: 'John Doe',
      type: FieldType.TEXT,
      label: 'Sales Representative',
      section: '_moreInformation',
      name: '',
      original: {} as never,
    },
    description: {
      value: 'Order for Q3 supplies',
      type: FieldType.TEXT,
      label: 'Description',
      section: '_moreInformation',
      name: '',
      original: {} as never,
    },
    invoiceAddress: {
      value: '456 Finance Ave, New York, NY',
      type: FieldType.TEXT,
      label: 'Invoice Address',
      section: '_moreInformation',
      name: '',
      original: {} as never,
    },
    _attachments: {
      name: '_attachments',
      label: 'Attachments',
      type: 'section',
      personalizable: false,
      icon: <AttachmentIcon />,
      id: 'attachments',
      fill: theme.palette.baselineColor.neutral[60],
      hoverFill: theme.palette.baselineColor.neutral[0],
      showInTab: 'both',
    },
    deliveryLocation: {
      value: '789 Delivery Rd, Los Angeles, CA',
      type: FieldType.TEXT,
      label: 'Delivery Location',
      section: '_attachments',
      name: '',
      original: {} as never,
    },
    quotation: {
      value: 'Q-001',
      type: FieldType.TEXT,
      label: 'Quotation',
      section: '_attachments',
      name: '',
      original: {} as never,
    },
    cancelledorder: {
      value: '',
      type: FieldType.TEXT,
      label: 'Cancelled Order',
      section: '_attachments',
      name: '',
      original: {} as never,
    },
    replacedorder: {
      value: '',
      type: FieldType.TEXT,
      label: 'Replaced Order',
      section: '_attachments',
      name: '',
      original: {} as never,
    },
    externalBusinessPartnerReference: {
      value: 'EXT-001',
      type: FieldType.TEXT,
      label: 'External Business Partner Reference',
      section: '_attachments',
      name: '',
      original: {} as never,
    },
    project: {
      value: 'Q3 Expansion',
      type: FieldType.TEXT,
      label: 'Project',
      name: '',
      original: {} as never,
    },
    costcenter: {
      value: 'Sales Department',
      type: FieldType.TEXT,
      label: 'Cost Center',
      section: '_attachments',
      name: '',
      original: {} as never,
    },
    asset: {
      value: 'N/A',
      type: FieldType.TEXT,
      label: 'Asset',
      section: '_attachments',
      name: '',
      original: {} as never,
    },
    stDimension: {
      value: 'West Coast',
      type: FieldType.TEXT,
      label: '1st Dimension',
      section: '_attachments',
      name: '',
      original: {} as never,
    },
    ndDimension: {
      value: 'Electronics',
      type: FieldType.TEXT,
      label: '2nd Dimension',
      section: '_attachments',
      name: '',
      original: {} as never,
    },
    transactionDocumentType: {
      value: 'Purchase Order',
      type: FieldType.TEXT,
      label: 'Transaction Document Type',
      section: '_mainSection',
      name: '',
      original: {} as never,
    },
    warehouseRule: {
      value: 'FIFO',
      type: FieldType.TEXT,
      label: 'Warehouse Rule',
      section: '_linkedItems',
      name: '',
      original: {} as never,
    },
    id: {
      value: '2',
      type: FieldType.TEXT,
      label: 'ID',
      name: '',
      original: {} as never,
    },
    _noteSection: {
      name: '_noteSection',
      label: 'Notes',
      type: 'section',
      personalizable: false,
      icon: <NoteIcon />,
      id: 'notes',
      fill: theme.palette.baselineColor.neutral[60],
      hoverFill: theme.palette.baselineColor.neutral[0],
      showInTab: 'both',
    },
  },
];

```

## Archivo: `packages/storybook/src/stories/Components/Table/mockWidget.tsx`

```typescript
import { Box, Typography } from '@mui/material';
import SideIcon from '@workspaceui/componentlibrary/src/assets/icons/codesandbox.svg';
import TabWidget from '@workspaceui/componentlibrary/src/components/Widgets/TabWidget';
import type { TranslateFunction } from '@workspaceui/mainui/hooks/types';

const colors = {
  backgrounds: [
    '#f0f4f8',
    '#d9e2ec',
    '#bcccdc',
    '#9fb3c8',
    '#829ab1',
    '#627d98',
    '#486581',
    '#334e68',
    '#243b53',
    '#102a43',
    '#243b45',
  ],
  text: [
    '#102a43',
    '#243b53',
    '#334e68',
    '#486581',
    '#627d98',
    '#829ab1',
    '#9fb3c8',
    '#bcccdc',
    '#d9e2ec',
    '#f0f4f8',
    '#ffffff',
  ],
  accents: [
    '#e6f6ff',
    '#bae3ff',
    '#7cc4fa',
    '#47a3f3',
    '#2186eb',
    '#0967d2',
    '#0552b5',
    '#03449e',
    '#01337d',
    '#002159',
  ],
};

const getContrastColor = (bgColor: string) => {
  const index = colors.backgrounds.indexOf(bgColor);
  return index >= 5 ? colors.text[9] : colors.text[0];
};

export const createWidgets = (t: TranslateFunction) => {
  const widgets = [
    {
      id: '1',
      children: (
        <TabWidget
          title={t('grid.items.erp.text')}
          content={
            <Typography variant='h3' fontWeight='bold'>
              1,245,863.00 €
            </Typography>
          }
          noRecordText={t('table.labels.noRecord')}
        />
      ),
      icon: <SideIcon fill={colors.text[0]} />,
      iconButtonAction: () => {},
      tooltip: t('table.tooltips.details'),
      title: t('grid.items.erp.text'),
      color: getContrastColor(colors.backgrounds[1]),
      bgcolor: colors.backgrounds[1],
      iconBgColor: colors.accents[2],
      iconButtonColor: getContrastColor(colors.backgrounds[1]),
      iconButtonHoverColor: colors.accents[4],
      iconButtonBgColor: colors.backgrounds[3],
      iconButtonHoverBgColor: colors.backgrounds[0],
      size: 'full',
    },
    {
      id: '2',
      children: <Box>💰 754,320.50 €</Box>,
      size: 'half',
      title: t('grid.items.tailored.text'),
      icon: <SideIcon fill={colors.text[9]} />,
      iconButtonAction: () => {},
      tooltip: t('table.tooltips.details'),
      color: colors.text[10],
      bgcolor: colors.backgrounds[10],
      iconBgColor: colors.accents[7],
      iconButtonColor: colors.text[10],
      iconButtonHoverColor: colors.accents[5],
      iconButtonBgColor: colors.backgrounds[8],
      iconButtonHoverBgColor: colors.backgrounds[6],
    },
    {
      id: '3',
      children: <Box>📊 25.7%</Box>,
      size: 'half',
      title: t('grid.items.adaptable.text'),
      icon: <SideIcon fill={getContrastColor(colors.backgrounds[5])} />,
      iconButtonAction: () => {},
      tooltip: t('table.tooltips.details'),
      color: getContrastColor(colors.backgrounds[5]),
      bgcolor: colors.backgrounds[5],
      iconBgColor: colors.accents[4],
      iconButtonColor: getContrastColor(colors.backgrounds[5]),
      iconButtonHoverColor: colors.accents[6],
      iconButtonBgColor: colors.backgrounds[6],
      iconButtonHoverBgColor: colors.backgrounds[4],
    },
    {
      id: '4',
      children: <Box>👥 12,453</Box>,
      size: 'full',
      title: t('breadcrumb.newRecord'),
      icon: <SideIcon fill={getContrastColor(colors.backgrounds[7])} />,
      iconButtonAction: () => {},
      tooltip: t('table.tooltips.details'),
      color: getContrastColor(colors.backgrounds[7]),
      bgcolor: colors.backgrounds[7],
      iconBgColor: colors.accents[5],
      iconButtonColor: getContrastColor(colors.backgrounds[7]),
      iconButtonHoverColor: colors.accents[7],
      iconButtonBgColor: colors.backgrounds[8],
      iconButtonHoverBgColor: colors.backgrounds[6],
    },
    {
      id: '5',
      children: <Box>📈 89.3%</Box>,
      size: 'half',
      title: t('drawer.recentlyViewed'),
      icon: <SideIcon fill={getContrastColor(colors.backgrounds[2])} />,
      iconButtonAction: () => {},
      tooltip: t('table.tooltips.details'),
      color: getContrastColor(colors.backgrounds[2]),
      bgcolor: colors.backgrounds[2],
      iconBgColor: colors.accents[1],
      iconButtonColor: getContrastColor(colors.backgrounds[2]),
      iconButtonHoverColor: colors.accents[3],
      iconButtonBgColor: colors.backgrounds[1],
      iconButtonHoverBgColor: colors.backgrounds[0],
    },
    {
      id: '6',
      children: <Box>🏆 Top 10%</Box>,
      size: 'half',
      title: t('process.messageTitle'),
      icon: <SideIcon fill={getContrastColor(colors.backgrounds[4])} />,
      iconButtonAction: () => {},
      tooltip: t('table.tooltips.details'),
      color: getContrastColor(colors.backgrounds[4]),
      bgcolor: colors.backgrounds[4],
      iconBgColor: colors.accents[2],
      iconButtonColor: getContrastColor(colors.backgrounds[4]),
      iconButtonHoverColor: colors.accents[4],
      iconButtonBgColor: colors.backgrounds[3],
      iconButtonHoverBgColor: colors.backgrounds[2],
    },
    {
      id: '7',
      children: <Box>📦 1,245</Box>,
      size: 'half',
      title: t('navigation.activityButton.tooltip'),
      icon: <SideIcon fill={getContrastColor(colors.backgrounds[4])} />,
      iconButtonAction: () => {},
      tooltip: t('table.tooltips.details'),
      color: getContrastColor(colors.backgrounds[4]),
      bgcolor: colors.backgrounds[4],
      iconBgColor: colors.accents[2],
      iconButtonColor: getContrastColor(colors.backgrounds[4]),
      iconButtonHoverColor: colors.accents[4],
      iconButtonBgColor: colors.backgrounds[3],
      iconButtonHoverBgColor: colors.backgrounds[2],
    },
    {
      id: '8',
      children: <Box>🔄 87.5%</Box>,
      size: 'half',
      title: t('process.completedSuccessfully'),
      icon: <SideIcon fill={getContrastColor(colors.backgrounds[4])} />,
      iconButtonAction: () => {},
      tooltip: t('table.tooltips.details'),
      color: getContrastColor(colors.backgrounds[4]),
      bgcolor: colors.backgrounds[4],
      iconBgColor: colors.accents[2],
      iconButtonColor: getContrastColor(colors.backgrounds[4]),
      iconButtonHoverColor: colors.accents[4],
      iconButtonBgColor: colors.backgrounds[3],
      iconButtonHoverBgColor: colors.backgrounds[2],
    },
    {
      id: '9',
      children: <Box>⏱️ 98.2%</Box>,
      size: 'half',
      title: t('navigation.waterfall.tooltipButton'),
      icon: <SideIcon fill={getContrastColor(colors.backgrounds[4])} />,
      iconButtonAction: () => {},
      tooltip: t('table.tooltips.details'),
      color: getContrastColor(colors.backgrounds[4]),
      bgcolor: colors.backgrounds[4],
      iconBgColor: colors.accents[2],
      iconButtonColor: getContrastColor(colors.backgrounds[4]),
      iconButtonHoverColor: colors.accents[4],
      iconButtonBgColor: colors.backgrounds[3],
      iconButtonHoverBgColor: colors.backgrounds[2],
    },
  ];
  return widgets;
};

export default createWidgets;

```

## Archivo: `packages/storybook/src/stories/Components/Table/toolbarFormviewMock.tsx`

```typescript
import SaveIcon from '@workspaceui/componentlibrary/src/assets/icons/save.svg';
import PlusIcon from '@workspaceui/componentlibrary/src/assets/icons/plus.svg';
import RefreshIcon from '@workspaceui/componentlibrary/src/assets/icons/refresh-cw.svg';
import SearchIcon from '@workspaceui/componentlibrary/src/assets/icons/search.svg';
import FilterIcon from '@workspaceui/componentlibrary/src/assets/icons/filter.svg';
import ColumnsIcon from '@workspaceui/componentlibrary/src/assets/icons/columns.svg';
import ChevronDownIcon from '@workspaceui/componentlibrary/src/assets/icons/chevrons-down.svg';
import SidebarIcon from '@workspaceui/componentlibrary/src/assets/icons/sidebar.svg';
import LowerFlapIcon from '@workspaceui/componentlibrary/src/assets/icons/lower-flap.svg';
import Excel from '@workspaceui/componentlibrary/src/assets/icons/ilustration/excel.svg';
import Copilot from '@workspaceui/componentlibrary/src/assets/icons/sparks.svg';
import Print from '@workspaceui/componentlibrary/src/assets/icons/color-picker.svg';
import Trash from '@workspaceui/componentlibrary/src/assets/icons/trash-2.svg';
import Printer from '@workspaceui/componentlibrary/src/assets/icons/printer.svg';
import Copy from '@workspaceui/componentlibrary/src/assets/icons/copy.svg';
import Mail from '@workspaceui/componentlibrary/src/assets/icons/mail.svg';
import LinkIcon from '@workspaceui/componentlibrary/src/assets/icons/link.svg';
import type { ToolbarSectionConfig } from './types';
import { theme } from '@workspaceui/componentlibrary/src/theme';
import type { TranslateFunction } from '@workspaceui/mainui/hooks/types';

const IconSize = 16;

export const createFormViewToolbarConfig = (
  onSave: () => void,
  onCancel: () => void,
  toggleDropdown: () => void,
  toggleSidebar: () => void,
  isDropdownOpen: boolean,
  isSidebarOpen: boolean,
  t: TranslateFunction,
): {
  leftSection: ToolbarSectionConfig;
  centerSection: ToolbarSectionConfig;
  rightSection: ToolbarSectionConfig;
} => ({
  leftSection: {
    buttons: [
      {
        key: 'save',
        tooltip: t('common.save'),
        icon: <SaveIcon />,
        iconText: 'Save Changes',
        onClick: onSave,
        height: 14,
        width: 14,
        fill: theme.palette.baselineColor.neutral[0],
        sx: {
          padding: '0.75rem',
          maxHeight: '2rem',
          background: theme.palette.baselineColor.neutral[100],
          borderRadius: '6.25rem',
          color: theme.palette.baselineColor.neutral[0],
          '&:hover': {
            border: 'none',
            background: theme.palette.dynamicColor.main,
            borderRadius: '6.25rem',
          },
        },
      },
      {
        key: 'Add',
        tooltip: t('common.cancel'),
        icon: <PlusIcon />,
        onClick: onCancel,
        height: IconSize,
        width: IconSize,
        fill: theme.palette.baselineColor.neutral[0],
        sx: {
          background: theme.palette.baselineColor.neutral[100],
        },
      },
      {
        key: 'refresh',
        icon: <RefreshIcon />,
        tooltip: t('table.tooltips.refresh'),
        onClick: () => {},
        height: IconSize,
        width: IconSize,
        sx: {
          border: `1px solid ${theme.palette.baselineColor.transparentNeutral[30]}`,
        },
      },
    ],
    style: {
      display: 'flex',
      width: 'auto',
      alignItems: 'center',
      background: `var(--Neutral-0, ${theme.palette.baselineColor.neutral[0]})`,
      borderRadius: '10rem',
      padding: '0.25rem',
      gap: '0.25rem',
      maxHeight: '2.5rem',
    },
  },
  centerSection: {
    buttons: [
      {
        key: 'print',
        icon: <Print />,
        tooltip: 'Print',
        onClick: () => {},
        height: IconSize,
        width: IconSize,
      },
      {
        key: 'copilot',
        icon: <Copilot />,
        tooltip: 'Copilot',
        onClick: () => {},
        height: IconSize,
        width: IconSize,
      },
      {
        key: 'delete',
        icon: <Trash />,
        tooltip: 'Delete',
        onClick: () => {},
        height: IconSize,
        width: IconSize,
      },
      {
        key: 'printer',
        icon: <Printer />,
        tooltip: 'Printer',
        onClick: () => {},
        height: IconSize,
        width: IconSize,
      },
      {
        key: 'copy',
        icon: <Copy />,
        tooltip: 'Copy',
        onClick: () => {},
        height: IconSize,
        width: IconSize,
      },
      {
        key: 'excel',
        icon: <Excel />,
        tooltip: 'Excel',
        onClick: () => {},
        height: IconSize,
        width: IconSize,
      },
      {
        key: 'mail',
        icon: <Mail />,
        tooltip: 'Mail',
        onClick: () => {},
        height: IconSize,
        width: IconSize,
      },
      {
        key: 'link',
        icon: <LinkIcon />,
        tooltip: 'Link',
        onClick: () => {},
        height: IconSize,
        width: IconSize,
      },
    ],
    style: {
      display: 'flex',
      width: '100%',
      background: `var(--Neutral-0, ${theme.palette.baselineColor.transparentNeutral[5]})`,
      borderRadius: '10rem',
      padding: '0.25rem',
      gap: '0.25rem',
    },
  },
  rightSection: {
    buttons: [
      {
        key: 'search',
        icon: <SearchIcon />,
        tooltip: t('table.tooltips.search'),
        onClick: () => {},
        height: IconSize,
        width: IconSize,
      },
      {
        key: 'views',
        icon: <ChevronDownIcon />,
        tooltip: t('table.tooltips.views'),
        onClick: () => {},
        height: IconSize,
        width: IconSize,
      },
      {
        key: 'filter',
        icon: <FilterIcon />,
        tooltip: t('table.tooltips.filter'),
        onClick: () => {},
        height: IconSize,
        width: IconSize,
      },
      {
        key: 'columns',
        icon: <ColumnsIcon />,
        tooltip: t('table.tooltips.columns'),
        onClick: () => {},
        height: IconSize,
        width: IconSize,
      },
      {
        key: 'sidebar',
        icon: <SidebarIcon />,
        tooltip: isSidebarOpen ? t('table.tooltips.closeSidebar') : t('table.tooltips.openSidebar'),
        onClick: toggleSidebar,
        height: IconSize,
        width: IconSize,
        fill: isSidebarOpen ? theme.palette.baselineColor.neutral[0] : theme.palette.baselineColor.neutral[80],
        hoverFill: isSidebarOpen ? theme.palette.baselineColor.neutral[20] : theme.palette.baselineColor.neutral[0],
        sx: isSidebarOpen
          ? {
              backgroundColor: theme.palette.dynamicColor.main,
              '&:hover': {
                background: theme.palette.baselineColor.neutral[80],
              },
            }
          : {},
      },
      {
        key: 'details',
        icon: <LowerFlapIcon />,
        tooltip: t('table.tooltips.details'),
        onClick: toggleDropdown,
        height: IconSize,
        width: IconSize,
        fill: isDropdownOpen ? theme.palette.baselineColor.neutral[0] : theme.palette.baselineColor.neutral[80],
        hoverFill: isDropdownOpen ? theme.palette.baselineColor.neutral[20] : theme.palette.baselineColor.neutral[0],
        sx: isDropdownOpen
          ? {
              backgroundColor: theme.palette.dynamicColor.main,
              '&:hover': {
                background: theme.palette.baselineColor.neutral[80],
              },
            }
          : {},
      },
    ],
    style: {
      display: 'flex',
      gap: '0.25rem',
      background: `var(--Neutral-0, ${theme.palette.baselineColor.transparentNeutral[5]})`,
      borderRadius: '10rem',
      padding: '0.25rem',
      marginLeft: '0.25rem',
    },
  },
});

```

## Archivo: `packages/storybook/src/stories/Components/Table/toolbarMock.tsx`

```typescript
import PlusIcon from '@workspaceui/componentlibrary/src/assets/icons/plus.svg';
import RefreshIcon from '@workspaceui/componentlibrary/src/assets/icons/refresh-cw.svg';
import SearchIcon from '@workspaceui/componentlibrary/src/assets/icons/search.svg';
import FilterIcon from '@workspaceui/componentlibrary/src/assets/icons/filter.svg';
import ColumnsIcon from '@workspaceui/componentlibrary/src/assets/icons/columns.svg';
import ChevronDownIcon from '@workspaceui/componentlibrary/src/assets/icons/chevron-down.svg';
import SidebarIcon from '@workspaceui/componentlibrary/src/assets/icons/sidebar.svg';
import LowerFlapIcon from '@workspaceui/componentlibrary/src/assets/icons/lower-flap.svg';
import Excel from '@workspaceui/componentlibrary/src/assets/icons/ilustration/excel.svg';
import Copilot from '@workspaceui/componentlibrary/src/assets/icons/sparks.svg';
import Print from '@workspaceui/componentlibrary/src/assets/icons/color-picker.svg';
import Trash from '@workspaceui/componentlibrary/src/assets/icons/trash-2.svg';
import Printer from '@workspaceui/componentlibrary/src/assets/icons/printer.svg';
import Copy from '@workspaceui/componentlibrary/src/assets/icons/copy.svg';
import Mail from '@workspaceui/componentlibrary/src/assets/icons/mail.svg';
import LinkIcon from '@workspaceui/componentlibrary/src/assets/icons/link.svg';
import type { ToolbarSectionConfig } from './types';
import { theme } from '@workspaceui/componentlibrary/src/theme';
import type { TranslateFunction } from '@workspaceui/mainui/hooks/types';

const IconSize = 16;

export const createToolbarConfig = (
  toggleDropdown: () => void,
  toggleSidebar: () => void,
  handleExpandClick: () => void,
  isDropdownOpen: boolean,
  isSidebarOpen: boolean,
  t: TranslateFunction,
): {
  leftSection: ToolbarSectionConfig;
  centerSection: ToolbarSectionConfig;
  rightSection: ToolbarSectionConfig;
} => ({
  leftSection: {
    buttons: [
      {
        key: 'new-line',
        icon: <PlusIcon />,
        iconText: 'New Line',
        tooltip: 'New Line',
        onClick: () => {},
        height: IconSize,
        width: IconSize,
        fill: theme.palette.baselineColor.neutral[0],
        sx: {
          padding: '0.75rem',
          maxHeight: '2rem',
          background: theme.palette.baselineColor.neutral[100],
          borderRadius: '6.25rem 0 0 6.25rem',
          color: theme.palette.baselineColor.neutral[0],
          '&:hover': {
            background: theme.palette.dynamicColor.main,
          },
        },
      },
      {
        key: 'expand',
        icon: <ChevronDownIcon />,
        tooltip: 'Expand',
        onClick: handleExpandClick,
        height: IconSize,
        width: IconSize,
        fill: theme.palette.baselineColor.neutral[0],
        sx: {
          background: theme.palette.baselineColor.neutral[100],
          borderRadius: '0 6.25rem 6.25rem 0',
          '&:hover': {
            background: theme.palette.dynamicColor.main,
          },
        },
      },
      {
        key: 'refresh',
        icon: <RefreshIcon />,
        tooltip: t('table.tooltips.refresh'),
        onClick: () => {},
        height: IconSize,
        width: IconSize,
        sx: {
          marginLeft: '0.2rem',
          border: `1px solid ${theme.palette.baselineColor.transparentNeutral[30]}`,
        },
      },
    ],
    style: {
      display: 'flex',
      width: 'auto',
      alignItems: 'center',
      background: `var(--Neutral-0, ${theme.palette.baselineColor.neutral[0]})`,
      borderRadius: '10rem',
      padding: '0.25rem',
      maxHeight: '2.5rem',
      gap: '0.05rem',
    },
  },
  centerSection: {
    buttons: [
      {
        key: 'print',
        icon: <Print />,
        tooltip: 'Print',
        onClick: () => {},
        height: IconSize,
        width: IconSize,
      },
      {
        key: 'copilot',
        icon: <Copilot />,
        tooltip: 'Copilot',
        onClick: () => {},
        height: IconSize,
        width: IconSize,
      },
      {
        key: 'delete',
        icon: <Trash />,
        tooltip: 'Delete',
        onClick: () => {},
        height: IconSize,
        width: IconSize,
      },
      {
        key: 'printer',
        icon: <Printer />,
        tooltip: 'Printer',
        onClick: () => {},
        height: IconSize,
        width: IconSize,
      },
      {
        key: 'copy',
        icon: <Copy />,
        tooltip: 'Copy',
        onClick: () => {},
        height: IconSize,
        width: IconSize,
      },
      {
        key: 'excel',
        icon: <Excel />,
        tooltip: 'Excel',
        onClick: () => {},
        height: IconSize,
        width: IconSize,
      },
      {
        key: 'mail',
        icon: <Mail />,
        tooltip: 'Mail',
        onClick: () => {},
        height: IconSize,
        width: IconSize,
      },
      {
        key: 'link',
        icon: <LinkIcon />,
        tooltip: 'Link',
        onClick: () => {},
        height: IconSize,
        width: IconSize,
      },
    ],
    style: {
      display: 'flex',
      width: '100%',
      background: `var(--Neutral-0, ${theme.palette.baselineColor.transparentNeutral[5]})`,
      borderRadius: '10rem',
      padding: '.25rem',
      gap: '0.25rem',
    },
  },
  rightSection: {
    buttons: [
      {
        key: 'search',
        icon: <SearchIcon />,
        tooltip: t('table.tooltips.search'),
        onClick: () => {},
        height: IconSize,
        width: IconSize,
      },
      {
        key: 'views',
        icon: <ChevronDownIcon />,
        tooltip: t('table.tooltips.views'),
        onClick: () => {},
        height: IconSize,
        width: IconSize,
      },
      {
        key: 'filter',
        icon: <FilterIcon />,
        tooltip: t('table.tooltips.filter'),
        onClick: () => {},
        height: IconSize,
        width: IconSize,
      },
      {
        key: 'columns',
        icon: <ColumnsIcon />,
        tooltip: t('table.tooltips.columns'),
        onClick: () => {},
        height: IconSize,
        width: IconSize,
      },
      {
        key: 'sidebar',
        icon: <SidebarIcon />,
        tooltip: isSidebarOpen ? t('table.tooltips.closeSidebar') : t('table.tooltips.openSidebar'),
        onClick: toggleSidebar,
        fill: isSidebarOpen ? theme.palette.baselineColor.neutral[0] : theme.palette.baselineColor.neutral[80],
        hoverFill: isSidebarOpen ? theme.palette.baselineColor.neutral[20] : theme.palette.baselineColor.neutral[0],
        sx: isSidebarOpen
          ? {
              backgroundColor: theme.palette.dynamicColor.main,
              '&:hover': {
                background: theme.palette.baselineColor.neutral[80],
              },
            }
          : {},
        height: IconSize,
        width: IconSize,
      },
      {
        key: 'details',
        icon: <LowerFlapIcon />,
        tooltip: t('table.tooltips.details'),
        onClick: toggleDropdown,
        fill: isDropdownOpen ? theme.palette.baselineColor.neutral[0] : theme.palette.baselineColor.neutral[80],
        hoverFill: isDropdownOpen ? theme.palette.baselineColor.neutral[20] : theme.palette.baselineColor.neutral[0],
        sx: isDropdownOpen
          ? {
              backgroundColor: theme.palette.dynamicColor.main,
              '&:hover': {
                background: theme.palette.baselineColor.neutral[80],
              },
            }
          : {},
        height: IconSize,
        width: IconSize,
      },
    ],
    style: {
      display: 'flex',
      gap: '0.25rem',
      background: `var(--Neutral-0, ${theme.palette.baselineColor.transparentNeutral[5]})`,
      borderRadius: '10rem',
      padding: '0.25rem',
    },
  },
});

```

## Archivo: `packages/storybook/src/stories/Components/Table/types.ts`

```typescript
import type { Section } from '@workspaceui/mainui/components/Form/FormView/types';
import type { BaseFieldDefinition, FieldDefinition } from '@workspaceui/api-client/src/api/types';

export type OrganizationField = FieldDefinition | Section;

export interface Organization {
  id: BaseFieldDefinition<string>;
  documentNo: BaseFieldDefinition<string>;
  transactionDocument: BaseFieldDefinition<string>;
  _noteSection: Section;
  [key: string]: FieldDefinition | Section;
}

export type OrganizationLabels = {
  [K in keyof Organization]: string;
};

export interface SelectedRecord {
  identifier: string;
  type: string;
}
export interface TableProps {
  data: Organization[];
  isTreeStructure?: boolean;
}

export interface Widget extends React.PropsWithChildren {
  id: string;
  title?: string;
  icon?: React.ReactNode;
  iconButtonAction?: () => void;
  tooltip?: string;
  color?: string;
  bgcolor?: string;
  size?: 'half' | 'full';
  iconBgColor?: string;
  iconButtonColor?: string;
  iconButtonHoverColor?: string;
  iconButtonBgColor?: string;
  iconButtonHoverBgColor?: string;
}

export interface ContentGridProps {
  widgets: Widget[];
}

```

## Archivo: `packages/storybook/src/stories/Components/Tag/Tag.stories.tsx`

```typescript
import { Grid } from '@mui/material';
import { InfoOutlined, CheckOutlined, Error } from '@mui/icons-material';
import Tag from '@workspaceui/componentlibrary/src/components/Tag';

export default {
  title: 'Components/Tag',
  component: Tag,
};

const Template = () => (
  <Grid container spacing={2}>
    <Grid item>
      <Tag type='success' icon={<InfoOutlined />} label='Registered' />
    </Grid>
    <Grid item>
      <Tag type='primary' label='Registered' />
    </Grid>
    <Grid item>
      <Tag type='warning' icon={<CheckOutlined />} label='Period Closed' />
    </Grid>
    <Grid item>
      <Tag type='error' icon={<Error />} label='Canceled' />
    </Grid>
    <Grid item>
      <Tag type='draft' label='In Draft' />
    </Grid>
  </Grid>
);

export const Variants = Template.bind({});

```

## Archivo: `packages/storybook/src/stories/Components/ToggleButton/ToggleButton.stories.tsx`

```typescript
import type React from 'react';
import { useState } from 'react';
import ToggleButton from '@workspaceui/componentlibrary/src/components/ProfileModal/ToggleButton';
import { sectionsMock, sectionsMock3, sectionsMock4 } from './mock';
import type { Meta, StoryObj } from '@storybook/react';
import type { Section } from '@workspaceui/componentlibrary/src/components/ProfileModal/ToggleButton/types';

interface ToggleButtonProps {
  sections: Section[];
  currentSection: string;
  onToggle: (section: string) => void;
}

const meta: Meta<typeof ToggleButton> = {
  title: 'Components/ToggleButton',
  component: ToggleButton,
  argTypes: {
    sections: { control: false },
    currentSection: { control: 'text' },
    onToggle: { action: 'toggled' },
  },
};

export default meta;

type Story = StoryObj<ToggleButtonProps>;

const ToggleButtonTemplate: React.FC<ToggleButtonProps> = (args) => {
  const [currentSection, setCurrentSection] = useState(args.currentSection);

  const handleToggle = (section: string) => {
    setCurrentSection(section);
    args.onToggle(section);
  };

  return <ToggleButton {...args} currentSection={currentSection} onToggle={handleToggle} />;
};

export const Default: Story = {
  render: (args) => <ToggleButtonTemplate {...args} />,
  args: {
    sections: sectionsMock,
    currentSection: 'profile',
    onToggle: (section: string) => console.log('Toggled to:', section),
  },
};

export const TripleButton: Story = {
  render: (args) => <ToggleButtonTemplate {...args} />,
  args: {
    sections: sectionsMock3,
    currentSection: 'profile',
    onToggle: (section: string) => console.log('Toggled to:', section),
  },
};

export const QuadButton: Story = {
  render: (args) => <ToggleButtonTemplate {...args} />,
  args: {
    sections: sectionsMock4,
    currentSection: 'profile',
    onToggle: (section: string) => console.log('Toggled to:', section),
  },
};

```

## Archivo: `packages/storybook/src/stories/Components/ToggleButton/mock.tsx`

```typescript
import PersonOutlineIcon from '@mui/icons-material/PersonOutline';
import LockIcon from '@mui/icons-material/Lock';
import HomeIcon from '@mui/icons-material/Home';
import SettingsIcon from '@mui/icons-material/Settings';
import type { Section } from '@workspaceui/componentlibrary/src/components/ProfileModal/ToggleButton/types';

export const sectionsMock: Section[] = [
  { id: 'profile', label: 'Profile', icon: <PersonOutlineIcon /> },
  { id: 'password', label: 'Password', icon: <LockIcon /> },
];

export const sectionsMock3: Section[] = [
  { id: 'profile', label: 'Profile', icon: <PersonOutlineIcon /> },
  { id: 'password', label: 'Password', icon: <LockIcon /> },
  { id: 'home', label: 'Home', icon: <HomeIcon /> },
];

export const sectionsMock4: Section[] = [
  { id: 'profile', label: 'Profile', icon: <PersonOutlineIcon /> },
  { id: 'password', label: 'Password', icon: <LockIcon /> },
  { id: 'home', label: 'Home', icon: <HomeIcon /> },
  { id: 'settings', label: 'Settings', icon: <SettingsIcon /> },
];

```

## Archivo: `packages/storybook/src/stories/Components/ToggleChip/ToggleChip.stories.tsx`

```typescript
import type React from 'react';
import { useState, useEffect } from 'react';
import { Box, Grid } from '@mui/material';
import ToggleChip from '@workspaceui/componentlibrary/src/components/Toggle/ToggleChip';
import type { Meta, StoryObj } from '@storybook/react';

interface ToggleChipProps {
  isActive: boolean;
  onToggle: () => void;
}

const meta: Meta<typeof ToggleChip> = {
  title: 'Components/ToggleChip',
  component: ToggleChip,
  argTypes: {
    isActive: { control: 'boolean' },
    onToggle: { action: 'toggled' },
  },
};

export default meta;

type Story = StoryObj<ToggleChipProps>;

const ToggleChipTemplate: React.FC<ToggleChipProps> = (args) => {
  const [isActive, setIsActive] = useState(args.isActive);

  const handleToggle = () => {
    setIsActive(!isActive);
    args.onToggle();
  };

  useEffect(() => {
    setIsActive(args.isActive);
  }, [args.isActive]);

  return (
    <Grid container spacing={2}>
      <Box sx={{ margin: '5rem' }}>
        <ToggleChip isActive={isActive} onToggle={handleToggle} />
      </Box>
    </Grid>
  );
};

export const Variants: Story = {
  render: (args) => <ToggleChipTemplate {...args} />,
  args: {
    isActive: false,
    onToggle: () => console.log('Toggled'),
  },
};

```

## Archivo: `packages/storybook/src/stories/Components/ToggleSection/ToggleSection.stories.tsx`

```typescript
import SelectorList from '@workspaceui/componentlibrary/src/components/ProfileModal/ToggleSection';
import type { SelectorListProps } from '@workspaceui/componentlibrary/src/components/ProfileModal/types';
import type { Meta, StoryObj } from '@storybook/react';
import { mockRoles } from './mock';

const meta: Meta<typeof SelectorList> = {
  title: 'Components/Sections',
  component: SelectorList,
  argTypes: {
    section: {
      control: 'radio',
      options: ['password', 'profile'],
    },
    passwordLabel: { control: 'text' },
    newPasswordLabel: { control: 'text' },
    confirmPasswordLabel: { control: 'text' },
    onRoleChange: { action: 'role changed' },
    onWarehouseChange: { action: 'warehouse changed' },
    onSaveAsDefaultChange: { action: 'save as default changed' },
  },
};

export default meta;

type Story = StoryObj<SelectorListProps>;

export const PasswordSection: Story = {
  args: {
    section: 'password',
    passwordLabel: 'Current Password',
    newPasswordLabel: 'New Password',
    confirmPasswordLabel: 'Confirm New Password',
  },
};

export const ProfileSection: Story = {
  args: {
    section: 'profile',
    roles: mockRoles,
    selectedRole: { id: '1', value: '1', title: 'Admin' },
    selectedWarehouse: { id: 'wh1', value: 'wh1', title: 'Warehouse 1' },
    saveAsDefault: false,
  },
};

```

## Archivo: `packages/storybook/src/stories/Components/ToggleSection/mock.ts`

```typescript
export const mockRoles = [
  {
    id: '1',
    name: 'Admin',
    orgList: [
      {
        id: 'org1',
        name: 'Organization 1',
        warehouseList: [
          { id: 'wh1', name: 'Warehouse 1' },
          { id: 'wh2', name: 'Warehouse 2' },
        ],
      },
      {
        id: 'org2',
        name: 'Organization 2',
        warehouseList: [
          { id: 'wh3', name: 'Warehouse 3' },
          { id: 'wh4', name: 'Warehouse 4' },
        ],
      },
    ],
  },
  {
    id: '2',
    name: 'User',
    orgList: [
      {
        id: 'org3',
        name: 'Organization 3',
        warehouseList: [
          { id: 'wh5', name: 'Warehouse 5' },
          { id: 'wh6', name: 'Warehouse 6' },
        ],
      },
    ],
  },
];

```

## Archivo: `packages/storybook/src/stories/Components/Tooltip/Tooltip.stories.tsx`

```typescript
import type { FC } from 'react';
import { Grid, Tooltip, Button, Box } from '@mui/material';

export default {
  title: 'Components/Tooltip',
  component: Tooltip,
};

const TooltipDemo: FC = () => {
  return (
    <Box sx={{ margin: '10rem 35rem', width: 500 }}>
      <Grid container justifyContent='center'>
        <Grid item>
          <Tooltip title='Add' placement='top-start' arrow>
            <Button>top-start</Button>
          </Tooltip>
          <Tooltip title='Add' placement='top' arrow>
            <Button>top</Button>
          </Tooltip>
          <Tooltip title='Add' placement='top-end' arrow>
            <Button>top-end</Button>
          </Tooltip>
        </Grid>
      </Grid>
      <Grid container justifyContent='center'>
        <Grid item xs={6}>
          <Tooltip title='Add' placement='left-start' arrow>
            <Button>left-start</Button>
          </Tooltip>
          <br />
          <Tooltip title='Add' placement='left' arrow>
            <Button>left</Button>
          </Tooltip>
          <br />
          <Tooltip title='Add' placement='left-end' arrow>
            <Button>left-end</Button>
          </Tooltip>
        </Grid>
        <Grid item container xs={6} alignItems='flex-end' direction='column'>
          <Grid item>
            <Tooltip title='Add' placement='right-start' arrow>
              <Button>right-start</Button>
            </Tooltip>
          </Grid>
          <Grid item>
            <Tooltip title='Add' placement='right' arrow>
              <Button>right</Button>
            </Tooltip>
          </Grid>
          <Grid item>
            <Tooltip title='Add' placement='right-end' arrow>
              <Button>right-end</Button>
            </Tooltip>
          </Grid>
        </Grid>
      </Grid>
      <Grid container justifyContent='center'>
        <Grid item>
          <Tooltip title='Add' placement='bottom-start' arrow>
            <Button>bottom-start</Button>
          </Tooltip>
          <Tooltip title='Add' placement='bottom' arrow>
            <Button>bottom</Button>
          </Tooltip>
          <Tooltip title='Add' placement='bottom-end' arrow>
            <Button>bottom-end</Button>
          </Tooltip>
        </Grid>
      </Grid>
    </Box>
  );
};

const Template = () => <TooltipDemo />;

export const Default = Template.bind({});

```

## Archivo: `packages/storybook/src/stories/Components/WaterfallModal/WaterfallModal.stories.tsx`

```typescript
import WaterfallModal from '@workspaceui/componentlibrary/src/components/Waterfall/WaterfallModal';
import type { WaterfallModalProps } from '@workspaceui/componentlibrary/src/components/Waterfall/types';
import { initialPeople, menuItems } from '../mock';
import AddIcon from '@workspaceui/componentlibrary/src/assets/icons/plus.svg';
import type { Meta, StoryObj } from '@storybook/react';

const meta: Meta<typeof WaterfallModal> = {
  title: 'Components/WaterfallModal',
  component: WaterfallModal,
  argTypes: {
    backButtonText: { control: 'text' },
    activateAllText: { control: 'text' },
    deactivateAllText: { control: 'text' },
    buttonText: { control: 'text' },
    customizeText: { control: 'text' },
    tooltipWaterfallButton: { control: 'text' },
  },
};

export default meta;

type Story = StoryObj<WaterfallModalProps>;

export const DefaultWaterfallModal: Story = {
  render: (args) => <WaterfallModal {...args} />,
  args: {
    menuItems,
    initialPeople,
    backButtonText: 'Back',
    activateAllText: 'Activate all',
    deactivateAllText: 'Deactivate all',
    buttonText: 'Buttons',
    customizeText: 'Customize',
    tooltipWaterfallButton: 'Waterfall',
    icon: <AddIcon />,
  },
};

```

## Archivo: `packages/storybook/src/stories/Components/mock.ts`

```typescript
import type { Item } from '@workspaceui/componentlibrary/src/components/DragModal/DragModal.types';

export const menuItems = [
  { emoji: '💼', label: 'New Job', key: 'newJob' },
  { emoji: '💳', label: 'New Sales Order', key: 'newSalesOrder' },
  { emoji: '💳', label: 'New Sales Invoice', key: 'newInvoice' },
  { emoji: '📦', label: 'New Product', key: 'newProduct' },
  { emoji: '📊', label: 'New Accounting Sheet', key: 'newAccountingSheet' },
];

export const initialPeople: Item[] = [
  { id: '1', label: 'Work', isActive: true },
  { id: '2', label: 'Sales Order', isActive: false },
  { id: '3', label: 'Sales Invoice', isActive: true },
  { id: '4', label: 'Product', isActive: false },
  { id: '5', label: 'Third-Party Invoice Paid', isActive: false },
  { id: '6', label: 'Third-Party Credit Memo', isActive: true },
];

```

## Archivo: `packages/storybook/src/stories/Components/notifications.mock.ts`

```typescript
import type { Inotifications } from '@workspaceui/componentlibrary/src/commons';
import {
  Description,
  LightbulbCircle,
  CloudDownloadOutlined,
  WarningAmberOutlined,
  Person,
  AutoAwesome,
  NoteAltOutlined,
  FileDownloadOutlined,
} from '@mui/icons-material';
import { theme } from '@workspaceui/componentlibrary/src/theme';

const buttonStyles = {
  leftButton: {
    background: theme.palette.baselineColor.transparentNeutral[10],
    color: theme.palette.baselineColor.transparentNeutral[70],
    height: '2rem',
    borderRadius: '6.25rem',
    padding: '0.5rem 1rem',
    border: `1px solid ${theme.palette.baselineColor.transparentNeutral[10]}`,
    '&:hover': {
      border: '1px solid transparent',
      background: theme.palette.dynamicColor.main,
      color: theme.palette.baselineColor.neutral[10],
    },
  },
  rightButton: {
    background: theme.palette.baselineColor.neutral[100],
    color: theme.palette.baselineColor.neutral[0],
    height: '2rem',
    borderRadius: '6.25rem',
    padding: '0.5rem 1rem',
    '&:hover': {
      background: theme.palette.dynamicColor.main,
      color: theme.palette.baselineColor.neutral[10],
    },
  },
};

export const createNotifications = (): Inotifications[] => [
  {
    id: '1',
    description: 'The costs have been calculated for July 30, 2024.',
    priority: 'High',
    date: '1m ago',
    icon: Description,
  },
  {
    id: '2',
    description:
      'Copilot recommends purchasing [📦 Long Fine Cruise Rice 1 K](https://example.com) as it is running out of stock.',
    priority: 'Medium',
    date: '1m ago',
    icon: LightbulbCircle,
    ctaButtons: [
      {
        key: 'retry',
        label: 'do it myself',
        action: () => console.log('Retry clicked'),
        sx: buttonStyles.leftButton,
      },
      {
        key: 'contact-support',
        label: 'Copilot is in charge',
        action: () => console.log('Contact Support clicked'),
        icon: AutoAwesome,
        sx: buttonStyles.rightButton,
      },
    ],
  },
  {
    id: '3',
    description: 'A new version of Etendo has come out; it **is necessary to update** the system.',
    priority: 'medium priority',
    date: '2023-01-03',
    tagType: 'warning',
    icon: CloudDownloadOutlined,
    ctaButtons: [
      {
        key: 'view-details',
        label: 'Release note',
        action: () => console.log('View Details clicked'),
        icon: NoteAltOutlined,
        sx: buttonStyles.leftButton,
      },
      {
        key: 'update',
        label: 'Update',
        action: () => console.log('Dismiss clicked'),
        icon: FileDownloadOutlined,
        sx: buttonStyles.rightButton,
      },
    ],
  },
  {
    id: '4',
    description: 'There was an **error** in database',
    priority: 'High Priority',
    date: '2023-01-04',
    tagType: 'error',
    icon: WarningAmberOutlined,
  },
  {
    id: '5',
    description: '[Alexandra Asto](https://example.com) te menciono [💳 946240](https://example.com)',
    priority: 'Draft',
    date: '2023-01-05',
    tagType: 'draft',
    icon: Person,
  },
];

export const NOTIFICATIONS = createNotifications();

```

## Archivo: `packages/storybook/src/stories/Icons/IconGallery.stories.tsx`

```typescript
import React from 'react';
import { Grid, Typography, Card, Box } from '@mui/material';
import { typographyTitleStyles, cardStyles, boxStyles, typographyStyles } from './styles';
import { iconPaths } from './iconPaths';
import { theme } from '../../../../ComponentLibrary/src/theme';

const icons = iconPaths.map((path) =>
  React.lazy(() => import(`../../../../ComponentLibrary/src/assets/icons/${path}.svg`)),
);

export default {
  title: 'Design System/Icon Gallery',
  component: Grid,
  decorators: [
    (Story: React.FC) => (
      <React.Suspense>
        <Story />
      </React.Suspense>
    ),
  ],
};

export const IconGallery = () => (
  <Grid container spacing={2}>
    <Grid item xs={12}>
      <Typography variant='h6' style={typographyTitleStyles}>
        Icon Gallery
      </Typography>
    </Grid>
    <Grid container item spacing={2}>
      {icons.map((IconComponent, index) => (
        <Grid item xs={6} sm={4} md={2} xl={2} key={iconPaths[index]}>
          <Card variant='outlined' style={cardStyles}>
            <Box style={boxStyles}>
              <IconComponent fill={theme.palette.baselineColor.neutral[80]} width='48' height='48' />
            </Box>
            <Typography variant='caption' sx={typographyStyles.caption}>
              {iconPaths[index]}
            </Typography>
          </Card>
        </Grid>
      ))}
    </Grid>
  </Grid>
);

```

## Archivo: `packages/storybook/src/stories/Icons/iconPaths.ts`

```typescript
export const iconPaths = [
  'check',
  'cast',
  'activity',
  'airplay',
  'alert-circle',
  'zoom-in',
  'zoom-out',
  'activity',
  'chevrons-down',
  'external-link',
  'lock',
  'plus-circle',
  'thermometer',
  'airplay',
  'chevrons-left',
  'eye-off',
  'log-in',
  'plus-square',
  'thumbs-down',
  'alert-circle',
  'chevrons-right',
  'eye',
  'log-out',
  'plus',
  'thumbs-up',
  'alert-octagon',
  'chevrons-up',
  'facebook',
  'lower-flap',
  'pocket',
  'toggle-left',
  'alert-triangle',
  'chrome',
  'fast-forward',
  'mail',
  'power',
  'toggle-right',
  'align-center',
  'circle',
  'feather',
  'map-pin',
  'printer',
  'tool',
  'align-justify',
  'clipboard',
  'figma',
  'map',
  'radio',
  'trash-2',
  'align-left',
  'clock',
  'file-minus',
  'maximize-2',
  'refresh-ccw',
  'trash',
  'align-right',
  'close-record',
  'file-plus',
  'maximize',
  'refresh-cw',
  'trello',
  'anchor',
  'cloud-drizzle',
  'file-text',
  'meh',
  'remove-payment',
  'trending-down',
  'aperture',
  'cloud-lightning',
  'file',
  'menu-close',
  'repeat',
  'trending-up',
  'archive',
  'cloud-off',
  'film',
  'menu-open',
  'rewind',
  'triangle',
  'arrow-down-circle',
  'cloud-rain',
  'filter',
  'menu',
  'rotate-ccw',
  'truck',
  'arrow-down-left',
  'cloud-snow',
  'flag',
  'message-circle',
  'rotate-cw',
  'tv',
  'arrow-down-right',
  'cloud',
  'folder-minus',
  'message-square',
  'rss',
  'twitch',
  'arrow-down',
  'code',
  'folder-plus',
  'mic-off',
  'save',
  'twitter',
  'arrow-left-circle',
  'codepen',
  'folder',
  'mic',
  'scissors',
  'type',
  'arrow-left',
  'codesandbox',
  'formula',
  'minimize-2',
  'search',
  'umbrella',
  'arrow-right-circle',
  'coffee',
  'framer',
  'minimize',
  'send',
  'underline',
  'arrow-right',
  'color-picker',
  'frown',
  'minus-circle',
  'server',
  'unlock',
  'arrow-up-circle',
  'columns',
  'gift',
  'minus-square',
  'settings',
  'upload-cloud',
  'arrow-up-left',
  'command',
  'git-branch',
  'minus',
  'share-2',
  'upload',
  'arrow-up-right',
  'compass',
  'git-commit',
  'money',
  'share',
  'user-check',
  'arrow-up',
  'copy',
  'git-merge',
  'monitor',
  'shield-off',
  'user-minus',
  'at-sign',
  'corner-down-left',
  'git-pull-request',
  'moon',
  'shield',
  'user-plus',
  'atom',
  'corner-down-right',
  'github',
  'more-horizontal',
  'shopping-bag',
  'user-x',
  'award',
  'corner-left-down',
  'gitlab',
  'more-information',
  'shopping-cart',
  'user',
  'bar-chart-2',
  'corner-left-up',
  'globe',
  'more-vertical',
  'shuffle',
  'users',
  'bar-chart',
  'corner-right-down',
  'grid',
  'mouse-pointer',
  'sidebar',
  'video-off',
  'battery-charging',
  'corner-right-up',
  'hard-drive',
  'move',
  'skip-back',
  'video',
  'battery',
  'corner-up-left',
  'hash',
  'music',
  'skip-forward',
  'voicemail',
  'bell-off',
  'corner-up-right',
  'headphones',
  'navigation-2',
  'slack',
  'volume-1',
  'bell',
  'cpu',
  'heart',
  'navigation',
  'slash',
  'volume-2',
  'bluetooth',
  'credit-card',
  'help-circle',
  'note',
  'sliders',
  'volume-x',
  'bold',
  'crop',
  'hexagon',
  'octagon',
  'smartphone',
  'volume',
  'book-open',
  'crosshair',
  'home',
  'package',
  'smile',
  'warehouse',
  'book',
  'cursiva',
  'pause-circle',
  'sparks',
  'watch',
  'bookmark',
  'database',
  'image',
  'pause',
  'speaker',
  'widget',
  'box',
  'delete',
  'inbox',
  'pen-tool',
  'square',
  'wifi-off',
  'briefcase',
  'disc',
  'info',
  'percent',
  'wifi',
  'building',
  'divide-circle',
  'instagram',
  'phone-call',
  'star',
  'wind',
  'calendar',
  'divide-square',
  'invoice',
  'phone-forwarded',
  'stop-circle',
  'x-octagon',
  'camera-off',
  'divide',
  'kanban',
  'phone-incoming',
  'strikethrough',
  'x-square',
  'camera',
  'dollar-sign',
  'key',
  'phone-missed',
  'sun',
  'x',
  'cast',
  'download-cloud',
  'layers',
  'phone-off',
  'sunrise',
  'youtube',
  'check-circle-filled',
  'download',
  'layout',
  'phone-outgoing',
  'sunset',
  'zap-off',
  'check-circle',
  'drag',
  'life-buoy',
  'phone',
  'tab',
  'zap',
  'check-square',
  'dribbble',
  'link-2',
  'pie-chart',
  'table',
  'zoom-in',
  'check',
  'droplet',
  'link',
  'pin-filled',
  'tablet',
  'zoom-out',
  'chevron-down',
  'edit-2',
  'linkedin',
  'pin-outline',
  'tag',
  'chevron-left',
  'edit-3',
  'list',
  'play-circle',
  'target',
  'chevron-right',
  'edit',
  'loader',
  'play',
  'terminal',
  'chevron-up',
  'eraser',
  'lower-flap',
  'thermometer',
  'chevrons-down',
  'external-link',
  'lock',
  'plus-circle',
  'thermometer',
];

```

## Archivo: `packages/storybook/src/stories/Icons/styles.ts`

```typescript
import { theme } from '../../../../ComponentLibrary/src/theme';
import type { CSSProperties } from 'react';

export const cardStyles: CSSProperties = {
  margin: '0.25rem',
  padding: '0.5rem',
  width: '10.75rem',
  textAlign: 'center',
  borderRadius: theme.shape.borderRadius,
};

export const boxStyles: CSSProperties = {
  height: '5rem',
  display: 'flex',
  alignItems: 'center',
  justifyContent: 'center',
  borderRadius: theme.shape.borderRadius,
};

export const typographyStyles = {
  caption: {
    fontWeight: 600,
    fontSize: '0.75rem',
  },
};

export const typographyTitleStyles = {
  margin: 16,
  marginBottom: 0,
  color: theme.palette.baselineColor.neutral[90],
  fontWeight: 500,
  fontSize: '1.5rem',
};

```

## Archivo: `packages/storybook/src/stories/Styles/Typography/styles.ts`

```typescript
import { theme } from '../../../../../ComponentLibrary/src/theme';

export const typographyTitleStyles = {
  margin: 16,
  color: theme.palette.baselineColor.neutral[90],
  fontWeight: 500,
  fontSize: '1.5rem',
  marginBottom: '0.5rem',
};

```

## Archivo: `packages/storybook/src/styles/Modal.stories.styles.ts`

```typescript
import type { Theme } from '@emotion/react';
import type { SxProps } from '@mui/material';
import type { CSSProperties } from 'react';
import { theme } from '../../../ComponentLibrary/src/theme';

export const sx: { [key: string]: SxProps<Theme> } = {
  menuStyles: {
    display: 'flex',
    alignItems: 'center',
    '&:hover': {
      color: theme.palette.dynamicColor.dark,
    },
  },
};

export const styles: { [key: string]: CSSProperties } = {
  spanStyles: {
    marginRight: '0.5rem',
  },
};

```

## Archivo: `packages/storybook/src/styles/colors.ts`

```typescript
export const PRIMARY_20 = '#333333';
export const PRIMARY_30 = '#8689AA';
export const PRIMARY_40 = '#606380';
export const PRIMARY_50 = '#575A72';
export const PRIMARY_60 = '#4B539D';
export const PRIMARY_80 = '#303775';
export const PRIMARY_100 = '#202452';

export const SECONDARY_30 = '#FEF7D0';
export const SECONDARY_50 = '#FFEB7A';
export const SECONDARY_100 = '#FAD614';

export const TERTIARY_10 = '#F2F5F9';
export const TERTIARY_30 = '#EFF1F7';
export const TERTIARY_50 = '#EDF1FF';
export const TERTIARY_100 = '#808695';

export const QUATERNARY_10 = '#F5F5FC';
export const QUATERNARY_50 = '#DDDFF6';
export const QUATERNARY_70 = '#1EA7FD50';
export const QUATERNARY_100 = '#7182FF';

export const NEUTRAL_0 = '#FFFFFF';
export const NEUTRAL_5 = '#F2F2F2';
export const NEUTRAL_10 = '#E5E5E5';
export const NEUTRAL_20 = '#616161';
export const NEUTRAL_30 = '#212121';
export const NEUTRAL_40 = '#999999';
export const NEUTRAL_50 = '#FAFAFA';
export const NEUTRAL_60 = '#808080';
export const NEUTRAL_70 = '#999999';
export const NEUTRAL_80 = '#00000010';
export const NEUTRAL_90 = '#1A1B26';
export const NEUTRAL_100 = '#000000';

export const INITIAL_10 = '#ECF5FF';
export const INITIAL_90 = '#1EA7FD';
export const INITIAL_100 = '#3E97FF';

export const PROCESS_10 = '#FFF6EC';
export const PROCESS_100 = '#FBA643';

export const SUCCESS_10 = '#E5F7ED';
export const SUCCESS_100 = '#00B34C';

export const DESTRUCTIVE_10 = '#FEF0EF';
export const DESTRUCTIVE_100 = '#F36A62';

export const DEFAULT_COLOR_THEME = PRIMARY_100;

```

## Archivo: `packages/storybook/src/svg.d.ts`

```typescript
declare module '*.svg?url' {
  const content: string;
  export default content;
}

declare module '*.svg' {
  import type * as React from 'react';
  const SVGComponent: React.FunctionComponent<React.SVGProps<SVGSVGElement> & { title?: string }>;
  export default SVGComponent;
}

```

## Archivo: `packages/storybook/src/vite-env.d.ts`

```typescript
/// <reference types="./@types/svg" />
/// <reference types="vite/client" />

```

## Archivo: `packages/storybook/vite.config.ts`

```typescript
import path from 'path';
import react from '@vitejs/plugin-react';
import { defineConfig } from 'vite';
import svgr from 'vite-plugin-svgr';

export default defineConfig({
  plugins: [
    react(),
    svgr({
      include: '**/*.svg',
      svgrOptions: {
        icon: true,
      },
    }),
  ],
  resolve: {
    alias: {
      '@workspaceui/api-client': path.resolve(__dirname, '../api-client'),
      '@workspaceui/componentlibrary': path.resolve(__dirname, '../ComponentLibrary'),
    },
  },
});

```

